/*! cui 2016-11-08 */
var datepicker_instActive,formatOptions={ymdFormat:["dd","MMdd","yyyyMM","yyyyMMdd"],ymFormat:["yyyy","yyyyMM"],yFormat:["yyyy"]};$.coral.trim=function(a){return a.replace(/(^\s*)|(\s*$)/g,"")},$.coral.parseDate=function(a,b,c){var d,e=c;if(null==a||null==b)throw"Invalid arguments";if(c=c||{},b="object"==typeof b?b.toString():b+"",""===b)return null;if("timepicker"==e.model){var f=new Date,g=[];a="yyyy-MM-dd "+e.timeFormat,g.push(f.getFullYear()),g.push(f.getMonth()+1),g.push(f.getDate()),b=g.join("-")+" "+b}d=configDateFormat(a,b,c),a=d.format,b=d.value;var h,i,f,j=_hasTime(a),k=0,l=(c?c.shortYearCutoff:null)||c.shortYearCutoff,m="string"!=typeof l?l:(new Date).getFullYear()%100+parseInt(l,10),e=((c?c.dayNamesShort:null)||c.dayNamesShort,(c?c.dayNames:null)||c.dayNames,(c?c.monthNamesShort:null)||c.monthNamesShort,(c?c.monthNames:null)||c.monthNames,c.opts),n=-1,o=-1,p=-1,q=-1,r=-1,s=-1,t=-1,u=!1,v=function(b){var c=h+1<a.length&&a.charAt(h+1)===b;return c&&h++,c},w=function(b){for(var c=1;h+1<a.length&&a.charAt(h+1)==b;)c++,h++;return c},x=function(a,c){if(k>b.length||k==b.length)return-1;var d=new RegExp("^\\d{1,"+c+"}"),e=b.substring(k).match(d);if(!e)throw"Missing number at position "+k;return k+=e[0].length,parseInt(e[0],10)},y=function(){""!==b.charAt(k)&&b.charAt(k)!==a.charAt(h)||k++};for(h=0;h<a.length;h++)if(u)"'"!==a.charAt(h)||v("'")?y():u=!1;else switch(a.charAt(h)){case"d":var z=w("d");p=x("d",z);break;case"M":z=w("M"),o=x("M",z);break;case"y":z=w("y"),n=x("y",z);break;case"H":z=w("H"),r=x("H",z);break;case"m":z=w("m"),s=x("m",z);break;case"s":z=w("s"),t=x("s",z);break;default:y()}if(-1==p&&(p=1,-1==o&&(o=1)),-1!=p&&-1==o&&(o=(new Date).getMonth()+1),-1===n?n=(new Date).getFullYear():100>n&&(n+=(new Date).getFullYear()-(new Date).getFullYear()%100+(m>=n?0:-100)),q>-1)for(o=1,p=q;;){if(i=_getDaysInMonth(n,o-1),i>=p)break;o++,p-=i}if(n=-1==n?1:n,r=-1==r?0:r,s=-1==s?0:s,t=-1==t?0:t,f=_daylightSavingAdjustWidthTime(new Date(n,o-1,p),[r,s,t]),f.getFullYear()!==n||f.getMonth()+1!==o||f.getDate()!==p||j&&(f.getHours()!==r||f.getMinutes()!==s||f.getSeconds()!==t))throw"Invalid date";return f},$.coral.longToStringDate=function(a,b){var c;if(!$.trim(a)||1==a&&b.restrictConvert)return"";c=void 0==b?"yyyy-MM-dd":b.dateFormat;var d=new Date(parseInt(a)),e=$.coral.formatDate(c,d,b);return e},$.coral.stringToLongDate=function(a,b){if(!$.trim(a))return b.restrictConvert?1:"";var c=new Date(a),a=c.getTime();return a},$.coral.formatDate=function(a,b,c){if(!b)return"";var d,e=c,f=e?e.dayNamesShort:null,g=e?e.dayNames:null,h=(e?e.monthNamesShort:null,e?e.monthNames:null),i=function(b){var c=d+1<a.length&&a.charAt(d+1)===b;return c&&d++,c},j=function(b){for(var c=1;d+1<a.length&&a.charAt(d+1)==b;)c++,d++;return c},k=function(a,b,c){var d=""+b;if(i(a))for(;d.length<c;)d="0"+d;return d},l=function(a,b,c,d){return i(a)?d[b]:c[b]},m="",n=!1;if(e&&"timepicker"==e.model&&(a="yyyy-MM-dd "+e.timeFormat),b)for(d=0;d<a.length;d++)if(n)"'"!==a.charAt(d)||i("'")?m+=a.charAt(d):n=!1;else switch(a.charAt(d)){case"d":m+=k("d",b.getDate(),2);break;case"D":m+=l("D",b.getDay(),f,g);break;case"M":var o=j("M");4==o?m+=h[b.getMonth()]:3==o?m+=h[b.getMonth()]:2==o?m+=b.getMonth()+1>9?b.getMonth()+1:"0"+(b.getMonth()+1):1==o&&(m+=b.getMonth()+1);break;case"y":o=j("y"),4==o?m+=b.getFullYear():3==o?m+=(b.getFullYear()+"").substring(1,4):2==o?m+=(b.getYear()%100<10?"0":"")+b.getYear()%100:1==o&&(m+=b.getYear()%100);break;case"H":o=j("H"),2==o?m+=b.getHours()>9?b.getHours():"0"+b.getHours():1==o&&(m+=b.getHours());break;case"m":o=j("m"),2==o?m+=b.getMinutes()>9?b.getMinutes():"0"+b.getMinutes():1==o&&(m+=b.getMinutes());break;case"s":o=j("s"),2==o?m+=b.getSeconds()>9?b.getSeconds():"0"+b.getSeconds():1==o&&(m+=b.getSeconds());break;case"W":o=j("W"),2==o?m+=c.calculateWeek(b)>9?c.calculateWeek(b):"0"+c.calculateWeek(b):1==o&&(m+=c.calculateWeek(b));break;case"w":m+=b.getDay();break;default:m+=a.charAt(d)}return e&&"timepicker"==e.model&&(m=m.substring(m.indexOf(" ")+1,m.length)),m},_hasTime=function(a){var b=a+"";return-1!=b.indexOf("H")||-1!=b.indexOf("m")||-1!=b.indexOf("s")},getFormatter=function(a,b,c){var d=null,e=null,f=c;b.indexOf("y")>-1&&b.indexOf("M")>-1&&b.indexOf("d")>-1&&(d="ymdFormat"),b.indexOf("y")>-1&&b.indexOf("M")>-1&&-1==b.indexOf("d")&&(d="ymFormat"),b.indexOf("y")>-1&&-1==b.indexOf("M")&&-1==b.indexOf("d")&&(d="yFormat");var g=f.formatOptions||formatOptions,a="object"==typeof a?a.toString():a+"";if(""===a)return null;var h=a.split(" ");if(h[0].indexOf("/")>-1||h[0].indexOf("-")>-1)for(var i=h[0].indexOf("/")>-1?h[0].split("/"):h[0].split("-"),j=0;j<i.length;j++)i[j].length%2!=0&&(i[j]="0"+i[j]),h[0]=i.join("-");for(var k=h[0].indexOf("/")>-1?h[0].replace(/\//g,""):h[0].replace(/-/g,""),j=(h[0].split("/").length-1,h[0].split("-").length-1,0);j<g[d].length;j++)g[d][j].length==k.length&&(e=g[d][j]);return(e?e:b)||null},configDateFormat=function(a,b,c){var d=a,e=a.split(" "),f=(e[1]||"",b.split(" "));if(f[0].indexOf("/")>-1||f[0].indexOf("-")>-1)for(var g=f[0].indexOf("/")>-1?f[0].split("/"):f[0].split("-"),h=0;h<g.length;h++)g[h].length%2!=0&&(g[h]="0"+g[h]),f[0]=g.join("-");return a=getFormatter(f[0],e[0],c),a+=d.substr(e[0].length,d.length),f[0]=f[0].indexOf("/")>-1?f[0].replace(/\//g,""):f[0].replace(/-/g,""),b=f.join(" "),{format:a,value:b}},_daylightSavingAdjust=function(a){return a?(a.setHours(a.getHours()>12?a.getHours()+2:0),a):null},_getFormatConfig=function(a){var b=a.shortYearCutoff;return b="string"!=typeof b?b:(new Date).getFullYear()%100+parseInt(b,10),{shortYearCutoff:b,dayNamesShort:a.dayNamesShort,dayNames:a.dayNames,monthNamesShort:a.monthNamesShort,monthNames:a.monthNames,calculateWeek:a.calculateWeek,opts:a}},_daylightSavingAdjustWidthTime=function(a,b){var c=_daylightSavingAdjust(a);return c&&(c.setHours(b[0]),c.setMinutes(b[1]),c.setSeconds(b[2]),c.setMilliseconds(0)),a},$.component("coral.datepicker",$.coral.inputbase,{castProperties:["showRequiredMark","hideRequiredMark","shortCut"],version:"4.0.2",componentName:"datepicker",componentFullName:"coral-datepicker",initialized:!1,_curInst:null,_keyEvent:!1,_disabledInputs:[],_datepickerShowing:!1,_inDialog:!1,_mainDivId:"coral-datepicker-divId",_inlineClass:"coral-datepicker-inline",_appendClass:"coral-datepicker-append",_triggerClass:"coral-datepicker-trigger",_dialogClass:"coral-datepicker-dialog",_disableClass:"coral-datepicker-disabled",_unselectableClass:"coral-datepicker-unselectable",_currentClass:"coral-datepicker-current-day",_dayOverClass:"coral-datepicker-days-cell-over",regional:[],options:{showOn:"button",showAnim:"fadeIn",showOptions:{},closeOnClick:!0,iframePanel:!1,dateFormat:"yyyy-MM-dd",timeFormat:"HH:mm:ss",formatOptions:formatOptions,firstDay:1,isRTL:!1,showMonthAfterYear:!0,defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!0,changeYear:!0,complete:!0,yearRange:"c-30:c+30",showOtherMonths:!0,selectOtherMonths:!0,showWeek:!1,calculateWeek:function(a){var b,c=new Date(a.getTime());return c.setDate(c.getDate()+4-(c.getDay()||7)),b=c.getTime(),c.setMonth(0),c.setDate(1),Math.floor(Math.round((b-c)/864e5)/7)+1},shortYearCutoff:"+10",validDate:!0,model:"datepicker",minDate:null,maxDate:null,minTime:null,maxTime:null,duration:"fast",beforeShowDay:null,beforeShow:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!0,autoSize:!1,disabled:!1,isLabel:!1,readonly:!1,readonlyInput:!1,showClose:!1,value:null,required:!1,showStar:!0,starBefore:!1,errMsg:null,errMsgPosition:"leftBottom",startDateId:null,endDateId:null,onSelect:null,onChange:null,onFormatError:null,onFormatWarn:null,srcDateFormat:null,zIndex:null,name:null,triggers:null,excluded:!1,valueType:"string",restrictConvert:!0},markerClassName:"hasDatepicker",maxRows:4,extendRemove:function(a,b){$.extend(a,b);for(var c in b)null==b[c]&&(a[c]=b[c]);return a},bindHover:function(a){var b=this,c="button, .coral-datepicker-prev, .coral-datepicker-next, .coral-datepicker-calendar td a, .menuTimeSel";return a.delegate(c,"mouseout",function(){$(this).removeClass("coral-state-hover"),-1!==this.className.indexOf("coral-datepicker-prev")&&$(this).removeClass("coral-datepicker-prev-hover"),-1!==this.className.indexOf("coral-datepicker-next")&&$(this).removeClass("coral-datepicker-next-hover")}).delegate(c,"mouseover",{element:b},b.datepicker_handleMouseover)},datepicker_handleMouseover:function(a){var b=a.data?a.data.element:a;b.isDisabled()||($(this).parents(".coral-datepicker-calendar").find("a").removeClass("coral-state-hover"),$(this).addClass("coral-state-hover"),-1!==this.className.indexOf("coral-datepicker-prev")&&$(this).addClass("coral-datepicker-prev-hover"),-1!==this.className.indexOf("coral-datepicker-next")&&$(this).addClass("coral-datepicker-next-hover"))},widget:function(){return this.dpDiv},_create:function(){var a,b;a=this.element[0].nodeName.toLowerCase(),b="div"===a||"span"===a,this.regional[""]={closeText:"关闭",prevText:"上月",nextText:"下月&#x3E;",currentText:"今天",monthNames:["1","2","3","4","5","6","7","8","9","10","11","12"],monthNamesShort:["1","2","3","4","5","6","7","8","9","10","11","12"],dayNames:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],dayNamesShort:["周日","周一","周二","周三","周四","周五","周六"],dayNamesMin:["日","一","二","三","四","五","六"],weekHeader:"周",yearSuffix:"年",monthSuffix:"月"},$.extend(this.options,this.regional[""]);var c=this.options;null!=c.dateFormat&&null==c.srcDateFormat&&(c.srcDateFormat=c.dateFormat),"long"==c.valueType&&c.value&&(c.value=$.coral.longToStringDate(c.value,c)),this.regional.en=$.extend(!0,{},this.regional[""]),this.regional["en-US"]=$.extend(!0,{},this.regional.en);$("body").find("#coral-datepicker-divId");if(this.dpDiv=$("#coral-datepicker-divId").length?$("#coral-datepicker-divId"):this.bindHover($("<div id='"+this._mainDivId+"' class='coral-datepicker coral-component coral-component-content coral-helper-clearfix coral-corner-all'></div>")),this.iframePanel=$("<iframe class='coral-datepicker-iframePanel' style='position:absolute;height:auto;'></iframe>"),this.initialized||($(document).mousedown({that:this},this._checkExternalClick),this.initialized=!0),0===$("#"+this._mainDivId).length&&$("body").append(this.dpDiv),this.prepareInit(this.options),this._initElement(),c.startDateId){$("#"+c.startDateId).datepicker("option","endDateId",this.element[0].id);var d=$("#"+c.startDateId).datepicker("getValue");$("#"+this.element[0].id).datepicker("option","minDate",d)}"input"===a?this.connect():b&&this.inline(),$(document).off(".coral-datepicker").on("mousedown.coral-datepicker","#"+this._mainDivId,function(a){return $(a.target).hasClass("menuTimeSel")?void a.stopPropagation():void a.stopPropagation()})},component:function(){return this.element.parent().parent()},_initElement:function(){var a=this.options,b=a.id,c=this.element.attr("name")||a.name||"",d=$.coral.trim(a.value),e=a.width,f=a.height,g=a.cls,h=a.labelField,i=a.showClose,j="",k=a.componentCls;this.originalValue=d,c&&this.element.removeAttr("name"),i&&(j="<span class='coral-input-clearIcon cui-icon-cross2'></span>");var l=$("<input id='"+b+"_srcval' name='"+c+"' type='hidden' value='"+(null==d?"":d)+"'>"),m=$("<span id='"+b+"_eleBorder' class='coral-textbox-border coral-corner-all'>"+j+"</span>"),n=$("<span id='"+b+"_eleComp' class='coral-textbox'></span>");if(this.element.addClass("coral-textbox-default coral-validation-datepicker tabbable "),this.element.addClass("coral-form-element-datepicker ctrl-init ctrl-form-element ctrl-init-datepicker"),null!=f&&(n.outerHeight(f),this.element.outerHeight("100%")),null!=e&&n.outerWidth(e),n.insertAfter(this.element).addClass(k),l.appendTo(m),this.element.appendTo(m).addClass(g),m.appendTo(n),a.iframePanel&&this.iframePanel.appendTo("body").hide(),null!=h){var o=$('<label class="coral-label">'+h+"</label>");m.before(o),n.addClass("coral-hasLabel")}this.options.readonly||this.element.prop("readonly",this.options.readonlyInput)},prepareInit:function(a){var b=this.element[0];a=a||{},b.id?a.id?b.id=a.id:a.id=$(b).uniqueId().attr("id"):(a.id&&(b.id=a.id),a.id=$(b).uniqueId().attr("id")),b.name?a.name?b.name=a.name:a.name=$(b).attr("name"):(a.name&&(b.name=a.name),a.name=$(b).attr("name")),a.value=$(b).val()||a.value||"";var c="div"===b.nodeName.toLowerCase()||"span"===b.nodeName.toLowerCase();this._newInst($(b),c)},_newInst:function(a,b){var c=a[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");this.dpDiv.css({display:"none"}),a.attr("component-role",this.componentName),this.inst={id:c,input:a,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:b,isShow:!1,dpDiv:b?this.bindHover($("<div class='"+this._inlineClass+" coral-datepicker coral-datepicker-panel coral-component coral-component-content coral-helper-clearfix coral-corner-all'></div>")):this.dpDiv},$.extend(this.options,this.inst)},connect:function(){var a=this.options,b=this.element[0],c=$(b),d=this;a.append=$([]),a.trigger=$([]),c.hasClass(this.markerClassName)||(this._attachments(c),c.addClass(this.markerClassName).keydown({that:d},this._doKeyDown).keypress({that:d},this._doKeyPress).keyup({that:d},this._doKeyUp),this._autoSize(),a.disabled&&this.disable(),a.readonlyInput&&this.readonlyInput(a.readonlyInput),a.readonly&&this.readonly(a.readonly),a.isLabel&&this.isLabel(a.isLabel))},_processDefaultDate:function(a,b){var c=this.options;if(""==b)return c.selectedDay=c.currentDay=null,c.selectedMonth=c.currentMonth=null,c.selectedYear=c.currentYear=null,c.currentHur=null,c.currentMiu=null,c.currentSed=null,c.input.val(""),null;var d=c.dateFormat,e=null;try{e=$.coral.parseDate(d,b,c)}catch(f){return null}c.selectedDay=c.currentDay=e.getDate(),c.selectedMonth=c.currentMonth=e.getMonth(),c.selectedYear=c.currentYear=e.getFullYear(),c.currentHur=e.getHours(),c.currentMiu=e.getMinutes(),c.currentSed=e.getSeconds();var g=_daylightSavingAdjustWidthTime(new Date(c.currentYear,c.currentMonth,c.currentDay),[c.currentHur,c.currentMiu,c.currentSed]),h="";if(!c.value&&b&&(c.value=b),""!=c.value){var i=getFormatter(c.value,c.dateFormat,c);h=this.completeFormate(i,d),h=$.coral.formatDate(h,g,c)}return c.input.val(h),g},_attachments:function(a){var b,c,d=this,e=this.options,f=e.appendText,g=e.isRTL;e.append&&e.append.remove(),f&&(e.append=$("<span class='"+this._appendClass+"'>"+f+"</span>"),a[g?"before":"after"](e.append)),a.unbind("focus",this.show),a.unbind("blur"),a.parent().unbind("mouseleave"),a.parent().unbind("mouseenter"),a.unbind(".attachments"),e.trigger&&e.trigger.remove();var h=$.coral.trim(e.value);if(""==a.parent().find("input[type='hidden']").val()&&"string"==typeof h&&""!=h)d._processDefaultDate(d,h),d._setHiddenInputValue();else{var i=d._getHiddenInputValue();d._processDefaultDate(d,i)}a.parent().find(".coral-input-clearIcon").unbind("click").bind("click",function(a){d.setValue("",!0)}),b=e.showOn,a.focus(function(a){"focus"!==b&&"both"!==b||d.show(a),d.options.readonly||d.options.isLabel||d.component().addClass("coral-state-focus")}),"button"!==b&&"both"!==b||(c=e.buttonText,e.trigger=$("<span/>").addClass("coral-icon-calendar cui-icon-calendar4"),a[g?"before":"after"](e.trigger),1==e.isLabel&&a.parent().addClass("coral-datepicker-no-close"),e.trigger.click(function(b){return d._datepickerShowing&&d._lastInput===a[0]?d.hide():d._datepickerShowing&&d._lastInput!==a[0]&&d.hide(),d.show(),!1})),a.blur(function(a){d._inputBlur(e,a)}),a.parent().mouseleave(function(){e.readonly||e.isLabel||e.disabled||e.readonlyInput||a.parent().parent().removeClass("coral-textbox-hover")}),a.parent().mouseenter(function(){e.readonly||e.isLabel||e.disabled||e.readonlyInput||a.parent().parent().addClass("coral-textbox-hover")}),a.bind("keyup.attachments",function(a){switch(a.keyCode){case 9:d.show(a)}})},_autoSize:function(){var a=this.options;if(a.autoSize&&!a.inline){var b,c,d,e,f=new Date(2009,11,20),g=a.dateFormat;if(g.match(/[DM]/)){b=function(a){for(c=0,d=0,e=0;e<a.length;e++)a[e].length>c&&(c=a[e].length,d=e);return d};g.match(/MM/)?"monthNames":"monthNamesShort",g.match(/DD/)?"dayNames":"dayNamesShort";f.setMonth(b(a.matchMM)),f.setDate(b(a.amtchDD)+20-f.getDay())}a.input.attr("size",this._formatDate(f).length)}},inline:function(){var a=this.element[0],b=this.options,c=$(a);c.hasClass(this.markerClassName)||(c.addClass(this.markerClassName).append(b.dpDiv),this._setDate(this._getDefaultDate(),!0),this.update(),this._updateAlternate(),b.disabled&&this.disable(a),b.dpDiv.css("display","block"))},dialog:function(a,b,c,d){var e,f,g,h,i,j=(this.element[0],this),k=this._dialogInst;return k||(this.uuid+=1,e="dp"+this.uuid,this._dialogInput=$("<input type='text' id='"+e+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown({that:j},this._doKeyDown),$("body").append(this._dialogInput),this._newInst(this._dialogInput,!1),this._dialogInst=k,inst.options={}),j.extendRemove(inst.options,c||{}),a=a&&a.constructor===Date?this._formatDate(inst,a):a,this._dialogInput.val(a),this._pos=d?d.length?d:[d.pageX,d.pageY]:null,this._pos||(f=document.documentElement.clientWidth,g=document.documentElement.clientHeight,h=document.documentElement.scrollLeft||document.body.scrollLeft,i=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[f/2-100+h,g/2-150+i]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),inst.options.onSelect=b,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this.show(),$.blockUI&&$.blockUI(this.dpDiv),this},_destroy:function(){var a,b=this.options,c=this.element[0],d=$(c);$(c).parent().parent().replaceWith(d),d.hasClass(this.markerClassName)&&(a=c.nodeName.toLowerCase(),$.removeData(c,"inited"),b.isShow=!1,"input"===a?(b.append.remove(),b.trigger.remove(),d.removeClass(this.markerClassName).unbind(".field").unbind(".restrictInput").unbind("blur").unbind("focus").unbind("keydown").unbind("keypress").unbind("keyup").unbind("datepickeronblur").unbind("datepickeronchange").unbind("datepickeronkeydown").unbind("datepickeronkeyup").unbind("datepickeronstatus").unbind("onOptionChange")):"div"!==a&&"span"!==a||d.removeClass(this.markerClassName).empty(),$(c).val(""),$(c).removeAttr("value"),d.removeAttr("component-role").removeClass("coral-textbox-default coral-validation-datepicker coral-form-element-datepicker ctrl-init ctrl-form-element ctrl-init-datepicker").removeAttr("data-options"))},enable:function(){var a,b,c=this.element[0],d=this.options,e=$(c);e.hasClass(this.markerClassName)&&(a=c.nodeName.toLowerCase(),"input"===a?(c.disabled=!1,d.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""}),e.parent().parent().removeClass("coral-state-disabled")):"div"!==a&&"span"!==a||(b=e.children("."+this._inlineClass),b.children().removeClass("coral-state-disabled"),b.find("select.coral-datepicker-month, select.coral-datepicker-year").prop("disabled",!1)),this._disabledInputs=$.map(this._disabledInputs,function(a){return a===c?null:a}))},disable:function(){var a,b,c=this.element[0],d=this.options,e=$(c);e.hasClass(this.markerClassName)&&(a=c.nodeName.toLowerCase(),"input"===a?(c.disabled=!0,d.trigger.css({opacity:"0.5",cursor:"default"}),e.parent().parent().addClass("coral-state-disabled")):"div"!==a&&"span"!==a||(b=e.children("."+this._inlineClass),b.children().addClass("coral-state-disabled"),b.find("select.coral-datepicker-month, select.coral-datepicker-year").prop("disabled",!0)),this._disabledInputs=$.map(this._disabledInputs,function(a){return a===c?null:a}),this._disabledInputs[this._disabledInputs.length]=c)},readonly:function(a){var b=this.element[0],c=$(b);c.hasClass(this.markerClassName)&&($(b).parent().parent().removeClass("coral-isLabel"),$(b).parent().parent().toggleClass("coral-readonly",a),$(b).toggleClass("tabbable",!a),this._readonly(b,a))},_readonly:function(a,b){var c=a.nodeName.toLowerCase(),d=this.options;if("input"===c&&b&&(a.readOnly=!0,d.trigger.filter("button").each(function(){this.readOnly=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})),"input"===c&&!b){if(this.isIsLabel())return;a.readOnly=!1,d.trigger.filter("button").each(function(){this.readOnly=!1}).end().filter("img").css({opacity:"1.0",cursor:""})}},readonlyInput:function(a){this.options.readonly||this.element.prop("readonly",a)},isReadonly:function(){return this.options.readonly?this.options.readonly:!1},isReadonlyInput:function(){return this.options.readonlyInput?this.options.readonlyInput:!1},isIsLabel:function(){return this.options.isLabel?this.options.isLabel:!1},isLabel:function(a){var b=this.element[0],c=$(b),d=this.options;if(c.hasClass(this.markerClassName)){d.id;a?(c.parent().removeClass("coral-datepicker-no-close"),c.parent().parent().removeClass("coral-readonly"),c.parent().parent().addClass("coral-isLabel"),c.removeClass("tabbable")):(c.parent().parent().removeClass("coral-isLabel coral-readonly"),c.parent().addClass("coral-datepicker-no-close"),c.addClass("tabbable")),this.options.readonly=a,this.options.isLabel=a,this._readonly(b,a)}},isDisabled:function(){var a=this.element[0];if(!a)return!1;for(var b=0;b<this._disabledInputs.length;b++)if(this._disabledInputs[b]===a)return!0;return!1},_doOption:function(a,b){var c,d,e,f=this,g=this.options;c=this.getDate(!0),d=this._getMinMaxDate("min"),e=this._getMinMaxDate("max");var h=this._getHiddenInputValue();if("value"==a){if(b){var i=getFormatter(b,g.dateFormat,g),j=$.coral.parseDate(i,b,g),k=g.srcDateFormat;2===this._checkDateRange(j)&&(b=$.coral.formatDate(k,d,g)),1===this._checkDateRange(j)&&(b=$.coral.formatDate(k,e,g))}c=f._processDefaultDate(f,b)}(null!==d&&"dateFormat"==a||null!==d&&"minDate"==a)&&(g.minDate=this._formatDate(d)),(null!==e&&"dateFormat"==a||null!==e&&"maxDate"==a)&&(g.maxDate=this._formatDate(e)),"disabled"==a&&(b?this.disable():this.enable()),"readonlyInput"==a&&this.readonlyInput(b),"readonly"==a&&this.readonly(b),"isLabel"==a&&this.isLabel(b),"showAnim"!=a&&("startDateId"===a&&$("#"+b).datepicker("option","endDateId",g.id),this._attachments(this.element),this._autoSize(),this._setDate(c),g.isShow&&this.update(),this._updateAlternate(),this._setHiddenInputValue(),"value"==a&&this._setStartEnd(h,b))},_setOption:function(a,b){"value"==a&&"long"==this.options.valueType&&(b=$.coral.longToStringDate(b,this.options)),this._super(a,b),this._doOption(a,b)},valid:function(){var a=this.element[0],b={hasTips:!1,element:$(a)};return!($.validate.validateField(null,b).length>0)},change:function(a,b){this.element[0];this.option(a,b)},refresh:function(){var a=(this.element[0],this.options);a&&this.update()},reset:function(){var a=this.element[0];$(a).datepicker("option","value",this.originalValue)},setValue:function(a,b){var c=this.options;"long"==c.valueType&&(a=$.coral.longToStringDate(a,c));var d=(this.element[0],this._getHiddenInputValue()),a=$.coral.trim(a);this._doOption("value",a),b&&this._change(d,a)},getValue:function(a){var b=(this.element[0],this.options),c=this.getDateValue();return"long"==b.valueType&&(c=$.coral.stringToLongDate(c,b)),c},getText:function(){return this.options.input.val()},getValidateValue:function(){return this.options.restrictConvert&&"long"==this.options.valueType?this.getText():this.getValue()},setDate:function(a){var b=this.options,c=b.dateFormat,d=$.coral.formatDate(c,a,b);this.setValue(d)},getDate:function(a){var b=(this.element[0],this.options);return b&&!b.inline&&this._setDateFromField(b,a),b?this._getDate():null},getDateValue:function(){this.element[0],this.options;return this._getHiddenInputValue()},_doKeyDown:function(a){var b,c,d,e=a.data.that,f=e.options,g=!0,h=f.dpDiv.is(".coral-datepicker-rtl"),i=e._getHiddenInputValue();if(f._keyEvent=!0,e._datepickerShowing)switch(a.keyCode){case 9:e.hide(),g=!1;break;case 13:d=$("td."+e._dayOverClass+":not(."+e._currentClass+")",f.dpDiv),d[0]&&e._selectDay(a.target,f.selectedMonth,f.selectedYear,d[0]),b=f.onSelect,b?c=e._formatDate():e.hide();case 27:e.hide();break;case 33:e._adjustDate(a.target,a.ctrlKey?-f.stepBigMonths:-f.stepMonths,"M");break;case 34:e._adjustDate(a.target,a.ctrlKey?+f.stepBigMonths:+f.stepMonths,"M");break;case 35:(a.ctrlKey||a.metaKey)&&e._clearDate(),g=a.ctrlKey||a.metaKey;break;case 36:(a.ctrlKey||a.metaKey)&&e._gotoToday(a.target),g=a.ctrlKey||a.metaKey;break;case 37:(a.ctrlKey||a.metaKey)&&e._adjustDate(a.target,h?1:-1,"D"),g=a.ctrlKey||a.metaKey,a.originalEvent.altKey&&e._adjustDate(a.target,a.ctrlKey?-f.stepBigMonths:-f.stepMonths,"M");break;case 38:(a.ctrlKey||a.metaKey)&&e._adjustDate(a.target,-7,"D"),g=a.ctrlKey||a.metaKey;break;case 39:(a.ctrlKey||a.metaKey)&&e._adjustDate(a.target,h?-1:1,"D"),g=a.ctrlKey||a.metaKey,a.originalEvent.altKey&&e._adjustDate(a.target,a.ctrlKey?+f.stepBigMonths:+f.stepMonths,"M");break;case 40:(a.ctrlKey||a.metaKey)&&e._adjustDate(a.target,7,"D"),g=a.ctrlKey||a.metaKey;break;default:g=!1}else if(36===a.keyCode&&a.ctrlKey)e.show();else switch(g=!1,a.keyCode){case 9:case 13:e._setHiddenInputValue(),c=e._getHiddenInputValue(),e._setStartEnd(i,c),e._change(i,c)}f.shortCut&&$.coral.callFunction(f.shortCut,a,this),e._trigger("onKeyDown",a,[{oldValue:i,value:f.input.val()}]),g&&(a.preventDefault(),a.stopPropagation())},_setStartEnd:function(a,b){var c=this.options;if(a!=b){var d=c.startDateId,e=c.endDateId;d&&$("#"+d).datepicker("option","maxDate",b),e&&$("#"+e).datepicker("option","minDate",b)}},_change:function(a,b,c){a!=b&&(this.options.value=b,this._trigger("onChange",c,[{oldValue:a,newValue:b,value:b}]))},_doKeyPress:function(a){},_doKeyUp:function(a){var b,c=a.data.that,d=c.options,e=c._getHiddenInputValue(),f=c._getMinMaxDate("min"),g=c._getMinMaxDate("max");if(d.input.val()!==d.lastVal){try{""==d.input.val()&&(d.selectedDay=null,d.drawMonth=d.selectedMonth=null,d.drawYear=d.selectedYear=null,d.currentDay=null,d.currentMonth=null,d.currentYear=null,d.currentHur=null,d.currentMiu=null,d.currentSed=null),b=$.coral.parseDate(d.dateFormat,d.input?d.input.val():null,d),d.input.addClass("isEdit"),b&&0===c._checkDateRange(b)?(c._setDateFromField(),c._updateAlternate()):1===c._checkDateRange(b)?(d.currentDay=g.getDate(),d.currentMonth=g.getMonth(),d.currentYear=g.getFullYear()):2===c._checkDateRange(b)&&(d.currentDay=f.getDate(),d.currentMonth=f.getMonth(),d.currentYear=f.getFullYear());d.input.val()}catch(h){d.input.val()}c._trigger("onKeyUp",a,[{oldValue:e,value:d.input.val()}])}return!0},_checkDateRange:function(a){var b,c,b=(this.options,this._getMinMaxDate("min"));return c=this._getMinMaxDate("max"),null!=c&&a>c?1:null!=b&&b>a?2:0},_srcDateFormatSeparator:function(a){var b="/";return a.indexOf("/")>-1?b:a.indexOf("-")>-1?b="-":void 0},_setHiddenInputValue:function(){var a=this.options;if(""==a.input.val())return void a.input.parent().find("input[type='hidden']").val("");var b=a.dateFormat,c=c||a.srcDateFormat,d=this._srcDateFormatSeparator(c);if(null==a.currentYear||null==a.currentMonth)return void a.input.parent().find("input[type='hidden']").val("");var e=_daylightSavingAdjustWidthTime(new Date(a.currentYear,a.currentMonth,a.currentDay),[a.currentHur,a.currentMiu,a.currentSed]),f=getFormatter(a.input.val(),a.dateFormat,a),g=this.completeFormate(f,b);if(a.complete)h=$.coral.formatDate(c,e,a);else if(c.indexOf("-")>-1||c.indexOf("/")>-1){g=g.indexOf("y")>-1&&g.indexOf("M")>-1&&g.indexOf("d")>-1?c:g;var h=$.coral.formatDate(g,e,_getFormatConfig(a));if(h.indexOf("-")>-1)var h=-1==h.indexOf(d)?h.replace(/-/gm,d):h;else if(h.indexOf("/")>-1)var h=-1==h.indexOf(d)?h.replace(/\//gm,d):h}else g=g.indexOf("-")>-1?g.replace(/-/gm,""):g.replace(/\//gm,""),g.indexOf("y")>-1&&(-1==g.indexOf("d")&&g.indexOf("y")>-1&&g.indexOf("M")>-1&&(c=c.split(" ")[0],g=c.replace(/d/gm,"")),g=g.indexOf("y")>-1&&g.indexOf("M")>-1&&g.indexOf("d")>-1?c:g),h=$.coral.formatDate(g,e,a);a.input.parent().find("input[type='hidden']").val(h)},_getHiddenInputValue:function(){var a=this.options;a.id;return a.input.parent().find("input[type='hidden']").val()},_createEditFormat:function(a){var b="";return null!=a&&(b+=this._isYearMonthMode(a)?"yyyy-MM":this._isYearMode(a)?"yyyy":"yyyy-MM-dd",_hasTime(a)&&(b+=" HH:mm:ss")),b},completeFormate:function(a,b){var c,d=this.options,e=b.indexOf("H")>-1?b.split(" ")[0]:b;if(d.complete)return b;if(-1==e.indexOf("d"))return-1==e.indexOf("d")&&-1==a.indexOf("M")?a:e;if(e.indexOf("d")>-1){var f=e.indexOf("y"),g=e.indexOf("d"),h=e.substr(g+2,e.length),i=e.substr(0,g-1);e.substr(0,g+2);if(2==a.length)return a;if(a.indexOf("y")>-1&&a.indexOf("d")>-1&&a.indexOf("M")>-1)return b;if(-1==a.indexOf("d")){if(-1==a.indexOf("M"))return a;0==g&&(c=h),8==g&&(c=i),3==g&&(c=i+h)}else-1==a.indexOf("y")&&(0==f&&(c=e.substr(f+5,5)),6==f&&(c=e.substr(0,f-1)))}return c},compMaxMin:function(){var a=this.options,b=this._getMinMaxDate("min"),c=this._getMinMaxDate("max");b&&a.currentYear==b.getFullYear()&&a.currentMonth==b.getMonth()&&a.currentDay==b.getDate().toString()?a.currentHur<b.getHours()?(a.currentHur=b.getHours(),a.currentMiu=b.getMinutes(),a.currentSed=b.getSeconds()):a.currentHur==b.getHours()&&(a.currentHur=b.getHours(),a.currentMiu<b.getMinutes()?(a.currentMiu=b.getMinutes(),a.currentSed=b.getSeconds()):a.currentMiu==b.getMinutes()&&(a.currentMiu=b.getMinutes(),a.currentSed<=b.getSeconds()&&(a.currentSed=b.getSeconds()))):c&&a.currentYear==c.getFullYear()&&a.currentMonth==c.getMonth()&&a.currentDay==c.getDate().toString()&&(a.currentHur>c.getHours()?(a.currentHur=c.getHours(),a.currentMiu=c.getMinutes(),a.currentSed=c.getSeconds()):a.currentHur==c.getHours()&&(a.currentHur=c.getHours(),a.currentMiu>c.getMinutes()?(a.currentMiu=c.getMinutes(),a.currentSed=c.getSeconds()):a.currentMiu==c.getMinutes()&&(a.currentMiu=c.getMinutes(),a.currentSed>=c.getSeconds()&&(a.currentSed=c.getSeconds()))))},_inputBlur:function(a){this.component().removeClass("coral-state-focus");var b=this.options,c=b.dateFormat;if(!this.isReadonly()&&!this.isIsLabel()){var d=this._getHiddenInputValue(),e="";this._getMinMaxDate("min"),this._getMinMaxDate("max");this.compMaxMin();var f=_daylightSavingAdjustWidthTime(new Date(b.currentYear,b.currentMonth,b.currentDay),[b.currentHur,b.currentMiu,b.currentSed]);if(("undefined"!=typeof b.currentYear||null!=b.currentYear)&&!b.isShow){var g=getFormatter(b.input.val(),b.dateFormat,b),h=/[\u4E00-\u9FA5]|[\uFE30-\uFFA0]|[a-zA-Z]|[`~!@#\$%\^\&\*\(\)_\+<>\?"\{\},\.\\\;'\[\]]|^[-\/:]|[-\/:]$/gi;h.exec(b.input.val())&&b.input.val(""),""!=b.input.val()&&(e=this.completeFormate(g,c),e=$.coral.formatDate(e,f,b)),b.input.val(e),this._setHiddenInputValue(),this._setStartEnd(d,e),this._change(d,e,null),this._trigger("onBlur",a,[{value:e}])}}},focus:function(a){return a?input=a.target:input=this.element[0],"input"!==input.nodeName.toLowerCase()&&(input=$("input",input.parentNode)[0]),this.isDisabled()||this._lastInput===input||this.isReadonly()||this.isIsLabel()||this.isReadonlyInput()?!1:(input.focus(),!0)},show:function(a){var b,c=this,d=this.options;if(b=a?a.target:this.element[0],"input"!==b.nodeName.toLowerCase()&&(b=$("input",b.parentNode)[0]),!(c.isDisabled()||c._lastInput===b||c.isReadonly()||c.isIsLabel())){var e,f,g,h,i,j;if($.coral._curInst&&$.coral._curInst!==d&&($.coral._curInst.dpDiv.stop(!0,!0),d&&c._datepickerShowing&&c.hide()),e=d.beforeShow,f=e?e.apply(b,[b,d]):{},f!==!1){c.extendRemove(d,f),d.lastVal=null,c._lastInput=b,c._setDateFromField(),c._inDialog&&(b.value=""),c._pos||(c._pos=c._findPos(b),c._pos[1]+=b.offsetHeight),g=!1,$(b).parents().each(function(){return g|="fixed"===$(this).css("position"),!g}),h={left:c._pos[0],top:c._pos[1]},c._pos=null,d.dpDiv.empty(),d.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),c.iframePanel.css({position:"absolute",display:"block",top:"-1000px"}),c.update();var k=$(d.dpDiv),l=c.iframePanel,m=k.width(),n=k.height();h=c._checkOffset(h,g),d.dpDiv.css({position:c._inDialog&&$.blockUI?"static":g?"fixed":"absolute",
display:"none",left:h.left+"px",top:h.top+"px"}),c.iframePanel.css({position:c._inDialog&&$.blockUI?"static":g?"fixed":"absolute",display:"none",left:h.left+"px",top:h.top+"px",width:m,height:n}),d.isShow||(d.isShow=!0,d.inline||(i=d.showAnim,j=d.duration,null!=d.zIndex&&(d.dpDiv.zIndex(d.zIndex+1),c.iframePanel.zIndex(d.zIndex)),c._datepickerShowing=!0,$.effects&&$.effects.effect[i]?d.dpDiv.show(i,d.showOptions,j):d.dpDiv[i||"show"](i?j:null),c.iframePanel.show(i),c._shouldFocusInput()&&d.input.focus(),c._curInst=d,$.coral._curInst=c._curInst),function o(){var a=$(b).parent().parent();d.isShow&&(k.css({left:$.coral.getLeft(k,a),top:$.coral.getTop(k,a)}),l.css({left:$.coral.getLeft(k,a),top:$.coral.getTop(k,a)}),setTimeout(o,200))}()),d.dpDiv.find("#dpTimeSpinner").spinner("setValue",d.dpDiv.find("#dpTimeHour").val()),d.dpDiv.find("#dpTimeSpinner").spinner("setValue",d.dpDiv.find("#dpTimeMinute").val()),d.dpDiv.find("#dpTimeSpinner").spinner("setValue",d.dpDiv.find("#dpTimeSecond").val())}}},_updateDateTime:function(){var a,b,c,d,e,f,g=this,h=[],i=this.options;if("timepicker"==i.model){var j=new Date;h.push(j.getFullYear(),j.getMonth(),j.getDate());var k=i.minTime?h.join("-")+" "+i.minTime:null,l=i.maxTime?h.join("-")+" "+i.maxTime:null,m=new Date(k),n=new Date(l);d=new Date(j.getFullYear(),j.getMonth(),j.getDate()),e=f=d}else{var k=this._getMinMaxDate("min"),l=this._getMinMaxDate("max"),m=new Date(k),n=new Date(l);d=new Date(i.selectedYear,i.selectedMonth,i.selectedDay),e=new Date(m.getFullYear(),m.getMonth(),m.getDate()),f=new Date(n.getFullYear(),n.getMonth(),n.getDate())}i.dpDiv.find("#coral-timePanel").find("#dpTimeHour").spinner({max:24,min:0,step:1,vertical:!0,onSpin:function(b,c){var h=$(this).spinner("getValue");return a=c.value,new Date(d).getTime()==new Date(e).getTime()&&k&&a<m.getHours()||l&&new Date(d).getTime()==new Date(f).getTime()&&a>n.getHours()?($(this).find("#dpTimeHour").val(h),!1):void g._selectTime(a)}}),i.dpDiv.find("#coral-timePanel").find("#dpTimeMinute").spinner({max:60,min:0,step:1,vertical:!0,onSpin:function(a,c){var h=$(this).spinner("getValue");b=c.value;var j=i.dpDiv.find("#dpTimeHour").val();return new Date(d).getTime()==new Date(e).getTime()&&k&&b<m.getMinutes()&&j<=m.getHours()||l&&new Date(d).getTime()==new Date(f).getTime()&&b>n.getMinutes()&&j>=n.getHours()?($(this).find("#dpTimeMinute").val(h),!1):void g._selectTime(null,c.value)}}),i.dpDiv.find("#coral-timePanel").find("#dpTimeSecond").spinner({max:60,min:0,step:1,vertical:!0,onSpin:function(a,b){var h=$(this).spinner("getValue");c=b.value;var j=i.dpDiv.find("#dpTimeHour").val(),o=i.dpDiv.find("#dpTimeMinute").val();return new Date(d).getTime()==new Date(e).getTime()&&k&&c<m.getSeconds()&&j<=m.getHours()&&o<=m.getMinutes()||l&&new Date(d).getTime()==new Date(f).getTime()&&c>n.getSeconds()&&j>=n.getHours()&&o>=n.getMinutes()?($(this).find("#dpTimeSecond").val(h),!1):void g._selectTime(null,null,b.value)}})},update:function(){var a=this.options,b=this;this.maxRows=4,datepicker_instActive=a,"datepicker"==a.model?(a.dpDiv.empty().append(this._generateHTML()).append(this._generateTimePanel()),a.dpDiv.find("#timepicker").find(".icon-checkmark").hide()):a.dpDiv.empty().append(this._generateTimePanel()),this._updateDateTime(),this._attachHandlers(),this._attachTimeHandlers();var c,d=this._getNumberOfMonths(),e=d[1],f=17,g=a.dpDiv.find("."+this._dayOverClass+" a");g.length>0&&this.datepicker_handleMouseover.apply(g.get(0),[b]),a.dpDiv.removeClass("coral-datepicker-multi-2 coral-datepicker-multi-3 coral-datepicker-multi-4").width(""),e>1&&a.dpDiv.addClass("coral-datepicker-multi-"+e).css("width",f*e+"em"),a.dpDiv[(1!==d[0]||1!==d[1]?"add":"remove")+"Class"]("coral-datepicker-multi"),a.dpDiv[(a.isRTL?"add":"remove")+"Class"]("coral-datepicker-rtl"),a===this._curInst&&this._datepickerShowing&&this._shouldFocusInput(),a.yearshtml&&(c=a.yearshtml,setTimeout(function(){c===a.yearshtml&&a.yearshtml&&a.dpDiv.find("select.coral-datepicker-year:first").replaceWith(a.yearshtml),c=a.yearshtml=null},0))},_shouldFocusInput:function(){var a=this.options;return a.input&&a.input.is(":visible")&&!a.input.is(":disabled")&&!a.input.is(":focus")},_checkOffset:function(a,b){var c=this.options,d=c.dpDiv.outerWidth(),e=c.dpDiv.outerHeight(),f=c.input?c.input.outerWidth():0,g=c.input?c.input.outerHeight():0,h=document.documentElement.clientWidth+(b?0:$(document).scrollLeft()),i=document.documentElement.clientHeight+(b?0:$(document).scrollTop());return a.left-=c.isRTL?d-f:0,a.left-=b&&a.left===c.input.offset().left?$(document).scrollLeft():0,a.top-=b&&a.top===c.input.offset().top+g?$(document).scrollTop():0,a.left-=Math.min(a.left,a.left+d>h&&h>d?Math.abs(a.left+d-h):0),a.top-=Math.min(a.top,a.top+e>i&&i>e?Math.abs(e+g):0),a},_findPos:function(a){for(var b,c=this.options,d=c.isRTL;a&&("hidden"===a.type||1!==a.nodeType||$.expr.filters.hidden(a));)a=a[d?"previousSibling":"nextSibling"];return b=$(a).offset(),[b.left,b.top]},hide:function(a){var b,c,d,e,a=this.element[0],f=this,g=this._curInst;!g||a&&g!==this.options||(g.isShow=!1,this._datepickerShowing&&(b=g.showAnim,c=g.duration,d=function(){f._tidyDialog(g)},$.effects&&($.effects.effect[b]||$.effects[b])?g.dpDiv.hide(b,g.showOptions,c,d):g.dpDiv["slideDown"===b?"slideUp":"fadeIn"===b?"fadeOut":"hide"](b?c:null,d),this.iframePanel.hide(),b||d(),this._datepickerShowing=!1,e=g.onClose,e&&e.apply(g.input?g.input[0]:null,[g.input?g.input.val():"",g]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),$.blockUI&&($.unblockUI(),$("body").append(this.dpDiv))),this._inDialog=!1))},_tidyDialog:function(a){a.dpDiv.removeClass(this._dialogClass).unbind(".coral-datepicker-calendar")},_checkExternalClick:function(a){var b=a.data.that;if(b._curInst){var c=$(a.target),d=b.options;a.isDefaultPrevented()||(c[0].id===b._mainDivId||0!==c.parents("#"+b._mainDivId).length||c.hasClass(b.markerClassName)||c.closest("."+b._triggerClass).length||!b._datepickerShowing||b._inDialog&&$.blockUI)&&(!c.hasClass(b.markerClassName)||b._curInst===d)||b.hide()}},_adjustDate:function(a,b,c){var d=$(a),e=this.options;this.isDisabled(d[0])||this.isReadonly()||this.isIsLabel()||(this._adjustInstDate(b+("M"===c?e.showCurrentAtPos:0),c),this.update())},_gotoToday:function(a){var b,c=this,d=($(a),this.options),e=_hasTime(d.dateFormat);if(d.gotoCurrent&&d.currentDay)d.selectedDay=d.currentDay,d.drawMonth=d.selectedMonth=d.currentMonth,d.drawYear=d.selectedYear=d.currentYear;else{if(b=new Date,e||b.setHours(0,0,0,0),1===c._checkDateRange(b))return;if(2===c._checkDateRange(b))return;d.selectedDay=b.getDate(),d.drawMonth=d.selectedMonth=b.getMonth(),d.drawYear=d.selectedYear=b.getFullYear(),d.currentHur=b.getHours(),d.currentMiu=b.getMinutes(),d.currentSed=b.getSeconds()}if(this._notifyChange(),e)this._selectDateTime();else{var f=d.dpDiv.children("table").find(".coral-datepicker-today");this._selectDay(a,+f.attr("data-month"),+f.attr("data-year"),f[0])}this._updateDateTime()},_selectMonthYear:function(a,b,c,d){var e=$(a),f=this,g=this.options,h=this._isYearMonthMode(g.dateFormat),i=this._isYearMode(g.dateFormat);h===!0?g["draw"+("M"===c?"Month":"Year")]=parseInt("M"===c?$(b).attr("data-month"):b.options[b.selectedIndex].value,10):i===!0?g.drawYear=parseInt("Y"===c?$(b).attr("data-year"):b.options[b.selectedIndex].value,10):g["draw"+("M"===c?"Month":"Year")]=parseInt(b.options[b.selectedIndex].value,10),g["selected"+("M"===c?"Month":"Year")]=g["draw"+("M"===c?"Month":"Year")];var j=this._getHiddenInputValue();h===!0&&"M"===c&&this._setMonthYearValue(this),i===!0&&this._setMonthYearValue(this);var k=this._getHiddenInputValue();this._notifyChange(),d&&(f._setStartEnd(j,k),f._change(j,k,null)),this._adjustDate(e)},_setMonthYearValue:function(a){var b=this.options,c=b.dateFormat;a._isYearMonthMode(c)&&(b.currentYear=b.selectedYear,b.currentMonth=b.selectedMonth,b.currentDay=b.selectedDay=1),a._isYearMode(c)&&(b.currentYear=b.selectedYear,b.currentMonth=b.selectedMonth=1,b.currentDay=b.selectedDay=1);var d=a._formatDate();b.input&&b.input.val(d),a._setHiddenInputValue()},_selectDay:function(a,b,c,d){var e=this.options;$(a);if(!($(d).hasClass(this._unselectableClass)||this.isDisabled()||this.isReadonly()||this.isIsLabel())){e.selectedDay=e.currentDay=$("a",d).html(),e.selectedMonth=e.currentMonth=b,e.selectedYear=e.currentYear=c;e.dateFormat,this._getMinMaxDate("min"),this._getMinMaxDate("max");this.compMaxMin(),this._autoFixInput(this);e.dpDiv.find("#dpTimeHour").val(),e.dpDiv.find("#dpTimeMinute").val(),e.dpDiv.find("#dpTimeSecond").val();this._selectDate(a,this._formatDate(e.currentDay,e.currentMonth,e.currentYear)),$(d).parent().parent().find("a").removeClass("coral-state-active"),$(d).children("a").addClass("coral-state-active"),this.update(),this.options.closeOnClick&&-1==e.dateFormat.indexOf("H")&&this.hide()}},_clearDate:function(){this._setDate("")},clearError:function(){var a=this.element[0];$(".coral-validate-state-error").remove(),$(".coral-errorIcon").remove(),$(".coral-validate-error").removeClass("coral-validate-error"),$(a).prop("isError",!1)},_selectDate:function(a,b){var c=($(a),this.options);c.dateFormat;if(b=null!=b?b:this._formatDate(),c.input&&c.input.val(b),this._updateAlternate(),c.inline)this.update();else{this._lastInput=c.input[0],"object"!=typeof c.input[0]&&c.input.focus(),this._lastInput=null;var d=this._getHiddenInputValue();this._setHiddenInputValue();var e=this._getHiddenInputValue();e!==d&&(this._setStartEnd(d,e),this._change(d,e,null))}this._trigger("onSelect",null,[{oldValue:d,newValue:e}])},_attachTimeHandlers:function(){function a(a,b){var c=b?function(){var b=0;return a.children(":visible").each(function(a){b+=$(this).outerHeight(!0)}),b}():0;a.height(c)}var b=this.options;this._getHiddenInputValue();this._setHiddenInputValue();this._getHiddenInputValue();b.dpDiv.find("#timePanel").bind("mousedown",function(c){var d=b.dpDiv.find("#datepicker"),e=b.dpDiv.find("#timepicker");d.hasClass("in")?(a(d,!0),a(d,!1),a(e,!0),setTimeout(function(){e.css("height","auto")},350)):(a(e,!0),a(d,!0),a(e,!1),setTimeout(function(){d.css("height","auto")},350)),d.toggleClass("in"),c.preventDefault()}),this._verifyInput(b.dpDiv.find("#dpTimeHour"),"H"),this._verifyInput(b.dpDiv.find("#dpTimeMinute"),"m"),this._verifyInput(b.dpDiv.find("#dpTimeSecond"),"s")},_autoFixInput:function(a){var b=this.options,c=a._getMinMaxDate("min"),d=a._getMinMaxDate("max"),e=b.dpDiv.find("#dpTimeHour").val(),f=b.dpDiv.find("#dpTimeMinute").val(),g=b.dpDiv.find("#dpTimeSecond").val();e=e.replace(/[^0-9]/g,""),""==e&&(e=b.currentHur),f=f.replace(/[^0-9]/g,""),""==f&&(f=b.currentMiu),g=g.replace(/[^0-9]/g,""),""==g&&(g=b.currentSed);var h=new Date(b.currentYear,b.currentMonth,b.currentDay,e,f,g),i=h;1===a._checkDateRange(h)?i=d:2===a._checkDateRange(h)&&(i=c),b.dpDiv.find("#dpTimeHour").spinner("setValue",i.getHours()||"00"),b.dpDiv.find("#dpTimeMinute").spinner("setValue",i.getMinutes()||"00"),b.dpDiv.find("#dpTimeSecond").spinner("setValue",i.getSeconds()||"00")},_verifyInput:function(a,b){var c=this,d=59;d="H"==b?23:d,a.change(function(){c._autoFixInput(c)}).bind("paste",function(){c._autoFixInput(c)})},_selectTime:function(a,b,c){var d=this.options,e=this._getHiddenInputValue(),f=a||d.dpDiv.find("#dpTimeHour").val(),g=b||d.dpDiv.find("#dpTimeMinute").val(),c=c||d.dpDiv.find("#dpTimeSecond").val();d.currentHur=f,d.currentMiu=g,d.currentSed=c,d.input.val(this._formatDate()),this._setHiddenInputValue();var h=this._getHiddenInputValue();this._change(e,h,null)},_selectDateTime:function(){var a=this._getHiddenInputValue(),b=this.options,c=this._getMinMaxDate("min"),d=this._getMinMaxDate("max"),e=new Date;if(!b.selectedYear){b.currentDay=b.selectedDay=e.getDate(),b.currentMonth=b.selectedMonth=e.getMonth(),b.currentYear=b.selectedYear=e.getFullYear();var f=new Date(b.currentYear,b.currentMonth,b.currentDay,hur,miu,sed);c||d?1===this._checkDateRange(f)?(b.selectedDay=d.getDate(),b.selectedMonth=d.getMonth(),b.selectedYear=d.getFullYear()):2===this._checkDateRange(f)&&(b.selectedDay=c.getDate(),b.selectedMonth=c.getMonth(),b.selectedYear=c.getFullYear()):b.input.val(f)}b.input.val(this._formatDate()),this._setHiddenInputValue(),this._updateAlternate();var g=this._getHiddenInputValue();this._setStartEnd(a,g),this._change(a,g,null);$(b.input[0]);this.hide()},_hasHur:function(a){var b=a+"";return-1!=b.indexOf("H")},_hasMin:function(a){var b=a+"";return-1!=b.indexOf("m")},_hasSec:function(a){var b=a+"";return-1!=b.indexOf("s")},_isYearMonthMode:function(a){return _hasTime(a)?!1:-1!=a.indexOf("M")&&-1!=a.indexOf("y")&&-1==a.indexOf("d")},_isYearMode:function(a){return _hasTime(a)?!1:-1!=a.indexOf("y")&&-1==a.indexOf("M")&&-1==a.indexOf("d")},_updateAlternate:function(){var a,b,c,d=this.options,e=d.altField;e&&(a=d.altFormat||d.dateFormat,b=this._getDate(),c=$.coral.formatDate(a,b,d),$(e).each(function(){$(this).val(c)}))},noWeekends:function(a){var b=a.getDay();return[b>0&&6>b,""]},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,_possibleChars:function(a){var b,c="",d=!1,e=function(c){var d=b+1<a.length&&a.charAt(b+1)===c;return d&&b++,d};for(b=0;b<a.length;b++)if(d)"'"!==a.charAt(b)||e("'")?c+=a.charAt(b):d=!1;else switch(a.charAt(b)){case"d":case"m":case"y":case"@":case"H":case"M":case"s":c+="0123456789";break;case"D":case"W":return null;case"'":e("'")?c+="'":d=!0;break;default:c+=a.charAt(b)}return c},_setDateFromField:function(a){var b=this.options,c=b.dateFormat,d=(b.lastVal=b.input?b.input.val():null,this._getDefaultDate()),e=d,f=b.input.val();_getFormatConfig(b);try{e=$.coral.parseDate(c,f,b)||d}catch(g){e=d}b.selectedDay=e.getDate(),b.drawMonth=b.selectedMonth=e.getMonth(),b.drawYear=b.selectedYear=e.getFullYear(),b.currentDay=e.getDate(),b.currentMonth=e.getMonth(),b.currentYear=e.getFullYear(),b.currentHur=e.getHours(),b.currentMiu=e.getMinutes(),b.currentSed=e.getSeconds(),this._adjustInstDate()},_getDefaultDate:function(){var a=this.options;return this._restrictMinMax(this._determineDate(a.defaultDate,new Date))},_determineDate:function(a,b){var c=this,d=this.options,e=function(a){var b=new Date;return b.setDate(b.getDate()+a),b},f=function(a){try{var b="yyyy-MM-dd",e=d.srcDateFormat;return c._isYearMonthMode(e)&&(b="yyyy-MM"),c._isYearMode(e)&&(b="yyyy"),(a+"").length>10&&_hasTime(e)&&(b+=" HH:mm:ss"),b=d.dateFormat,$.coral.parseDate(b,a,d)}catch(f){}for(var g=(a.toLowerCase().match(/^c/)?c._getDate():null)||new Date,h=g.getFullYear(),i=g.getMonth(),j=g.getDate(),k=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=k.exec(a);l;){switch(l[2]||"d"){case"d":case"D":j+=parseInt(l[1],10);break;case"w":case"W":j+=7*parseInt(l[1],10);break;case"m":case"M":i+=parseInt(l[1],10),j=Math.min(j,c._getDaysInMonth(h,i,d));break;case"y":case"Y":h+=parseInt(l[1],10),j=Math.min(j,c._getDaysInMonth(h,i,d))}l=k.exec(a)}return new Date(h,i,j)},g=null==a||""===a?b:"string"==typeof a?f(a):"number"==typeof a?isNaN(a)?b:e(a):new Date(a.getTime());g=g&&"Invalid Date"===g.toString()?b:g;var h=0,i=0,j=0,k=0;return g&&(h=g.getHours(),i=g.getMinutes(),j=g.getSeconds(),k=g.getMilliseconds(),g.setHours(0),g.setMinutes(0),g.setSeconds(0),g.setMilliseconds(0)),_daylightSavingAdjustWidthTime(g,[h,i,j])},_setDate:function(a,b){var c=!a,d=this.options,e=d.selectedMonth,f=d.selectedYear,g=this._restrictMinMax(this._determineDate(a,new Date)),h=d.dateFormat,i=this._getHiddenInputValue();if(d.selectedDay=d.currentDay=g.getDate(),d.drawMonth=d.selectedMonth=d.currentMonth=g.getMonth(),d.drawYear=d.selectedYear=d.currentYear=g.getFullYear(),d.currentHur=g.getHours(),d.currentMiu=g.getMinutes(),d.currentSed=g.getSeconds(),e===d.selectedMonth&&f===d.selectedYear||b||this._notifyChange(),this._adjustInstDate(),d.input)if(c)this._processDefaultDate(this,""),this._setHiddenInputValue();else if(d.complete){var j=this._formatDate();d.input.val(j),this._setStartEnd(i,j)}else{var k=getFormatter(d.value,d.dateFormat,d),l=this.completeFormate(k,h);l=$.coral.formatDate(l,a,d),d.input.val(l)}},_getDate:function(){var a=this.options,b=!a.currentYear||a.input&&""===a.input.val()?null:_daylightSavingAdjustWidthTime(new Date(a.currentYear,a.currentMonth,a.currentDay),[a.currentHur,a.currentMiu,a.currentSed]);return b},_attachHandlers:function(){var a=this,b=this.options,c=b.stepMonths,d="#"+b.id.replace(/\\\\/g,"\\"),e=this._isYearMonthMode(b.dateFormat),f=this._isYearMode(b.dateFormat);b.dpDiv.find("[data-handler]").map(function(){var g={prev:function(){return e===!0?a._adjustDate(d,-1,"Y"):f===!0?a._adjustDate(d,-12,"Y"):a._adjustDate(d,-c,"M"),!1},next:function(){return e===!0?a._adjustDate(d,1,"Y"):f===!0?a._adjustDate(d,12,"Y"):a._adjustDate(d,+c,"M"),!1},hide:function(){a.hide()},today:function(){return a._gotoToday(d),!1},selectDay:function(){return a._selectDay(d,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonthAndHide:function(){return a._selectMonthYear(d,this,"M",!0),a.hide(),!1},selectYearAndHide:function(){return a._selectMonthYear(d,this,"Y",!0),a.hide(),!1},selectMonth:function(){return a._selectMonthYear(d,this,"M"),!1},selectYear:function(){return a._selectMonthYear(d,this,"Y"),!1},focusTime:function(){if($(this).prop("readonly"))return!1;if(a.focusInput=this.id,"dpTimeHour"==this.id&&(b.dpDiv.find(".coral-datepicer-timePanel").hide(),b.dpDiv.find(".hourMenu").show()),"dpTimeMinute"==this.id){var c=$("#dpTimeHour").val();b.dpDiv.find(".coral-datepicer-timePanel").hide(),b.dpDiv.find(".minuteMenu").replaceWith(a._modifiedMin(c)),b.dpDiv.find(".minuteMenu").show()}if("dpTimeSecond"==this.id){var c=$("#dpTimeHour").val(),d=$("#dpTimeMinute").val();b.dpDiv.find(".secondMenu").replaceWith(a._modifiedSed(c,d)),b.dpDiv.find(".coral-datepicer-timePanel").hide(),b.dpDiv.find(".secondMenu").show()}return!1}};$(this).bind(this.getAttribute("data-event"),g[this.getAttribute("data-handler")]),$(b.dpDiv).off(".hourMenu").on("mousedown.hourMenu",".hourMenu",function(c){return $(c.target).hasClass("menuTimeSel")?(b.dpDiv.find("#dpTimeHour").spinner("setValue",$(c.target).html()),b.dpDiv.find(".menuSel").hide(),a._autoFixInput(a),a._selectTime(),b.dpDiv.find("#coral-timePanel").show(),!1):!1}),$(b.dpDiv).off(".minuteMenu").on("mousedown.minuteMenu",".minuteMenu",function(c){return $(c.target).hasClass("menuTimeSel")?(b.dpDiv.find("#dpTimeMinute").spinner("setValue",$(c.target).html()),b.dpDiv.find(".menuSel").hide(),a._autoFixInput(a),a._selectTime(),b.dpDiv.find("#coral-timePanel").show(),!1):!1}),$(b.dpDiv).off(".secondMenu").on("mousedown.secondMenu",".secondMenu",function(c){return $(c.target).hasClass("menuTimeSel")?(b.dpDiv.find("#dpTimeSecond").spinner("setValue",$(c.target).html()),b.dpDiv.find(".menuSel").hide(),a._autoFixInput(a),a._selectTime(),b.dpDiv.find("#coral-timePanel").show(),!1):!1})})},_generateHTML:function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O=this.options,P=new Date,Q=_daylightSavingAdjustWidthTime(new Date(P.getFullYear(),P.getMonth(),P.getDate()),[0,0,0]),R=O.isRTL,S=this._isYearMonthMode(O.dateFormat),T=this._isYearMode(O.dateFormat),U=1==S||1==T?!1:O.showButtonPanel,V=O.hideIfNoPrevNext,W=O.navigationAsDateFormat,X=this._getNumberOfMonths(),Y=O.showCurrentAtPos,Z=O.stepMonths,_=1!==X[0]||1!==X[1],aa=_daylightSavingAdjustWidthTime(O.currentDay?new Date(O.currentYear,O.currentMonth,O.currentDay):new Date(9999,9,9),[0,0,0]),ba=this._getMinMaxDate("min"),ca=this._getMinMaxDate("max"),da=O.drawMonth-Y,ea=O.drawYear,fa=(O.dateFormat,""),ga=_hasTime(O.dateFormat);if(0>da&&(da+=12,ea--),ca)for(a=_daylightSavingAdjustWidthTime(new Date(ca.getFullYear(),ca.getMonth()-X[0]*X[1]+1,ca.getDate()),[O.currentHur,O.currentMiu,O.currentSed]),a=ba&&ba>a?ba:a;_daylightSavingAdjustWidthTime(new Date(ea,da,1),[O.currentHur,O.currentMiu,O.currentSed])>a;)da--,0>da&&(da=11,ea--);O.drawMonth=da,O.drawYear=ea,b=O.prevText,b=W?$.coral.formatDate(b,_daylightSavingAdjustWidthTime(new Date(ea,da-Z,1),[O.currentHur,O.currentMiu,O.currentSed]),O):b,c=this._canAdjustMonth(-1,ea,da)?"<a class='coral-datepicker-prev coral-state-default coral-corner-all' data-handler='prev' data-event='mousedown' title='"+b+"'><span class='icon  cui-icon-arrow-"+(R?"right3":"left3")+"'></span></a>":V?"":"<a class='coral-datepicker-prev coral-state-default coral-corner-all coral-state-disabled' title='"+b+"'><span class='coral-icon coral-icon-circle-triangle-"+(R?"e":"w")+"'>"+b+"</span></a>",d=O.nextText,d=W?$.coral.formatDate(d,_daylightSavingAdjustWidthTime(new Date(ea,da+Z,1),[O.currentHur,O.currentMiu,O.currentSed]),O):d,e=this._canAdjustMonth(1,ea,da)?"<a class='coral-datepicker-next coral-state-default coral-corner-all' data-handler='next' data-event='mousedown' title='"+d+"'><span class='cui-icon-arrow-"+(R?"left3":"right3")+"'></span></a>":V?"":"<a class='coral-datepicker-next coral-state-default coral-corner-all coral-state-disabled' title='"+d+"'><span class='coral-icon coral-icon-circle-triangle-"+(R?"w":"e")+"'>"+d+"</span></a>",f=O.currentText,g=O.gotoCurrent&&O.currentDay?aa:Q,f=W?$.coral.formatDate(f,g,O):f,h="",i=U?"<div class='coral-datepicker-buttonpane coral-component-content' "+(S||T?"style='display:none'":"")+">"+(R?h:"")+(this._isInRange(g)?"<button type='button' class='coral-datepicker-current coral-state-default coral-priority-primary coral-corner-all' data-handler='today' data-event='mousedown'>"+f+"</button>":"")+(R?"":h)+"</div>":"";var ha="";for(!ga||(ha+='<button class="coral-datepicker-close coral-state-default coral-priority-secondary coral-corner-all" id="dpTimeEnsure">确定</button>'),ha+=U?"<button type='button' class='coral-datepicker-current coral-state-default coral-priority-primary coral-corner-all' data-handler='today' data-event='mousedown'>"+f+"</button>":"",j=parseInt(O.firstDay,10),j=isNaN(j)?0:j,k=O.showWeek,l=O.dayNames,m=O.dayNamesMin,n=O.monthNames,o=O.monthNamesShort,p=O.beforeShowDay,q=O.showOtherMonths,r=O.selectOtherMonths,t=this._getDefaultDate(),s=new Date(t.getFullYear(),t.getMonth(),t.getDate()),u="","datepicker"==O.model&&(fa="collapse in"),w=0;w<X[0];w++){for(x="",this.maxRows=4,y=0;y<X[1];y++){if(z=_daylightSavingAdjustWidthTime(new Date(ea,da,O.selectedDay),[O.currentHur,O.currentMiu,O.currentSed]),A=" coral-corner-all",B="",_){if(B+="<div class='coral-datepicker-group",X[1]>1)switch(y){case 0:B+=" coral-datepicker-group-first",A=" coral-corner-"+(R?"right":"left");break;case X[1]-1:B+=" coral-datepicker-group-last",A=" coral-corner-"+(R?"left":"right");break;default:B+=" coral-datepicker-group-middle",A=""}B+="'>"}for(B+="<div id='datepicker' class='coral-datepickerPanel "+fa+"'><div class='coral-datepicker-header coral-helper-clearfix"+A+"'>"+(/all|left/.test(A)&&0===w?R?e:c:"")+(/all|right/.test(A)&&0===w?R?c:e:"")+this._generateMonthYearHeader(da,ea,ba,ca,w>0||y>0,n,o,S)+"</div>",S===!0&&(B+=this._generateMonthHTML(da,ea,ba,ca,w>0||y>0,n,o,aa,Q)),1==T&&(B+=this._generateYearHTML(ea,ba,ca,w>0||y>0,aa,Q)),B+="<table class='coral-datepicker-calendar' "+(S||T?"style='display:none'":"")+"><thead><tr>",C=k?"<th class='coral-datepicker-week-col'>"+O.weekHeader+"</th>":"",v=0;7>v;v++)D=(v+j)%7,C+="<th scope='col'"+((v+j+6)%7>=5?" class='coral-datepicker-week-end'":"")+"><span title='"+l[D]+"'>"+m[D]+"</span></th>";for(B+=C+"</tr></thead><tbody>",E=this._getDaysInMonth(ea,da,O),ea===O.selectedYear&&da===O.selectedMonth&&(O.selectedDay=Math.min(O.selectedDay,E)),F=(this._getFirstDayOfMonth(ea,da)-j+7)%7,G=Math.ceil((F+E)/7),H=_&&this.maxRows>G?this.maxRows:G,this.maxRows=H,I=_daylightSavingAdjustWidthTime(new Date(ea,da,1-F),[0,0,0]),J=0;H>J;J++){for(B+="<tr>",K=k?"<td class='coral-datepicker-week-col'>"+O.calculateWeek(I)+"</td>":"",v=0;7>v;v++)L=p?p.apply(O.input?O.input[0]:null,[I]):[!0,""],M=I.getMonth()!==da,N=M&&!r||!L[0]||ba&&I<=new Date(ba.getFullYear(),ba.getMonth(),ba.getDate()-1)||ca&&I>ca,K+="<td class='"+((v+j+6)%7>=5?" coral-datepicker-week-end":"")+(M?" coral-datepicker-other-month":"")+(I.getTime()===z.getTime()&&da===O.selectedMonth&&O._keyEvent||s.getTime()===I.getTime()&&s.getTime()===z.getTime()?" "+this._dayOverClass:"")+(N?" "+this._unselectableClass+" coral-state-disabled":"")+(M&&!q?"":" "+L[1]+(I.getTime()===aa.getTime()?" "+this._currentClass:"")+(I.getTime()===Q.getTime()?" coral-datepicker-today":""))+"'"+(M&&!q||!L[2]?"":" title='"+L[2].replace(/'/g,"&#39;")+"'")+(N?"":" data-handler='selectDay' data-event='mousedown' data-month='"+I.getMonth()+"' data-year='"+I.getFullYear()+"'")+">"+(M&&!q?"&#xa0;":N?"<span class='coral-state-default'>"+I.getDate()+"</span>":"<a class='coral-state-default"+(I.getTime()===Q.getTime()?" coral-state-highlight":"")+(I.getTime()===aa.getTime()?" coral-state-active":"")+(M?" coral-priority-secondary":"")+"' href='javascript:void(0);'>"+I.getDate()+"</a>")+"</td>",I.setDate(I.getDate()+1),I=_daylightSavingAdjustWidthTime(I,[0,0,0]);B+=K+"</tr>"}da++,da>11&&(da=0,ea++),ga&&(B+="</tbody></table></div><div class='picker-switch accordion-toggle'><a class='coral-datepicker-today time-btn' data-handler='today' data-event='mousedown'>今天</a>",B+="<a id='timePanel' class='date-time-icon time-btn'><span class='cui-icon-clock'/></a><a class='datepicker-close time-btn' data-handler='hide' data-event='click'>关闭</a></div>"),x+=B}u+=x}return O._keyEvent=!1,u},_generateMonthHTML:function(a,b,c,d,e,f,g,h,i){for(var j="<table class='coral-datepicker-calendar' ><tbody>",k=(this.options,0),l="",m="",n=c&&c.getFullYear()===b,o=d&&d.getFullYear()===b,p=0;3>p;p++){j+="<tr>";for(var q=0;4>q;q++)l=k===i.getMonth()&&b===i.getFullYear()?"coral-state-highlight":"",m=k===a?"coral-state-active":"",j+=(!n||k>=c.getMonth())&&(!o||k<=d.getMonth())?"<td data-handler='selectMonthAndHide' data-event='mousedown' data-month='"+k+"'><a class='coral-state-default date-month "+l+" "+m+"' href='javascript:void(0);'>"+f[k++]+"</a></td>":"<td class='"+this._unselectableClass+" coral-state-disabled'><span class='date-month' >"+f[k++]+"</span></td>";j+="</tr>"}return j+"</tbody></table>"},isExist:function(a){return"undefined"!=typeof a},_timeDateInitValue:function(){var a,b,c,d,e,f,g,h,i,j=this.options,k=[],l=new Date;if("timepicker"==j.model){a=j.currentHur?j.currentHur:l.getHours(),b=j.currentMiu?j.currentMiu:l.getMinutes(),c=j.currentSed?j.currentSed:l.getSeconds(),k.push(l.getFullYear(),l.getMonth(),l.getDate());var m=j.minTime?k.join("-")+" "+j.minTime:null,n=j.maxTime?k.join("-")+" "+j.maxTime:null;d=new Date(l.getFullYear(),l.getMonth(),l.getDate(),a,b,c),i=new Date(l.getFullYear(),l.getMonth(),l.getDate()),g=h=i}else{var o=(_hasTime(j.dateFormat),this._hasHur(j.dateFormat)),p=this._hasMin(j.dateFormat),q=this._hasSec(j.dateFormat),m=j.minDate;n=j.maxDate,a=o?this.isExist(j.currentHur)?j.currentHur:l.getHours():"00",b=p?this.isExist(j.currentMiu)?j.currentMiu:l.getMinutes():"00",c=q?this.isExist(j.currentSed)?j.currentSed:l.getSeconds():"00",d=new Date(j.selectedYear,j.selectedMonth,j.selectedDay,a,b,c),i=new Date(j.selectedYear,j.selectedMonth,j.selectedDay),m&&""!=m&&(e=new Date(m.replace(/-/g,"/")),g=new Date(e.getFullYear(),e.getMonth(),e.getDate())),n&&""!=n&&(f=new Date(n.replace(/-/g,"/")),h=new Date(f.getFullYear(),f.getMonth(),f.getDate()))}return 1===this._checkDateRange(d)?(d=new Date(n.replace(/-/g,"/")),a=d.getHours(),b=d.getMinutes(),c=d.getSeconds()):2===this._checkDateRange(d)&&(d=new Date(m.replace(/-/g,"/")),a=d.getHours(),b=d.getMinutes(),c=d.getSeconds()),{hur:a,min:b,sed:c,minDate:m,maxDate:n,minDay:e,maxDay:f,compMin:g,compMax:h,compDate:i}},_generateTimePanel:function(){var a,b,c,d,e=this.options,f=(e.dateFormat,[]),g="";"datepicker"==this.options.model&&(g="collapse"),b=this._timeDateInitValue();var h=b.minDate,i=b.maxDate,j=b.compDate,c=b.compMin,d=b.compMax;return f.push("<div id='timepicker' class='coral-timepickerPanel "+g+"'>"),f.push("<table id='coral-timePanel' class='coral-datepicer-timePanel'><tr><td><input data-handler='focusTime' data-event='click' id='dpTimeHour' name='timeHourVal' value='"+b.hur+"' maxlength='2'/></td>"),f.push("<td class='separator'>:</td><td><input id='dpTimeMinute' name='timeMinVal' data-handler='focusTime' data-event='click' value='"+b.min+"' maxlength='2'/></td>"),a="datepicker"==e.model&&e.dateFormat.indexOf("s")>-1||"timepicker"==e.model&&e.timeFormat.indexOf("s")>-1?"":"display:none",f.push("<td class='separator' style="+a+">:</td><td id='secondTd' style="+a+"><input id='dpTimeSecond' name='timeSecVal' data-handler='focusTime' data-event='click' value='"+b.sed+"' maxlength='2'/></td>"),f.push("</tr></table>"),f.push(this._timeHourPanel(h,i,j,c,d,!1)),f.push(this._timeMinPanel(h,i,j,c,d,!1)),f.push(this._timeSedPanel(h,i,j,c,d,!1)),f.push("</div>"),f.join("")},_generateYearHTML:function(a,b,c,d,e,f){for(var g=this.options,h="<table class='coral-datepicker-calendar' ><tbody>",i="",j="",k=a-a%12,l=b&&b.getFullYear()===a,m=c&&c.getFullYear()===a,n=0;3>n;n++){h+="<tr>";for(var o=0;4>o;o++)i="",j=k==g.currentYear?"coral-state-active":"",h+=(!l||k>=b.getFullYear())&&(!m||k<=c.getFullYear())?"<td data-handler='selectYearAndHide' data-event='mousedown' data-year='"+k+"'><a class='coral-state-default date-year  "+j+"' href='javascript:void(0);'>"+k++ +"</a></td>":"<td class='"+this._unselectableClass+" coral-state-disabled'><span class='date-year' >"+k++ +"</span></td>";h+="</tr>"}return h+"</tbody></table>"},_timeHourPanel:function(a,b,c,d,e,f){var g=[],h="";f&&(h="hourPanel"),g.push("<div class='menuSel hourMenu '"+h+" style='display: none;'>"),g.push("<table cellspacing='0' cellpadding='3' border='0' nowrap='nowrap'><tbody>");for(var i=0,j=0;6>j;j++){g.push("<tr nowrap='nowrap'></tr>");for(var k=0;4>k;k++)a&&i<new Date(a).getHours()&&new Date(c).getTime()==new Date(d).getTime()||b&&i>new Date(b).getHours()&&new Date(c).getTime()==new Date(e).getTime()?g.push("<td nowrap='' class='menuTimeSel coral-state-disabled' data-handler='clickHour' data-event='click' >"+(i++/Math.pow(10,2)).toFixed(2).substr(2)+"</td>"):g.push("<td nowrap='' class='menuTimeSel' data-handler='clickHour' data-event='click' >"+(i++/Math.pow(10,2)).toFixed(2).substr(2)+"</td>");g.push("</tr>")}return g.push("</tbody></table></div>"),g.join("")},_timeMinPanel:function(a,b,c,d,e,f){var g=[],h="";f&&(h="minPanel"),g.push("<div class='menuSel minuteMenu '"+h+" style='display: none;'>"),g.push("<table cellspacing='0' cellpadding='3' border='0' nowrap='nowrap'><tbody>");for(var i=0,j=0;3>j;j++){g.push("<tr nowrap='nowrap'></tr>");for(var k=0;4>k;k++)a&&i<new Date(a).getMinutes()&&new Date(c).getTime()==new Date(d).getTime()||b&&i>new Date(b).getMinutes()&&new Date(c).getTime()==new Date(e).getTime()?g.push("<td nowrap='' class='menuTimeSel coral-state-disabled' data-handler='clickMinute' data-event='click'>"+i+"</td>"):g.push("<td nowrap='' class='menuTimeSel' data-handler='clickMinute' data-event='click' >"+i+"</td>"),i+=5;g.push("</tr>")}return g.push("</tbody></table></div>"),g.join("")},_timeSedPanel:function(a,b,c,d,e,f){var g,h=[],i="";f&&(i="sedPanel"),h.push("<div class='menuSel secondMenu '"+i+" style='display: none;'>"),h.push("<table cellspacing='0' cellpadding='3' border='0' nowrap='nowrap'><tbody>"),g=0;for(var j=0;4>j;j++){h.push("<tr nowrap='nowrap'></tr>");for(var k=0;3>k;k++)a&&g<new Date(a).getSeconds()&&new Date(c).getTime()==new Date(d).getTime()||b&&g>new Date(b).getSeconds()&&new Date(c).getTime()==new Date(e).getTime()?h.push("<td nowrap='' class='menuTimeSel coral-state-disabled' data-handler='clickSecond' data-event='click'>"+(g/Math.pow(10,2)).toFixed(2).substr(2)+"</td>"):h.push("<td nowrap='' class='menuTimeSel' data-handler='clickSecond' data-event='click' >"+(g/Math.pow(10,2)).toFixed(2).substr(2)+"</td>"),g+=5;h.push("</tr>");
}return h.push("</tbody></table></div>"),h.join("")},_modifiedMin:function(a){var b,c,d,e,f,g=this.options,h=[],i=g.minDate,j=g.maxDate;if("timepicker"==g.model){var k=new Date;h.push(k.getFullYear(),k.getMonth(),k.getDate()),i=g.minTime?h.join("-")+" "+g.minTime:null,j=g.maxTime?h.join("-")+" "+g.maxTime:null,d=new Date(k.getFullYear(),k.getMonth(),k.getDate()),e=f=d}else d=new Date(g.selectedYear,g.selectedMonth,g.selectedDay),b=new Date(i),c=new Date(j),e=new Date(b.getFullYear(),b.getMonth(),b.getDate()),f=new Date(c.getFullYear(),c.getMonth(),c.getDate());var l=[];l.push("<div class='menuSel minuteMenu' style='display: none;'>"),l.push("<table cellspacing='0' cellpadding='3' border='0<tr' nowrap='nowrap'><tbody>");for(var m=0,n=0;3>n;n++){l.push("<tr nowrap='nowrap'></tr>");for(var o=0;4>o;o++)i&&m<new Date(i).getMinutes()&&new Date(d).getTime()==new Date(e).getTime()&&a==new Date(i).getHours()||j&&m>new Date(j).getMinutes()&&new Date(d).getTime()==new Date(f).getTime()&&a==new Date(j).getHours()?l.push("<td nowrap='' class='menuTimeSel coral-state-disabled' data-handler='clickMinute' data-event='click'>"+(m/Math.pow(10,2)).toFixed(2).substr(2)+"</td>"):l.push("<td nowrap='' class='menuTimeSel' data-handler='clickMinute' data-event='click' >"+(m/Math.pow(10,2)).toFixed(2).substr(2)+"</td>"),m+=5;l.push("</tr>")}return l.push("</tbody></table></div>"),l.join("")},_modifiedSed:function(a,b){var c=this.options,d=c.minDate,e=c.maxDate,f=new Date(c.selectedYear,c.selectedMonth,c.selectedDay),g=new Date(d),h=new Date(e),i=new Date(g.getFullYear(),g.getMonth(),g.getDate()),j=new Date(h.getFullYear(),h.getMonth(),h.getDate()),k=[];k.push("<div class='menuSel secondMenu' style='display: none;'>"),k.push("<table cellspacing='0' cellpadding='3' border='0<tr' nowrap='nowrap'><tbody>");for(var l=0,m=0;3>m;m++){k.push("<tr nowrap='nowrap'></tr>");for(var n=0;4>n;n++)d&&l<new Date(d).getSeconds()&&new Date(f).getTime()==new Date(i).getTime()&&a==new Date(d).getHours()&&b==new Date(d).getMinutes()||e&&l>new Date(e).getSeconds()&&new Date(f).getTime()==new Date(j).getTime()&&a==new Date(e).getHours()&&b==new Date(e).getMinutes()?k.push("<td nowrap='' class='menuTimeSel coral-state-disabled' data-handler='clickSecond' data-event='click'>"+(l/Math.pow(10,2)).toFixed(2).substr(2)+"</td>"):k.push("<td nowrap='' class='menuTimeSel' data-handler='clickSecond' data-event='click' >"+(l/Math.pow(10,2)).toFixed(2).substr(2)+"</td>"),l+=5;k.push("</tr>")}return k.push("</tbody></table></div>"),k.join("")},_generateMonthYearHeader:function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q=this.options,r=q.changeMonth,s=q.changeYear,t=q.showMonthAfterYear,u="<div class='coral-datepicker-title'>",v="",w=q.monthSuffix,x=q.dateFormat;if(!this._isYearMonthMode(x)&&!this._isYearMode(x)){if(e||!r)v+="<span class='coral-datepicker-month'>"+f[a]+"</span>";else{for(i=c&&c.getFullYear()===b,j=d&&d.getFullYear()===b,v+="<select class='coral-datepicker-month' data-handler='selectMonth' data-event='change'>",k=0;12>k;k++)(!i||k>=c.getMonth())&&(!j||k<=d.getMonth())&&(v+="<option value='"+k+"'"+(k===a?" selected='selected'":"")+">"+g[k]+"</option>");v+="</select>",v+=w}t||(u+=v+(!e&&r&&s?"":"&#xa0;"))}if(!q.yearshtml)if(q.yearshtml="",e||!s)u+="<span class='coral-datepicker-year'>"+b+"</span>";else{if(l=q.yearRange.split(":"),m=(new Date).getFullYear(),n=function(a){var c=a.match(/c[+\-].*/)?b+parseInt(a.substring(1),10):a.match(/[+\-].*/)?m+parseInt(a,10):parseInt(a,10);return isNaN(c)?m:c},o=n(l[0]),p=Math.max(o,n(l[1]||"")),o=c?Math.max(o,c.getFullYear()):o,p=d?Math.min(p,d.getFullYear()):p,this._isYearMode(x)){var o=b-b%12;q.yearshtml+="<span class = 'coral-datepicker-year'>"+o+"-"+(o+11)+"</span>"}else{for(q.yearshtml+="<select class='coral-datepicker-year' data-handler='selectYear' data-event='change'>";p>=o;o++)q.yearshtml+="<option value='"+o+"'"+(o===b?" selected='selected'":"")+">"+o+"</option>";q.yearshtml+="</select>"}u+=q.yearshtml,q.yearshtml=null}return u+=q.yearSuffix,t&&(u+=(!e&&r&&s?"":"&#xa0;")+(h===!1?v:"")),u+="</div>"},_adjustInstDate:function(a,b){var c=this.options,d=c.drawYear+("Y"===b?a:0),e=c.drawMonth+("M"===b?a:0),f=Math.min(c.selectedDay,this._getDaysInMonth(d,e,c))+("D"===b?a:0),g=this._restrictMinMax(_daylightSavingAdjustWidthTime(new Date(d,e,f),[c.currentHur,c.currentMiu,c.currentSed]));c.selectedDay=g.getDate(),c.drawMonth=c.selectedMonth=g.getMonth(),c.drawYear=c.selectedYear=g.getFullYear(),"M"!==b&&"Y"!==b||this._notifyChange()},_restrictMinMax:function(a){var b=(this.options,this._getMinMaxDate("min")),c=this._getMinMaxDate("max"),d=b&&b>a?b:a;return c&&d>c?c:d},_notifyChange:function(){var a=this.options,b=a.onChangeMonthYear;b&&b.apply(a.input?a.input[0]:null,[a.selectedYear,a.selectedMonth+1,a])},_getNumberOfMonths:function(){var a=this.options,b=a.numberOfMonths;return null==b?[1,1]:"number"==typeof b?[1,b]:b},_getMinMaxDate:function(a){var b,c=this.options;return b="timepicker"==c.model?a+"Time":a+"Date",this._determineDate(c[b],null)},_getDaysInMonth:function(a,b,c){var d=c;return d?32-_daylightSavingAdjustWidthTime(new Date(a,b,32),[d.currentHur,d.currentMiu,d.currentSed]).getDate():32-_daylightSavingAdjustWidthTime(new Date(a,b,32),[0,0,0]).getDate()},_getFirstDayOfMonth:function(a,b){return new Date(a,b,1).getDay()},_canAdjustMonth:function(a,b,c){var d=this.options,e=this._getNumberOfMonths(),f=_daylightSavingAdjustWidthTime(new Date(b,c+(0>a?a:e[0]*e[1]),1),[d.currentHur,d.currentMiu,d.currentSed]);return 0>a&&f.setDate(this._getDaysInMonth(f.getFullYear(),f.getMonth(),d)),this._isInRange(f)},_isInRange:function(a){var b,c,d=this.options,e=this._getMinMaxDate("min"),f=this._getMinMaxDate("max"),g=null,h=null,i=d.yearRange;return i&&(b=i.split(":"),c=(new Date).getFullYear(),g=parseInt(b[0],10),h=parseInt(b[1],10),b[0].match(/[+\-].*/)&&(g+=c),b[1].match(/[+\-].*/)&&(h+=c)),(!e||a.getTime()>=e.getTime())&&(!f||a.getTime()<=f.getTime())&&(!g||a.getFullYear()>=g)&&(!h||a.getFullYear()<=h)},_formatDate:function(a,b,c){var d=this.options;a||(d.currentDay=d.selectedDay,d.currentMonth=d.selectedMonth,d.currentYear=d.selectedYear);var e=(this._getMinMaxDate("min"),this._getMinMaxDate("max"),a?"object"==typeof a?a:_daylightSavingAdjustWidthTime(new Date(c,b,a),[d.currentHur,d.currentMiu,d.currentSed]):_daylightSavingAdjustWidthTime(new Date(d.currentYear,d.currentMonth,d.currentDay),[d.currentHur,d.currentMiu,d.currentSed]));return $.coral.formatDate(d.dateFormat,e,d)},_apply:function(a,b,c){var d=this.options,e=d.type;if(e){if("string"==typeof e)return window[e].apply(d.input?d.input[0]:null,[c].concat(b));if($.isFunction(e))return e.apply(d.input?d.input[0]:null,[c].concat(b))}}});