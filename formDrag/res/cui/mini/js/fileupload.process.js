/*! cui 2016-11-08 */
!function(){"use strict";var a=$.blueimp.fileupload.prototype.options.add;$.component("blueimp.fileupload",$.blueimp.fileupload,{options:{processQueue:[],add:function(b,c){var d=$(this);c.process(function(){return d.fileupload("process",c)}),a.call(this,b,c)}},processActions:{},_processFile:function(a,b){var c=this,d=$.Deferred().resolveWith(c,[a]),e=d.promise();return this._trigger("process",null,a),$.each(a.processQueue,function(a,d){var f=function(a){return b.errorThrown?$.Deferred().rejectWith(c,[b]).promise():c.processActions[d.action].call(c,a,d)};e=e.pipe(f,d.always&&f)}),e.done(function(){c._trigger("onProcessDone",null,a),c._trigger("onProcessAlways",null,a)}).fail(function(){c._trigger("onProcessFail",null,a),c._trigger("onProcessAlways",null,a)}),e},_transformProcessQueue:function(a){var b=[];$.each(a.processQueue,function(){var c={},d=this.action,e=this.prefix===!0?d:this.prefix;$.each(this,function(b,d){"string"===$.type(d)&&"@"===d.charAt(0)?c[b]=a[d.slice(1)||(e?e+b.charAt(0).toUpperCase()+b.slice(1):b)]:c[b]=d}),b.push(c)}),a.processQueue=b},processing:function(){return this._processing},process:function(a){var b=this,c=$.extend({},this.options,a);return c.processQueue&&c.processQueue.length&&(this._transformProcessQueue(c),0===this._processing&&this._trigger("onProcessStart"),$.each(a.files,function(d){var e=d?$.extend({},c):c,f=function(){return a.errorThrown?$.Deferred().rejectWith(b,[a]).promise():b._processFile(e,a)};e.index=d,b._processing+=1,b._processingQueue=b._processingQueue.pipe(f,f).always(function(){b._processing-=1,0===b._processing&&b._trigger("onProcessStop")})})),this._processingQueue},_create:function(){this._super(),this._processing=0,this._processingQueue=$.Deferred().resolveWith(this).promise()}})}();