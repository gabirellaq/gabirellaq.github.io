/*! cui 2016-11-08 */
var _final={className:{BUTTON:"button",LEVEL:"level",ICO_LOADING:"ico_loading",SWITCH:"switch"},editIcon:"cui-icon-pencil7",removeIcon:"cui-icon-cross2",event:{NODECREATED:"tree_nodeCreated",CLICK:"tree_click",EXPAND:"tree_expand",COLLAPSE:"tree_collapse",ASYNC_SUCCESS:"tree_async_success",ASYNC_ERROR:"tree_async_error",REMOVE:"tree_remove",CHECK:"tree_check",DRAG:"tree_drag",DROP:"tree_drop",RENAME:"tree_rename",DRAGMOVE:"tree_dragmove"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul",CHECK:"_check",EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},line:{CENTER:"centerDottedLine",BOTTOM:"bottomDottedLine",ROOTS:"topDottedLine",NOLINE:"noline",LINE:"dottedLine"},folder:{OPEN:"folderOpen",CLOSE:"folderClose",FILE:"file",DOCU:"docu"},arrow:{RIGHT:"arrowRight1",DOWN:"arrowDown1"},node:{CURHOVER:"coral-state-hover",CURSELECTED:"curSelectedNode",CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetTree",TMPTARGET_NODE:"tmpTargetNode"},checkbox:{STYLE:"checkbox",DEFAULT:"coral-state-default",DISABLED:"coral-state-disabled",FALSE:"false",TRUE:"true",UNCHECKED:"unchecked",CHECKED:"checked",PARTIAL:"Partical",FOCUS:"coral-state-focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"}},settings={},roots={},caches={};$.component("coral.tree",{castProperties:["data","fontCss","rootNode","chkboxType","formatter","showIcon","addDiyDom","beforeDrag","onDrag","onDrop"],version:"4.0.2",componentName:"tree",componentFullName:"coral-tree",options:{treeId:"",treeObj:null,clickExpand:!1,disabledMessage:"the node is disabled",disabled:!1,addDiyDom:null,autoCancelSelected:!0,dblClickExpand:!0,expandSpeed:"fast",fontCss:{},iconUrl:!0,nameIsHTML:!1,selectedMulti:!0,showIcon:!0,showLine:!1,showTitle:!0,txtSelectedEnable:!1,rootInNode:!1,showRootNode:!0,rootNode:!1,keyChildren:"children",keyName:"name",keyTitle:"",keyUrl:"url",simpleDataEnable:!1,simpleDataIdKey:"id",simpleDataPIdKey:"pId",simpleDataRootPId:null,keepParent:!1,keepLeaf:!1,asyncEnable:!1,asyncContentType:"application/x-www-form-urlencoded",asyncType:"post",asyncDataType:"text",asyncUrl:"",asyncAutoParam:[],asyncOtherParam:[],asyncDataFilter:null,checkable:!1,autoCheckTrigger:!1,chkStyle:_final.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:_final.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"},keyChecked:"checked",editable:!1,editNameSelectAll:!1,showRemoveBtn:!0,showRenameBtn:!0,removeTitle:"remove",renameTitle:"rename",dragStyle:"line",dragAutoExpandTrigger:!1,dragIsCopy:!0,dragIsMove:!0,dragPrev:!0,dragNext:!0,dragInner:!0,dragMinMoveSize:5,dragBorderMax:10,dragBorderMin:-5,dragMaxShowNodeNum:5,dragAutoOpenTime:500,addHoverDom:null,removeHoverDom:null,beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeReName:null,onDrag:null,onDragMove:null,onDrop:null,onReName:null,beforeCheck:null,onCheck:null,beforeAsync:null,beforeClick:null,beforeDblClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,beforeRemove:null,onLoadError:null,onLoad:null,onNodeCreated:null,onClick:null,onDblClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null,onRemove:null},_create:function(){this.options,this.element;this._initTree()},_getTreeObj:function(a){var b=this._getTreeTools(a);return b?b:null},_initTree:function(){var a=this.element,b=this.options.data;a.hasClass("coral-tree")||a.addClass("coral-tree"),a.attr("component-role","tree");var c=this.options;c.treeId=a.uniqueId().attr("id"),c.treeObj=a,c.treeObj.empty(),settings[c.treeId]=c,c.cls&&a.addClass(c.cls),c.componentCls&&a.addClass(c.componentCls),"undefined"==typeof document.body.style.maxHeight&&(c.expandSpeed=""),this._initNodeBind={bind:[this._coreBindEvent,this._checkBindEvent,this._editBindEvent],unbind:[this._coreUnbindEvent,this._checkUnbindEvent,this._editUnbindEvent],caches:[this._coreInitCache,this._checkInitCache,this._editInitCache],nodes:[this._coreInitNode,this._checkInitNode,this._editInitNode],proxys:[this._checkEventProxy,this._coreEventProxy,this._editEventProxy],roots:[this._coreInitRoot,this._checkInitRoot,this._editInitRoot],beforeA:[this._beforeA],afterA:[],innerBeforeA:[],innerAfterA:[],treeTools:[this._checkTreeTools,this._editTreeTools]},this._initRoot(c);var d=this._getRoot(c),e=c.keyChildren;b=b?this._clone(this._isArray(b)?b:[b]):[],b=this._createRootNodes(c,b),c.simpleDataEnable?d[e]=this._transformToTreeFormat(c,b):d[e]=b,this._initCache(c),this._unbindTree(c),this._bindTree(c),this._unbindEvent(c),this._bindEvent(c),c.disabled?this.disable():this.enable(),c.isInit=!0,c.dataLoaded=!1,c.rootReload=!0,d[e]&&d[e].length>0?(this._createNodes(c,0,d[e]),c.treeObj.trigger(_final.event.ASYNC_SUCCESS,[c.treeId,null,d[e]])):c.asyncEnable&&c.asyncUrl&&""!==c.asyncUrl&&this._asyncNode(c)},_setOption:function(a,b){var c=this.options;this._super(a,b),"disabled"===a&&(b?$("#"+c.treeId).prepend("<div class='coral-state-disabled tree-disabled'></div>"):$("#"+c.treeId+" .tree-disabled").remove())},_pinyinEngine:function(){return new pinyinEngine},_pinyinSetCache:function(a,b,c){for(var d in c)a.setCache([c[d][b]],c[d]);return a},_pinyinSearch:function(a,b,c){var d=[];a.search(b,function(a){d.push(a)}),c(d)},filterNodesByParam:function(a){var b=this,c=b.getNodes(),d=[];b.expandAll(!0),d=b.transformToArray(c);var e=b._pinyinEngine();e=b._pinyinSetCache(e,"name",d),b.hideNodes(d),"object"==typeof a&&$.each(a,function(a,c){"name"==a&&b._pinyinSearch(e,c,function(a){b.showNodes(a,{showParents:!0})})})},disable:function(){return this._setOption("disabled",!0)},enable:function(){return this._setOption("disabled",!1)},showNodes:function(a,b){var c=this.options;this._showNodes(c,a,b)},showNode:function(a){var b=this.options;a&&this._showNodes(b,[a],b)},hideNodes:function(a){var b=this.options;this._hideNodes(b,a,b)},hideNode:function(a){var b=this.options;a&&this._hideNodes(b,[a],b)},removeNode:function(a,b){var c=this.options;a&&(b=!!b,b&&0==this._apply(c.beforeRemove,[c.treeId,a,c],!0)||(this._removeNode(c,a),b&&c.treeObj.trigger(_final.event.REMOVE,[c.treeId,a])))},selectNode:function(a,b){var c=this.options;if(a&&this._uCanDo(c)){if(b=c.selectedMulti&&b,a.parentTId)this._expandCollapseParentNode(c,a.getParentNode(),!0,!1,function(){try{this._$(a,c).focus().blur()}catch(b){}});else try{this._$(a,c).focus().blur()}catch(d){}this._selectNode(c,a,b)}},transformToTreeNodes:function(a){var b=this.options;return this._transformToTreeFormat(b,a)},transformToArray:function(a){var b=this.options;return this._transformToArrayFormat(b,a)},addNodes:function(a,b,c){function d(){f._addNodes(e,a,h,1==c)}var e=this.options,f=this,g=null!=a?"undefined"==typeof a.level?0:a.level:null;if(!b)return null;if(a||(a=null),a&&!a.isParent&&e.keepLeaf)return null;var h=f._clone(f._isArray(b)?b:[b]);return f._canAsync(e,a)?f._asyncNode(e,a,c,d):d(),this._addLine(e,a,g),h},cancelSelectedNode:function(a){var b=this.options;this._cancelPreSelectedNode(b,a)},destroy:function(){var a=this.options;this._destroy(a)},expandAll:function(a){var b=this.options;return a=!!a,this._expandCollapseSonNode(b,null,a,!0),a},expandNode:function(a,b,c,d,e){var f=this.options;if(!a||!a.isParent)return null;if(b!==!0&&b!==!1&&(b=!a.open),e=!!e,e&&b&&0==this._apply(f.beforeExpand,[f.treeId,a,f],!0))return null;if(e&&!b&&0==this._apply(f.beforeCollapse,[f.treeId,a,f],!0))return null;if(b&&a.parentTId&&this._expandCollapseParentNode(f,a.getParentNode(),b,!1),b===a.open&&!c)return null;if(this._getRoot(f).expandTriggerFlag=e,!this._canAsync(f,a)&&c)this._expandCollapseSonNode(f,a,b,!0,function(){if(d!==!1)try{this._$(a,f).focus().blur()}catch(b){}});else if(a.open=!b,this._switchNode(f,a),d!==!1)try{this._$(a,f).focus().blur()}catch(g){}return b},getNodes:function(){var a=this.options;return this._getNodes(a)},getNodeByParam:function(a,b,c){var d=this.options;return a?this._getNodeByParam(d,c?c[d.keyChildren]:this._getNodes(d),a,b):null},getNodeByTId:function(a){var b=this.options;return this._getNodeCache(b,a)},getNodesByParam:function(a,b,c){var d=this.options;return a?this._getNodesByParam(d,c?c[d.keyChildren]:this._getNodes(d),a,b):null},getNodesByParamFuzzy:function(a,b,c){var d=this.options;return a?this._getNodesByParamFuzzy(d,c?c[d.keyChildren]:this._getNodes(d),a,b):null},getNodesByFilter:function(a,b,c,d){var e=this.options;return b=!!b,a&&"function"==typeof a?this._getNodesByFilter(e,c?c[e.keyChildren]:this._getNodes(e),a,b,d):b?null:[]},getNodeIndex:function(a){var b=this.options;if(!a)return null;for(var c=b.keyChildren,d=a.parentTId?a.getParentNode():this._getRoot(b),e=0,f=d[c].length;f>e;e++)if(d[c][e]==a)return e;return-1},getSelectedNodes:function(){for(var a=this.options,b=[],c=this._getRoot(a).curSelectedList,d=0,e=c.length;e>d;d++)b.push(c[d]);return b},isSelectedNode:function(a){var b=this.options;return this._isSelectedNode(b,a)},reAsyncChildNodes:function(a,b,c,d){var e=this.options;if(this.options.asyncEnable){var f=!a;if(f&&(a=this._getRoot(e)),"refresh"==b){for(var g=this.options.keyChildren,h=0,i=a[g]?a[g].length:0;i>h;h++)this._removeNodeCache(e,a[g][h]);if(this._removeSelectedNode(e),a[g]=[],f)this.options.treeObj.empty();else{var j=this._$(a,_final.id.UL,e);j.empty()}}this._asyncNode(this.options,f?null:a,!!c,null,d)}},reLoadChildNodes:function(a,b,c,d){var e=this.options,f=!a;if(f&&(a=this._getRoot(e)),"refresh"==b){for(var g=e.keyChildren,h=0,i=a[g]?a[g].length:0;i>h;h++)this._removeNodeCache(e,a[g][h]);if(this._removeSelectedNode(e),a[g]=[],f)this.element.empty();else{var j=this._$(a,_final.id.UL,e);j.empty()}}e.isInit&&(d=this._createRootNodes(e,d)),this.addNodes(f?null:a,d,!!c)},refresh:function(){var a=this.options;a.treeObj.empty();var b=this._getRoot(a),c=b[a.keyChildren];this._initRoot(a),b[a.keyChildren]=c,this._initCache(a),this._createNodes(a,0,b[a.keyChildren])},reload:function(a){var b=this.options;if(this.options.isInit=!0,a){a=a||{};var c=[],d=!1;"string"!=typeof a?a.data?c=a.data:a instanceof Array?c=a:(a.asyncUrl&&(this.options.asyncUrl=a.asyncUrl),d=!0):(d=!0,this.options.asyncUrl=a),d&&this.options.asyncEnable?this.reAsyncChildNodes(null,"refresh",null,a):(this.reLoadChildNodes(null,"refresh",null,c),this._apply(b.onLoad,[null,this.options.treeId]),a.onLoad?this._apply(b.onLoad,[b.treeId,null,c]):b.treeObj.trigger(_final.event.ASYNC_SUCCESS,[b.treeId,null,c]))}else this.options.asyncEnable&&(a=a||{},this.reAsyncChildNodes(null,"refresh",null,a))},removeChildNodes:function(a){var b=this.options;if(!a)return null;var c=b.keyChildren,d=a[c];return this._removeChildNodes(b,a),d?d:null},_coreInitRoot:function(a){var a=this.options,b=this._getRoot(a);b||(b={},this._setRoot(a,b)),b[a.keyChildren]=[],b.expandTriggerFlag=!1,b.curSelectedList=[],b.noSelection=!0,b.createdNodes=[],b.zId=0,b._ver=(new Date).getTime()},_checkInitRoot:function(a){var a=this.options,b=this._getRoot(a);b.radioCheckedList=[]},_editInitRoot:function(a){var a=this.options,b=this._getRoot(a),c=this._getRoots();b.curEditNode=null,b.curEditInput=null,b.curHoverNode=null,b.dragFlag=0,b.dragNodeShowBefore=[],b.dragMaskList=new Array,c.showHoverDom=!0},_coreInitCache:function(a){var a=this.options,b=this._getCache(a);b||(b={},this._setCache(a,b)),b.nodes=[],b.doms=[]},_checkInitCache:function(a){},_editInitCache:function(a){},_coreBindEvent:function(a){var a=this.options,b=this,c=a.treeObj,d=_final.event;c.bind(d.NODECREATED,function(c,d,e){b._trigger("onNodeCreated",null,[d,e,a])}),c.bind(d.CLICK,function(c,d,e,f,g){return 1==f.nodeDisabled?!1:void b._trigger("onClick",null,[e,f,g,a])}),c.bind(d.EXPAND,function(c,d,e){b._trigger("onExpand",null,[d,e,a])}),c.bind(d.COLLAPSE,function(c,d,e){b._trigger("onCollapse",null,[d,e,a])}),c.bind(d.ASYNC_SUCCESS,function(c,d,e,f){b._trigger("onLoad",null,[d,e,f,a])}),c.bind(d.ASYNC_ERROR,function(c,d,e,f,g,h){b._trigger("onLoad",null,[d,e,f,g,h,a])}),c.bind(d.REMOVE,function(c,d,e){b._trigger("onRemove",null,[d,e,a])})},_checkBindEvent:function(a){var b=this.element,c=this;cache=_final.event,b.bind(cache.CHECK,function(b,d,e,f){b.srcEvent=d,c._trigger("onCheck",null,[e,f,a])})},_editBindEvent:function(a){var b=this.element,c=_final.event,d=this;b.bind(c.RENAME,function(b,c,e,f){d._trigger("onReName",null,[c,e,f,a])}),b.bind(c.DRAG,function(b,c,e,f){d._trigger("onDrag",null,[e,f,a])}),b.bind(c.DRAGMOVE,function(b,c,e,f){d._trigger("onDragMove",null,[e,f,a])}),b.bind(c.DROP,function(b,c,e,f,g,h,i){d._trigger("onDrop",null,[e,f,g,h,i,a])})},_coreUnbindEvent:function(a){var b=this.element,c=_final.event;b.unbind(c.NODECREATED).unbind(c.CLICK).unbind(c.EXPAND).unbind(c.COLLAPSE).unbind(c.ASYNC_SUCCESS).unbind(c.ASYNC_ERROR).unbind(c.REMOVE)},_checkUnbindEvent:function(a){var b=this.element,c=_final.event;b.unbind(c.CHECK)},_editUnbindEvent:function(a){var b=this.element,c=_final.event;b.unbind(c.RENAME),b.unbind(c.DRAG),b.unbind(c.DRAGMOVE),b.unbind(c.DROP)},_coreEventProxy:function(a){var b=a.target,c=this._getSetting(this.options.treeId),d="",e=null,f="",g="",h=null,i=null,j=null;if(this._eqs(a.type,"mousedown")?g="mousedown":this._eqs(a.type,"mouseup")?g="mouseup":this._eqs(a.type,"contextmenu")?g="contextmenu":this._eqs(a.type,"click")?this._eqs(b.tagName,"span")&&null!==b.getAttribute("treeNode"+_final.id.SWITCH)?(d=this._getNodeMainDom(b).id,f="switchNode"):(j=this._getMDom(c,b,[{tagName:"a",attrName:"treeNode"+_final.id.A}]),j&&(d=this._getNodeMainDom(j).id,f="clickNode")):this._eqs(a.type,"dblclick")&&(g="dblclick",j=this._getMDom(c,b,[{tagName:"a",attrName:"treeNode"+_final.id.A}]),j&&(d=this._getNodeMainDom(j).id,f="switchNode")),g.length>0&&0==d.length&&(j=this._getMDom(c,b,[{tagName:"a",attrName:"treeNode"+_final.id.A}]),j&&(d=this._getNodeMainDom(j).id)),d.length>0)switch(e=this._getNodeCache(c,d),f){case"switchNode":e.isParent&&(this._eqs(a.type,"click")||this._eqs(a.type,"dblclick")&&this._apply(c.dblClickExpand,[c.treeId,e,c],c.dblClickExpand))?h=this._onSwitchNode:f="";break;case"clickNode":h=this._onClickNode}switch(g){case"mousedown":i=this._onTreeMousedown;break;case"mouseup":i=this._onTreeMouseup;break;case"dblclick":i=this._onTreeDblclick;break;case"contextmenu":i=this._onTreeContextmenu}var k={stop:!1,node:e,nodeEventType:f,nodeEventCallback:h,treeEventType:g,treeEventCallback:i};return k},_checkEventProxy:function(a){var b=a.target,c=this._getSetting(this.options.treeId),d="",e=null,f="",g="",h=null,i=null;if(this._eqs(a.type,"mouseover")?c.checkable&&this._eqs(b.tagName,"span")&&null!==b.getAttribute("treeNode"+_final.id.CHECK)&&(d=this._getNodeMainDom(b).id,f="mouseoverCheck"):this._eqs(a.type,"mouseout")?c.checkable&&this._eqs(b.tagName,"span")&&null!==b.getAttribute("treeNode"+_final.id.CHECK)&&(d=this._getNodeMainDom(b).id,f="mouseoutCheck"):this._eqs(a.type,"click")&&c.checkable&&this._eqs(b.tagName,"span")&&null!==b.getAttribute("treeNode"+_final.id.CHECK)&&(d=this._getNodeMainDom(b).id,f="checkNode"),d.length>0)switch(e=this._getNodeCache(c,d),f){case"checkNode":h=this._onCheckNode;break;case"mouseoverCheck":h=this._onMouseoverCheck;break;case"mouseoutCheck":h=this._onMouseoutCheck}var j={stop:"checkNode"===f,node:e,nodeEventType:f,nodeEventCallback:h,treeEventType:g,treeEventCallback:i};return j},_editEventProxy:function(a){var b=a.target,c=this._getSetting(this.options.treeId),d=a.relatedTarget,e="",f=null,g="",h="",i=null,j=null,k=null;if(this._eqs(a.type,"mouseover")?(k=this._getMDom(c,b,[{tagName:"a",attrName:"treeNode"+_final.id.A}]),k&&(e=this._getNodeMainDom(k).id,g="hoverOverNode")):this._eqs(a.type,"mouseout")?(k=this._getMDom(c,d,[{tagName:"a",attrName:"treeNode"+_final.id.A}]),k||(e="remove",g="hoverOutNode")):this._eqs(a.type,"mousedown")&&(k=this._getMDom(c,b,[{tagName:"a",attrName:"treeNode"+_final.id.A}]),k&&(e=this._getNodeMainDom(k).id,g="mousedownNode")),e.length>0)switch(f=this._getNodeCache(c,e),g){case"mousedownNode":i=this._onMousedownNode;break;case"hoverOverNode":i=this._onHoverOverNode;break;case"hoverOutNode":i=this._onHoverOutNode}var l={stop:!1,node:f,nodeEventType:g,nodeEventCallback:i,treeEventType:h,treeEventCallback:j};return l},_beforeA:function(a,b,c){a.keyChecked;a.checkable&&(this._makeChkFlag(a,b),c.push("<span ID='",b.tId,_final.id.CHECK,"' class='",this._makeChkClass(a,b),"' treeNode",_final.id.CHECK,b.nocheck===!0?" style='display:none;'":"","></span>"))},_coreInitNode:function(a,b,c,d,e,f,g){if(c){var h=this._getRoot(a),i=this,j=a.keyChildren;c.level=b,c.tId=a.treeId+"_"+ ++h.zId,c.parentTId=d?d.tId:null,c.open="string"==typeof c.open?i._eqs(c.open,"true"):!!c.open,c[j]&&c[j].length>0?(c.isParent=!0,c.zAsync=!0):(c.isParent="string"==typeof c.isParent?i._eqs(c.isParent,"true"):!!c.isParent,c.open=c.isParent&&!a.asyncEnable?c.open:!1,c.zAsync=!c.isParent),c.isFirstNode=e,c.isLastNode=f,c.getParentNode=function(){return i._getNodeCache(a,c.parentTId)},c.getPreNode=function(){return i._getPreNode(a,c)},c.getNextNode=function(){return i._getNextNode(a,c)},c.isAjaxing=!1,i._fixPIdKeyValue(a,c)}},_checkInitNode:function(a,b,c,d,e,f,g){if(c){1==c.nodeDisabled&&(c.chkDisabled=!0);var h=a.keyChecked,i=this;if("string"==typeof c[h]&&(c[h]=i._eqs(c[h],"true")),c[h]=!!c[h],c.checkedOld=c[h],"string"==typeof c.nocheck&&(c.nocheck=i._eqs(c.nocheck,"true")),c.nocheck=!!c.nocheck||a.nocheckInherit&&d&&!!d.nocheck,"string"==typeof c.chkDisabled&&(c.chkDisabled=i._eqs(c.chkDisabled,"true")),c.chkDisabled=!!c.chkDisabled||a.chkDisabledInherit&&d&&!!d.chkDisabled,"string"==typeof c.halfCheck&&(c.halfCheck=i._eqs(c.halfCheck,"true")),c.halfCheck=!!c.halfCheck,c.check_Child_State=-1,c.check_Focus=!1,c.getCheckStatus=function(){return i._getCheckStatus(a,c)},a.chkStyle==_final.radio.STYLE&&a.radioType==_final.radio.TYPE_ALL&&c[h]){var j=i._getRoot(a);j.radioCheckedList.push(c)}}},_editInitNode:function(a,b,c,d,e,f,g){c&&(c.isHover=!1,c.editNameFlag=!1)},_checkTreeTools:function(a,b){},checkNode:function(a,b,c,d){var e=this.options.keyChecked,f=this,g=this.options;if(a.chkDisabled!==!0&&(b!==!0&&b!==!1&&(b=!a[e]),d=!!d,(a[e]!==b||c)&&(!d||0!=f._apply(g.beforeCheck,[g.treeId,a,g],!0))&&this._uCanDo(g)&&g.checkable&&a.nocheck!==!0)){a[e]=b;var h=this._$(a,_final.id.CHECK,g);(c||g.chkStyle===_final.radio.STYLE)&&this._checkNodeRelation(g,a),this._setChkClass(g,h,a),this._repairParentChkClassWithSelf(g,a),d&&g.treeObj.trigger(_final.event.CHECK,[null,g.treeId,a])}},_editTreeTools:function(a,b){b.cancelEditName=function(a){var b=this._getRoot(this.opts);b.curEditNode&&this._cancelCurEditNode(this.opts,a?a:null,!0)}},copyNode:function(a,b,c,d){function e(){this._addNodes(f,a,[g],d)}if(!b)return null;var f=this.options;if(a&&!a.isParent&&f.keepLeaf&&c===_final.move.TYPE_INNER)return null;var g=this._clone(b);return a||(a=null,c=_final.move.TYPE_INNER),c==_final.move.TYPE_INNER?this._canAsync(f,a)?this._asyncNode(f,a,d,e):e():(this._addNodes(f,a.parentNode,[g],d),this._moveNode(f,a,g,c,!1,d)),g},editName:function(a){var b=this.options;a&&a.tId&&a===this._getNodeCache(b,a.tId)&&(a.parentTId&&this._expandCollapseParentNode(b,a.getParentNode(),!0),this._editNode(b,a))},moveNode:function(a,b,c,d){function e(){this._moveNode(f,a,b,c,!1,d)}if(!b)return b;var f=this.options;return a&&!a.isParent&&f.keepLeaf&&c===_final.move.TYPE_INNER?null:a&&(b.parentTId==a.tId&&c==_final.move.TYPE_INNER||this._$(b,f).find("#"+a.tId).length>0)?null:(a||(a=null),this._canAsync(f,a)&&c===_final.move.TYPE_INNER?this._asyncNode(f,a,d,e):e(),b)},setEditable:function(a){var b=this.options;return b.editable=a,this.refresh()},checkAllNodes:function(a){this._repairAllChk(this.options,!!a)},getCheckedNodes:function(a){var b=this.options.keyChildren;return a=a!==!1,this._getTreeCheckedNodes(this.options,this._getRoot(this.options)[b],a)},getChangeCheckedNodes:function(){var a=this.options.keyChildren;return this._getTreeChangeCheckedNodes(this.options,this._getRoot(this.options)[a])},setChkDisabled:function(a,b,c,d){b=!!b,c=!!c,d=!!d,this._repairSonChkDisabled(this.options,a,b,d),this._repairParentChkDisabled(this.options,a.getParentNode(),b,c)},updateNode:function(a,b){var c=(this.options.updateNode,this.options);if(a){var d=this._$(a,c);if(d.get(0)&&this._uCanDo(c)&&(this._setNodeName(c,a),this._setNodeTarget(c,a),this._setNodeUrl(c,a),this._setNodeLineIcos(c,a),this._setNodeFontCss(c,a)),a&&this.options.checkable){var d=this._$(a,this.options);if(d.get(0)&&this._uCanDo(this.options)){var e=this._$(a,_final.id.CHECK,this.options);1!=b&&this.options.chkStyle!==_final.radio.STYLE||this._checkNodeRelation(this.options,a),this._setChkClass(this.options,e,a),this._repairParentChkClassWithSelf(this.options,a)}}}},_addNodeCache:function(a,b){this._getCache(a).nodes[this._getNodeCacheId(b.tId)]=b},_getNodeCacheId:function(a){return a.substring(a.lastIndexOf("_")+1)},_addNodesData:function(a,b,c){var d=a.keyChildren;b[d]||(b[d]=[]),b[d].length>0&&(b[d][b[d].length-1].isLastNode=!1,this._setNodeLineIcos(a,b[d][b[d].length-1])),b.isParent=!0,b[d]=b[d].concat(c)},_addSelectedNode:function(a,b){var c=this._getRoot(a);this._isSelectedNode(a,b)||c.curSelectedList.push(b)},_addCreatedNode:function(a,b){if(a.onNodeCreated||a.addDiyDom){var c=this._getRoot(a);c.createdNodes.push(b)}},_fixPIdKeyValue:function(a,b){a.simpleDataEnable&&(b[a.simpleDataPIdKey]=b.parentTId?b.getParentNode()[a.simpleDataIdKey]:a.simpleDataRootPId)},_getAfterA:function(a,b,c){for(var d=0,e=this._initNodeBind.afterA.length;e>d;d++)this._initNodeBind.afterA[d].apply(this,arguments)},_getBeforeA:function(a,b,c){for(var d=0,e=this._initNodeBind.beforeA.length;e>d;d++)this._initNodeBind.beforeA[d].apply(this,arguments)},_getInnerAfterA:function(a,b,c){for(var d=0,e=this._initNodeBind.innerAfterA.length;e>d;d++)this._initNodeBind.innerAfterA[d].apply(this,arguments)},_getInnerBeforeA:function(a,b,c){for(var d=0,e=this._initNodeBind.innerBeforeA.length;e>d;d++)this._initNodeBind.innerBeforeA[d].apply(this,arguments)},_getCache:function(a){return caches[a.treeId]},_getNextNode:function(a,b){if(!b)return null;for(var c=a.keyChildren,d=b.parentTId?b.getParentNode():this._getRoot(a),e=0,f=d[c].length-1;f>=e;e++)if(d[c][e]===b)return e==f?null:d[c][e+1];return null},_getNodeByParam:function(a,b,c,d){if(!b||!c)return null;for(var e=a.keyChildren,f=0,g=b.length;g>f;f++){if(b[f][c]==d)return b[f];var h=this._getNodeByParam(a,b[f][e],c,d);if(h)return h}return null},_getNodeCache:function(a,b){if(!b)return null;var c=caches[a.treeId].nodes[this._getNodeCacheId(b)];return c?c:null},_getNodeName:function(a,b){var c=a.keyName;return""+b[c]},_getNodeTitle:function(a,b){var c=""===a.keyTitle?a.keyName:a.keyTitle;return""+b[c]},_getNodes:function(a){return this._getRoot(a)[a.keyChildren]},_getNodesByParam:function(a,b,c,d){if(!b||!c)return[];for(var e=a.keyChildren,f=[],g=0,h=b.length;h>g;g++)b[g][c]==d&&f.push(b[g]),f=f.concat(this._getNodesByParam(a,b[g][e],c,d));return f},_getNodesByParamFuzzy:function(a,b,c,d){if(!b||!c)return[];var e=a.keyChildren,f=[];d=d.toLowerCase();for(var g=0,h=b.length;h>g;g++)"string"==typeof b[g][c]&&b[g][c].toLowerCase().indexOf(d)>-1&&f.push(b[g]),f=f.concat(this._getNodesByParamFuzzy(a,b[g][e],c,d));return f},_getNodesByFilter:function(a,b,c,d,e){if(!b)return d?null:[];for(var f=a.keyChildren,g=d?null:[],h=0,i=b.length;i>h;h++){if(this._apply(c,[b[h],e],!1)){if(d)return b[h];g.push(b[h])}var j=this._getNodesByFilter(a,b[h][f],c,d,e);if(d&&j)return j;g=d?j:g.concat(j)}return g},_getPreNode:function(a,b){if(!b)return null;for(var c=a.keyChildren,d=b.parentTId?b.getParentNode():this._getRoot(a),e=0,f=d[c].length;f>e;e++)if(d[c][e]===b)return 0==e?null:d[c][e-1];return null},_getRadioCheckedList:function(a){for(var b=this._getRoot(a).radioCheckedList,c=0,d=b.length;d>c;c++)this._getNodeCache(a,b[c].tId)||(b.splice(c,1),c--,d--);return b},_getCheckStatus:function(a,b){if(!a.checkable||b.nocheck||b.chkDisabled)return null;var c=a.keyChecked,d={checked:b[c],half:b.halfCheck?b.halfCheck:a.chkStyle==_final.radio.STYLE?2===b.check_Child_State:b[c]?b.check_Child_State>-1&&b.check_Child_State<2:b.check_Child_State>0};return d},_getTreeCheckedNodes:function(a,b,c,d){if(!b)return[];var e=a.keyChildren,f=a.keyChecked,g=c&&a.chkStyle==_final.radio.STYLE&&a.radioType==_final.radio.TYPE_ALL;d=d?d:[];for(var h=0,i=b.length;i>h&&(b[h].nocheck===!0||b[h].chkDisabled===!0||b[h][f]!=c||(d.push(b[h]),!g))&&(this._getTreeCheckedNodes(a,b[h][e],c,d),!(g&&d.length>0));h++);return d},_getTreeChangeCheckedNodes:function(a,b,c){if(!b)return[];var d=a.keyChildren,e=a.keyChecked;c=c?c:[];for(var f=0,g=b.length;g>f;f++)b[f].nocheck!==!0&&b[f].chkDisabled!==!0&&b[f][e]!=b[f].checkedOld&&c.push(b[f]),this._getTreeChangeCheckedNodes(a,b[f][d],c);return c},_getRoot:function(a){return a?roots[a.treeId]:null},_getRoots:function(){return roots},_getSetting:function(a){return settings[a]},_getSettings:function(){return settings},_getTreeTools:function(a){var b=this._getRoot(this._getSetting(a));return b?b.treeTools:null},_initCache:function(a){for(var b=0,c=this._initNodeBind.caches.length;c>b;b++)this._initNodeBind.caches[b].apply(this,arguments)},_initNode:function(a,b,c,d,e,f){for(var g=0,h=this._initNodeBind.nodes.length;h>g;g++)this._initNodeBind.nodes[g].apply(this,arguments)},_initRoot:function(a){for(var b=0,c=this._initNodeBind.roots.length;c>b;b++)this._initNodeBind.roots[b].apply(this,arguments)},_isSelectedNode:function(a,b){for(var c=this._getRoot(a),d=0,e=c.curSelectedList.length;e>d;d++)if(b===c.curSelectedList[d])return!0;return!1},_removeNodeCache:function(a,b){var c=a.keyChildren;if(b[c])for(var d=0,e=b[c].length;e>d;d++)this._removeNodeCache(a,b[c][d]);this._getCache(a).nodes[this._getNodeCacheId(b.tId)]=null},_removeSelectedNode:function(a,b){for(var c=this._getRoot(a),d=0,e=c.curSelectedList.length;e>d;d++)b!==c.curSelectedList[d]&&this._getNodeCache(a,c.curSelectedList[d].tId)||(c.curSelectedList.splice(d,1),d--,e--)},_setCache:function(a,b){caches[a.treeId]=b},_setRoot:function(a,b){roots[a.treeId]=b},_setTreeTools:function(a,b){for(var c=0,d=this._initNodeBind.treeTools.length;d>c;c++)this._initNodeBind.treeTools[c].apply(this,arguments)},_makeChkFlag:function(a,b){if(b){var c=a.keyChildren,d=a.keyChecked,e=-1;if(b[c])for(var f=0,g=b[c].length;g>f;f++){var h=b[c][f],i=-1;if(a.chkStyle==_final.radio.STYLE){if(i=h.nocheck===!0||h.chkDisabled===!0?h.check_Child_State:h.halfCheck===!0?2:h[d]?2:h.check_Child_State>0?2:0,2==i){e=2;break}0==i&&(e=0)}else if(a.chkStyle==_final.checkbox.STYLE){if(i=h.nocheck===!0||h.chkDisabled===!0?h.check_Child_State:h.halfCheck===!0?1:h[d]?-1===h.check_Child_State||2===h.check_Child_State?2:1:h.check_Child_State>0?1:0,1===i){e=1;break}if(2===i&&e>-1&&f>0&&i!==e){e=1;break}if(2===e&&i>-1&&2>i){e=1;break}i>-1&&(e=i)}}b.check_Child_State=e}},_setSonNodeLevel:function(a,b,c){if(c){var d=a.keyChildren;if(c.level=b?b.level+1:0,c[d])for(var e=0,f=c[d].length;f>e;e++)c[d][e]&&this._setSonNodeLevel(a,c,c[d][e])}},_transformToArrayFormat:function(a,b){if(!b)return[];var c=a.keyChildren,d=[];if(this._isArray(b))for(var e=0,f=b.length;f>e;e++)d.push(b[e]),b[e][c]&&(d=d.concat(this._transformToArrayFormat(a,b[e][c])));else d.push(b),b[c]&&(d=d.concat(this._transformToArrayFormat(a,b[c])));return d},_transformToTreeFormat:function(a,b){var c,d,e=a.simpleDataIdKey,f=a.simpleDataPIdKey,g=a.keyChildren;if(!e||""==e||!b)return[];if(this._isArray(b)){var h=[],i=[];for(c=0,d=b.length;d>c;c++)i[b[c][e]]=b[c];for(c=0,d=b.length;d>c;c++)i[b[c][f]]&&b[c][e]!=b[c][f]?(i[b[c][f]][g]||(i[b[c][f]][g]=[]),i[b[c][f]][g].push(b[c])):h.push(b[c]);return h}return[b]},_bindEvent:function(a){for(var b=0,c=this._initNodeBind.bind.length;c>b;b++)this._initNodeBind.bind[b].apply(this,arguments)},_unbindEvent:function(a){for(var b=0,c=this._initNodeBind.unbind.length;c>b;b++)this._initNodeBind.unbind[b].apply(this,arguments)},_bindTree:function(a){var b=({treeId:a.treeId},this);treeObj=this.element,a.txtSelectedEnable||treeObj.bind("selectstart",function(a){var b=a.originalEvent.srcElement.nodeName.toLowerCase();return"input"===b||"textarea"===b}).css({"-moz-user-select":"-moz-none"}),this._on(treeObj,{click:function(a){b._proxy(a)},dblclick:function(a){b._proxy(a)},mouseover:function(a){b._proxy(a)},mouseout:function(a){b._proxy(a)},mousedown:function(a){b._proxy(a)},mouseup:function(a){b._proxy(a)},contextmenu:function(a){b._proxy(a)}})},_unbindTree:function(a){var b=this.element;b.unbind("click",this._proxy),b.unbind("dblclick",this._proxy),b.unbind("mouseover",this._proxy),b.unbind("mouseout",this._proxy),b.unbind("mousedown",this._proxy),b.unbind("mouseup",this._proxy),b.unbind("contextmenu",this._proxy)},_doProxy:function(a){for(var b=[],c=0,d=this._initNodeBind.proxys.length;d>c;c++){var e=this._initNodeBind.proxys[c].apply(this,arguments);if(b.push(e),e.stop)break}return b},_proxy:function(a){var b=this._getSetting(this.options.treeId),c=this;if(!this._uCanDo(b,a))return!0;for(var d=this._doProxy(a),e=!0,f=!1,g=0,h=d.length;h>g;g++){var i=d[g];i.nodeEventCallback&&(f=!0,e=i.nodeEventCallback.apply(i,[c,i.node,a])&&e),i.treeEventCallback&&(f=!0,e=i.treeEventCallback.apply(i,[c,i.node,a])&&e)}return e},_onSwitchNode:function(a,b){var c=a.options,d=a._getSetting(c.treeId);if(b.open){if(0==a._apply(d.beforeCollapse,[d.treeId,b,d],!0))return!0;a._getRoot(d).expandTriggerFlag=!0,a._switchNode(d,b)}else{if(0==a._apply(d.beforeExpand,[d.treeId,b,d]))return!0;a._getRoot(d).expandTriggerFlag=!0,a._switchNode(d,b)}return!0},_onClickNode:function(a,b){var c=a.options;return clickFlag=c.autoCancelSelected&&(event.ctrlKey||event.metaKey)&&a._isSelectedNode(c,b)?0:c.autoCancelSelected&&(event.ctrlKey||event.metaKey)&&c.selectedMulti?2:1,0==a._apply(c.beforeClick,[c.treeId,b,clickFlag,c],!0)?!0:(0===clickFlag?a._cancelPreSelectedNode(c,b):a._selectNode(c,b,2===clickFlag),c.treeObj.trigger(_final.event.CLICK,[event,c.treeId,b,clickFlag]),c.clickExpand&&$(c.treeObj).tree("expandNode",b,null,null,null,!0),!0)},_onTreeMousedown:function(a,b){var c=a._getSetting(a.options.treeId);return a._apply(c.beforeMouseDown,[c.treeId,b,c],!0)&&a._trigger("onMouseDown",null,[c.treeId,b,c]),!0},_onTreeMouseup:function(a,b){var c=a._getSetting(a.options.treeId);return a._apply(c.beforeMouseUp,[c.treeId,b,c],!0)&&a._trigger("onMouseUp",null,[c.treeId,b,c]),!0},_onTreeDblclick:function(a,b){var c=a._getSetting(a.options.treeId);return a._apply(c.beforeDblClick,[c.treeId,b,c],!0)&&a._trigger("onDblClick",null,[c.treeId,b,c]),!0},_onTreeContextmenu:function(a,b){var c=a._getSetting(a.options.treeId);return a._apply(c.beforeRightClick,[c.treeId,b,c],!0)&&a._trigger("onRightClick",null,[c.treeId,b,c]),"function"!=typeof c.onRightClick},_onCheckNode:function(a,b){var c=a.options;if(b.chkDisabled===!0)return!1;var d=a._getSetting(c.treeId),e=d.keyChecked;if(0==a._apply(d.beforeCheck,[d.treeId,b,d],!0))return!0;b[e]=!b[e],a._checkNodeRelation(d,b);var f=a._$(b,_final.id.CHECK,d);return a._setChkClass(d,f,b),a._repairParentChkClassWithSelf(d,b),a.element.trigger(_final.event.CHECK,[event,d.treeId,b]),!0},_onMouseoverCheck:function(a,b){var c=a.options;if(b.chkDisabled===!0)return!1;var d=a._getSetting(c.treeId),e=a._$(b,_final.id.CHECK,d);return b.check_Focus=!0,a._setChkClass(d,e,b),!0},_onMouseoutCheck:function(a,b){var c=a.options;if(b.chkDisabled===!0)return!1;var d=a._getSetting(c.treeId),e=a._$(b,_final.id.CHECK,d);return b.check_Focus=!1,a._setChkClass(d,e,b),!0},_onHoverOverNode:function(a,b){var c=a.options,d=a._getSetting(c.treeId),e=a._getRoot(d);e.curHoverNode!=b&&a._onHoverOutNode(a),e.curHoverNode=b,a._addHoverDom(d,b)},_onHoverOutNode:function(a,b){var c=a.options,d=a._getSetting(c.treeId),e=a._getRoot(d);e.curHoverNode&&!a._isSelectedNode(d,e.curHoverNode)&&(a._removeTreeDom(d,e.curHoverNode),e.curHoverNode=null)},_onMousedownNode:function(a,b,c){function d(b){if(0==k.dragFlag&&Math.abs(C-b.clientX)<j.dragMinMoveSize&&Math.abs(D-b.clientY)<j.dragMinMoveSize)return!0;
var c,d,f,g,h,i=j.keyChildren;if(u.css("cursor","pointer"),0==k.dragFlag){if(0==a._apply(j.beforeDrag,[j.treeId,o,j],!0))return e(b),!0;for(c=0,d=o.length;d>c;c++)0==c&&(k.dragNodeShowBefore=[]),f=o[c],f.isParent&&f.open?(a._expandCollapseNode(j,f,!f.open),k.dragNodeShowBefore[f.tId]=!0):k.dragNodeShowBefore[f.tId]=!1;k.dragFlag=1,l.showHoverDom=!1,a._showIfameMask(j,!0);var m=!0,n=-1;if(o.length>1){var x=o[0].parentTId?o[0].getParentNode()[i]:a._getNodes(j);for(h=[],c=0,d=x.length;d>c;c++)if(void 0!==k.dragNodeShowBefore[x[c].tId]&&(m&&n>-1&&n+1!==c&&(m=!1),h.push(x[c]),n=c),o.length===h.length){o=h;break}}for(m&&(r=o[0].getPreNode(),s=o[o.length-1].getNextNode()),c=0,d=o.length;d>c;c++)f=o[c],f.editNameFlag=!1,a._selectNode(j,f,c>0),a._removeTreeDom(j,f),c>j.dragMaxShowNodeNum-1||(g=a._$("<li id='"+f.tId+"_tmp'></li>",j),g.append(a._$(f,_final.id.A,j).clone()),g.css("padding","0"),g.children("#"+f.tId+_final.id.A).removeClass(_final.node.CURSELECTED),c==j.dragMaxShowNodeNum-1&&(g=a._$("<li id='"+f.tId+"_moretmp'><a>  ...  </a></li>",j)));p=a._$("<span class='tmpTreeMove_arrow'></span>",j),p.attr("id","treeMove_arrow_tmp"),p.appendTo(u),a.element.trigger(_final.event.DRAG,[b,j.treeId,o])}if(1==k.dragFlag){if(q&&p.attr("id")==b.target.id&&A&&b.clientX+t.scrollLeft()+2>$("#"+A+_final.id.A,q).offset().left){var F=$("#"+A+_final.id.A,q);b.target=F.length>0?F.get(0):b.target}else q&&(q.removeClass(_final.node.TMPTARGET_TREE),A&&$("#"+A+_final.id.A,q).removeClass(_final.node.TMPTARGET_NODE+"_"+_final.move.TYPE_PREV).removeClass(_final.node.TMPTARGET_NODE+"_"+_final.move.TYPE_NEXT).removeClass(_final.node.TMPTARGET_NODE+"_"+_final.move.TYPE_INNER));q=null,A=null,v=!1,w=j;var G=a._getSettings();for(var H in G)G[H].treeId&&G[H].editable&&G[H].treeId!=j.treeId&&(b.target.id==G[H].treeId||$(b.target).parents("#"+G[H].treeId).length>0)&&(v=!0,w=G[H]);var I=t.scrollTop(),J=t.scrollLeft(),K=w.treeObj.offset(),L=w.treeObj.get(0).scrollHeight,M=w.treeObj.get(0).scrollWidth,N=b.clientY+I-K.top,O=w.treeObj.height()+K.top-b.clientY-I,P=b.clientX+J-K.left,Q=w.treeObj.width()+K.left-b.clientX-J,R=N<j.dragBorderMax&&N>j.dragBorderMin,S=O<j.dragBorderMax&&O>j.dragBorderMin,T=P<j.dragBorderMax&&P>j.dragBorderMin,U=Q<j.dragBorderMax&&Q>j.dragBorderMin,V=N>j.dragBorderMin&&O>j.dragBorderMin&&P>j.dragBorderMin&&Q>j.dragBorderMin,W=R&&w.treeObj.scrollTop()<=0,X=S&&w.treeObj.scrollTop()+w.treeObj.height()+10>=L,Y=T&&w.treeObj.scrollLeft()<=0,Z=U&&w.treeObj.scrollLeft()+w.treeObj.width()+10>=M;if(b.target&&a._isChildOrSelf(b.target,w.treeId)){for(var _=b.target;_&&_.tagName&&!a._eqs(_.tagName,"li")&&_.id!=w.treeId;)_=_.parentNode;var aa=!0;for(c=0,d=o.length;d>c;c++){if(f=o[c],_.id===f.tId){aa=!1;break}if(a._$(f,j).find("#"+_.id).length>0){aa=!1;break}}aa&&b.target&&a._isChildOrSelf(b.target,_.id+_final.id.A)&&(q=$(_),A=_.id)}f=o[0],V&&a._isChildOrSelf(b.target,w.treeId)&&(!q&&(b.target.id==w.treeId||W||X||Y||Z)&&(v||!v&&f.parentTId)&&(q=w.treeObj),R?w.treeObj.scrollTop(w.treeObj.scrollTop()-10):S&&w.treeObj.scrollTop(w.treeObj.scrollTop()+10),T?w.treeObj.scrollLeft(w.treeObj.scrollLeft()-10):U&&w.treeObj.scrollLeft(w.treeObj.scrollLeft()+10),q&&q!=w.treeObj&&q.offset().left<w.treeObj.offset().left&&w.treeObj.scrollLeft(w.treeObj.scrollLeft()+q.offset().left-w.treeObj.offset().left));var ba=0,ca=0;if(q&&q.attr("id")!=w.treeId){var da=null==A?null:a._getNodeCache(w,A),ea=(b.ctrlKey||b.metaKey)&&j.dragIsMove&&j.dragIsCopy||!j.dragIsMove&&j.dragIsCopy,fa=!(!r||A!==r.tId),ga=!(!s||A!==s.tId),ha=f.parentTId&&f.parentTId==A,ia=(ea||!ga)&&a._apply(w.dragPrev,[w.treeId,o,da,w],!!w.dragPrev),ja=(ea||!fa)&&a._apply(w.dragNext,[w.treeId,o,da,w],!!w.dragNext),ka=(ea||!ha)&&!(w.keepLeaf&&!da.isParent)&&a._apply(w.dragInner,[w.treeId,o,da,w],!!w.dragInner);if(ia||ja||ka){var la=$("#"+A+_final.id.A,q),ma=da.isLastNode?null:$("#"+da.getNextNode().tId+_final.id.A,q.next()),na=la.offset().top,oa=la.offset().left,pa=ia?ka?.25:ja?.5:1:-1,qa=ja?ka?.75:ia?.5:0:-1,ra=(b.clientY+I-na)/la.height();if((1==pa||pa>=ra&&ra>=-.2)&&ia?(ba=1-p.width(),ca=na-p.height()/2,B=_final.move.TYPE_PREV):(0==qa||ra>=qa&&1.2>=ra)&&ja?(ba=1-p.width(),ca=null==ma||da.isParent&&da.open?na+la.height()-p.height()/2:ma.offset().top-p.height()/2,B=_final.move.TYPE_NEXT):(ba=5-p.width(),ca=na,B=_final.move.TYPE_INNER),p.css({display:"block",top:ca+"px",left:oa+ba+"px"}),"line"==j.dragStyle&&(_final.move.TYPE_INNER==B?p.removeClass("preNext_line").addClass("inner_line"):p.removeClass("inner_line").addClass("preNext_line")),la.addClass(_final.node.TMPTARGET_NODE+"_"+B),y==A&&z==B||(E=(new Date).getTime()),da&&da.isParent&&B==_final.move.TYPE_INNER){var sa=!0;window.TreeMoveTimer&&window.TreeMoveTargetNodeTId!==da.tId?(clearTimeout(window.TreeMoveTimer),window.TreeMoveTargetNodeTId=null):window.TreeMoveTimer&&window.TreeMoveTargetNodeTId===da.tId&&(sa=!1),sa&&(window.TreeMoveTimer=setTimeout(function(){B==_final.move.TYPE_INNER&&da&&da.isParent&&!da.open&&(new Date).getTime()-E>w.dragAutoOpenTime&&a._apply(w.beforeDragOpen,[w.treeId,da,w],!0)&&(a._switchNode(w,da),w.dragAutoExpandTrigger&&w.treeObj.trigger(_final.event.EXPAND,[w.treeId,da]))},w.dragAutoOpenTime+50),window.TreeMoveTargetNodeTId=da.tId)}}else q=null,A="",B=_final.move.TYPE_INNER,window.TreeMoveTimer&&(clearTimeout(window.TreeMoveTimer),window.TreeMoveTargetNodeTId=null)}else B=_final.move.TYPE_INNER,q&&a._apply(w.dragInner,[w.treeId,o,null,w],!!w.dragInner)?q.addClass(_final.node.TMPTARGET_TREE):q=null,p.css({display:"none"}),window.TreeMoveTimer&&(clearTimeout(window.TreeMoveTimer),window.TreeMoveTargetNodeTId=null);y=A,z=B,a.element.trigger(_final.event.DRAGMOVE,[b,j.treeId,o])}return!1}function e(b){function c(){if(v){if(!n)for(var c=0,d=o.length;d>c;c++)a._removeNode(j,o[c]);if(B==_final.move.TYPE_INNER)a._addNodes(w,r,s);else if(a._addNodes(w,r.getParentNode(),s),B==_final.move.TYPE_PREV)for(c=0,d=s.length;d>c;c++)a._moveNode(w,r,s[c],B,!1);else for(c=-1,d=s.length-1;d>c;d--)a._moveNode(w,r,s[d],B,!1)}else if(n&&B==_final.move.TYPE_INNER)a._addNodes(w,r,s);else if(n&&a._addNodes(w,r.getParentNode(),s),B!=_final.move.TYPE_NEXT)for(c=0,d=s.length;d>c;c++)a._moveNode(w,r,s[c],B,!1);else for(c=-1,d=s.length-1;d>c;d--)a._moveNode(w,r,s[d],B,!1);a._selectNodes(w,s),a._$(s[0],j).focus().blur(),a.element.trigger(_final.event.DROP,[b,w.treeId,s,r,B,n])}if(window.TreeMoveTimer&&(clearTimeout(window.TreeMoveTimer),window.TreeMoveTargetNodeTId=null),y=null,z=null,t.unbind("mousemove",d),t.unbind("mouseup",e),t.unbind("selectstart",f),u.css("cursor","auto"),q&&(q.removeClass(_final.node.TMPTARGET_TREE),A&&$("#"+A+_final.id.A,q).removeClass(_final.node.TMPTARGET_NODE+"_"+_final.move.TYPE_PREV).removeClass(_final.node.TMPTARGET_NODE+"_"+_final.move.TYPE_NEXT).removeClass(_final.node.TMPTARGET_NODE+"_"+_final.move.TYPE_INNER)),a._showIfameMask(j,!1),l.showHoverDom=!0,0!=k.dragFlag){k.dragFlag=0;var h,i,m;for(h=0,i=o.length;i>h;h++)m=o[h],m.isParent&&k.dragNodeShowBefore[m.tId]&&!m.open&&(a._expandCollapseNode(j,m,!m.open),delete k.dragNodeShowBefore[m.tId]);p&&p.remove();var n=(b.ctrlKey||b.metaKey)&&j.dragIsMove&&j.dragIsCopy||!j.dragIsMove&&j.dragIsCopy;if(!n&&q&&A&&o[0].parentTId&&A==o[0].parentTId&&B==_final.move.TYPE_INNER&&(q=null),q){var r=null==A?null:a._getNodeCache(w,A);if(0==a._apply(g.beforeDrop,[w.treeId,o,r,B,n,j],!0))return void a._selectNodes(x,o);var s=n?a._clone(o):o;B==_final.move.TYPE_INNER&&a._canAsync(w,r)?a._asyncNode(w,r,!1,c):c()}else a._selectNodes(x,o),a.element.trigger(_final.event.DROP,[b,j.treeId,o,null,null,null])}}function f(){return!1}var g=a.options;event=c;var h,i,j=a._getSetting(g.treeId),k=a._getRoot(j),l=a._getRoots();if(2==event.button||!j.editable||!j.dragIsCopy&&!j.dragIsMove)return!0;var m=event.target,n=a._getRoot(j).curSelectedList,o=[];if(a._isSelectedNode(j,b))for(h=0,i=n.length;i>h;h++){if(n[h].editNameFlag&&a._eqs(m.tagName,"input")&&null!==m.getAttribute("treeNode"+_final.id.INPUT))return!0;if(o.push(n[h]),o[0].parentTId!==n[h].parentTId){o=[b];break}}else o=[b];a._editNodeBlur=!0,a._cancelCurEditNode(j);var p,q,r,s,t=$(a.element.get(0).ownerDocument),u=$(a.element.get(0).ownerDocument.body),v=!1,w=j,x=j,y=null,z=null,A=null,B=_final.move.TYPE_INNER,C=a.clientX,D=a.clientY,E=(new Date).getTime();return a._uCanDo(j)&&t.bind("mousemove",d),t.bind("mouseup",e),t.bind("selectstart",f),a.preventDefault&&a.preventDefault(),!0},_apply:function(a,b,c){if(a==c&&!$.isFunction(a))return c;if("undefined"==typeof a||null==a)return c;var d,e,f;return d=$.coral.toFunction(a),$.isFunction(d)?(e=d.apply(f||this,b?b:[]),"undefined"==typeof e?c:e):c},_canAsync:function(a,b){var c=a.keyChildren;return a.asyncEnable&&b&&b.isParent&&!(b.zAsync||b[c]&&b[c].length>0)},_clone:function(a){var b=this;if(null===a)return null;var c=b._isArray(a)?[]:{};for(var d in a)c[d]=a[d]instanceof Date?new Date(a[d].getTime()):"object"==typeof a[d]?this._clone(a[d]):a[d];return c},_eqs:function(a,b){return a.toLowerCase()===b.toLowerCase()},_isArray:function(a){return"[object Array]"===Object.prototype.toString.apply(a)},_$:function(a,b,c){return b&&"string"!=typeof b&&(c=b,b=""),"string"==typeof a?$(a,c?this.element.get(0).ownerDocument:null):$("#"+a.tId+b,c?this.element:null)},_getMDom:function(a,b,c){if(!b)return null;for(;b&&b.id!==a.treeId;){for(var d=0,e=c.length;b.tagName&&e>d;d++)if(this._eqs(b.tagName,c[d].tagName)&&null!==b.getAttribute(c[d].attrName))return b;b=b.parentNode}return null},_getNodeMainDom:function(a){return $(a).parent("li").get(0)||$(a).parentsUntil("li").parent().get(0)},_isChildOrSelf:function(a,b){return $(a).closest("#"+b).length>0},_getAbs:function(a){var b=a.getBoundingClientRect(),c=document.body.scrollTop+document.documentElement.scrollTop,d=document.body.scrollLeft+document.documentElement.scrollLeft;return[b.left+d,b.top+c]},_inputFocus:function(a){a.get(0)&&(a.focus(),this._setCursorPosition(a.get(0),a.val().length))},_inputSelect:function(a){a.get(0)&&(a.focus(),a.select())},_setCursorPosition:function(a,b){if(a.setSelectionRange)a.focus(),a.setSelectionRange(b,b);else if(a.createTextRange){var c=a.createTextRange();c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",b),c.select()}},_showIfameMask:function(a,b){for(var c=this._getRoot(a);c.dragMaskList.length>0;)c.dragMaskList[0].remove(),c.dragMaskList.shift();if(b)for(var d=this._$("iframe",a),e=0,f=d.length;f>e;e++){var g=d.get(e),h=this._getAbs(g),i=this._$("<div id='treeMask_"+e+"' class='treeMask' style='top:"+h[1]+"px; left:"+h[0]+"px; width:"+g.offsetWidth+"px; height:"+g.offsetHeight+"px;'></div>",a);i.appendTo(this._$("body",a)),c.dragMaskList.push(i)}},_addNodes:function(a,b,c,d){if(!a.keepLeaf||!b||b.isParent)if(this._isArray(c)||(c=[c]),a.simpleDataEnable&&(c=this._transformToTreeFormat(a,c)),b){var e=this._$(b,_final.id.SWITCH,a),f=this._$(b,_final.id.ICON,a),g=this._$(b,_final.id.UL,a);b.open||(this._replaceSwitchClass(b,e,_final.arrow.RIGHT),this._replaceIcoClass(b,f,_final.folder.CLOSE),b.open=!1,g.css({display:"none"})),this._addNodesData(a,b,c),this._createNodes(a,b.level+1,c,b),d||this._expandCollapseParentNode(a,b,!0)}else this._addNodesData(a,this._getRoot(a),c),this._createNodes(a,0,c,null)},_appendNodes1:function(a,b,c,d,e,f){if(!c)return[];for(var g=[],h=a.keyChildren,i=0,j=c.length;j>i;i++){var k=c[i];if(e){var l=d?d:this._getRoot(a),m=l[h],n=m.length==c.length&&0==i,o=i==c.length-1;this._initNode(a,b,k,d,n,o,f),this._addNodeCache(a,k)}var p=[];k[h]&&k[h].length>0&&(p=this._appendNodes(a,b+1,k[h],k,e,f&&k.open)),f&&(this._makeDOMNodeMainBefore(g,a,k),this._makeDOMNodeNameBefore(g,a,k),this._addDiyDom(g,a,k),this._makeDOMNodeLine(g,a,k),this._getBeforeA(a,k,g),this._getInnerBeforeA(a,k,g),this._makeDOMNodeIcon(g,a,k),this._getInnerAfterA(a,k,g),this._makeDOMNodeNameAfter(g,a,k),this._getAfterA(a,k,g),k.isParent&&k.open&&this._makeUlHtml(a,k,g,p.join("")),this._makeDOMNodeMainAfter(g,a,k),this._addCreatedNode(a,k))}return g},_appendParentULDom:function(a,b){var c=[],d=this._$(b,a);!d.get(0)&&b.parentTId&&(this._appendParentULDom(a,b.getParentNode()),d=this._$(b,a));var e=this._$(b,_final.id.UL,a);e.get(0)&&e.remove();var f=a.keyChildren,g=this._appendNodes(a,b.level+1,b[f],b,!1,!0);this._makeUlHtml(a,b,c,g.join("")),d.append(c.join(""))},_asyncNode:function(setting,node,isSilent,callback,opts){var opts=opts||{},that=this,i,l,isInit=setting.isInit;if(node&&!node.isParent)return this._apply(callback),!1;if(node&&node.isAjaxing)return!1;if(0==that._apply(setting.beforeAsync,[setting.treeId,node,setting],!0))return this._apply(callback),!1;if(node){node.isAjaxing=!0;var icoObj=that._$(node,_final.id.ICON,setting);icoObj.attr({style:"","class":_final.className.BUTTON+" "+_final.className.ICO_LOADING})}var tmpParam={},asyncOtherParam=opts.asyncOtherParam||setting.asyncOtherParam,autoParams=setting.asyncAutoParam.split(","),isInit=setting.isInit;for(i=0,l=autoParams.length;node&&l>i;i++){var pKey=autoParams[i].split("="),spKey=pKey;pKey.length>1&&(spKey=pKey[1],pKey=pKey[0]),tmpParam[spKey]=node[pKey]}if(this._isArray(asyncOtherParam))for(i=0,l=asyncOtherParam.length;l>i;i+=2)tmpParam[asyncOtherParam[i]]=asyncOtherParam[i+1];else for(var p in asyncOtherParam)tmpParam[p]=asyncOtherParam[p];var _tmpV=this._getRoot(setting)._ver,asyncUrl=this._apply(setting.asyncUrl,[setting.treeId,node,opts],setting.asyncUrl);return $.ajax({contentType:setting.asyncContentType,type:setting.asyncType,url:asyncUrl,data:tmpParam,dataType:setting.asyncDataType,success:function(msg){if(_tmpV==that._getRoot(setting)._ver){var newNodes=[];try{newNodes=msg&&0!=msg.length?"string"==typeof msg?eval("("+msg+")"):msg:[]}catch(err){newNodes=msg}node&&(node.isAjaxing=null,node.zAsync=!0),that._setNodeLineIcos(setting,node),newNodes&&""!==newNodes?(isInit&&(newNodes=that._createRootNodes(setting,newNodes)),newNodes=that._apply(setting.asyncDataFilter,[setting.treeId,node,newNodes,setting],newNodes),that._addNodes(setting,node,newNodes?that._clone(newNodes):[],!!isSilent)):(isInit&&(newNodes=that._createRootNodes(setting,newNodes)),that._addNodes(setting,node,rootNodes,!!isSilent)),opts.onLoad?that._apply(opts.onLoad,[setting.treeId,node,msg]):that.element.trigger(_final.event.ASYNC_SUCCESS,[setting.treeId,node,msg]),that._apply(callback)}},error:function(a,b,c){_tmpV==that._getRoot(setting)._ver&&(node&&(node.isAjaxing=null),that._setNodeLineIcos(setting,node),that.element.trigger(_final.event.ASYNC_ERROR,[setting.treeId,node,a,b,c]))}}),!0},_addEditBtn:function(a,b){var c=this;if(!(b.editNameFlag||this._$(b,_final.id.EDIT,a).length>0)&&this._apply(a.showRenameBtn,[a.treeId,b,a],a.showRenameBtn)){var d=this._$(b,_final.id.A,a),e="<span class='"+_final.className.BUTTON+" "+_final.editIcon+" edit' id='"+b.tId+_final.id.EDIT+"' title='"+this._apply(a.renameTitle,[a.treeId,b,a],a.renameTitle)+"' treeNode"+_final.id.EDIT+" style='display:none;'></span>";d.append(e),this._$(b,_final.id.EDIT,a).bind("click",function(){return c._uCanDo(a)&&0!=c._apply(a.beforeEditName,[a.treeId,b,a],!0)?(c._editNode(a,b),!1):!1}).show()}},_addRemoveBtn:function(a,b){var c=this;if(!(b.editNameFlag||this._$(b,_final.id.REMOVE,a).length>0)&&this._apply(a.showRemoveBtn,[a.treeId,b,a],a.showRemoveBtn)){var d=this._$(b,_final.id.A,a),e="<span class='"+_final.className.BUTTON+" "+_final.removeIcon+" remove' id='"+b.tId+_final.id.REMOVE+"' title='"+this._apply(a.removeTitle,[a.treeId,b,a],a.removeTitle)+"' treeNode"+_final.id.REMOVE+" style='display:none;'></span>";d.append(e),this._$(b,_final.id.REMOVE,a).bind("click",function(){return c._uCanDo(a)&&0!=c._apply(a.beforeRemove,[a.treeId,b,a],!0)?(c._removeNode(a,b),c.element.trigger(_final.event.REMOVE,[a.treeId,b]),!1):!1}).bind("mousedown",function(a){return!0}).show()}},_addHoverDom:function(a,b){this._getRoots().showHoverDom&&(b.isHover=!0,a.editable&&(this._addEditBtn(a,b),this._addRemoveBtn(a,b)),this._$(b,_final.id.A,a).addClass(_final.node.CURHOVER),this._apply(a.addHoverDom,[a.treeId,b,a]))},_cancelPreSelectedNode1:function(a,b){for(var c=this._getRoot(a).curSelectedList,d=0,e=c.length-1;e>=d;e--)if((!b||b===c[e])&&(this._$(c[e],_final.id.A,a).removeClass(_final.node.CURSELECTED),b)){this._removeSelectedNode(a,b);break}b||(this._getRoot(a).curSelectedList=[])},_createNodeCallback:function(a){if(a.onNodeCreated||a.addDiyDom)for(var b=this._getRoot(a);b.createdNodes.length>0;){var c=b.createdNodes.shift();this._apply(a.addDiyDom,[a.treeId,c,a]),a.onNodeCreated&&this.element.trigger(_final.event.NODECREATED,[a.treeId,c])}},_createRootNodes:function(a,b){return a.simpleDataEnable&&(b=this._transformToTreeFormat(a,b)),1==a.showRootNode?a.rootNode&&"boolean"!=typeof a.rootNode&&(a.rootNode.children=b,b=[a.rootNode]):"boolean"==typeof a.rootNode&&a.rootNode&&b.length>=1&&(b=b[0].children&&b[0].children.length>0?b[0].children:[]),b},_createNodes1:function(a,b,c,d){if(c&&0!=c.length){var e=this._getRoot(a),f=a.keyChildren,g=!d||d.open||!!this._$(d[f][0],a).get(0);e.createdNodes=[];var h=this._appendNodes(a,b,c,d,!0,g);if(d){var i=this._$(d,_final.id.UL,a);i.get(0)&&i.append(h.join(""))}else this.element.append(h.join(""));a.isInit=!1,this._createNodeCallback(a)}},_checkNodeRelation:function(a,b){var c,d,e,f=a.keyChildren,g=a.keyChecked,h=_final.radio;if(a.chkStyle==h.STYLE){var i=this._getRadioCheckedList(a);if(b[g])if(a.radioType==h.TYPE_ALL){for(d=i.length-1;d>=0;d--)c=i[d],c[g]&&c!=b&&(c[g]=!1,i.splice(d,1),this._setChkClass(a,this._$(c,_final.id.CHECK,a),c),c.parentTId!=b.parentTId&&this._repairParentChkClassWithSelf(a,c));i.push(b)}else{var j=b.parentTId?b.getParentNode():this._getRoot(a);for(d=0,e=j[f].length;e>d;d++)c=j[f][d],c[g]&&c!=b&&(c[g]=!1,this._setChkClass(a,this._$(c,_final.id.CHECK,a),c))}else if(a.radioType==h.TYPE_ALL)for(d=0,e=i.length;e>d;d++)if(b==i[d]){i.splice(d,1);break}}else b[g]&&(!b[f]||0==b[f].length||a.chkboxType.Y.indexOf("s")>-1)&&this._setSonNodeCheckBox(a,b,!0),b[g]||b[f]&&0!=b[f].length&&!(a.chkboxType.N.indexOf("s")>-1)||this._setSonNodeCheckBox(a,b,!1),b[g]&&a.chkboxType.Y.indexOf("p")>-1&&this._setParentNodeCheckBox(a,b,!0),!b[g]&&a.chkboxType.N.indexOf("p")>-1&&this._setParentNodeCheckBox(a,b,!1)},_cancelCurEditNode:function(a,b,c){var d=this._getRoot(a),e=a.keyName,f=d.curEditNode;if(f){var g=d.curEditInput,h=b?b:c?f[e]:g.val();if(this._apply(a.beforeReName,[a.treeId,f,h,c,a],!0)===!1)return!1;f[e]=h,this.element.trigger(_final.event.RENAME,[a.treeId,f,c]);var i=this._$(f,_final.id.A,a);i.removeClass(_final.node.CURSELECTED_EDIT),g.unbind(),this._setNodeName(a,f),f.editNameFlag=!1,d.curEditNode=null,d.curEditInput=null,this._selectNode(a,f,!1)}return d.noSelection=!0,!0},_editNode:function(a,b){var c=this,d=this._getRoot(a);if(this._editNodeBlur=!1,this._isSelectedNode(a,b)&&d.curEditNode==b&&b.editNameFlag)return void setTimeout(function(){this._inputFocus(d.curEditInput)},0);var e=a.keyName;b.editNameFlag=!0,this._removeTreeDom(a,b),this._cancelCurEditNode(a),this._selectNode(a,b,!1),this._$(b,_final.id.SPAN,a).html("<input type=text class='rename' id='"+b.tId+_final.id.INPUT+"' treeNode"+_final.id.INPUT+" >");var f=this._$(b,_final.id.INPUT,a);f.attr("value",b[e]),a.editNameSelectAll?this._inputSelect(f):this._inputFocus(f),f.bind("blur",function(b){c._editNodeBlur||c._cancelCurEditNode(a)}).bind("keydown",function(b){"13"==b.keyCode?(c._editNodeBlur=!0,c._cancelCurEditNode(a)):"27"==b.keyCode&&c._cancelCurEditNode(a,null,!0)}).bind("click",function(a){return!1}).bind("dblclick",function(a){return!1}),this._$(b,_final.id.A,a).addClass(_final.node.CURSELECTED_EDIT),d.curEditInput=f,d.noSelection=!1,d.curEditNode=b},_destroy:function(a){a&&(this._initCache(a),this._initRoot(a),this._unbindTree(a),this._unbindEvent(a),this.element.empty(),delete settings[a.treeId])},_expandCollapseNode:function(a,b,c,d,e){var f=this,g=this._getRoot(a),h=a.keyChildren;if(!b)return void f._apply(e,[]);if(g.expandTriggerFlag){var i=e;e=function(){i&&i(),b.open?f.element.trigger(_final.event.EXPAND,[a.treeId,b]):f.element.trigger(_final.event.COLLAPSE,[a.treeId,b])},g.expandTriggerFlag=!1}if(!b.open&&b.isParent&&(!this._$(b,_final.id.UL,a).get(0)||b[h]&&b[h].length>0&&!this._$(b[h][0],a).get(0))&&(this._appendParentULDom(a,b),this._createNodeCallback(a)),b.open==c)return void this._apply(e,[]);var j=this._$(b,_final.id.UL,a),k=this._$(b,_final.id.SWITCH,a),l=this._$(b,_final.id.ICON,a);b.isParent?(b.open=!b.open,b.iconOpen&&b.iconClose&&l.attr("style",this._makeNodeIcoStyle(a,b)),b.open?(this._replaceSwitchClass(b,k,_final.arrow.DOWN),this._replaceIcoClass(b,l,_final.folder.OPEN),0==d||""==a.expandSpeed?(j.show(),this._apply(e,[])):b[h]&&b[h].length>0?j.slideDown(a.expandSpeed,e):(j.show(),this._apply(e,[]))):(this._replaceSwitchClass(b,k,_final.arrow.RIGHT),this._replaceIcoClass(b,l,_final.folder.CLOSE),0!=d&&""!=a.expandSpeed&&b[h]&&b[h].length>0?j.slideUp(a.expandSpeed,e):(j.hide(),this._apply(e,[])))):this._apply(e,[])},_expandCollapseParentNode:function(a,b,c,d,e){if(b){if(!b.parentTId)return void this._expandCollapseNode(a,b,c,d,e);this._expandCollapseNode(a,b,c,d),b.parentTId&&this._expandCollapseParentNode(a,b.getParentNode(),c,d,e)}},_expandCollapseSonNode:function(a,b,c,d,e){var f=this._getRoot(a),g=a.keyChildren,h=b?b[g]:f[g],i=b?!1:d,j=this._getRoot(a).expandTriggerFlag;if(this._getRoot(a).expandTriggerFlag=!1,h)for(var k=0,l=h.length;l>k;k++)h[k]&&this._expandCollapseSonNode(a,h[k],c,i);this._getRoot(a).expandTriggerFlag=j,this._expandCollapseNode(a,b,c,d,e)},_makeDOMNodeIcon:function(a,b,c){var d=this._getNodeName(b,c),e=b.nameIsHTML?d:d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");b.formatter&&(e=this._apply(b.formatter,[b,c,e,b],b.formatter)),a.push("<span id='",c.tId,_final.id.ICON,"' title='' treeNode",_final.id.ICON," class='",this._makeNodeIcoClass(b,c),"' style='",this._makeNodeIcoStyle(b,c),"'></span><span id='",c.tId,_final.id.SPAN,"' class='coral-tree-node-name'>",e,"</span>")},_makeDOMNodeLine:function(a,b,c){a.push("<span id='",c.tId,_final.id.SWITCH,"' title='' class='",this._makeNodeLineClass(b,c),"' treeNode",_final.id.SWITCH,"></span>")},_makeDOMNodeMainAfter:function(a,b,c){a.push("</li>")},_makeDOMNodeMainBefore:function(a,b,c){a.push("<li ",c.hidden?"style='display:none;' ":"","id='",c.tId,"' class='",_final.className.LEVEL,c.level,"' tabindex='0' hidefocus='true' treenode>")},_makeDOMNodeNameAfter:function(a,b,c){a.push("</a>")},_makeDOMNodeNameBefore:function(a,b,c){var d=this._getNodeTitle(b,c),e=this._makeNodeUrl(b,c),f=this._makeNodeFontCss(b,c),g=[];for(var h in f)g.push(h,":",f[h],";");a.push("<a id='",c.tId,_final.id.A,"' class='",_final.className.LEVEL,c.level,c.nodeDisabled===!0?" coral-state-disabled":"","' treeNode",_final.id.A,' onclick="',c.click||"",'" ',1==c.nodeDisabled?"title='"+b.disabledMessage+"'":"",null!=e&&e.length>0?"href='"+e+"'":""," target='",this._makeNodeTarget(c),"' style='",g.join(""),"'"),this._apply(1==c.nodeDisabled||b.showTitle,[b.treeId,c,b],b.showTitle)&&d&&a.push("title='",d.replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"'"),a.push(">")},_addDiyDom:function(a,b,c){c.level>0&&a.push(this._getIndent(b,c))},_getIndent:function(a,b){var c=16;if(b.getParentNode()){var d="",e=["cui-icon"];return b.getParentNode().getNextNode()?(a.showLine?e.push(_final.line.LINE):e.push(_final.line.NOLINE),d="<span class='treeLine "+e.join("-")+"' style='width:"+c+"px;'></span>"):d="<span class='treeIndent' style='width:"+c+"px;'></span>",this._getIndent(a,b.getParentNode())+d}return""},_makeNodeFontCss:function(a,b){var c=this._apply(a.fontCss,[a.treeId,b,a],a.fontCss);return c&&"function"!=typeof c?c:{}},_makeNodeIcoClass:function(a,b){var c=b.isParent&&b.iconOpen&&b.iconClose?b.open?b.iconOpen:b.iconClose:b.icon,d=b.isParent?" coral-tree-icon-parent":" coral-tree-icon-leaf";if(c)return 1==a.iconUrl?_final.className.BUTTON:_final.className.BUTTON+" "+c;var e=["cui-icon"];return b.isAjaxing||(e[0]=(b.iconSkin?b.iconSkin+"-":"")+e[0],a.showIcon&&(b.isParent?e.push(b.open?_final.folder.OPEN:_final.folder.CLOSE):e.push(_final.folder.FILE))),_final.className.BUTTON+d+" "+e.join("-")},_makeNodeIcoStyle:function(a,b){var c=[];if(!b.isAjaxing){var d=b.isParent&&b.iconOpen&&b.iconClose?b.open?b.iconOpen:b.iconClose:b.icon;d&&(1==a.iconUrl?c.push("background:url(",d,") 0 0 no-repeat;"):this._makeNodeIcoClass(a,b)),0!=a.showIcon&&this._apply(a.showIcon,[a.treeId,b,a],!0)||c.push("width:0px;height:0px;display:none")}return c.join("")},_makeNodeLineClass:function(a,b){var c=[],d="cui-icon-";return 1==a.showLine?b.isParent?c.push(b.open?_final.arrow.DOWN:_final.arrow.RIGHT):b.isLastNode?(c.push(_final.line.BOTTOM),d="cui-icon-"):(c.push(_final.line.CENTER),d="cui-icon-"):b.isParent?c.push(b.open?_final.arrow.DOWN:_final.arrow.RIGHT):c.push(_final.folder.DOCU),this._makeNodeLineClassEx(b)+d+c.join("-")},_makeNodeLineClassEx:function(a){return _final.className.BUTTON+" "+_final.className.LEVEL+a.level+" "+_final.className.SWITCH+" "},_makeNodeTarget:function(a){return a.target||"_blank"},_makeNodeUrl1:function(a,b){var c=a.keyUrl;return b[c]?b[c]:null},_makeUlHtml:function(a,b,c,d){c.push("<ul id='",b.tId,_final.id.UL,"' class='",_final.className.LEVEL,b.level," ",this._makeUlLineClass(a,b),"' style='display:",b.open?"block":"none","'>"),c.push(d),c.push("</ul>")},_makeUlLineClass:function(a,b){return a.showLine&&!b.isLastNode?_final.line.LINE:""},_makeChkClass:function(a,b){var c,d=a.keyChecked,e=_final.checkbox,f=_final.radio,g="",h="";return a.chkStyle==f.STYLE?(g=b.check_Child_State<1?e.CHECKED:e.PARTIAL,c="cui-icon-"+a.chkStyle+"-"+(b[d]?e.CHECKED:e.UNCHECKED),c+=g==e.PARTIAL?e.PARTIAL:""):(g=b.halfCheck?e.PARTIAL:b[d]?2===b.check_Child_State||-1===b.check_Child_State?e.CHECKED:e.PARTIAL:b.check_Child_State<1?e.UNCHECKED:e.PARTIAL,c="cui-icon-"+a.chkStyle+"-"+(g==e.PARTIAL?(b[d]?e.CHECKED:e.UNCHECKED)+e.PARTIAL:g)),h=b.check_Focus&&b.chkDisabled!==!0?e.FOCUS:1==b.chkDisabled?e.DISABLED:e.DEFAULT,_final.className.BUTTON+" "+h+" "+c},_addLine:function(a,b,c){var d="undefined"==typeof c?1:0,e="",f=this._transformToArrayFormat(a,b);for(null!=c&&null!=b.level&&(e=("undefined"==typeof c?0:c)-("undefined"==typeof b.level?0:b.level)),d;d<f.length;d++)this._$(f[d],_final.id.A,a).find("span:lt("+(f[d].level+e)+")").remove(),this._$(f[d],_final.id.A,a).prepend(this._getIndent(a,f[d]))},_lineClass:function(a,b){var c=[];return c=a.isParent?a.open?_final.arrow.DOWN:_final.arrow.RIGHT:b?0==a.level&&a.isLastNode&&a.isFirstNode?_final.line.NOLINE:0==a.level&&a.isFirstNode&&!a.isLastNode?_final.line.ROOTS:a.isLastNode?_final.line.BOTTOM:_final.line.CENTER:_final.line.NOLINE},_moveNode:function(a,b,c,d,e,f){var g=this._getRoot(a),h=a.keyChildren;if(b!=c&&(!a.keepLeaf||!b||b.isParent||d!=_final.move.TYPE_INNER)){var i=c.parentTId?c.getParentNode():g,j=i.level;targetNodeIsRoot=null===b||b==g,targetNodeIsRoot&&null===b&&(b=g),targetNodeIsRoot&&(d=_final.move.TYPE_INNER);var k=b.parentTId?b.getParentNode():g;d!=_final.move.TYPE_PREV&&d!=_final.move.TYPE_NEXT&&(d=_final.move.TYPE_INNER),d==_final.move.TYPE_INNER&&(targetNodeIsRoot?c.parentTId=null:(b.isParent||(b.isParent=!0,b.open=!!b.open,this._setNodeLineIcos(a,b)),c.parentTId=b.tId));var l,m;if(targetNodeIsRoot)l=this.element,m=l;else{if(f||d!=_final.move.TYPE_INNER?f||this._expandCollapseNode(a,b.getParentNode(),!0,!1):this._expandCollapseNode(a,b,!0,!1),l=this._$(b,a),m=this._$(b,_final.id.UL,a),l.get(0)&&!m.get(0)){var n=[];this._makeUlHtml(a,b,n,""),l.append(n.join(""))}m=this._$(b,_final.id.UL,a)}var o=this._$(c,a);o.get(0)?l.get(0)||o.remove():o=this._appendNodes(a,c.level,[c],null,!1,!0).join(""),m.get(0)&&d==_final.move.TYPE_INNER?m.append(o):l.get(0)&&d==_final.move.TYPE_PREV?l.before(o):l.get(0)&&d==_final.move.TYPE_NEXT&&l.after(o);var p,q,r=[],s=-1,t=0,u=null,v=null,w=null,x=null,y=c.level;if(c.isFirstNode)s=0,i[h].length>1&&(u=i[h][1],u.isFirstNode=!0,w=u.level);else if(c.isLastNode)s=i[h].length-1,u=i[h][s-1],u.isLastNode=!0,w=u.level;else for(p=0,q=i[h].length;q>p;p++)if(i[h][p].tId==c.tId){s=p;break}if(s>=0&&i[h].splice(s,1),d!=_final.move.TYPE_INNER)for(p=0,q=k[h].length;q>p;p++)k[h][p].tId==b.tId&&(t=p);d==_final.move.TYPE_INNER?(b[h]||(b[h]=new Array),b[h].length>0&&(v=b[h][b[h].length-1],v.isLastNode=!1,x=v.level),b[h].splice(b[h].length,0,c),c.isLastNode=!0,c.isFirstNode=1==b[h].length):b.isFirstNode&&d==_final.move.TYPE_PREV?(k[h].splice(t,0,c),v=b,v.isFirstNode=!1,x=v.level,c.parentTId=b.parentTId,c.isFirstNode=!0,c.isLastNode=!1):b.isLastNode&&d==_final.move.TYPE_NEXT?(k[h].splice(t+1,0,c),v=b,v.isLastNode=!1,x=v.level,c.parentTId=b.parentTId,c.isFirstNode=!1,c.isLastNode=!0):(d==_final.move.TYPE_PREV?k[h].splice(t,0,c):k[h].splice(t+1,0,c),c.parentTId=b.parentTId,c.isFirstNode=!1,c.isLastNode=!1),this._fixPIdKeyValue(a,c),this._setSonNodeLevel(a,c.getParentNode(),c);var z=this._$(c,_final.id.SWITCH,a);if(this._setNodeLineIcos(a,c),this._repairNodeLevelClass(a,c,y),this._addLine(a,c,y),r=this._lineClass(c,a.showLine),this._replaceSwitchClass(c,z,r),!a.keepParent&&i[h].length<1){i.isParent=!1,i.open=!1;var A=this._$(i,_final.id.UL,a),B=this._$(i,_final.id.SWITCH,a),C=this._$(i,_final.id.ICON,a);r=this._lineClass(i,a.showLine),this._replaceSwitchClass(i,B,r),this._replaceIcoClass(i,C,_final.folder.FILE),A.css("display","none"),this._addLine(a,i,j)}else u&&(this._setNodeLineIcos(a,u),this._addLine(a,u,w));v&&(B=this._$(v,_final.id.SWITCH,a),this._setNodeLineIcos(a,v),this._addLine(a,v,x),r=this._lineClass(v,a.showLine),this._replaceSwitchClass(v,B,r)),a.check&&a.checkable&&this._repairChkClass&&(this._repairChkClass(a,i),this._repairParentChkClassWithSelf(a,i),i!=c.parent&&this._repairParentChkClassWithSelf(a,c)),f||this._expandCollapseParentNode(a,c.getParentNode(),!0,e)}},_removeChildNodes:function(a,b){if(b){var c=a.keyChildren,d=b[c];if(d){for(var e=0,f=d.length;f>e;e++)this._removeNodeCache(a,d[e]);if(this._removeSelectedNode(a),delete b[c],a.keepParent)this._$(b,_final.id.UL,a).empty();else{b.isParent=!1,b.open=!1;var g=this._$(b,_final.id.SWITCH,a),h=this._$(b,_final.id.ICON,a);this._replaceSwitchClass(b,g,_final.line.CENTER),this._replaceIcoClass(b,h,_final.line.CENTER),this._$(b,_final.id.UL,a).remove()}}}},_showNode:function(a,b,c){b.hidden=!1,this._initShowForExCheck(a,b),this._$(b,a).show(),"undefined"!=typeof c&&"undefined"!=typeof c.showParents&&c.showParents&&null!==b.getParentNode()&&this._showNode(a,b.getParentNode(),c)},_initShowForExCheck:function(a,b){if(!b.hidden&&a.checkable){if("undefined"!=typeof b._nocheck&&(b.nocheck=b._nocheck,delete b._nocheck),this._setChkClass){var c=this._$(b,_final.id.CHECK,a);this._setChkClass(a,c,b)}this._repairParentChkClassWithSelf&&this._repairParentChkClassWithSelf(a,b)}},_showNodes:function(a,b,c){if(b&&0!=b.length){var d,e,f={};for(d=0,e=b.length;e>d;d++){var g=b[d];if(!f[g.parentTId]){var h=g.getParentNode();f[g.parentTId]=null===h?this._getRoot(a):g.getParentNode()}this._showNode(a,g,c)}for(var i in f){var j=f[i][a.keyChildren];this._setFirstNodeForShow(a,j),this._setLastNodeForShow(a,j)}}},_setFirstNodeForShow:function(a,b){var c,d,e,f,g;for(d=0,e=b.length;e>d;d++){if(c=b[d],!f&&!c.hidden&&c.isFirstNode){f=c;break}if(f||c.hidden||c.isFirstNode){if(f&&c.isFirstNode){c.isFirstNode=!1,g=c,this._setNodeLineIcos(a,c);break}c=null}else c.isFirstNode=!0,f=c,this._setNodeLineIcos(a,c)}return{"new":f,old:g}},_setLastNodeForShow:function(a,b){var c,d,e,f;for(d=b.length-1;d>=0;d--){if(c=b[d],!e&&!c.hidden&&c.isLastNode){e=c;break}if(e||c.hidden||c.isLastNode){if(e&&c.isLastNode){c.isLastNode=!1,f=c,this._setNodeLineIcos(a,c);break}c=null}else c.isLastNode=!0,e=c,this._setNodeLineIcos(a,c)}return{"new":e,old:f}},_hideNode:function(a,b,c){b.hidden=!0,b.isFirstNode=!1,b.isLastNode=!1,this._initHideForExCheck(a,b),this._cancelPreSelectedNode(a,b),this._$(b,a).hide()},_initHideForExCheck:function(a,b){b.hidden&&a.checkable&&("undefined"==typeof b._nocheck&&(b._nocheck=!!b.nocheck,b.nocheck=!0),b.check_Child_State=-1,
this._repairParentChkClassWithSelf&&this._repairParentChkClassWithSelf(a,b))},_hideNodes:function(a,b,c){if(b&&0!=b.length){var d,e,f={};for(d=0,e=b.length;e>d;d++){var g=b[d];if((g.isFirstNode||g.isLastNode)&&!f[g.parentTId]){var h=g.getParentNode();f[g.parentTId]=null===h?this._getRoot(a):g.getParentNode()}this._hideNode(a,g,c)}for(var i in f){var j=f[i][a.keyChildren];this._setFirstNodeForHide(a,j),this._setLastNodeForHide(a,j)}}},_setFirstNodeForHide:function(a,b){var c,d,e;for(d=0,e=b.length;e>d&&(c=b[d],!c.isFirstNode);d++){if(!c.hidden&&!c.isFirstNode){c.isFirstNode=!0,this._setNodeLineIcos(a,c);break}c=null}return c},_setLastNodeForHide:function(a,b){var c,d;for(d=b.length-1;d>=0&&(c=b[d],!c.isLastNode);d--){if(!c.hidden&&!c.isLastNode){c.isLastNode=!0,this._setNodeLineIcos(a,c);break}c=null}return c},_setFirstNode:function(a,b){var c=a.keyChildren,d=b[c].length;d>0&&(b[c][0].isFirstNode=!0)},_setLastNode:function(a,b){var c=a.keyChildren,d=b[c].length;d>0&&(b[c][d-1].isLastNode=!0)},_removeNode2:function(a,b){var c=this._getRoot(a),d=[],e=a.keyChildren,f=(b.level,b.getPreNode(),b.getNextNode(),b.parentTId?b.getParentNode():c),g=f.level;if(b.isFirstNode=!1,b.isLastNode=!1,b.getPreNode=function(){return null},b.getNextNode=function(){return null},this._getNodeCache(a,b.tId)){this._$(b,a).remove(),this._removeNodeCache(a,b),this._removeSelectedNode(a,b);for(var h=0,i=f[e].length;i>h;h++)if(f[e][h].tId==b.tId){f[e].splice(h,1);break}this._setFirstNode(a,f),this._setLastNode(a,f);var j,k,l,m=f[e].length;if(a.keepParent||0!=m){if(a.showLine&&m>0){var n=f[e][m-1];if(j=this._$(n,_final.id.UL,a),k=this._$(n,_final.id.SWITCH,a),l=this._$(n,_final.id.ICON,a),f==c)if(1==f[e].length)this._replaceSwitchClass(n,k,_final.arrow.DOWN);else{var o=this._$(f[e][0],_final.id.SWITCH,a);this._replaceSwitchClass(f[e][0],o,f[e][0].isParent?1==f[e][0].open?_final.arrow.DOWN:_final.arrow.RIGHT:_final.line.ROOTS),n.isParent?this._replaceSwitchClass(n,k,1==b.open?_final.arrow.DOWN:_final.arrow.RIGHT):this._replaceSwitchClass(n,k,_final.line.BOTTOM)}else n.isParent?this._replaceSwitchClass(n,k,n.open?_final.arrow.DOWN:_final.arrow.RIGHT):this._replaceSwitchClass(n,k,_final.line.BOTTOM);this._addLine(a,f,g),j.removeClass(_final.line.LINE)}}else f.isParent=!1,f.open=!1,j=this._$(f,_final.id.UL,a),k=this._$(f,_final.id.SWITCH,a),l=this._$(f,_final.id.ICON,a),d=this._lineClass(f,a.showLine),this._replaceSwitchClass(f,k,d),this._replaceIcoClass(f,l,_final.folder.FILE),j.css("display","none")}},_replaceIcoClass:function(a,b,c){var d=a.isParent&&a.iconOpen&&a.iconClose?a.open?a.iconOpen:a.iconClose:a.icon;if(b&&!a.isAjaxing){var e=b.attr("class");if(void 0!=e){var f=e.split("-");switch(c){case _final.folder.OPEN:case _final.folder.CLOSE:case _final.folder.FILE:case _final.line.CENTER:case _final.line.BOTTOM:case _final.line.LINE:d?b.attr("class",f):(f[f.length-1]=c,b.attr("class",f.join("-")))}}}},_replaceSwitchClass:function(a,b,c){if(b){var d=b.attr("class");if(void 0!=d){var e=d.split("-");switch(c){case _final.arrow.DOWN:case _final.arrow.RIGHT:case _final.line.NOLINE:e[e.length-1]=c;break;case _final.folder.OPEN:case _final.folder.CLOSE:case _final.line.ROOTS:case _final.line.CENTER:case _final.line.BOTTOM:case _final.folder.DOCU:case _final.line.LINE:e[e.length-1]=c}b.attr("class",e.join("-")),c!==_final.folder.DOCU?b.removeAttr("disabled"):b.attr("disabled","disabled")}}},_repairAllChk:function(a,b){if(a.checkable&&a.chkStyle===_final.checkbox.STYLE)for(var c=a.keyChecked,d=a.keyChildren,e=this._getRoot(a),f=0,g=e[d].length;g>f;f++){var h=e[d][f];h.nocheck!==!0&&h.chkDisabled!==!0&&(h[c]=b),this._setSonNodeCheckBox(a,h,b)}},_repairChkClass:function(a,b){if(b&&(this._makeChkFlag(a,b),b.nocheck!==!0)){var c=this._$(b,_final.id.CHECK,a);this._setChkClass(a,c,b)}},_repairParentChkClass:function(a,b){if(b&&b.parentTId){var c=b.getParentNode();this._repairChkClass(a,c),this._repairParentChkClass(a,c)}},_repairParentChkClassWithSelf:function(a,b){if(b){var c=a.keyChildren;b[c]&&b[c].length>0?this._repairParentChkClass(a,b[c][0]):this._repairParentChkClass(a,b)}},_repairSonChkDisabled:function(a,b,c,d){if(b){var e=a.keyChildren;if(b.chkDisabled!=c&&(b.chkDisabled=c),this._repairChkClass(a,b),b[e]&&d)for(var f=0,g=b[e].length;g>f;f++){var h=b[e][f];this._repairSonChkDisabled(a,h,c,d)}}},_repairParentChkDisabled:function(a,b,c,d){b&&(b.chkDisabled!=c&&d&&(b.chkDisabled=c),this._repairChkClass(a,b),this._repairParentChkDisabled(a,b.getParentNode(),c,d))},_selectNode1:function(a,b,c){c||this._cancelPreSelectedNode(a),this._$(b,_final.id.A,a).addClass(_final.node.CURSELECTED),this._addSelectedNode(a,b)},_setNodeFontCss:function(a,b){var c=this._$(b,_final.id.A,a),d=this._makeNodeFontCss(a,b);d&&c.css(d)},_setNodeLineIcos:function(a,b){if(b){var c=this._$(b,_final.id.SWITCH,a),d=this._$(b,_final.id.UL,a),e=this._$(b,_final.id.ICON,a),f=this._makeUlLineClass(a,b);0==f.length?d.removeClass(_final.line.LINE):d.addClass(f),c.attr("class",this._makeNodeLineClass(a,b)),b.isParent?c.removeAttr("disabled"):c.attr("disabled","disabled"),e.removeAttr("style"),e.attr("style",this._makeNodeIcoStyle(a,b)),e.attr("class",this._makeNodeIcoClass(a,b))}},_setNodeName:function(a,b){var c=this._getNodeTitle(a,b),d=this._$(b,_final.id.SPAN,a);d.empty();var e="";if(e=a.formatter?this._apply(a.formatter,[a,b,a],a.formatter):this._getNodeName(a,b),a.nameIsHTML?d.html(e):d.text(e),this._apply(a.showTitle,[a.treeId,b,a],a.showTitle)){var f=this._$(b,_final.id.A,a);f.attr("title",c?c:"")}},_setNodeTarget:function(a,b){var c=this._$(b,_final.id.A,a);c.attr("target",this._makeNodeTarget(b))},_setNodeUrl:function(a,b){var c=this._$(b,_final.id.A,a),d=this._makeNodeUrl(a,b);null==d||0==d.length?c.removeAttr("href"):c.attr("href",d)},_switchNode:function(a,b){if(b.open||!this._canAsync(a,b))this._expandCollapseNode(a,b,!b.open);else if(a.asyncEnable){if(!this._asyncNode(a,b))return void this._expandCollapseNode(a,b,!b.open)}else b&&this._expandCollapseNode(a,b,!b.open)},_setChkClass:function(a,b,c){b&&(c.nocheck===!0?b.hide():b.show(),b.attr("class",this._makeChkClass(a,c)))},_setParentNodeCheckBox:function(a,b,c,d){var e=a.keyChildren,f=a.keyChecked,g=this._$(b,_final.id.CHECK,a);if(d||(d=b),this._makeChkFlag(a,b),b.nocheck!==!0&&b.chkDisabled!==!0&&(b[f]=c,this._setChkClass(a,g,b),a.autoCheckTrigger&&b!=d&&this.element.trigger(_final.event.CHECK,[null,a.treeId,b])),b.parentTId){var h=!0;if(!c)for(var i=b.getParentNode()[e],j=0,k=i.length;k>j;j++)if(i[j].nocheck!==!0&&i[j].chkDisabled!==!0&&i[j][f]||(i[j].nocheck===!0||i[j].chkDisabled===!0)&&i[j].check_Child_State>0){h=!1;break}h&&this._setParentNodeCheckBox(a,b.getParentNode(),c,d)}},_setSonNodeCheckBox:function(a,b,c,d){if(b){var e=a.keyChildren,f=a.keyChecked,g=this._$(b,_final.id.CHECK,a);d||(d=b);var h=!1;if(b[e])for(var i=0,j=b[e].length;j>i&&b.chkDisabled!==!0;i++){var k=b[e][i];this._setSonNodeCheckBox(a,k,c,d),k.chkDisabled===!0&&(h=!0)}b!=this._getRoot(a)&&b.chkDisabled!==!0&&(h&&b.nocheck!==!0&&this._makeChkFlag(a,b),b.nocheck!==!0&&b.chkDisabled!==!0?(b[f]=c,h||(b.check_Child_State=b[e]&&b[e].length>0?c?2:0:-1)):b.check_Child_State=-1,this._setChkClass(a,g,b),a.autoCheckTrigger&&b!=d&&b.nocheck!==!0&&b.chkDisabled!==!0&&this.element.trigger(_final.event.CHECK,[null,a.treeId,b]))}},_removeEditBtn:function(a,b){this._$(b,_final.id.EDIT,a).unbind().remove()},_removeRemoveBtn:function(a,b){this._$(b,_final.id.REMOVE,a).unbind().remove()},_removeTreeDom:function(a,b){b.isHover=!1,this._removeEditBtn(a,b),this._removeRemoveBtn(a,b),this._$(b,_final.id.A,a).removeClass(_final.node.CURHOVER),this._apply(a.removeHoverDom,[a.treeId,b,a])},_repairNodeLevelClass:function(a,b,c){if(c!==b.level){var d=this._$(b,a),e=this._$(b,_final.id.A,a),f=this._$(b,_final.id.UL,a),g=_final.className.LEVEL+c,h=_final.className.LEVEL+b.level;d.removeClass(g),d.addClass(h),e.removeClass(g),e.addClass(h),f.removeClass(g),f.addClass(h)}},_selectNodes:function(a,b){for(var c=0,d=b.length;d>c;c++)this._selectNode(a,b[c],c>0)},_createNodes:function(a,b,c,d){var e=this._createNodes1;e&&e.apply(this,arguments),c&&this._repairParentChkClassWithSelf&&this._repairParentChkClassWithSelf(a,d)},_removeNode1:function(a,b){var c=this._removeNode2,d=b.getParentNode();c&&c.apply(this,arguments),b&&d&&(this._repairChkClass(a,d),this._repairParentChkClass(a,d))},_appendNodes:function(a,b,c,d,e,f){var g=this._appendNodes1,h="";return g&&(h=g.apply(this,arguments)),d&&this._makeChkFlag(a,d),h},_cancelPreSelectedNode:function(a,b){_cancelPreSelectedNode=this._cancelPreSelectedNode1;for(var c=this._getRoot(a).curSelectedList,d=0,e=c.length;e>d&&(b&&b!==c[d]||(this._removeTreeDom(a,c[d]),!b));d++);_cancelPreSelectedNode&&_cancelPreSelectedNode.apply(this,arguments)},_makeNodeUrl:function(a,b){var c=this._makeNodeUrl1;return a.editable?null:c.apply(this,arguments)},_removeNode:function(a,b){var c=this._removeNode1,d=this._getRoot(a);d.curEditNode===b&&(d.curEditNode=null),c&&c.apply(this,arguments)},_selectNode:function(a,b,c){var d=this._selectNode1,e=this._getRoot(a);return this._isSelectedNode(a,b)&&e.curEditNode==b&&b.editNameFlag?!1:(d&&d.apply(this,arguments),this._addHoverDom(a,b),!0)},_uCanDo1:function(a,b){return!0},_uCanDo:function(a,b){var c=this._uCanDo1,d=this._getRoot(a);return b&&(this._eqs(b.type,"mouseover")||this._eqs(b.type,"mouseout")||this._eqs(b.type,"mousedown")||this._eqs(b.type,"mouseup"))?!0:(d.curEditNode&&(this._editNodeBlur=!1,d.curEditInput.focus()),!d.curEditNode&&(c?c.apply(this,arguments):!0))}});