/*! cui 2016-11-08 */
!function(){$.component("coral.selectable",$.coral.mouse,{version:"4.0.1",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var a,b=this;this.element.addClass("coral-selectable"),this.dragged=!1,this.refresh=function(){a=$(b.options.filter,b.element[0]),a.addClass("coral-selectee"),a.each(function(){var a=$(this),b=a.offset();$.data(this,"selectable-item",{element:this,$element:a,left:b.left,top:b.top,right:b.left+a.outerWidth(),bottom:b.top+a.outerHeight(),startselected:!1,selected:a.hasClass("coral-selected"),selecting:a.hasClass("coral-selecting"),unselecting:a.hasClass("coral-unselecting")})})},this.refresh(),this.selectees=a.addClass("coral-selectee"),this._mouseInit(),this.helper=$("<div class='coral-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("coral-selectee").removeData("selectable-item"),this.element.removeClass("coral-selectable coral-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(a){var b=this,c=this.options;this.opos=[a.pageX,a.pageY],this.options.disabled||(this.selectees=$(c.filter,this.element[0]),this._trigger("start",a),$(c.appendTo).append(this.helper),this.helper.css({left:a.pageX,top:a.pageY,width:0,height:0}),c.autoRefresh&&this.refresh(),this.selectees.filter(".coral-selected").each(function(){var c=$.data(this,"selectable-item");c.startselected=!0,a.metaKey||a.ctrlKey||(c.$element.removeClass("coral-selected"),c.selected=!1,c.$element.addClass("coral-unselecting"),c.unselecting=!0,b._trigger("unselecting",a,{unselecting:c.element}))}),$(a.target).parents().addBack().each(function(){var c,d=$.data(this,"selectable-item");return d?(c=!a.metaKey&&!a.ctrlKey||!d.$element.hasClass("coral-selected"),d.$element.removeClass(c?"coral-unselecting":"coral-selected").addClass(c?"coral-selecting":"coral-unselecting"),d.unselecting=!c,d.selecting=c,d.selected=c,c?b._trigger("selecting",a,{selecting:d.element}):b._trigger("unselecting",a,{unselecting:d.element}),!1):void 0}))},_mouseDrag:function(a){if(this.dragged=!0,!this.options.disabled){var b,c=this,d=this.options,e=this.opos[0],f=this.opos[1],g=a.pageX,h=a.pageY;return e>g&&(b=g,g=e,e=b),f>h&&(b=h,h=f,f=b),this.helper.css({left:e,top:f,width:g-e,height:h-f}),this.selectees.each(function(){var b=$.data(this,"selectable-item"),i=!1;b&&b.element!==c.element[0]&&("touch"===d.tolerance?i=!(b.left>g||b.right<e||b.top>h||b.bottom<f):"fit"===d.tolerance&&(i=b.left>e&&b.right<g&&b.top>f&&b.bottom<h),i?(b.selected&&(b.$element.removeClass("coral-selected"),b.selected=!1),b.unselecting&&(b.$element.removeClass("coral-unselecting"),b.unselecting=!1),b.selecting||(b.$element.addClass("coral-selecting"),b.selecting=!0,c._trigger("selecting",a,{selecting:b.element}))):(b.selecting&&((a.metaKey||a.ctrlKey)&&b.startselected?(b.$element.removeClass("coral-selecting"),b.selecting=!1,b.$element.addClass("coral-selected"),b.selected=!0):(b.$element.removeClass("coral-selecting"),b.selecting=!1,b.startselected&&(b.$element.addClass("coral-unselecting"),b.unselecting=!0),c._trigger("unselecting",a,{unselecting:b.element}))),b.selected&&(a.metaKey||a.ctrlKey||b.startselected||(b.$element.removeClass("coral-selected"),b.selected=!1,b.$element.addClass("coral-unselecting"),b.unselecting=!0,c._trigger("unselecting",a,{unselecting:b.element})))))}),!1}},_mouseStop:function(a){var b=this;return this.dragged=!1,$(".coral-unselecting",this.element[0]).each(function(){var c=$.data(this,"selectable-item");c.$element.removeClass("coral-unselecting"),c.unselecting=!1,c.startselected=!1,b._trigger("unselected",a,{unselected:c.element})}),$(".coral-selecting",this.element[0]).each(function(){var c=$.data(this,"selectable-item");c.$element.removeClass("coral-selecting").addClass("coral-selected"),c.selecting=!1,c.selected=!0,c.startselected=!0,b._trigger("selected",a,{selected:c.element})}),this._trigger("stop",a),this.helper.remove(),!1}})}();