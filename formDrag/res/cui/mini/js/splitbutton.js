/*! cui 2016-11-08 */
$.component("coral.splitbutton",$.coral.button,{version:"4.0.2",componentName:"splitbutton",castProperties:["menuOptions","dataCustom"],options:{id:null,name:null,label:null,cls:null,icons:{primary:null,secondary:null},width:null,text:!0,disabled:!1,menuOptions:{autoDisplay:!1,popup:!0},data:null,url:null,onCreate:null,onClick:null,onDblClick:null},component:function(){return this.uiBox},uiBorder:function(){return this.uiBorder},uiDropdownButton:function(){return this.dropdownButton},menu:function(){return this.uiMenu},_create:function(){this._initElements(),this._super()},_initElements:function(){var a=this,b=this.options,c=this.options.menuOptions,d=this.options.data,e=this.options.url;this.element.addClass("ctrl-init ctrl-init-splitbutton coral-splitbutton-element"),this.dropdownButton=$("<button class='coral-splitbutton-dropdownbutton' type='button'></button>").uniqueId(),this.uiBorder=$('<span class="coral-splitbutton-border"></span>'),this.uiBox=$('<span class="coral-splitbutton"></span>'),this.uiBox.append(this.uiBorder),this.uiMenu=$('<ul class="coral-splitbutton-menu"></ul>'),this.uiBox.insertAfter(this.element),this.uiBorder.append(this.element).append(this.dropdownButton),this.uiMenu.appendTo($(document.body)),b.width&&this.uiBox.css({width:b.width}),"undefined"!=typeof this.element.attr("id")?this.options.id=this.element.attr("id"):this.options.id?this.element.attr("id",this.options.id):this.options.id=this.element.uniqueId(),"undefined"!=typeof this.element.attr("name")?this.options.name=this.element.attr("name"):this.options.name&&this.element.attr("name",this.options.name),this.triggerId=this.dropdownButton.attr("id"),this._on(this.element,{buttononclick:function(b,c){a._trigger("onClick",b,c)}}),this.dropdownButton.button({label:"下拉按钮",text:!1,icons:"cui-icon-arrow-down3",onClick:function(b,c){if(a._getToolbar().length&&0!=a._getToolbar().toolbar("option","clickToDisplay")&&a._getToolbar().length&&a._getToolbar().toolbar("option","autoDisplay")){var d=a._getToolbar(!0);d.length&&d.toggleClass("coral-toolbar-click-active")}},onMouseEnter:function(b,c){if(a._getToolbar().length&&a._getToolbar().toolbar("option","autoDisplay")){var d=a._getToolbar(!0);d.hasClass("coral-toolbar-click-active")&&($(".coral-tieredmenu:visible").length&&a._hideMenus(),a.uiMenu.tieredmenu("show"))}}});var f={};null!=d&&(f.data=d),null!=e&&(f.url=e),c=$.extend({},f,b.menuOptions,{id:this.element.attr("id")+"_tieredmenu",trigger:this.dropdownButton,of:this.element}),this.uiMenu.tieredmenu(c),a._getToolbar().length&&a._getToolbar().toolbar("option","autoDisplay")&&this.uiMenu.tieredmenu("component").bind("mouseleave",function(){a._hideMenus()}),this._on(this.uiMenu,{tieredmenuonclick:function(b,c){a._trigger("onClick",b,c)}})},_getToolbar:function(a){var b=(this.options,$());return this.element.hasClass("ctrl-toolbar-element")&&(b=a?this.element.parents(".coral-toolbar:eq(0)"):this.element.parents(".ctrl-init-toolbar:eq(0)")),b},_hideMenus:function(){$(".coral-tieredmenu").hide()},hideAllMenus:function(){$(".coral-tieredmenu").hide()},showMenu:function(){this.uiMenu.tieredmenu("show")},_setOption:function(a,b){if("id"!==a&&"name"!==a){"disabled"===a&&(this.element.toggleClass("coral-state-disabled",b),this.dropdownButton.button("option","disabled",b)),this._super(a,b)}},_destroy:function(){this.uiBox.replaceWith(this.element),this.uiMenu.parent().remove(),this.element.removeClass("ctrl-init ctrl-init-splitbutton coral-splitbutton-element")}});