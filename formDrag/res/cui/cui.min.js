/*! cui 2016-11-08 */
(function( factory ) {
	if ( typeof define === 'function' && define.amd ) {
		define([ 'jquery' ], factory );
} else {
	factory( jQuery );
	}
}(function( $ ) {
/*! cui 2016-11-08 */
function shortCutOuter(a){var b={type:"keydown",propagate:!1,disable_in_input:!1,target:document,keycode:!1},c=a.shortKey,d=a.opts;d||(d=b);var e=d.target;"string"==typeof d.target&&(e=document.getElementById(d.target));var f=function(b){$.coral.callFunction(a)};all_shortcuts[c]={callback:f,target:e,event:d.type},e.addEventListener?e.addEventListener(d.type,f,!1):e.attachEvent?e.attachEvent("on"+d.type,f):e["on"+d.type]=f}function focusable(a,b){var c,d,e,f=a.nodeName.toLowerCase();return"area"===f?(c=a.parentNode,d=c.name,a.href&&d&&"map"===c.nodeName.toLowerCase()?(e=$("img[usemap='#"+d+"']")[0],!!e&&visible(e)):!1):(/input|select|textarea|button|object/.test(f)?!a.disabled:"a"===f?a.href||b:b)&&visible(a)}function visible(a){return $.expr.filters.visible(a)&&!$(a).parents().addBack().filter(function(){return"hidden"===$.css(this,"visibility")}).length}function _refreshAllComponent(a){"undefined"==typeof a&&(a="body");var b=a.tagName?a.tagName.toLowerCase():"";if(a=$(a)[0],"none"!=a.style.display&&"style"!=b&&"script"!=b){var c=a.childNodes,d=$(a).attr("component-id"),e=$("#"+d),f=e.attr("component-role");if(d){if("undefined"==typeof f)return;if(-1!==$.inArray(f,$.coral.formPlugins))return;"panel"==f?e[f]("resizePanel"):e[f]("refresh")}else for(var g=0,h=c.length;h>g;g++){var i=c[g];1==i.nodeType&&i.parentNode==a&&_refreshAllComponent(i)}}}function _refreshChild(a){for(var a=$(a)[0],b=a.childNodes,c=0,d=b.length;d>c;c++){var e=b[c];1==e.nodeType&&e.parentNode==a&&_refreshAllComponent(e)}}void 0!==document.documentMode&&document.documentMode<=5&&alert("CoralUI can not be used in this ('quirks') mode!");var CoralUIVersion="4.1.5";window.Coral={cc:function(a,b){$.parser.component.push({componentName:a,id:b})}},window.coral={},$.uiplugins=$.uiplugins||{},coral.eventsQueue=[],coral.eventsParser=function(){$.each(coral.eventsQueue,function(a){var b=coral.eventsQueue.shift();b.instance._on.apply(b.instance,b.args)}),coral.eventsTimer=null},coral.render=function(a){$(a).attr("data-render",""),$.parser.parse(a)};var validAction=!1;$.controller=function(a,b){return b?(window[a]=window[a]||{},$.extend(!0,window[a],b)):window[a]},$.coralApply=function(a,b,c){var d=$(b).attr("component-role"),e={};return d&&(e=$(b)[d]("option")),e.controllerName&&(b=$.controller(e.controllerName)),$.isFunction(a)?a.apply(b,c):void 0},$.coral=$.coral||{},$.coral.openTag=!0,$.coral.strictLayout=!1,coral.regSpecialChars=["^","$","(",")","[","]","{","}",".","?","+","*","|","\\"],coral.specialCharsMap={"&":"&amp;","#":"&#35",">":"&gt;","<":"&lt;","‘":"&lsquo","’":"&rsquo",",":"&sbquo","'":"&#39","\\":"&#92;",'"':"&ldquo;","!":"&#33","%":"&#37","~":"&#126","@":"&#64","=":"&#61","(":"&#40",")":"&#41","{":"&#123","}":"&#125","[":"&#91;","]":"&#93;",$:"&#36","?":"&#63","*":"&#42;","|":"&#124;","^":"&#94;",".":"&#46;","+":"&#43;","/":"&#47;"," ":"&nbsp;"},$(document).unbind(".clearTips").bind("click.clearTips",function(a){return validAction?(validAction=!1,void a.stopPropagation()):($(".coral-validate-state-error").slideUp(100,function(a){$(this).remove()}),void(validAction=!1))}),$(document).unbind("mousewheel").bind("mousewheel",function(a){var b=$.validate.validateSuffix();setTimeout(function(){$.each($(".coral-validate-state-error"),function(a,c){var d=$(c).attr("class"),e=d.substring(0,d.indexOf(b)),f=$("#"+e).find(".ctrl-init"),g=f.parents(".coral-validate");$(c).remove(),g.validate("validItem",f,null,!0)})},0)}),$.coral.decode=function(a){return a},$.coral.encode=function(a){return a},$.coral.getStyles=function(a){if(window.getComputedStyle){var b=window.getComputedStyle(a,null);return b}if(document.documentElement.currentStyle){var b=a.currentStyle;return b}},$.coral.fitParent=function(a,b){b=void 0==b?!0:b;var c=a.parent();return b?c.hasClass("coral-noscroll")||(c.addClass("coral-noscroll"),"BODY"==c.attr("tagName")&&$("html").addClass("coral-panel-fit")):c.hasClass("coral-noscroll")&&(c.removeClass("coral-noscroll"),"BODY"==c.attr("tagName")&&$("html").removeClass("coral-panel-fit")),{width:c.width(),height:c.height()}},$.coral.getLeft=function(a,b){var c=b.offset().left;return c+a.outerWidth()>$(window).outerWidth()+$(document).scrollLeft()&&(c=$(window).outerWidth()+$(document).scrollLeft()-a.outerWidth()),0>c&&(c=0),c},$.coral.getTop=function(a,b,c){var d=b.offset().top+b.outerHeight();return"up"==c?d=b.offset().top-a.outerHeight():(d+a.outerHeight()>$(window).outerHeight()+$(document).scrollTop()&&(d=b.offset().top-a.outerHeight()),d<$(document).scrollTop()&&(d=b.offset().top+b.outerHeight())),d},$.coral.findComponent=function(a,b){var c=[];a||(a=".ctrl-init");var d=$(a,b),e=/[\t\r\n]/g;return d.length&&$.each(d,function(){for(var a="",b=this.className.replace(e," ").split(" "),d=0,f=b.length;f>d;d++){a=$(this).attr("component-role"),c.push($(this)[a]("instance"));break}}),c},$.coral.setIsLabel=function(a,b){var c=$.coral.findComponent(".ctrl-form-element",b),d=0,e=c.length;for(d;e>d;d++){var f=c[d];f._setOption("isLabel",a),f.element.hasClass("hasTooltip")&&(0==a?f.element.tooltip("enable"):f.element.tooltip("disable"))}},$.coral.setIslabel=$.coral.setIsLabel,$.coral.setReadOnly=function(a,b){var c=$.coral.findComponent(".ctrl-form-element",b),d=0,e=c.length;for(d;e>d;d++){var f=c[d];f._setOption("readonly",a),f.element.hasClass("hasTooltip")&&(0==a?f.element.tooltip("enable"):f.element.tooltip("disable"))}},$.coral.renderComponent=function(a){var b=[],c=".coral-no-rendered";a||(a="body");var d=$(c,a),e=/[\t\r\n]/g;return d.length&&$.each(d,function(){for(var a="",b=this.className.replace(e," ").split(" "),c=0,d=b.length;d>c;c++){if(a=$(this).attr("component-role"),rendered=$(this).prop("rendered"),!rendered){$(this).removeClass("coral-no-rendered");var f=$(this)[a]("instance");$(this).addClass("ctrl-init ctrl-init-"+this.componentName),f._create(),f._renderComponent()}break}}),b},$.coral.parseShortCut=function(a){$.coral.addShortCut(a.shortKey,a.callback,a.opts)},$.coral.formatOption=function(a){delete a.xtype;var b=JSON.stringify(a),b=b.replace("{",""),b=b.substring(0,b.length-1);return b},$.coral.customComponent=function(a){var b,c=a.xtype,d=[],e=a.items;switch(c){case"layout":if(e=a.regions,b=$.coral.formatOption(a),d.push("<div class='coralui-"+c+"' data-options='"+b+"'>"),e){for(var f=0;f<e.length;f++){var g=e[f];if(itemStr=$.coral.formatOption(e[f]),d.push("<div data-options='"+itemStr+"'>"),g.items)for(var h=e[f].items,i=0;i<h.length;i++){var j=$.coral.customComponent(h[i]);d.push(j)}d.push("</div>")}d.push("</div>")}break;case"row":if(e=a.columns,d.push('<div class="row-fluid clearfix">'),e.length)for(var f=0;f<e.length;f++){var g=e[f];if(d.push('<div class="span'+g.percent+' column ctrl-init ctrl-init-sortable coral-sortable">'),0!=g.items.length)for(var h=e[f].items,i=0;i<h.length;i++){var j=$.coral.customComponent(h[i]);d.push(j)}d.push("</div>")}d.push("</div>");break;case"accordion":if(b=$.coral.formatOption(a),d.push("<div class='coralui-"+c+"' data-options='"+b+"'>"),e)for(var i=0;i<e.length;i++){var j=$.coral.customComponent(e[i]);d.push(j)}d.push("</div>");break;case"container":if(b=$.coral.formatOption(a),d.push("<div class='demo ui-sortable ctrl-init ctrl-init-sortable coral-sortable'>"),e)for(var i=0;i<e.length;i++){var j=$.coral.customComponent(e[i]);d.push(j)}d.push("</div>");break;case"tree":b=$.coral.formatOption(a),d.push("<ul class='coralui-"+c+"' data-options='"+b+"'/>");break;case"grid":b=$.coral.formatOption(a),d.push("<div class='coralui-"+c+"' data-options='"+b+"'/>");break;case"form":if(b=$.coral.formatOption(a),d.push("<form class='coralui-form' data-options='"+b+"'>"),e){d.push('<div class="ui-draggable"><div class="column">');for(var f=0;f<e.length;f++){var g=e[f],j=$.coral.customComponent(e[f]);d.push(j)}d.push("</div></div>")}else d.push('<div class="ui-draggable"><div class="column"></div></div>');d.push("</form>");break;case"textbox":case"combobox":case"combogrid":case"combotree":case"radio":b=$.coral.formatOption(a),d.push("<input class='coralui-"+c+"' data-options='"+b+"'/>");break;case"textarea":b=$.coral.formatOption(a),d.push("<textarea class='coralui-textbox' data-options='"+b+"'/>");break;case"button":b=$.coral.formatOption(a),d.push("<button class='coralui-"+c+"' data-options='"+b+"'/>");break;case"toolbar":case"progressbar":b=$.coral.formatOption(a),d.push("<div class='coralui-"+c+"' data-options='"+b+"'/>");break;case"view":var k=a.items;if(delete a.items,b=$.coral.formatOption(a),a.items=k,d.push("<div class='coralui-"+c+"' data-options='"+b+"'>"),e.length)for(var i=0;i<e.length;i++){var j=$.coral.customComponent(e[i]);d.push(j)}d.push("</div>")}return d.join("")},$.coral.customRender=function(a){var b="";b=$.coral.customComponent(a);var c=$(a.renderTo||"body").html(b);$.parser.parse(c)},$.coral.callFunction=function(a,b,c){function d(a,b,c,d,e){if(a=a.toLowerCase(),d=d||window.event,c.disable_in_input){var f;if(d.target?f=d.target:d.srcElement&&(f=d.srcElement),3==f.nodeType&&(f=f.parentNode),"INPUT"==f.tagName||"TEXTAREA"==f.tagName)return}d.keyCode?code=d.keyCode:d.which&&(code=d.which);var g=String.fromCharCode(code).toLowerCase();188==code&&(g=","),190==code&&(g=".");var h=a.split("+"),i=0,j={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"},l={esc:27,escape:27,tab:9,space:32,"return":13,enter:13,backspace:8,scrolllock:145,scroll_lock:145,scroll:145,capslock:20,caps_lock:20,caps:20,numlock:144,num_lock:144,num:144,pause:19,"break":19,insert:45,home:36,"delete":46,end:35,pageup:33,page_up:33,pu:33,pagedown:34,page_down:34,pd:34,left:37,up:38,right:39,down:40,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},m={shift:{wanted:!1,pressed:!1},ctrl:{wanted:!1,pressed:!1},alt:{wanted:!1,pressed:!1},meta:{wanted:!1,pressed:!1}};d.ctrlKey&&(m.ctrl.pressed=!0),d.shiftKey&&(m.shift.pressed=!0),d.altKey&&(m.alt.pressed=!0),d.metaKey&&(m.meta.pressed=!0);for(var n=0;k=h[n],n<h.length;n++)"ctrl"==k||"control"==k?(i++,m.ctrl.wanted=!0):"shift"==k?(i++,m.shift.wanted=!0):"alt"==k?(i++,m.alt.wanted=!0):"meta"==k?(i++,m.meta.wanted=!0):k.length>1?l[k]==code&&i++:c.keycode?c.keycode==code&&i++:g==k?i++:j[g]&&d.shiftKey&&(g=j[g],g==k&&i++);return i!=h.length||m.ctrl.pressed!=m.ctrl.wanted||m.shift.pressed!=m.shift.wanted||m.alt.pressed!=m.alt.wanted||m.meta.pressed!=m.meta.wanted||(b.apply(e?e.element:d,[d]),c.propagate)?void 0:(d.cancelBubble=!0,d.returnValue=!1,d.stopPropagation&&(d.stopPropagation(),d.preventDefault()),!1)}var e,f,g,h={type:"keydown",propagate:!1,disable_in_input:!1,target:document,keycode:!1};if(a instanceof Array)for(var i=0;i<a.length;i++)e=a[i].shortKey,f=a[i].callback,g=a[i].opts,g||(g=h),d(e,f,g,b,c);else e=a.shortKey,f=a.callback,g=a.opts,g||(g=h),d(e,f,g,b,c)};var all_shortcuts={};$.coral.addShortCut=function(a){var b;if(a instanceof Object)for(b=0;b<a.length;b++)shortCutOuter(a[b])},$.coral.removeShortCut=function(a,b){a=a.toLowerCase();var c=all_shortcuts[a];if(delete all_shortcuts[a],c){var d=c.event,e=c.callback;if(b)var f=$(b);else var f=c.target;f.detachEvent?f.detachEvent("on"+d,e):f.removeEventListener?f.removeEventListener(d,e,!1):f["on"+d]=!1}},$.coral.valid={},$.coral.valid=function(a){function b(a,b){if(!b)return!1;for(var c=b.length,d=0;c>d;d++)if("string"==typeof b[d]&&a.is(b[d]))return!0;return!1}function c(a,b,c){return"datepicker"==b?a[b]("valid",a,c):$.inArray(b,["textbox","combobox","combotree","radio","radiolist","checkbox","checkboxlist"])>-1?a[b]("valid",c):void 0}validAction=!0;var d=0,e=$.data(a,"excluded"),f=a.find($("[class*='coral-validation-']")),g=null,h=!0;return e&&"string"==typeof e&&(e=$.map(e.split(","),function(a){return $.trim(a)})),"form"===a[0].tagName.toLowerCase()&&(g=a.form("option","errTipsType")),f.each(function(){var a=this.className,f="",i=a.split(" ");for(var j in i)if(i[j].indexOf("coral-validation-")>=0){f=i[j].substr(i[j].indexOf("coral-validation-")+17);break}b($(this)[f]("component"),e)||("none"===g&&(h=!1),c($(this),f,h)||("first"===g&&(h=!1),++d))}),!(d>0)},jQuery.support.placeholder=function(){var a=document.createElement("input");return"placeholder"in a}();var uuid=0,runiqueId=/^coral-id-\d+$/;$.extend($.coral,{version:"4.0.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},zindex:1e3}),$.fn.extend({scrollParent:function(a){var b=this.css("position"),c="absolute"===b,d=a?/(auto|scroll|hidden)/:/(auto|scroll)/,e=this.parents().filter(function(){var a=$(this);return c&&"static"===a.css("position")?!1:d.test(a.css("overflow")+a.css("overflow-y")+a.css("overflow-x"))}).eq(0);return"fixed"!==b&&e.length?e:$(this[0].ownerDocument||document)},uniqueId:function(a){return this.each(function(){this.id||(a?a+="-":a="",this.id=a+"coral-id-"+ ++uuid)})},removeUniqueId:function(){return this.each(function(){runiqueId.test(this.id)&&$(this).removeAttr("id")})},closestComponent:function(a){return this.each(function(){$(this).closest(".ctrl-init-"+a)})}}),$.extend($.expr[":"],{data:$.expr.createPseudo?$.expr.createPseudo(function(a){return function(b){return!!$.data(b,a)}}):function(a,b,c){return!!$.data(a,c[3])},focusable:function(a){return focusable(a,!isNaN($.attr(a,"tabindex")))},tabbable:function(a){var b=$.attr(a,"tabindex"),c=isNaN(b);return(c||b>=0)&&focusable(a,!c)}}),$("<a>").outerWidth(1).jquery||$.each(["Width","Height"],function(a,b){function c(a,b,c,e){return $.each(d,function(){b-=parseFloat($.css(a,"padding"+this))||0,c&&(b-=parseFloat($.css(a,"border"+this+"Width"))||0),e&&(b-=parseFloat($.css(a,"margin"+this))||0)}),b}var d="Width"===b?["Left","Right"]:["Top","Bottom"],e=b.toLowerCase(),f={innerWidth:$.fn.innerWidth,innerHeight:$.fn.innerHeight,outerWidth:$.fn.outerWidth,outerHeight:$.fn.outerHeight};$.fn["inner"+b]=function(a){return void 0===a?f["inner"+b].call(this):this.each(function(){$(this).css(e,c(this,a)+"px")})},$.fn["outer"+b]=function(a,d){return"number"!=typeof a?f["outer"+b].call(this,a):this.each(function(){$(this).css(e,c(this,a,!0,d)+"px")})}}),$.fn.addBack||($.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),$("<a>").data("a-b","a").removeData("a-b").data("a-b")&&($.fn.removeData=function(a){return function(b){return arguments.length?a.call(this,$.camelCase(b)):a.call(this)}}($.fn.removeData)),$.coral.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),$.fn.extend({focus:function(a){return function(b,c){return"number"==typeof b?this.each(function(){var a=this;setTimeout(function(){$(a).focus(),c&&c.call(a)},b)}):a.apply(this,arguments)}}($.fn.focus),disableSelection:function(){var a="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(a+".coral-disableSelection",function(a){a.preventDefault()})}}(),enableSelection:function(){return this.unbind(".coral-disableSelection")},zIndex:function(a){if(void 0!==a)return this.css("zIndex",a);if(this.length)for(var b,c,d=$(this[0]);d.length&&d[0]!==document;){if(b=d.css("position"),("absolute"===b||"relative"===b||"fixed"===b)&&(c=parseInt(d.css("zIndex"),10),!isNaN(c)&&0!==c))return c;d=d.parent()}return 0}}),$.extend($.coral,{plugin:{add:function(a,b,c){var d,e=$.coral[a].prototype;for(d in c)e.plugins[d]=e.plugins[d]||[],e.plugins[d].push([b,c[d]])},call:function(a,b,c,d){var e,f=a.plugins[b];if(f&&(d||a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType))for(e=0;e<f.length;e++)a.options[f[e][0]]&&f[e][1].apply(a.element,c)}},toFunction:function(fn){var ns=null,i=0,_fn=null;if($.isFunction(fn))return fn;if("string"==typeof fn){if($.isFunction(window[fn]))return window[fn];try{if(_fn=eval("("+fn+")"),$.isFunction(_fn))return _fn}catch(e){}if(fn.indexOf(".")>0){if(ns=fn.split("."),_fn=window[ns[0]],!_fn)return null;for(i=1;i<ns.length;i++)if(_fn=_fn[ns[i]],!_fn)return null}return _fn}return fn}}),$.extend({loadJson:function(a,b){var c=null;return $.ajax({url:a,type:"get",dataType:"json",async:!1,data:b,success:function(a){c=a},error:function(a,b,c){$.error("function load json error: "+b)}}),c},isCoral:function(a,b){return arguments.length<2||!a?!1:(a.jquery&&(a=a.get(0)),!!$.data(a,"coral-"+b))}}),$.extend($.coral,{beforeDoOverflow:function(){},scriptPath:function(){var a=document.getElementsByTagName("script"),b=a[a.length-1],c=b.src.substring(0,b.src.lastIndexOf("/")+1);return c}(),contextPathFun:function(){var a=window.document.location.href,b=window.document.location.pathname,c=a.indexOf(b),d=(a.substring(0,c),b.substring(0,b.substr(1).indexOf("/")+1));return d},adjustedUI:function(a){var b,c=$(a),d=c.parent();b=d.height(),c.siblings(":visible").each(function(){var a=$(this),c=a.css("position");"absolute"!==c&&"fixed"!==c&&(b-=a.outerHeight(!0))}),c.height(Math.max(0,b-c.innerHeight()+c.height())).addClass("coral-scroll");var e=c.uniqueId("coral-adjuested").attr("id");c.attr("component-id",e),c.attr("component-role","adjusted"),$.coral.refreshAllComponent(a)},isFit:function(a,b){var c=$(a).parent().closest(".ctrl-fit-element");c.length||(c=$("body"));var d=c.length&&(c[0]===$(b)[0]||c.find(b).length);return d},formPlugins:["button","menubutton","textbox","autocomplete","autocompletetree","uploader","splitbutton","radio","radiolist","checkbox","checkboxlist","spinner","slider","combo","fileuploader","combobox","combotree","combogrid","datepicker","tree","progressbar"],getUI:function(a){return $.uiplugins[a]?$.uiplugins[a]:-1},refreshChild:function(a){_refreshChild(a)},refreshAllComponent:function(a){_refreshAllComponent(a)}}),$.coral.contextPath=$.coral.contextPathFun.apply(),$.fn.caret=function(a){var b=this[0],c="true"===b.contentEditable;if(0==arguments.length){if(window.getSelection){if(c){b.focus();var d=window.getSelection().getRangeAt(0),e=d.cloneRange();return e.selectNodeContents(b),e.setEnd(d.endContainer,d.endOffset),e.toString().length}return b.selectionStart}if(document.selection){if(b.focus(),c){var d=document.selection.createRange(),e=document.body.createTextRange();return e.moveToElementText(b),e.setEndPoint("EndToEnd",d),e.text.length}var a=0,f=b.createTextRange(),e=document.selection.createRange().duplicate(),g=e.getBookmark();for(f.moveToBookmark(g);0!==f.moveStart("character",-1);)a++;return a}return b.selectionStart?b.selectionStart:0}if(-1==a&&(a=this[c?"text":"val"]().length),window.getSelection)c?(b.focus(),window.getSelection().collapse(b.firstChild,a)):b.setSelectionRange(a,a);else if(document.body.createTextRange)if(c){var f=document.body.createTextRange();f.moveToElementText(b),f.moveStart("character",a),f.collapse(!0),f.select()}else{var f=b.createTextRange();f.move("character",a),f.select()}return c||b.focus(),a};/*! cui 2016-11-08 */
!function(){var a=0,b=Array.prototype.slice;$.cleanData=function(a){return function(b){var c,d,e;for(e=0;null!=(d=b[e]);e++)try{c=$._data(d,"events"),c&&c.remove&&$(d).triggerHandler("remove")}catch(f){}a(b)}}($.cleanData),$.component=function(a,b,c){var d,e,f,g,h={},i=a.split(".")[0];return a=a.split(".")[1],d=i+"-"+a,c||(c=b,b=$.Component),$.expr[":"][d.toLowerCase()]=function(a){return!!$.data(a,d)},$[i]=$[i]||{},e=$[i][a],f=$[i][a]=function(b,c){return this._createComponent?void(arguments.length&&(b=b&&b.noUseParse?$.component.extend({},$.fn[a].defaults||{},b):$.component.extend({},$.fn[a].defaults||{},this._parseOptions(c),b),this._createComponent(b,c))):new f(b,c)},$.uiplugins=$.uiplugins||{},a&&!$.uiplugins.name&&("adjusted"==a&&($.uiplugins.fill=f,$.uiplugins["coral-adjusted"]=f),$.uiplugins["coralui-"+a]=f),$.extend(f,e,{version:c.version,_proto:$.extend({},c),_childConstructors:[]}),g=new b,g.options=$.component.extend({},g.options),$.each(c,function(a,c){return $.isFunction(c)?void(h[a]=function(){var d=function(){return b.prototype[a].apply(this,arguments)},e=function(c){return b.prototype[a].apply(this,c)};return function(){var a,b=this._super,f=this._superApply;return this._super=d,this._superApply=e,a=c.apply(this,arguments),this._super=b,this._superApply=f,a}}()):void(h[a]=c)}),f.prototype=$.component.extend(g,{componentEventPrefix:e?g.componentEventPrefix||a:a},h,{constructor:f,namespace:i,componentName:a,componentFullName:d}),e?($.each(e._childConstructors,function(a,b){var c=b.prototype;$.component(c.namespace+"."+c.componentName,f,b._proto)}),delete e._childConstructors):b._childConstructors.push(f),$.component.bridge(a,f),f},$.component.extend=function(a){for(var c,d,e=b.call(arguments,1),f=0,g=e.length;g>f;f++)for(c in e[f])d=e[f][c],e[f].hasOwnProperty(c)&&void 0!==d&&($.isPlainObject(d)?a[c]=$.isPlainObject(a[c])?$.component.extend({},a[c],d):$.component.extend({},d):a[c]=d);return a},$.component.bridge=function(a,c){var d=c.prototype.componentFullName||a;$.fn[a]=function(e){var f="string"==typeof e,g=b.call(arguments,1),h=this;return"tree"==a&&arguments[1]&&(e.data=arguments[1]),e=!f&&g.length?$.component.extend.apply(null,[e].concat(g)):e,f?this.each(function(){var b,c=$.data(this,d);return c?"instance"===e?(h=c,!1):$.isFunction(c[e])&&"_"!==e.charAt(0)?(b=c[e].apply(c,g),b!==c&&void 0!==b?(h=b&&b.jquery?h.pushStack(b.get()):b,!1):void 0):$.error("no such method '"+e+"' for "+a+" component instance"):$.error("cannot call methods on "+a+" prior to initialization; attempted to call method '"+e+"'")}):this.each(function(){var a=$.data(this,d);a?(a.option(e||{}),a._init&&a._init()):$.data(this,d,new c(e,this))}),h}},$.Component=function(){},$.Component._childConstructors=[],$.Component.prototype={componentName:"component",componentEventPrefix:"",defaultElement:"<div>",castProperties:null,options:{disabled:!1,authorized:!0,rendered:!0,onCreate:null},formFieldArray:["autocomplete","autocompletetree","combobox","combotree","combogrid","checkbox","checkboxlist","datepicker","radio","radiolist","spinner","textbox","fileuploader"],panelArray:["accordion","dialog","form","grid","layout","panel","tabs","toolbar","splitcontainer","view","adjusted"],refresh:function(){},_createComponent:function(b,c){var d=this;return c=$(c||this.defaultElement||this)[0],this.element=$(c),this.uuid=a++,this.eventNamespace="."+this.componentName+this.uuid,this.element.attr("component-role")||this.element.attr("component-role",this.componentName),this.options=$.component.extend({},this.options,this._getCreateOptions(),b),this.options.authorized&&"false"!==this.options.authorized||this.element.remove(),this.bindings=$(),this.hoverable=$(),this.focusable=$(),c!==this&&($.data(c,this.componentFullName,this),this._on(!0,this.element,{remove:function(a){a.target===d.element[0]&&this.destroy()}}),this.document=$(c.style?c.ownerDocument:c.document||c),this.window=$(this.document[0].defaultView||this.document[0].parentWindow)),this.element.prop("rendered",!!this.options.rendered),this.options.rendered?(this.element.addClass("ctrl-init ctrl-init-"+this.componentName),this._create(),this._renderComponent(),void 0):void this.element.addClass("coral-no-rendered")},_renderComponent:function(){this.options.componentCls&&this.component().addClass(this.options.componentCls),this.options.cls&&this.element.addClass(this.options.cls),this.addField&&this.addField(),$.inArray(this.componentName,this.panelArray)>-1?("undefined"!=typeof this.element.attr("id")?this.options.id=this.element.attr("id"):this.options.id?this.element.attr("id",this.options.id):this.options.id=this.element.uniqueId(this.componentName).attr("id"),this.component().addClass("ctrl-fit-element"),this.component().attr("component-id",this.options.id)):"undefined"!=typeof this.element.attr("id")?this.options.id=this.element.attr("id"):this.options.id&&this.element.attr("id",this.options.id),this._trigger("onCreate",null,this._getCreateEventData()),this._init()},properties:["controllerName"],_parseOptions:function(a){$(a);return $.extend({},$.parser.parseOptions(a,this.properties,this.castProperties))},_getCreateOptions:$.noop,_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,valid:function(){var a={hasTips:!1,element:this.element};return!($.validate.validateField(null,a).length>0)},isValid:function(){},destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.componentName).removeData(this.componentFullName).removeData($.camelCase(this.componentFullName)),this.element.removeClass("ctrl-form-element ctrl-init ctrl-init-"+this.componentName),this.component().unbind(this.eventNamespace).removeAttr("aria-disabled").removeAttr("component-role").removeClass(this.componentFullName+"-disabled coral-state-disabled"),this.element.removeAttr("component-role"),this.element.removeAttr("data-options"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("coral-state-hover"),this.focusable.removeClass("coral-state-focus")},_destroy:$.noop,component:function(){return this.element},option:function(a,b){var c,d,e,f=a;if(0===arguments.length)return $.component.extend({},this.options);if("string"==typeof a)if(f={},c=a.split("."),a=c.shift(),c.length){for(d=f[a]=$.component.extend({},this.options[a]),e=0;e<c.length-1;e++)d[c[e]]=d[c[e]]||{},d=d[c[e]];if(a=c.pop(),1===arguments.length)return void 0===d[a]?null:d[a];d[a]=b}else{if(1===arguments.length)return void 0===this.options[a]?null:this.options[a];f[a]=b}return this._setOptions(f),this},_setOptions:function(a){var b;for(b in a)this._setOption(b,a[b]),this.element.trigger("onOptionChange",{key:b,value:a[b]});return this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&(this.component().toggleClass(this.componentFullName+"-disabled coral-state-disabled",!!b).attr("aria-disabled",b),b&&(this.hoverable.removeClass("coral-state-hover"),this.focusable.removeClass("coral-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},show:function(){this.component().removeClass("coral-state-hidden").show()},hide:function(){this.component().addClass("coral-state-hidden").hide()},_pinyinEngine:function(){return new pinyinEngine},_pinyinSetCache:function(a,b,c){for(var d in c)a.setCache([c[d][b]],c[d]);return a},_pinyinSearch:function(a,b,c){var d=[];a.search(b,function(a){d.push(a)}),c(d)},_on:function(a,b,c){var d,e=this;"boolean"!=typeof a&&(c=b,b=a,a=!1),c?(b=d=$(b),this.bindings=this.bindings.add(b)):(c=b,b=this.element,d=this.component()),$.each(c,function(c,f){function g(){return a||e.options.disabled!==!0&&!$(this).hasClass("coral-state-disabled")?("string"==typeof f?e[f]:f).apply(e,arguments):void 0}"string"!=typeof f&&(g.guid=f.guid=f.guid||g.guid||$.guid++);var h=c.match(/^([\w:-]*)\s*(.*)$/),i=h[1]+e.eventNamespace,j=h[2];j?d.delegate(j,i,g):b.bind(i,g)})},_off:function(a,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,a.unbind(b).undelegate(b)},_delay:function(a,b){function c(){return("string"==typeof a?d[a]:a).apply(d,arguments)}var d=this;return setTimeout(c,b||0)},_hoverable:function(a){this.hoverable=this.hoverable.add(a),this._on(a,{mouseenter:function(a){$(a.currentTarget).addClass("coral-state-hover")},mouseleave:function(a){$(a.currentTarget).removeClass("coral-state-hover")}})},_focusable:function(a){this.focusable=this.focusable.add(a),this._on(a,{focusin:function(a){$(a.currentTarget).addClass("coral-state-focus")},focusout:function(a){$(a.currentTarget).removeClass("coral-state-focus")}})},addNoTrigger:function(a){this.options.noTriggerEvent.push(a)},_trigger:function(a,b,c){var d=this.options.noTriggerEvent||[];if(d.length)for(var e=0;e<d.length;e++)if(a==d[e])return void d.splice(e,1);var f=this.options[a];this.options.controllerName&&"string"==typeof f&&(f=this.options.controllerName+"."+f);var g,h,i=$.isFunction(a)?a:$.coral.toFunction(f);if(c=c||{},b=$.Event(b),b.type=(a===this.componentEventPrefix?a:this.componentEventPrefix+a).toLowerCase(),b.target=this.element[0],h=b.originalEvent)for(g in h)g in b||(b[g]=h[g]);this.element.trigger(b,c),b.data=b.data||{},$.extend(b.data,this.options.dataCustom),$.extend(b.data,{controllerName:this.options.controllerName});var j;return j=$.controller(this.options.controllerName),this.options.controllerName&&!$.isFunction(this.options[a])&&j?$.extend(b.data,{element:this.element[0]}):j=this.element[0],!($.isFunction(i)&&i.apply(j,[b].concat(c))===!1||b.isDefaultPrevented())}},$.each({show:"fadeIn",hide:"fadeOut"},function(a,b){$.Component.prototype["_"+a]=function(c,d,e){"string"==typeof d&&(d={effect:d});var f,g=d?d===!0||"number"==typeof d?b:d.effect||b:a;d=d||{},"number"==typeof d&&(d={duration:d}),f=!$.isEmptyObject(d),d.complete=e,d.delay&&c.delay(d.delay),f&&$.effects&&$.effects.effect[g]?c[a](d):g!==a&&c[g]?c[g](d.duration,d.easing,e):c.queue(function(b){$(this)[a](),e&&e.call(c[0]),b()})}})}();/*! cui 2016-11-08 */
$.component("coral.formelement",{version:"4.0.2",options:{inputLabelGutter:10},getValidateValue:function(){return this.getValue()},clearError:function(){this.component().removeClass("hasErrorIcon coral-validate-error"),this.component().find(".coral-errorIcon").remove(),this.element.prop("isError",!1)},addField:function(){this.element.addClass("ctrl-form-element coral-validation-"+this.componentName);var a=this,b=this.element,c=b.closest(".coral-form-default"),d=c.length>0?$.extend({},$.validate.options,c.form("option")):$.extend({},$.validate.options);if(!(0===b.closest(".coral-form-default").length&&b.closest("form").length>0)){var e=this.options,f=e.required,g=(e.name,e.showStar,e.starBefore,e.validTypeOptions,e.triggers||d.triggers[this.componentName]||$.validate.options.triggers[this.componentName]),h=$.map(g,function(b){return a.componentEventPrefix+b+".field"}).join(" ");b.off(".field").on(h,function(a,b){$.validate.validItem($(this),a,!0)}),b.off(".focuselement").on(a.componentName+"onkeydown.focuselement",function(a,b){var d,e=$.coral.keyCode,f=0,g=c.find(".coral-button");$.each(g,function(a){"submit"==g[a].type&&(d=g[a])});var h,i=c.find(".tabbable"),f=0,j=document.activeElement;if($.each(i,function(a){return h=i[a]===j,f=a,h?!1:void 0}),h&&"TEXTAREA"!=i[f].tagName)if(a.shiftKey)switch(a.keyCode){case e.ENTER:f>0?i[f-1].focus():0==f&&(d?d.focus():i[i.length-1].focus())}else switch(a.keyCode){case e.ENTER:f<i.length-1?i[f+1].focus():f==i.length-1&&(d?d.focus():i[0].focus())}}),"boolean"==typeof f&&f&&$.validate._changeRequiredMark(this.element,f)}},_setOption:function(a,b){var c=this,d=this.options;switch(this._super(a,b),a){case"required":$.validate._changeRequiredMark(c.element,b),c.clearError();break;case"isLabel":case"readonly":case"readonlyInput":c.clearError();break;case"maxlength":$.validate.showTooltip(c.element,d.validTypeOptions)}},_createLabel:function(){var a=this.options.labelPosition||"left",b=this.options.labelField;this._initLabel(a,b)},_initLabel:function(a,b){this.labelPanel=$("<label class='coral-label ' style='width:100px;position:absolute;' data-pos="+a+">"+b+"</label>"),this.labelWraper=this.component(),this.labelWraper.prepend(this.labelPanel),this._positionLabelPanel(a)},_positionLabelPanel:function(a){var b=this.labelPanel.outerWidth();this.component().css("padding-"+a,b),this.labelPanel.css(a,0)}});/*! cui 2016-11-08 */
$.component("coral.inputbase",$.coral.formelement,{version:"4.0.2",options:{inputButtonGutter:5},setAtrr:function(){for(var a=["id","name","value","component-role","data-options"],b=0;b<a.length;b++)this.element.attr(a[b])&&this.textboxInput.setAttribute(a[b],this.element.attr(a[b]))},createInput:function(){var a="",b="",c="",d="";1==this.options.hasArrow&&("down"==this.options.showDirection&&(a="<span class='coral-combo-arrow coral-icon-arrow cui-icon-arrow-down3'></span>"),"up"==this.options.showDirection&&(a="<span class='coral-combo-arrow coral-icon-arrow cui-icon-arrow-up3'></span>")),"hidden"!==this.element.attr("type")&&"file"!==this.element.attr("type")&&"password"!==this.element.attr("type")&&"text"!==this.element.attr("type")&&"INPUT"==this.element[0].tagName.toUpperCase()?d="text":(d=this.element.attr("type"),d||(d="text")),this.options.showClose&&!this.options.required&&(b="<span class='coral-input-clearIcon cui-icon-cross2'></span>");var e='<input type="'+d+'" class="'+this.className+'" autocomplete="off"/>';"TEXTAREA"==this.element[0].tagName&&(e="<textarea type='textarea' class='"+this.className+"'/>"+this.element.text()+"</textarea>"),e="<span class='coral-textbox-border coral-corner-all "+this.classBorder+"'>"+e+b+a+"</span>",e+='<input name="'+c+"\" type='hidden'  class=\""+this.hiddenClass+'"/>',this.textboxWrapper=document.createElement("span"),this.textboxWrapper.className=this.compClass,this.textboxWrapper.innerHTML=e,this.elementBorder=this.textboxWrapper.firstChild,this.textboxInput=this.elementBorder.firstChild,this.clearIcon=$(this.textboxInput.nextSibling),this.setAtrr(),this.cloneCopyEvent(this.element[0],this.textboxInput);var f=this.element[0].parentNode;f&&this.textboxWrapper!=this.element[0]&&f.replaceChild(this.textboxWrapper,this.element[0])},cloneCopyEvent:function(a,b){if(1===b.nodeType&&jQuery.hasData(a)){var c,d,e,f=jQuery._data(a),g=jQuery._data(b,f),h=f.events;if(h){delete g.handle,g.events={};for(c in h)for(d=0,e=h[c].length;e>d;d++)jQuery.event.add(b,c,h[c][d])}g.data&&(g.data=jQuery.extend({},g.data))}},_setOption:function(a,b){var c=this;this._super(a,b),this.component().find(".button").each(function(){var d=$(this).attr("data-pos"),e=d.split("_");if("isLabel"===a)if(b)$(this).hide(),"outer"==e[0]?c.component().css("padding-"+e[1],0):c.component().find(".coral-textbox-border").css("padding-"+e[1],0);else{$(this).show();var f=$(this).outerWidth();"outer"==e[0]?c.component().css("padding-"+e[1],f+c.options.inputButtonGutter):c.component().find(".coral-textbox-border").css("padding-"+e[1],f)}if("readonly"===a||"disable"===a||"isLabel"===a){var g=$(this).find(".ctrl-init-button");b?g.button("disable"):g.button("enable")}})},_outerButtons:function(){this.uiDialogOuterButtonPanel=$("<span class='coral-outerbuttonset coral-outer coral-corner-all'></span>"),this.component().append(this.uiDialogOuterButtonPanel),this._createtoolPanelItems(this.options.buttonOptions,null,this.uiDialogOuterButtonPanel,null,"button"),this.component().css("padding-right",this.uiDialogOuterButtonPanel.outerWidth()+8)},_createButtonPanel:function(){var a,b=!1,c="right",d="inner",e="innerRight",f="prepend",g=this.options.buttons;for(a=0;a<this.options.buttons.length;a++){g[a].innerLeft&&(e="innerLeft",c="left",b=!0),g[a].innerRight&&(e="innerRight",c="right",f="append",b=!0),g[a].outerRight&&(e="outerRight",c="right",d="outer",f="append",b=!0),g[a].outerLeft&&(e="outerLeft",c="left",d="outer",b=!0),g[a].floatRight&&(e="floatRight",d="float",f="append",b=!0),g[a].floatLeft&&(e="floatLeft",c="left",d="float",b=!0);var h=g[a][e]?g[a][e][0]:g[a];h.type&&"combobox"==h.type?this._initToolPanel(d,e,c,f,a,"combobox"):b&&this._initToolPanel(d,e,c,f,a,"button")}b||(this.uiDialogButtonPanel=$("<span class='button "+e+" coral-textbox-btn-icons coral-buttonset coral-corner-"+c+"' data-pos="+d+"_"+c+"></span>"),this._createtoolPanelItems(this.options.buttons,c,this.uiDialogButtonPanel,d,"button"),this.elementBorder.append(this.uiDialogButtonPanel),this.elementBorder.css("padding-right",this.uiDialogButtonPanel.outerWidth()),this.uiDialogButtonPanel.css("right",0),this.rightPos=this.uiDialogButtonPanel.outerWidth())},_initToolPanel:function(a,b,c,d,e,f){"inner"==a?(this.uiButtonPanel=$("<span class='button "+b+" coral-buttonset coral-inner coral-corner-"+c+"' data-pos="+a+"_"+c+"></span>"),this.buttonPanelWraper=this.elementBorder):(this.uiButtonPanel=$("<span class='button "+b+" coral-outerbuttonset coral-outer coral-corner-all' data-pos="+a+"_"+c+"></span>"),this.buttonPanelWraper=this.component()),this.buttonPanelWraper[d](this.uiButtonPanel),this._createtoolPanelItems(this.options.buttons[e][b],c,this.uiButtonPanel,a,f),this._positionToolPanel(a,c)},_positionToolPanel:function(a,b){var c=this.uiButtonPanel.outerWidth()+1;"inner"===a?(this.elementBorder.css("padding-"+b,c),this.uiButtonPanel.css(b,0)):"float"===a?this.uiButtonPanel.css(b,-(c+this.options.inputButtonGutter)):"outer"===a&&(this.component().css("padding-"+b,c+this.options.inputButtonGutter),this.uiButtonPanel.css(b,0)),"left"===b&&this.uiButtonPanel.css("width",c),a+b==="innerright"&&(this.rightPos=this.uiButtonPanel.outerWidth())},_createtoolPanelItems:function(a,b,c,d,e){var f=this;$.isEmptyObject(a)&&(a={}),a instanceof Array==0&&(a=[a]),$.each(a,function(g){var h="",i="coral-corner-all";if("inner"==d&&"left"==b?0==g&&(h="coral-corner-left"):"inner"==d&&"right"==b?g==a.length-1&&(h="coral-corner-right"):i="","button"===e){var j,k=$.extend({type:"button"},{click:this.click});this.click=this.onClick||this.click,delete this.onClick,j=this.click||$.noop,k.click=function(){j.apply(f.element[0],arguments)},delete this.click;var l=$("<button></button>",k).button(this);l.button("component").addClass(h).removeClass(i).appendTo(c),this.click=j}else if("combobox"===e){delete this.type,this.width="item";var m=$("<input type='text'/>").appendTo("body");m.off(".changeLength").on("comboboxonload.changeLength",{target:m},function(a){f.resizeCombo.apply(a.data.target.combobox("instance"))}).on("comboboxonchange.changeLength",{target:m},function(a){f.resizeCombo.apply(a.data.target.combobox("instance"))}).combobox(this),m.combobox("component").addClass(h).removeClass(i).appendTo(c).addClass("coral-DropDownButton")}})},resizeCombo:function(){function a(a,c){var d=b.options.inputButtonGutter,e=0;"outer"===a&&($(".coral-outer").children(".coral-DropDownButton").each(function(){e+=$(this).width()}),b.component().closest(".coral-outer").css("width",e),b.component().closest(".coral-outer").closest(".coral-textbox").css("padding-"+c,e+d)),"inner"===a&&b.component().hasClass("coral-inner-left")&&($(".coral-inner").find(".coral-inner-left").each(function(){e+=$(this).width()}),b.component().closest(".coral-textbox-border").css("padding-left",e))}var b=this;this.options;this.component().closest(".coral-inner").length&&a("inner","left");var c=this.component().closest(".coral-outer");c.length&&("outer_right"==c.attr("data-pos")&&a("outer","right"),"outer_left"==c.attr("data-pos")&&a("outer","left"))}});/*! cui 2016-11-08 */
function _parseUI(a,b){var c=-1,b=b||null,d=String(a.className);if(d){var e=$(a);if(!e.attr("component-role"))for(var f=d.split(" "),g=0,h=f.length;h>g;g++){var i=f[g],j=$.coral.getUI(i);if(-1!==j){var k=i.split("-")[1];if(c=$.inArray(k,$.parser.formPlugins),e[k]){e.removeClass("coralui-"+k),"view"==k&&(b=$.parser.parseOptions(e).controllerName),b&&e.attr("controllerName",b),new j({},e);break}}}}if(-1===c){var l=a.childNodes;if("false"!==a.getAttribute("data-render"))for(var g=0;g<l.length;g++){var m=l[g];1==m.nodeType&&m.parentNode==a&&_parseUI(m,b)}}}function change2object(a,b){var c=b.shift();if(0==b.length){if(a&&a[c]&&"string"==typeof a[c])try{a[c]=new Function("return "+a[c])()}catch(d){}}else change2object(a[c],b)}$.parser={auto:!0,doneArr:[],component:[],onComplete:function(a){},onInit:function(a){},plugins:["coralui-tabs","coralui-layout","coralui-grid","coralui-panel","coralui-button","coralui-menubutton","coralui-treebutton","coralui-splitbutton","coralui-accordion","coralui-textbox","coralui-autocomplete","coralui-autocompletetree","coralui-uploader","coralui-radio","coralui-radiolist","coralui-checkbox","coralui-checkboxlist","coralui-spinner","coralui-slider","coralui-combo","coralui-combobox","coralui-combotree","coralui-combogrid","coralui-datepicker","coralui-form","coralui-picgrid","coralui-tree","coralui-toolbar","coralui-progressbar","coralui-menu","coralui-menubar","coralui-contextmenu","coralui-slidemenu","coralui-tieredmenu","coralui-navigatemenu","coralui-dialog","coralui-subfield","coralui-splitcontainer","coralui-view","coralui-loading","coralui-adjusted","fill","coral-adjusted"],formPlugins:["grid","button","menubutton","textbox","autocomplete","uploader","splitbutton","radio","radiolist","checkbox","checkboxlist","spinner","slider","combo","combobox","combotree","combogrid","datepicker","tree","progressbar","colorpicker"],isElement:function(a){return!(!a||!a.appendChild)},parse:function(a){"string"==typeof a&&($(a).length||(a=document.body)),a||(a=document.body),$.parser.onInit.call($.parser,a),$.parser.isElement($(a)[0])||(a=document.body),_parseUI($(a)[0]),$.coral.refreshAllComponent(a),$.parser.onComplete.call($.parser,a),$.each($.parser.doneArr,function(a){var b=$.parser.doneArr.shift();if($.isFunction(b))b.call($.parser);else if(b){var c=b;$.isFunction(c.fun)&&c.fun.call(c.context,c.args)}})},parseOptions:function(a,b,c){var d=$(a),e=$.trim(d.attr("data-options")),f=null,g=null,h=null,i=0,j=null,k=null,l=null,m={};if(e&&(f=e.substring(0,1),g=e.substring(e.length-1,1),"{"!=f&&(e="{"+e),"}"!=g&&(e+="}"),m=new Function("return "+e)()),b){h={};for(var i=0;i<b.length;i++)if(k=b[i],"string"==typeof k)"width"==k||"height"==k||"left"==k||"top"==k?h[k]=parseInt(a.style[k])||void 0:h[k]=d.attr(k);else for(j in k)l=k[j],"boolean"==l?h[j]=d.attr(j)?"true"==d.attr(j):void 0:"number"==l&&(h[j]="0"==d.attr(j)?0:parseFloat(d.attr(j))||void 0);$.extend(m,h),h=null}if(c instanceof Array)for(i=0;i<c.length;i++)j=c[i],m.controllerName&&"string"==typeof m[j]&&"true"!=m[j]&&"false"!=m[j]&&(m[j]=m.controllerName+"."+m[j]),change2object(m,j.split("."),m.controllerName);return m}},$(function(){!window.easyloader&&$.parser.auto&&$.parser.parse()}),$.parseDone=function(a){$.parser.doneArr.push(a)};/*! cui 2016-11-08 */
var validate_uuid=0,validateSuffix="coralForm",validatePrefix="validate";$.validate={options:{onStatus:"onstatus",errorMode:1,errMsgPosition:"leftBottom",requiredMsg:"*必输项",triggers:{textbox:["onchange","onblur","onkeyup"],radio:["onchange","onblur"],checkbox:["onchange","onblur"],radiolist:["onchange","onblur"],checkboxlist:["onchange","onblur"],combobox:["onchange","onblur"],colorpicker:[],combotree:["onchange","onblur"],combogrid:["onchange","onblur"],datepicker:["onchange","onblur"],autocomplete:["onchange","onblur"],spinner:["onchange","onblur"],textboxlist:["onchange","onblur"],autocompletetree:["onchange","onblur"],fileuploader:["onchange"]}},validateSuffix:function(){return validateSuffix},_validate:function(a){var b=a.validType,c=a.validValue,d=a.elementValue,e=a.optionValue,f=a.field,g=a.requiredMsg,h=a.errMsg;if("undefined"==typeof c)return"";switch(b){case"required":return this._checkRequired(c,d,g);case"minlength":return this._checkMinlength(c,d,h);case"maxlength":return this._checkMaxlength(c,d,h);case"pattern":return this._checkPattern(c,d,h);case"validType":return this._checkValidType(c,d,e,h);case"valid":return this._checkValid(c,d,h,f);case"specialCharacters":return this._isSpecialCharacters(c,d,h);default:return""}},getFieldType:function(a){return $(a).attr("component-role")},validTypeNames:["required","minlength","maxlength","pattern","validType","valid","specialCharacters"],validTypeOptions:{maxlength:{restrictInput:!1,showTooltip:!1},number:{restrictInput:!1},naturalnumber:{restrictInput:!1},integer:{restrictInput:!1},"float":{restrictInput:!1},zh:{restrictInput:!1},letter:{restrictInput:!1},uppercase:{restrictInput:!1},lowercase:{restrictInput:!1},zhOrNumOrLett:{restrictInput:!1},ip:{restrictInput:!1},port:{restrictInput:!1},url:{restrictInput:!1},email:{restrictInput:!1},mobile:{restrictInput:!1},idno:{restrictInput:!1},zipcode:{restrictInput:!1}},validateField:function(a,b){validAction=!0,b.validoptions=b.validoptions||{};var c=b.element,d=$.validate.getFieldType(c),e=b.notComponent?b.component:c[d]("component"),f=b.notComponent?b.validoptions:c[d]("option"),g=null,h=b.hasTips,i=[],j=f.errorMode||b.validoptions.errorMode||$.validate.options.errorMode,k=(f.errMsgPosition||b.validoptions.errMsgPosition||$.validate.options.errMsgPosition,f.readonly,f.disabled),l=f.isLabel;if(e.is(":visible")||(h=!1),h=!1,"hidden"==c.attr("type"))return c.prop("isError",!1),i;if(l||k)return c.prop("isError",!1),i;if(b.notComponent)g=b.value;else if("radio"===d||"checkbox"===d)g=c.prop("checked")?c[d]("getValue"):"";else try{g=c[d]("getValidateValue")}catch(m){$.error("cannot call methods on "+d+" , please achieve the getValue method !")}for(var n=0;n<this.validTypeNames.length;n++){var o=this.validTypeNames[n],p={optionValue:f.validType,requiredMsg:f.requiredMsg,elementValue:g,field:c,errMsg:f.errMsg,validValue:f[o],validType:o};if(f[o]&&"required"==o?!0:""!=g){var q=$.validate._validate(p);""==q||i.push(q)}}if(i.length>0){if($.validate.hideErrors(e),!b.notComponent)if(0==j)$(e).attr("data-errors",i.toString());else{var r=e.css("padding-right");e.append("<span class='cui-icon-notification2 coral-errorIcon' style='right:"+r+"' data-errors = '"+i.toString()+"' ></span>"),e.addClass("hasErrorIcon ")}e.addClass("coral-validate-error ");var s=i;return $.validate._apply(f.onValidError,c,a,s),$(c).prop("isError",!0),i}return $.validate._apply(f.onValidSuccess,c,a,{}),e.removeClass("coral-validate-error"),$.validate.hideErrors(e),$(c).prop("isError",!1),$(e).removeAttr("data-errors"),i},_apply:function(a,b,c,d){var e=$.coral.toFunction(a);return $.isFunction(e)?e.apply(b,[c,d]):void 0},_checkValid:function(a,b,c,d){var e="";c&&(e=c);var f=null;if(a){if(f=$.coralApply($.coral.toFunction(a),d&&d[0],[{value:b}]),"object"==typeof f&&"boolean"==typeof f.isValid)return f.isValid?"":f.errMsg?f.errMsg:""==e?f.errMsg:e;if("boolean"==typeof f)return f?e:e}return""},_checkRequired:function(a,b,c){var d=$.validate.options.requiredMsg;return c&&(d=c),"boolean"==typeof a&&a&&""==$.trim(b)?d:""},_checkMinlength:function(a,b,c){var d="最少输入"+a+"个字符！";if("undefined"!=typeof c&&null!=c&&""!=c&&(d=c),a&&this._isPositiveInteger(a)){var e=parseInt(a),f=this._getByteLength(b);return e>f?d:""}},_checkMaxlength:function(a,b,c){var d="最多输入"+a+"个字符！";if("undefined"!=typeof c&&null!=c&&""!=c&&(d=c),a&&this._isPositiveInteger(a)){var e=parseInt(a),f=this._getByteLength(b);return f>e?d:""}},_checkPattern:function(validValue,elementValue,errMsg){var errMsgResult="请输入匹配的字符串！";if("undefined"!=typeof errMsg&&null!=errMsg&&""!=errMsg&&(errMsgResult=errMsg),validValue){var reg=eval(validValue.replace(/\/\//g,"/"));return reg.test($.trim(elementValue))?"":errMsgResult}return""},_isSpecialCharacters:function(validValue,elementValue,errMsg){var errMsgResult="含有特殊符号！";if("undefined"!=typeof errMsg&&null!=errMsg&&""!=errMsg&&(errMsgResult=errMsg),validValue){var reg=eval(validValue.replace(/\/\//g,"/"));return reg.test($.trim(elementValue))?errMsgResult:""}return""},_checkValidType:function(a,b,c,d){var e="";"undefined"!=typeof d&&null!=d&&""!=d&&(e=d);var f=b;switch(a){case"number":return""==e&&(e="请输入数字！"),this._isNumber(f)?"":e;case"naturalnumber":return""==e&&(e="请输入自然数！"),this._isNaturalnumber(f)?"":e;case"integer":return""==e&&(e="请输入整数！"),this._isInteger(f)?"":e;case"float":return""==e&&(e="请输入实数！"),this._isFloat(f)?"":e;case"zh":return""==e&&(e="请输入汉字！"),this._isZh(f)?"":e;case"letter":return""==e&&(e="请输入英文字母！"),this._isLetter(f)?"":e;case"uppercase":return""==e&&(e="请输入大写英文字母！"),this._isUppercase(f)?"":e;case"lowercase":return""==e&&(e="请输入小写英文字母！"),this._isLowercase(f)?"":e;case"zhOrNumOrLett":return""==e&&(e="请输入汉字、数字、英文字母！"),this._isZhOrNumOrLett(f)?"":e;case"ip":return""==e&&(e="请输入合法的计算机IP地址！"),this._isIp(f)?"":e;case"port":return""==e&&(e="请输入合法的计算机IP地址端口号！"),this._isPort(f)?"":e;case"url":return""==e&&(e="请输入合法的网页地址！"),this._isUrl(f)?"":e;case"email":return""==e&&(e="请输入合法的电子邮件地址！"),this._isEmail(f)?"":e;case"mobile":return""==e&&(e="请输入合法的手机号码！"),this._isMobile(f)?"":e;case"idno":return""==e&&(e="请输入合法的身份证号码！"),this._isIDNo(f)?"":e;case"zipcode":return""==e&&(e="请输入合法邮政编码！"),this._isZipcode(f)?"":e;default:return""}},_isNumber:function(a){return!isNaN(a)},_isNaturalnumber:function(a){return!!/^[0-9]+$/.test(a)},_isInteger:function(a){return!!/^(\+|-)?\d+$/.test(a)},_isFloat:function(a){return!!/^(\+|-)?\d+($|\.\d+$)/.test(a)},_isZh:function(a){return!!/^[\u4e00-\u9fa5]+$/.test(a)},_isLetter:function(a){return!!/^[A-Za-z]+$/.test(a)},_isUppercase:function(a){return!!/^[A-Z]+$/.test(a)},_isLowercase:function(a){return!!/^[a-z]+$/.test(a)},_isZhOrNumOrLett:function(a){return!!/^[0-9a-zA-Z\u4e00-\u9fa5]+$/.test(a)},_isIp:function(a){return/^(\d+)\.(\d+)\.(\d+)\.(\d+)$/.test(a)?RegExp.$1<256&&RegExp.$2<256&&RegExp.$3<256&&RegExp.$4<256?!0:void 0:!1},_isPort:function(a){return!!(this._isNaturalnumber(a)&&65536>a)},_isUrl:function(a){return!!/^(http|https|ftp):\/\/(www\.)?.+.?$/.test(a)},_isEmail:function(a){return!!/^([-_A-Za-z0-9\.]+)@([_A-Za-z0-9]+\.)+[A-Za-z0-9]{2,3}$/.test(a)},_isMobile:function(a){return!!/^0?(13[0-9]|15[012356789]|17[0-9]|18[0-9]|14[57])[0-9]{8}$/.test(a)},_isIDNo:function(a){var b={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"},c=0,d=a,e=d.length;if(!/^\d{17}(\d|x)$/i.test(d)&&!/^\d{15}$/i.test(d))return!1;if(d=d.replace(/x$/i,"a"),null==b[parseInt(d.substr(0,2))])return!1;if(18==e){var f=d.substr(6,4)+"-"+Number(d.substr(10,2))+"-"+Number(d.substr(12,2)),g=new Date(f.replace(/-/g,"/"));if(f!=g.getFullYear()+"-"+(g.getMonth()+1)+"-"+g.getDate())return!1;for(var h=17;h>=0;h--)c+=Math.pow(2,h)%11*parseInt(d.charAt(17-h),11);if(c%11!=1)return!1}else if(15==e){f="19"+d.substr(6,2)+"-"+Number(d.substr(8,2))+"-"+Number(d.substr(10,2));var g=new Date(f.replace(/-/g,"/")),i=g.getFullYear().toString()+"-"+(g.getMonth()+1)+"-"+g.getDate();if(f!=i)return!1}return!0},_isZipcode:function(a){return!(!this._isNaturalnumber(a)||6!=a.length)},_isDate:function(a,b){var c,d,e,f,g,h=$.trim(a);if(/^(y{4})(-|\/)(M{1,2})\2(d{1,2})$/.test(b))f=/^(\d{4})(-|\/)(\d{1,2})\2(\d{1,2})$/;else if(/^(y{4})(年)(M{1,2})(月)(d{1,2})(日)$/.test(b))f=/^(\d{4})年(\d{1,2})月(\d{1,2})日$/;else{if("yyyyMMdd"!=b)return!1;f=/^(\d{4})(\d{2})(\d{2})$/}if(g=h.match(f),null==g)return!1;if(/^(y{4})(-|\/)(M{1,2})\2(d{1,2})$/.test(b)?(c=g[1],d=g[3],e=g[4]):(c=g[1],d=g[2],e=g[3]),1>d||d>12)return!1;if(1>e||e>31)return!1;if((4==d||6==d||9==d||11==d)&&31==e)return!1;if(2==d){var i=c%4==0&&(c%100!=0||c%400==0);if(e>29)return!1;if(29==e&&!i)return!1}return!0},showRequiredMark:function(a){var b=a.component;b.find("span.coral-validate-required:first").remove(),b.append("<span class='coral-validate-required'>*</span>")},hideRequiredMark:function(a){var b=a.component;b.find("span.coral-validate-required:first").remove()},showErrors:function(a,b,c,d){var e=a;(a.hasClass("coral-hasLabel")||a.hasClass("coral-validate-starBefore"))&&(a.find(".coral-radio-label").length?a=a.find(".coral-radio-label"):a.find(".coral-checkbox-label").length?a=a.find(".coral-checkbox-label"):a.find(".coral-label").next().length?a=a.find(".coral-label").next():a.find(".coral-validate-required").next().length&&(a=a.find(".coral-validate-required").next()));var f,g,h=$(a).parents("form"),i="tooltip",j=b.join("<br />"),k=$(a),l=k.attr("id"),f=$("."+l+validateSuffix),m="coral-validate-errorArrow-top";switch(0!=$(a).parents("form").length&&(i=$(h).form("option","container")),c){case"leftTop":m="coral-validate-errorArrow-top";break;case"leftBottom":m="coral-validate-errorArrow-bottom";break;case"rightTop":m="coral-validate-errorArrow-top";break;case"rightBottom":m="coral-validate-errorArrow-bottom";break;case"right":m="coral-validate-errorArrow-right"}var n='<div class="'+m+'"></div>';if(null==l&&(l=k.attr("id",validatePrefix+validate_uuid++).attr("id")),$("."+l+validateSuffix).length>0)$("."+l+validateSuffix).find(".error-content").html(j);else{f=$("<div class='"+l+validateSuffix+" coral-validate-state-error'><div class='error-content'>"+j+"</div>"+n+"</div>");var o=$(a).parents("form").attr("context");$(o).length>0?$(o).append(f):$(document.body).append(f),g=k.position()}var p="left top",q="right-20 top-"+(f.outerHeight()+8);switch(c){case"leftTop":p="right top",q="left+"+f.outerWidth()+" top-"+(f.outerHeight()+8);break;case"leftBottom":p="right bottom",q="left+"+f.outerWidth()+" bottom+"+(f.outerHeight()+8);break;case"rightTop":p="left top",q="right-20 top-"+(f.outerHeight()+8);break;case"rightBottom":p="left bottom",q="right-20 bottom+"+(f.outerHeight()+8);break;case"right":p="left middle",q="right+15 middle"}f.position({my:p,at:q,of:k}),e.addClass("coral-validate-error");setTimeout(function(){},2e3)},clearErrors:function(a){var b=$.coral.findComponent(".ctrl-form-element",a),c=0,d=b.length;for(c;d>c;c++){var e=b[c];e.clearError()}},clear:function(){$(".coral-validate-state-error").remove(),$(".coral-errorIcon").remove(),$(".coral-validate-error").removeClass("coral-validate-error")},hideErrors:function(a){var b=$(a),c=b.attr("id");$("."+c+validateSuffix).remove(),$(".coral-errorIcon",b).remove(),b.removeClass("coral-validate-error hasErrorIcon ")},hideErrorsTip:function(a){var b=$(a),c=b.attr("id");$("."+c+validateSuffix).remove()},_showTooltip:function(a,b){var c=$(a),d=$("<div class='coral-validate-tooltip'>"+b+"</div>");$(document.body).after(d);c.position();d.position({my:"left top",at:"right+20 top+"+($(a).height()/2-d.outerHeight()/2),of:c})},_hideTooltip:function(a){$(a);$(".coral-validate-tooltip").remove()},_getSubString:function(a,b){var c=/[^\x00-\xff]/g;if(a.replace(c,"mm").length<=b)return a;for(var d=Math.floor(b/2),e=d;e<a.length;e++)if(a.substr(0,e).replace(c,"mm").length>=b)return a.substr(0,e);return a},_getByteLength:function(a){for(var b=0,c=0;c<a.length;c++){var d=a.charAt(c);b+=null!=d.match(/[^\x00-\xff]/gi)?2:1}return b},_isPositiveInteger:function(a){return"NaN"===parseInt(a).toString()?!1:parseInt(a)>0},showTooltip:function(a,b){b=$.extend(!0,{},$.validate.validTypeOptions,b);var c=b.maxlength.showTooltip;c&&($(a).attr("tooltips","tooltips"),$(a).tooltip({items:"[tooltips]"}).addClass("hasTooltip"),$.validate.getMaxLength(a),$(a).on({keyup:function(b){$.validate.getMaxLength(a)}}))},getMaxLength:function(a){var b=0,c=$(a).val(),d=$(a).attr("component-role"),e=$(a)[d]("option","isLabel"),f=$(a)[d]("option","readonly"),g=$(a)[d]("option","readonlyInput"),h=$.validate._getByteLength(c),i=$(a)[d]("option","maxlength"),b=i-h;0==e&&0==f&&0==g&&$(a).tooltip("option","content","还可以输入"+b+"个字符")},restrictInput:function(a,b,c){var d=$(a).attr("component-role"),e=$(a)[d]("option"),f=null;return $.each($.validate.validTypeNames,function(c,d){var g=e[d],h=$.validate.validTypeOptions[d],i=$.validate.validTypeOptions[g],j=null,k=null;g&&h?(j=d,k=h):g&&i&&(j=g,k=i),j&&k&&k.restrictInput&&(f=$.validate.forbiddenInput(j,b,a))}),f},forbiddenInput:function(a,b,c){var d=$(c).attr("component-role"),e=$(c)[d]("option"),f=null,g=c.val();switch(a){case"maxlength":if(!b.ctrlKey&&-1==$.inArray(b.keyCode,[8,46,9,37,39,35,36])&&""!==$.validate._checkMaxlength(e[a],g+String.fromCharCode(b.keyCode))){for(var h=0,i=[],j=0;j<g.length;j++){var k=g.charAt(j);null!==k.match(/[^\x00-\xff]/gi)?(h+=2,h<=e[a]&&i.push(k)):(h+=1,h<=e[a]&&i.push(k))}c.val(i.join("")),f=!1}break;case"number":!b.ctrlKey&&-1==$.inArray(b.keyCode,[8,46,9,37,39,35,36])&&(b.keyCode<48||b.keyCode>57&&b.keyCode<96||b.keyCode>105)&&(f=!1);var l=/^[0-9]+.?[0-9]*$/;l.test(g)||$(c).val("")}return f},_changeRequiredMark:function(a,b){var c,d=a.attr("component-role"),e=a.closest(".ctrl-init-form");e.length>0&&(c=e.form("option"));var f=a[d]("option","showRequiredMark"),g=a[d]("option","hideRequiredMark"),h=null==f?c&&c.showRequiredMark||$.validate.showRequiredMark:f,i=null==g?c&&c.hideRequiredMark||$.validate.hideRequiredMark:g;h=$.coral.toFunction(h),i=$.coral.toFunction(i),b===!0?h&&h.apply(a[0],[{component:a[d]("component")}]):i&&i.apply(a[0],[{component:a[d]("component")}])},validItem:function(a,b,c){var d=this.options,e={validoptions:d,hasTips:c,element:a},f=$(a).attr("component-role"),g=$(a)[f]("option"),h=g.excluded;h||$.validate.validateField(b,e)},setExcluded:function(a,b){var c=$.coral.findComponent(".ctrl-form-element",$(b)),d=0,e=c.length;for(d;e>d;d++){var f=c[d];f._setOption("excluded",a),f.component().removeClass("coral-validate-error"),f.component().removeAttr("data-errors"),$(".coral-errorIcon",f.component()).remove(),f.element.prop("isError",!1)}}},$.component("coral.validate",{version:$.coral.version,options:{onStatus:"onstatus",showStar:!0,errMessages:{required:"* 必输项",minLength:"{0}",maxLength:"{0}",pattern:"",validType:{number:""},valid:""},fields:{},errMsgPosition:"leftBottom",excluded:[":disabled",":hidden",":not(:visible)"]},_isExclud:function(a,b){if(!b)return!1;for(var c=b.length,d=a.attr("component-role"),e=a[d]("option"),f=e.excluded,g=a[d]("component"),h=0;c>h;h++)if("string"==typeof b[h]&&g.is(b[h])||f)return!0;return!1},_create:function(){this.element.addClass("coral-validate ctrl-init ctrl-init-validate"),this.element.addClass("inited-validate")},_destroy:function(){this.element.removeClass("coral-validate ctrl-init ctrl-init-validate"),this._super()},_setOption:function(a,b){"id"!=a&&"name"!=a&&this._super(a,b)},removeField:function(){},updateField:function(){},_initField:function(){$(this.element).find(".ctrl-form-element")},valid:function(a){a||(a=this.element);var b=this,c=null,d=0,e=this.options.excluded,f=null,g=!0;return e&&"string"==typeof e&&(e=$.map(e.split(","),function(a){return $.trim(a)})),c=a.is($("[class*='coral-validation-']"))?$(a):$(a).find($("[class*='coral-validation-']")),"form"===$(a)[0].tagName.toLowerCase()&&(f=$(a).form("option","errTipsType")),f="none",c.each(function(a){var c=$(this),h=$.validate.getFieldType(c);b._isExclud(c,e)||("none"===f&&(g=!1),$.validate.validItem(c,null,g),c.prop("isError")&&("first"===f&&(g=!1),0==d&&c[h]("focus"),++d))}),!(d>0)}});/*! cui 2016-11-08 */
!function(){var a=!1;$(document).mouseup(function(){a=!1}),$.component("coral.mouse",{version:"4.0.1",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var a=this;this.element.bind("mousedown."+this.componentName,function(b){return a._mouseDown(b)}).bind("click."+this.componentName,function(b){return!0===$.data(b.target,a.componentName+".preventClickEvent")?($.removeData(b.target,a.componentName+".preventClickEvent"),b.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.componentName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.componentName,this._mouseMoveDelegate).unbind("mouseup."+this.componentName,this._mouseUpDelegate)},_mouseDown:function(b){if(!a){this._mouseStarted&&this._mouseUp(b),this._mouseDownEvent=b;var c=this,d=1===b.which,e="string"==typeof this.options.cancel&&b.target.nodeName?$(b.target).closest(this.options.cancel).length:!1;return d&&!e&&this._mouseCapture(b)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){c.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=this._mouseStart(b)!==!1,!this._mouseStarted)?(b.preventDefault(),!0):(!0===$.data(b.target,this.componentName+".preventClickEvent")&&$.removeData(b.target,this.componentName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return c._mouseMove(a)},this._mouseUpDelegate=function(a){return c._mouseUp(a)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),b.preventDefault(),a=!0,!0)):!0}},_mouseMove:function(a){return $.coral.ie&&(!document.documentMode||document.documentMode<9)&&!a.button?this._mouseUp(a):a.which?this._mouseStarted?(this._mouseDrag(a),a.preventDefault()):(this._mouseDistanceMet(a)&&this._mouseDelayMet(a)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,a)!==!1,this._mouseStarted?this._mouseDrag(a):this._mouseUp(a)),!this._mouseStarted):this._mouseUp(a)},_mouseUp:function(b){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target===this._mouseDownEvent.target&&$.data(b.target,this.componentName+".preventClickEvent",!0),this._mouseStop(b)),a=!1,!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}();/*! cui 2016-11-08 */
!function(){function a(a,b,c){return a>=b&&b+c>a}function b(a){return/left|right/.test(a.css("float"))||/inline|table-cell/.test(a.css("display"))}$.component("coral.sortable",$.coral.mouse,{version:"4.0.1",componentEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var a=this.options;this.containerCache={},this.element.addClass("coral-sortable"),this.refresh(),this.floating=this.items.length?"x"===a.axis||b(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(a,b){this._super(a,b),"handle"===a&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".coral-sortable-handle").removeClass("coral-sortable-handle"),$.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("coral-sortable-handle")})},_destroy:function(){this.element.removeClass("coral-sortable coral-sortable-disabled").find(".coral-sortable-handle").removeClass("coral-sortable-handle"),this._mouseDestroy();for(var a=this.items.length-1;a>=0;a--)this.items[a].item.removeData(this.componentName+"-item");return this},_mouseCapture:function(a,b){var c=null,d=!1,e=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(a),$(a.target).parents().each(function(){return $.data(this,e.componentName+"-item")===e?(c=$(this),!1):void 0}),$.data(a.target,e.componentName+"-item")===e&&(c=$(a.target)),c&&(!this.options.handle||b||($(this.options.handle,c).find("*").addBack().each(function(){this===a.target&&(d=!0)}),d))?(this.currentItem=c,this._removeCurrentsFromItems(),!0):!1)},_mouseStart:function(a,b,c){var d,e,f=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(a),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},$.extend(this.offset,{click:{left:a.pageX-this.offset.left,top:a.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(a),this.originalPageX=a.pageX,this.originalPageY=a.pageY,f.cursorAt&&this._adjustOffsetFromHelper(f.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),f.containment&&this._setContainment(),f.cursor&&"auto"!==f.cursor&&(e=this.document.find("body"),this.storedCursor=e.css("cursor"),e.css("cursor",f.cursor),this.storedStylesheet=$("<style>*{ cursor: "+f.cursor+" !important; }</style>").appendTo(e)),f.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",f.opacity)),f.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",f.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",a,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!c)for(d=this.containers.length-1;d>=0;d--)this.containers[d]._trigger("activate",a,this._uiHash(this));return $.coral.ddmanager&&($.coral.ddmanager.current=this),$.coral.ddmanager&&!f.dropBehaviour&&$.coral.ddmanager.prepareOffsets(this,a),this.dragging=!0,this.helper.addClass("coral-sortable-helper"),this._mouseDrag(a),!0},_mouseDrag:function(a){var b,c,d,e,f=this.options,g=!1;for(this.position=this._generatePosition(a),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-a.pageY<f.scrollSensitivity?this.scrollParent[0].scrollTop=g=this.scrollParent[0].scrollTop+f.scrollSpeed:a.pageY-this.overflowOffset.top<f.scrollSensitivity&&(this.scrollParent[0].scrollTop=g=this.scrollParent[0].scrollTop-f.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-a.pageX<f.scrollSensitivity?this.scrollParent[0].scrollLeft=g=this.scrollParent[0].scrollLeft+f.scrollSpeed:a.pageX-this.overflowOffset.left<f.scrollSensitivity&&(this.scrollParent[0].scrollLeft=g=this.scrollParent[0].scrollLeft-f.scrollSpeed)):(a.pageY-$(document).scrollTop()<f.scrollSensitivity?g=$(document).scrollTop($(document).scrollTop()-f.scrollSpeed):$(window).height()-(a.pageY-$(document).scrollTop())<f.scrollSensitivity&&(g=$(document).scrollTop($(document).scrollTop()+f.scrollSpeed)),a.pageX-$(document).scrollLeft()<f.scrollSensitivity?g=$(document).scrollLeft($(document).scrollLeft()-f.scrollSpeed):$(window).width()-(a.pageX-$(document).scrollLeft())<f.scrollSensitivity&&(g=$(document).scrollLeft($(document).scrollLeft()+f.scrollSpeed))),g!==!1&&$.coral.ddmanager&&!f.dropBehaviour&&$.coral.ddmanager.prepareOffsets(this,a)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),b=this.items.length-1;b>=0;b--)if(c=this.items[b],d=c.item[0],e=this._intersectsWithPointer(c),e&&c.instance===this.currentContainer&&d!==this.currentItem[0]&&this.placeholder[1===e?"next":"prev"]()[0]!==d&&!$.contains(this.placeholder[0],d)&&("semi-dynamic"===this.options.type?!$.contains(this.element[0],d):!0)){if(this.direction=1===e?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(c))break;this._rearrange(a,c),this._trigger("change",a,this._uiHash());break}return this._contactContainers(a),$.coral.ddmanager&&$.coral.ddmanager.drag(this,a),this._trigger("sort",a,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(a,b){if(a){if($.coral.ddmanager&&!this.options.dropBehaviour&&$.coral.ddmanager.drop(this,a),this.options.revert){var c=this,d=this.placeholder.offset(),e=this.options.axis,f={};e&&"x"!==e||(f.left=d.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),e&&"y"!==e||(f.top=d.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,$(this.helper).animate(f,parseInt(this.options.revert,10)||500,function(){c._clear(a)})}else this._clear(a,b);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("coral-sortable-helper"):this.currentItem.show();for(var a=this.containers.length-1;a>=0;a--)this.containers[a]._trigger("deactivate",null,this._uiHash(this)),this.containers[a].containerCache.over&&(this.containers[a]._trigger("out",null,this._uiHash(this)),this.containers[a].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),$.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?$(this.domPosition.prev).after(this.currentItem):$(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(a){var b=this._getItemsAsjQuery(a&&a.connected),c=[];return a=a||{},$(b).each(function(){var b=($(a.item||this).attr(a.attribute||"id")||"").match(a.expression||/(.+)[\-=_](.+)/);b&&c.push((a.key||b[1]+"[]")+"="+(a.key&&a.expression?b[1]:b[2]))}),!c.length&&a.key&&c.push(a.key+"="),c.join("&")},toArray:function(a){var b=this._getItemsAsjQuery(a&&a.connected),c=[];return a=a||{},b.each(function(){c.push($(a.item||this).attr(a.attribute||"id")||"")}),c},_intersectsWith:function(a){var b=this.positionAbs.left,c=b+this.helperProportions.width,d=this.positionAbs.top,e=d+this.helperProportions.height,f=a.left,g=f+a.width,h=a.top,i=h+a.height,j=this.offset.click.top,k=this.offset.click.left,l="x"===this.options.axis||d+j>h&&i>d+j,m="y"===this.options.axis||b+k>f&&g>b+k,n=l&&m;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?n:f<b+this.helperProportions.width/2&&c-this.helperProportions.width/2<g&&h<d+this.helperProportions.height/2&&e-this.helperProportions.height/2<i},_intersectsWithPointer:function(b){var c="x"===this.options.axis||a(this.positionAbs.top+this.offset.click.top,b.top,b.height),d="y"===this.options.axis||a(this.positionAbs.left+this.offset.click.left,b.left,b.width),e=c&&d,f=this._getDragVerticalDirection(),g=this._getDragHorizontalDirection();return e?this.floating?g&&"right"===g||"down"===f?2:1:f&&("down"===f?2:1):!1},_intersectsWithSides:function(b){var c=a(this.positionAbs.top+this.offset.click.top,b.top+b.height/2,b.height),d=a(this.positionAbs.left+this.offset.click.left,b.left+b.width/2,b.width),e=this._getDragVerticalDirection(),f=this._getDragHorizontalDirection();return this.floating&&f?"right"===f&&d||"left"===f&&!d:e&&("down"===e&&c||"up"===e&&!c)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return 0!==a&&(a>0?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;return 0!==a&&(a>0?"right":"left")},refresh:function(a){return this._refreshItems(a),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var a=this.options;return a.connectWith.constructor===String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(a){var b,c,d,e,f=[],g=[],h=this._connectWith();if(h&&a)for(b=h.length-1;b>=0;b--)for(d=$(h[b]),c=d.length-1;c>=0;c--)e=$.data(d[c],this.componentFullName),e&&e!==this&&!e.options.disabled&&g.push([$.isFunction(e.options.items)?e.options.items.call(e.element):$(e.options.items,e.element).not(".coral-sortable-helper").not(".coral-sortable-placeholder"),e]);for(g.push([$.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):$(this.options.items,this.element).not(".coral-sortable-helper").not(".coral-sortable-placeholder"),this]),b=g.length-1;b>=0;b--)g[b][0].each(function(){f.push(this)});return $(f)},_removeCurrentsFromItems:function(){var a=this.currentItem.find(":data("+this.componentName+"-item)");this.items=$.grep(this.items,function(b){for(var c=0;c<a.length;c++)if(a[c]===b.item[0])return!1;return!0})},_refreshItems:function(a){this.items=[],this.containers=[this];var b,c,d,e,f,g,h,i,j=this.items,k=[[$.isFunction(this.options.items)?this.options.items.call(this.element[0],a,{item:this.currentItem}):$(this.options.items,this.element),this]],l=this._connectWith();if(l&&this.ready)for(b=l.length-1;b>=0;b--)for(d=$(l[b]),c=d.length-1;c>=0;c--)e=$.data(d[c],this.componentFullName),e&&e!==this&&!e.options.disabled&&(k.push([$.isFunction(e.options.items)?e.options.items.call(e.element[0],a,{item:this.currentItem}):$(e.options.items,e.element),e]),this.containers.push(e));for(b=k.length-1;b>=0;b--)for(f=k[b][1],g=k[b][0],c=0,i=g.length;i>c;c++)h=$(g[c]),h.data(this.componentName+"-item",f),j.push({item:h,instance:f,width:0,height:0,left:0,top:0})},refreshPositions:function(a){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var b,c,d,e;for(b=this.items.length-1;b>=0;b--)c=this.items[b],c.instance!==this.currentContainer&&this.currentContainer&&c.item[0]!==this.currentItem[0]||(d=this.options.toleranceElement?$(this.options.toleranceElement,c.item):c.item,a||(c.width=d.outerWidth(),c.height=d.outerHeight()),e=d.offset(),c.left=e.left,c.top=e.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(b=this.containers.length-1;b>=0;b--)e=this.containers[b].element.offset(),this.containers[b].containerCache.left=e.left,this.containers[b].containerCache.top=e.top,this.containers[b].containerCache.width=this.containers[b].element.outerWidth(),this.containers[b].containerCache.height=this.containers[b].element.outerHeight();return this},_createPlaceholder:function(a){a=a||this;var b,c=a.options;c.placeholder&&c.placeholder.constructor!==String||(b=c.placeholder,c.placeholder={element:function(){var c=a.currentItem[0].nodeName.toLowerCase(),d=$("<"+c+">",a.document[0]).addClass(b||a.currentItem[0].className+" coral-sortable-placeholder").removeClass("coral-sortable-helper");return"tr"===c?a.currentItem.children().each(function(){$("<td>&#160;</td>",a.document[0]).attr("colspan",$(this).attr("colspan")||1).appendTo(d)}):"img"===c&&d.attr("src",a.currentItem.attr("src")),b||d.css("visibility","hidden"),d},update:function(d,e){b&&!c.forcePlaceholderSize||(e.height()||e.height(a.currentItem.innerHeight()-parseInt(a.currentItem.css("paddingTop")||0,10)-parseInt(a.currentItem.css("paddingBottom")||0,10)),e.width()||e.width(a.currentItem.innerWidth()-parseInt(a.currentItem.css("paddingLeft")||0,10)-parseInt(a.currentItem.css("paddingRight")||0,10)))}}),a.placeholder=$(c.placeholder.element.call(a.element,a.currentItem)),a.currentItem.after(a.placeholder),c.placeholder.update(a,a.placeholder)},_contactContainers:function(a){var c,d,e,f,g,h,i,j,k,l,m=null,n=null;for(c=this.containers.length-1;c>=0;c--)if(!$.contains(this.currentItem[0],this.containers[c].element[0]))if(this._intersectsWith(this.containers[c].containerCache)){if(m&&$.contains(this.containers[c].element[0],m.element[0]))continue;m=this.containers[c],n=c}else this.containers[c].containerCache.over&&(this.containers[c]._trigger("out",a,this._uiHash(this)),this.containers[c].containerCache.over=0);if(m)if(1===this.containers.length)this.containers[n].containerCache.over||(this.containers[n]._trigger("over",a,this._uiHash(this)),this.containers[n].containerCache.over=1);else{for(e=1e4,f=null,k=m.floating||b(this.currentItem),g=k?"left":"top",h=k?"width":"height",l=k?"clientX":"clientY",d=this.items.length-1;d>=0;d--)$.contains(this.containers[n].element[0],this.items[d].item[0])&&this.items[d].item[0]!==this.currentItem[0]&&(i=this.items[d].item.offset()[g],j=!1,a[l]-i>this.items[d][h]/2&&(j=!0),Math.abs(a[l]-i)<e&&(e=Math.abs(a[l]-i),f=this.items[d],this.direction=j?"up":"down"));if(!f&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[n])return;f?this._rearrange(a,f,null,!0):this._rearrange(a,null,this.containers[n].element,!0),this._trigger("change",a,this._uiHash()),this.containers[n]._trigger("change",a,this._uiHash(this)),this.currentContainer=this.containers[n],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[n]._trigger("over",a,this._uiHash(this)),this.containers[n].containerCache.over=1}},_createHelper:function(a){var b=this.options,c=$.isFunction(b.helper)?$(b.helper.apply(this.element[0],[a,this.currentItem])):"clone"===b.helper?this.currentItem.clone():this.currentItem;return c.parents("body").length||$("parent"!==b.appendTo?b.appendTo:this.currentItem[0].parentNode)[0].appendChild(c[0]),c[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),c[0].style.width&&!b.forceHelperSize||c.width(this.currentItem.width()),c[0].style.height&&!b.forceHelperSize||c.height(this.currentItem.height()),c},_adjustOffsetFromHelper:function(a){"string"==typeof a&&(a=a.split(" ")),$.isArray(a)&&(a={left:+a[0],top:+a[1]||0}),"left"in a&&(this.offset.click.left=a.left+this.margins.left),"right"in a&&(this.offset.click.left=this.helperProportions.width-a.right+this.margins.left),"top"in a&&(this.offset.click.top=a.top+this.margins.top),"bottom"in a&&(this.offset.click.top=this.helperProportions.height-a.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var a=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])&&(a.left+=this.scrollParent.scrollLeft(),a.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&$.coral.ie)&&(a={top:0,left:0}),{top:a.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:a.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var a,b,c,d=this.options;"parent"===d.containment&&(d.containment=this.helper[0].parentNode),"document"!==d.containment&&"window"!==d.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,$("document"===d.containment?document:window).width()-this.helperProportions.width-this.margins.left,($("document"===d.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(d.containment)||(a=$(d.containment)[0],b=$(d.containment).offset(),c="hidden"!==$(a).css("overflow"),this.containment=[b.left+(parseInt($(a).css("borderLeftWidth"),10)||0)+(parseInt($(a).css("paddingLeft"),10)||0)-this.margins.left,b.top+(parseInt($(a).css("borderTopWidth"),10)||0)+(parseInt($(a).css("paddingTop"),10)||0)-this.margins.top,b.left+(c?Math.max(a.scrollWidth,a.offsetWidth):a.offsetWidth)-(parseInt($(a).css("borderLeftWidth"),10)||0)-(parseInt($(a).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,b.top+(c?Math.max(a.scrollHeight,a.offsetHeight):a.offsetHeight)-(parseInt($(a).css("borderTopWidth"),10)||0)-(parseInt($(a).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(a,b){b||(b=this.position);var c="absolute"===a?1:-1,d="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,e=/(html|body)/i.test(d[0].tagName);return{top:b.top+this.offset.relative.top*c+this.offset.parent.top*c-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():e?0:d.scrollTop())*c,left:b.left+this.offset.relative.left*c+this.offset.parent.left*c-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():e?0:d.scrollLeft())*c}},_generatePosition:function(a){var b,c,d=this.options,e=a.pageX,f=a.pageY,g="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=/(html|body)/i.test(g[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(a.pageX-this.offset.click.left<this.containment[0]&&(e=this.containment[0]+this.offset.click.left),a.pageY-this.offset.click.top<this.containment[1]&&(f=this.containment[1]+this.offset.click.top),a.pageX-this.offset.click.left>this.containment[2]&&(e=this.containment[2]+this.offset.click.left),a.pageY-this.offset.click.top>this.containment[3]&&(f=this.containment[3]+this.offset.click.top)),d.grid&&(b=this.originalPageY+Math.round((f-this.originalPageY)/d.grid[1])*d.grid[1],f=this.containment?b-this.offset.click.top>=this.containment[1]&&b-this.offset.click.top<=this.containment[3]?b:b-this.offset.click.top>=this.containment[1]?b-d.grid[1]:b+d.grid[1]:b,c=this.originalPageX+Math.round((e-this.originalPageX)/d.grid[0])*d.grid[0],e=this.containment?c-this.offset.click.left>=this.containment[0]&&c-this.offset.click.left<=this.containment[2]?c:c-this.offset.click.left>=this.containment[0]?c-d.grid[0]:c+d.grid[0]:c)),{top:f-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():h?0:g.scrollTop()),left:e-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():h?0:g.scrollLeft())}},_rearrange:function(a,b,c,d){c?c[0].appendChild(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?b.item[0]:b.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var e=this.counter;this._delay(function(){e===this.counter&&this.refreshPositions(!d)})},_clear:function(a,b){this.reverting=!1;var c,d=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(c in this._storedCSS)"auto"!==this._storedCSS[c]&&"static"!==this._storedCSS[c]||(this._storedCSS[c]="");this.currentItem.css(this._storedCSS).removeClass("coral-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!b&&d.push(function(a){this._trigger("receive",a,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".coral-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||b||d.push(function(a){this._trigger("update",a,this._uiHash())}),this!==this.currentContainer&&(b||(d.push(function(a){this._trigger("remove",a,this._uiHash())}),d.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.currentContainer)),d.push(function(a){return function(b){a._trigger("update",b,this._uiHash(this))}}.call(this,this.currentContainer)))),c=this.containers.length-1;c>=0;c--)b||d.push(function(a){return function(b){a._trigger("deactivate",b,this._uiHash(this))}}.call(this,this.containers[c])),this.containers[c].containerCache.over&&(d.push(function(a){return function(b){a._trigger("out",b,this._uiHash(this))}}.call(this,this.containers[c])),this.containers[c].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!b){for(this._trigger("beforeStop",a,this._uiHash()),c=0;c<d.length;c++)d[c].call(this,a);this._trigger("stop",a,this._uiHash())}return this.fromOutside=!1,!1}if(b||this._trigger("beforeStop",a,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!b){for(c=0;c<d.length;c++)d[c].call(this,a);this._trigger("stop",a,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){$.Component.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(a){var b=a||this;return{helper:b.helper,placeholder:b.placeholder||$([]),position:b.position,originalPosition:b.originalPosition,offset:b.positionAbs,item:b.currentItem,sender:a?a.element:null}}})}();/*! cui 2016-11-08 */
!function(){$.component("coral.draggable",$.coral.mouse,{version:"4.0.1",componentEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("coral-draggable"),this.options.disabled&&this.element.addClass("coral-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(a,b){this._super(a,b),"handle"===a&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".coral-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("coral-draggable coral-draggable-dragging coral-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(a){var b=this.document[0],c=this.options;try{b.activeElement&&"body"!==b.activeElement.nodeName.toLowerCase()&&$(b.activeElement).blur()}catch(d){}return this.helper||c.disabled||$(a.target).closest(".coral-resizable-handle").length>0?!1:(this.handle=this._getHandle(a),this.handle?($(c.iframeFix===!0?"iframe":c.iframeFix).each(function(){$("<div class='coral-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css($(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(a){var b=this.options;return this.helper=this._createHelper(a),this.helper.addClass("coral-draggable-dragging"),this._cacheHelperProportions(),$.coral.ddmanager&&($.coral.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,$.extend(this.offset,{click:{left:a.pageX-this.offset.left,top:a.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(a,!1),this.originalPageX=a.pageX,this.originalPageY=a.pageY,b.cursorAt&&this._adjustOffsetFromHelper(b.cursorAt),this._setContainment(),this._trigger("start",a)===!1?(this._clear(),!1):(this._cacheHelperProportions(),$.coral.ddmanager&&!b.dropBehaviour&&$.coral.ddmanager.prepareOffsets(this,a),this._mouseDrag(a,!0),$.coral.ddmanager&&$.coral.ddmanager.dragStart(this,a),!0)},_mouseDrag:function(a,b){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(a,!0),this.positionAbs=this._convertPositionTo("absolute"),!b){var c=this._uiHash();if(this._trigger("drag",a,c)===!1)return this._mouseUp({}),!1;this.position=c.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",$.coral.ddmanager&&$.coral.ddmanager.drag(this,a),!1},_mouseStop:function(a){var b=this,c=!1;return $.coral.ddmanager&&!this.options.dropBehaviour&&(c=$.coral.ddmanager.drop(this,a)),this.dropped&&(c=this.dropped,this.dropped=!1),"original"!==this.options.helper||$.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!c||"valid"===this.options.revert&&c||this.options.revert===!0||$.isFunction(this.options.revert)&&this.options.revert.call(this.element,c)?$(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){b._trigger("stop",a)!==!1&&b._clear()}):this._trigger("stop",a)!==!1&&this._clear(),!1):!1},_mouseUp:function(a){return $("div.coral-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),$.coral.ddmanager&&$.coral.ddmanager.dragStop(this,a),this.element.focus(),$.coral.mouse.prototype._mouseUp.call(this,a)},cancel:function(){return this.helper.is(".coral-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(a){return this.options.handle?!!$(a.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("coral-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("coral-draggable-handle")},_createHelper:function(a){var b=this.options,c=$.isFunction(b.helper)?$(b.helper.apply(this.element[0],[a])):"clone"===b.helper?this.element.clone().removeAttr("id"):this.element;return c.parents("body").length||c.appendTo("parent"===b.appendTo?this.element[0].parentNode:b.appendTo),c[0]===this.element[0]||/(fixed|absolute)/.test(c.css("position"))||c.css("position","absolute"),c},_adjustOffsetFromHelper:function(a){"string"==typeof a&&(a=a.split(" ")),$.isArray(a)&&(a={left:+a[0],top:+a[1]||0}),"left"in a&&(this.offset.click.left=a.left+this.margins.left),"right"in a&&(this.offset.click.left=this.helperProportions.width-a.right+this.margins.left),"top"in a&&(this.offset.click.top=a.top+this.margins.top),"bottom"in a&&(this.offset.click.top=this.helperProportions.height-a.bottom+this.margins.top)},_isRootNode:function(a){return/(html|body)/i.test(a.tagName)||a===this.document[0]},_getParentOffset:function(){var a=this.offsetParent.offset(),b=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==b&&$.contains(this.scrollParent[0],this.offsetParent[0])&&(a.left+=this.scrollParent.scrollLeft(),a.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(a={top:0,left:0}),{top:a.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:a.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var a=this.element.position(),b=this._isRootNode(this.scrollParent[0]);return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+(b?0:this.scrollParent.scrollTop()),left:a.left-(parseInt(this.helper.css("left"),10)||0)+(b?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var a,b,c,d=this.options,e=this.document[0];return this.relativeContainer=null,d.containment?"window"===d.containment?void(this.containment=[$(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,$(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,$(window).scrollLeft()+$(window).width()-this.helperProportions.width-this.margins.left,$(window).scrollTop()+($(window).height()||e.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===d.containment?void(this.containment=[0,0,$(e).width()-this.helperProportions.width-this.margins.left,($(e).height()||e.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):d.containment.constructor===Array?void(this.containment=d.containment):("parent"===d.containment&&(d.containment=this.helper[0].parentNode),b=$(d.containment),c=b[0],void(c&&(a="hidden"!==b.css("overflow"),this.containment=[(parseInt(b.css("borderLeftWidth"),10)||0)+(parseInt(b.css("paddingLeft"),10)||0),(parseInt(b.css("borderTopWidth"),10)||0)+(parseInt(b.css("paddingTop"),10)||0),(a?Math.max(c.scrollWidth,c.offsetWidth):c.offsetWidth)-(parseInt(b.css("borderRightWidth"),10)||0)-(parseInt(b.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(a?Math.max(c.scrollHeight,c.offsetHeight):c.offsetHeight)-(parseInt(b.css("borderBottomWidth"),10)||0)-(parseInt(b.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=b))):void(this.containment=null)},_convertPositionTo:function(a,b){b||(b=this.position);var c="absolute"===a?1:-1,d=this._isRootNode(this.scrollParent[0]);return{top:b.top+this.offset.relative.top*c+this.offset.parent.top*c-("fixed"===this.cssPosition?-this.offset.scroll.top:d?0:this.offset.scroll.top)*c,left:b.left+this.offset.relative.left*c+this.offset.parent.left*c-("fixed"===this.cssPosition?-this.offset.scroll.left:d?0:this.offset.scroll.left)*c}},_generatePosition:function(a,b){var c,d,e,f,g=this.options,h=this._isRootNode(this.scrollParent[0]),i=a.pageX,j=a.pageY;return h&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),b&&(this.containment&&(this.relativeContainer?(d=this.relativeContainer.offset(),c=[this.containment[0]+d.left,this.containment[1]+d.top,this.containment[2]+d.left,this.containment[3]+d.top]):c=this.containment,a.pageX-this.offset.click.left<c[0]&&(i=c[0]+this.offset.click.left),a.pageY-this.offset.click.top<c[1]&&(j=c[1]+this.offset.click.top),a.pageX-this.offset.click.left>c[2]&&(i=c[2]+this.offset.click.left),a.pageY-this.offset.click.top>c[3]&&(j=c[3]+this.offset.click.top)),g.grid&&(e=g.grid[1]?this.originalPageY+Math.round((j-this.originalPageY)/g.grid[1])*g.grid[1]:this.originalPageY,j=c?e-this.offset.click.top>=c[1]||e-this.offset.click.top>c[3]?e:e-this.offset.click.top>=c[1]?e-g.grid[1]:e+g.grid[1]:e,f=g.grid[0]?this.originalPageX+Math.round((i-this.originalPageX)/g.grid[0])*g.grid[0]:this.originalPageX,i=c?f-this.offset.click.left>=c[0]||f-this.offset.click.left>c[2]?f:f-this.offset.click.left>=c[0]?f-g.grid[0]:f+g.grid[0]:f),"y"===g.axis&&(i=this.originalPageX),"x"===g.axis&&(j=this.originalPageY)),{top:j-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:h?0:this.offset.scroll.top),left:i-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:h?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("coral-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(a,b,c){return c=c||this._uiHash(),$.coral.plugin.call(this,a,[b,c,this],!0),"drag"===a&&(this.positionAbs=this._convertPositionTo("absolute")),$.Component.prototype._trigger.call(this,a,b,c)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),$.coral.plugin.add("draggable","connectToSortable",{start:function(a,b,c){var d=c.options,e=$.extend({},b,{item:c.element});c.sortables=[],$(d.connectToSortable).each(function(){var b=$.data(this,"coral-sortable");b&&!b.options.disabled&&(c.sortables.push({instance:b,shouldRevert:b.options.revert}),b.refreshPositions(),b._trigger("activate",a,e))})},stop:function(a,b,c){var d=$.extend({},b,{item:c.element});$.each(c.sortables,function(){this.instance.isOver?(this.instance.isOver=0,c.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(a),this.instance.options.helper=this.instance.options._helper,"original"===c.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",a,d))})},drag:function(a,b,c){var d=this;$.each(c.sortables,function(){var e=!1,f=this;this.instance.positionAbs=c.positionAbs,this.instance.helperProportions=c.helperProportions,this.instance.offset.click=c.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(e=!0,$.each(c.sortables,function(){return this.instance.positionAbs=c.positionAbs,this.instance.helperProportions=c.helperProportions,this.instance.offset.click=c.offset.click,this!==f&&this.instance._intersectsWith(this.instance.containerCache)&&$.contains(f.instance.element[0],this.instance.element[0])&&(e=!1),e})),e?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=$(d).clone().removeAttr("id").appendTo(this.instance.element).data("coral-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return b.helper[0]},a.target=this.instance.currentItem[0],this.instance._mouseCapture(a,!0),this.instance._mouseStart(a,!0,!0),this.instance.offset.click.top=c.offset.click.top,this.instance.offset.click.left=c.offset.click.left,this.instance.offset.parent.left-=c.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=c.offset.parent.top-this.instance.offset.parent.top,c._trigger("toSortable",a),c.dropped=this.instance.element,c.currentItem=c.element,this.instance.fromOutside=c),this.instance.currentItem&&this.instance._mouseDrag(a)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",a,this.instance._uiHash(this.instance)),this.instance._mouseStop(a,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),c._trigger("fromSortable",a),c.dropped=!1)})}}),$.coral.plugin.add("draggable","cursor",{start:function(a,b,c){var d=$("body"),e=c.options;d.css("cursor")&&(e._cursor=d.css("cursor")),d.css("cursor",e.cursor)},stop:function(a,b,c){var d=c.options;d._cursor&&$("body").css("cursor",d._cursor)}}),$.coral.plugin.add("draggable","opacity",{start:function(a,b,c){var d=$(b.helper),e=c.options;d.css("opacity")&&(e._opacity=d.css("opacity")),d.css("opacity",e.opacity)},stop:function(a,b,c){var d=c.options;d._opacity&&$(b.helper).css("opacity",d._opacity)}}),$.coral.plugin.add("draggable","scroll",{start:function(a,b,c){c.scrollParentNotHidden||(c.scrollParentNotHidden=c.helper.scrollParent(!1)),c.scrollParentNotHidden[0]!==c.document[0]&&"HTML"!==c.scrollParentNotHidden[0].tagName&&(c.overflowOffset=c.scrollParentNotHidden.offset())},drag:function(a,b,c){var d=c.options,e=!1,f=c.scrollParentNotHidden[0],g=c.document[0];f!==g&&"HTML"!==f.tagName?(d.axis&&"x"===d.axis||(c.overflowOffset.top+f.offsetHeight-a.pageY<d.scrollSensitivity?f.scrollTop=e=f.scrollTop+d.scrollSpeed:a.pageY-c.overflowOffset.top<d.scrollSensitivity&&(f.scrollTop=e=f.scrollTop-d.scrollSpeed)),d.axis&&"y"===d.axis||(c.overflowOffset.left+f.offsetWidth-a.pageX<d.scrollSensitivity?f.scrollLeft=e=f.scrollLeft+d.scrollSpeed:a.pageX-c.overflowOffset.left<d.scrollSensitivity&&(f.scrollLeft=e=f.scrollLeft-d.scrollSpeed))):(d.axis&&"x"===d.axis||(a.pageY-$(g).scrollTop()<d.scrollSensitivity?e=$(g).scrollTop($(g).scrollTop()-d.scrollSpeed):$(window).height()-(a.pageY-$(g).scrollTop())<d.scrollSensitivity&&(e=$(g).scrollTop($(g).scrollTop()+d.scrollSpeed))),d.axis&&"y"===d.axis||(a.pageX-$(g).scrollLeft()<d.scrollSensitivity?e=$(g).scrollLeft($(g).scrollLeft()-d.scrollSpeed):$(window).width()-(a.pageX-$(g).scrollLeft())<d.scrollSensitivity&&(e=$(g).scrollLeft($(g).scrollLeft()+d.scrollSpeed)))),e!==!1&&$.coral.ddmanager&&!d.dropBehaviour&&$.coral.ddmanager.prepareOffsets(c,a)}}),$.coral.plugin.add("draggable","snap",{start:function(a,b,c){var d=c.options;c.snapElements=[],$(d.snap.constructor!==String?d.snap.items||":data(coral-draggable)":d.snap).each(function(){var a=$(this),b=a.offset();this!==c.element[0]&&c.snapElements.push({item:this,width:a.outerWidth(),height:a.outerHeight(),top:b.top,left:b.left})})},drag:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=c.options,o=n.snapTolerance,p=b.offset.left,q=p+c.helperProportions.width,r=b.offset.top,s=r+c.helperProportions.height;for(l=c.snapElements.length-1;l>=0;l--)h=c.snapElements[l].left,i=h+c.snapElements[l].width,j=c.snapElements[l].top,k=j+c.snapElements[l].height,h-o>q||p>i+o||j-o>s||r>k+o||!$.contains(c.snapElements[l].item.ownerDocument,c.snapElements[l].item)?(c.snapElements[l].snapping&&c.options.snap.release&&c.options.snap.release.call(c.element,a,$.extend(c._uiHash(),{snapItem:c.snapElements[l].item})),c.snapElements[l].snapping=!1):("inner"!==n.snapMode&&(d=Math.abs(j-s)<=o,e=Math.abs(k-r)<=o,f=Math.abs(h-q)<=o,g=Math.abs(i-p)<=o,d&&(b.position.top=c._convertPositionTo("relative",{top:j-c.helperProportions.height,left:0}).top-c.margins.top),e&&(b.position.top=c._convertPositionTo("relative",{top:k,left:0}).top-c.margins.top),f&&(b.position.left=c._convertPositionTo("relative",{top:0,left:h-c.helperProportions.width}).left-c.margins.left),g&&(b.position.left=c._convertPositionTo("relative",{top:0,left:i}).left-c.margins.left)),m=d||e||f||g,"outer"!==n.snapMode&&(d=Math.abs(j-r)<=o,e=Math.abs(k-s)<=o,f=Math.abs(h-p)<=o,g=Math.abs(i-q)<=o,d&&(b.position.top=c._convertPositionTo("relative",{top:j,left:0}).top-c.margins.top),e&&(b.position.top=c._convertPositionTo("relative",{top:k-c.helperProportions.height,left:0}).top-c.margins.top),f&&(b.position.left=c._convertPositionTo("relative",{top:0,left:h}).left-c.margins.left),g&&(b.position.left=c._convertPositionTo("relative",{top:0,left:i-c.helperProportions.width}).left-c.margins.left)),!c.snapElements[l].snapping&&(d||e||f||g||m)&&c.options.snap.snap&&c.options.snap.snap.call(c.element,a,$.extend(c._uiHash(),{snapItem:c.snapElements[l].item})),c.snapElements[l].snapping=d||e||f||g||m)}}),$.coral.plugin.add("draggable","stack",{start:function(a,b,c){var d,e=c.options,f=$.makeArray($(e.stack)).sort(function(a,b){return(parseInt($(a).css("zIndex"),10)||0)-(parseInt($(b).css("zIndex"),10)||0)});f.length&&(d=parseInt($(f[0]).css("zIndex"),10)||0,$(f).each(function(a){$(this).css("zIndex",d+a)}),this.css("zIndex",d+f.length))}}),$.coral.plugin.add("draggable","zIndex",{start:function(a,b,c){var d=$(b.helper),e=c.options;d.css("zIndex")&&(e._zIndex=d.css("zIndex")),d.css("zIndex",e.zIndex)},stop:function(a,b,c){var d=c.options;d._zIndex&&$(b.helper).css("zIndex",d._zIndex)}})}();/*! cui 2016-11-08 */
!function(){$.component("coral.droppable",{version:"4.0.1",componentEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var a,b=this.options,c=b.accept;this.isover=!1,this.isout=!0,this.accept=$.isFunction(c)?c:function(a){return a.is(c)},this.proportions=function(){return arguments.length?void(a=arguments[0]):a?a:a={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(b.scope),b.addClasses&&this.element.addClass("coral-droppable")},_addToManager:function(a){$.coral.ddmanager.droppables[a]=$.coral.ddmanager.droppables[a]||[],$.coral.ddmanager.droppables[a].push(this)},_splice:function(a){for(var b=0;b<a.length;b++)a[b]===this&&a.splice(b,1)},_destroy:function(){var a=$.coral.ddmanager.droppables[this.options.scope];this._splice(a),this.element.removeClass("coral-droppable coral-droppable-disabled")},_setOption:function(a,b){if("accept"===a)this.accept=$.isFunction(b)?b:function(a){return a.is(b)};else if("scope"===a){var c=$.coral.ddmanager.droppables[this.options.scope];this._splice(c),this._addToManager(b)}this._super(a,b)},_activate:function(a){var b=$.coral.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),b&&this._trigger("activate",a,this.ui(b))},_deactivate:function(a){var b=$.coral.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),b&&this._trigger("deactivate",a,this.ui(b))},_over:function(a){var b=$.coral.ddmanager.current;b&&(b.currentItem||b.element)[0]!==this.element[0]&&this.accept.call(this.element[0],b.currentItem||b.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",a,this.ui(b)))},_out:function(a){var b=$.coral.ddmanager.current;b&&(b.currentItem||b.element)[0]!==this.element[0]&&this.accept.call(this.element[0],b.currentItem||b.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",a,this.ui(b)))},_drop:function(a,b){var c=b||$.coral.ddmanager.current,d=!1;return c&&(c.currentItem||c.element)[0]!==this.element[0]?(this.element.find(":data(coral-droppable)").not(".coral-draggable-dragging").each(function(){var b=$.data(this,"coral-droppable");return b.options.greedy&&!b.options.disabled&&b.options.scope===c.options.scope&&b.accept.call(b.element[0],c.currentItem||c.element)&&$.coral.intersect(c,$.extend(b,{offset:b.element.offset()}),b.options.tolerance,a)?(d=!0,!1):void 0}),d?!1:this.accept.call(this.element[0],c.currentItem||c.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",a,this.ui(c)),this.element):!1):!1},ui:function(a){return{draggable:a.currentItem||a.element,helper:a.helper,position:a.position,offset:a.positionAbs}}}),$.coral.intersect=function(){function a(a,b,c){return a>=b&&b+c>a}return function(b,c,d,e){if(!c.offset)return!1;var f=(b.positionAbs||b.position.absolute).left,g=(b.positionAbs||b.position.absolute).top,h=f+b.helperProportions.width,i=g+b.helperProportions.height,j=c.offset.left,k=c.offset.top,l=j+c.proportions().width,m=k+c.proportions().height;switch(d){case"fit":return f>=j&&l>=h&&g>=k&&m>=i;case"intersect":return j<f+b.helperProportions.width/2&&h-b.helperProportions.width/2<l&&k<g+b.helperProportions.height/2&&i-b.helperProportions.height/2<m;case"pointer":return a(e.pageY,k,c.proportions().height)&&a(e.pageX,j,c.proportions().width);case"touch":return(g>=k&&m>=g||i>=k&&m>=i||k>g&&i>m)&&(f>=j&&l>=f||h>=j&&l>=h||j>f&&h>l);default:return!1}}}(),$.coral.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(a,b){var c,d,e=$.coral.ddmanager.droppables[a.options.scope]||[],f=b?b.type:null,g=(a.currentItem||a.element).find(":data(coral-droppable)").addBack();a:for(c=0;c<e.length;c++)if(!(e[c].options.disabled||a&&!e[c].accept.call(e[c].element[0],a.currentItem||a.element))){for(d=0;d<g.length;d++)if(g[d]===e[c].element[0]){e[c].proportions().height=0;continue a}e[c].visible="none"!==e[c].element.css("display"),e[c].visible&&("mousedown"===f&&e[c]._activate.call(e[c],b),e[c].offset=e[c].element.offset(),e[c].proportions({width:e[c].element[0].offsetWidth,height:e[c].element[0].offsetHeight}))}},drop:function(a,b){var c=!1;return $.each(($.coral.ddmanager.droppables[a.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&$.coral.intersect(a,this,this.options.tolerance,b)&&(c=this._drop.call(this,b)||c),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],a.currentItem||a.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,b)))}),c},dragStart:function(a,b){a.element.parentsUntil("body").bind("scroll.droppable",function(){a.options.refreshPositions||$.coral.ddmanager.prepareOffsets(a,b)})},drag:function(a,b){a.options.refreshPositions&&$.coral.ddmanager.prepareOffsets(a,b),$.each($.coral.ddmanager.droppables[a.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var c,d,e,f=$.coral.intersect(a,this,this.options.tolerance,b),g=!f&&this.isover?"isout":f&&!this.isover?"isover":null;g&&(this.options.greedy&&(d=this.options.scope,e=this.element.parents(":data(coral-droppable)").filter(function(){return $.data(this,"coral-droppable").options.scope===d}),e.length&&(c=$.data(e[0],"coral-droppable"),c.greedyChild="isover"===g)),c&&"isover"===g&&(c.isover=!1,c.isout=!0,c._out.call(c,b)),this[g]=!0,this["isout"===g?"isover":"isout"]=!1,this["isover"===g?"_over":"_out"].call(this,b),c&&"isout"===g&&(c.isout=!1,c.isover=!0,c._over.call(c,b)))}})},dragStop:function(a,b){a.element.parentsUntil("body").unbind("scroll.droppable"),a.options.refreshPositions||$.coral.ddmanager.prepareOffsets(a,b)}}}();/*! cui 2016-11-08 */
!function(){function a(a){return parseInt(a,10)||0}function b(a){return!isNaN(parseInt(a,10))}function c(a,b){if("hidden"===$(a).css("overflow"))return!1;var c=b&&"left"===b?"scrollLeft":"scrollTop",d=!1;return a[c]>0?!0:(a[c]=1,d=a[c]>0,a[c]=0,d)}$.component("coral.resizable",$.coral.mouse,{version:"4.0.1",componentEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,layout:!1,helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var a,b,c,d,e,f=this,g=this.options;if(this.element.addClass("coral-resizable"),$.extend(this,{_aspectRatio:!!g.aspectRatio,aspectRatio:g.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:g.helper||g.ghost||g.animate?g.helper||"coral-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap($("<div class='coral-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("coral-resizable",this.element.data("coral-resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=g.handles||($(".coral-resizable-handle",this.element).length?{n:".coral-resizable-n",e:".coral-resizable-e",s:".coral-resizable-s",w:".coral-resizable-w",se:".coral-resizable-se",sw:".coral-resizable-sw",ne:".coral-resizable-ne",nw:".coral-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),a=this.handles.split(","),this.handles={},b=0;b<a.length;b++)c=$.trim(a[b]),e="coral-resizable-"+c,d=$("<div class='coral-resizable-handle "+e+"'></div>"),d.css({zIndex:g.zIndex}),"se"===c&&d.addClass("coral-icon coral-icon-gripsmall-diagonal-se"),this.handles[c]=".coral-resizable-"+c,this.element.append(d);this._renderAxis=function(a){var b,c,d,e;a=a||this.element;for(b in this.handles)this.handles[b].constructor===String&&(this.handles[b]=this.element.children(this.handles[b]).first().show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(c=$(this.handles[b],this.element),e=/sw|ne|nw|se|n|s/.test(b)?c.outerHeight():c.outerWidth(),d=["padding",/ne|nw|n/.test(b)?"Top":/se|sw|s/.test(b)?"Bottom":/^e$/.test(b)?"Right":"Left"].join(""),a.css(d,e),this._proportionallyResize()),$(this.handles[b]).length},this._renderAxis(this.element),this._handles=$(".coral-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){f.resizing||(this.className&&(d=this.className.match(/coral-resizable-(se|sw|ne|nw|n|e|s|w)/i)),f.axis=d&&d[1]?d[1]:"se")}),g.autoHide&&(this._handles.hide(),$(this.element).addClass("coral-resizable-autohide").mouseenter(function(){g.disabled||($(this).removeClass("coral-resizable-autohide"),f._handles.show())}).mouseleave(function(){g.disabled||f.resizing||($(this).addClass("coral-resizable-autohide"),f._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var a,b=function(a){$(a).removeClass("coral-resizable coral-resizable-disabled coral-resizable-resizing").removeData("resizable").removeData("coral-resizable").unbind(".resizable").find(".coral-resizable-handle").remove()};return this.elementIsWrapper&&(b(this.element),a=this.element,this.originalElement.css({position:a.css("position"),width:a.outerWidth(),height:a.outerHeight(),top:a.css("top"),left:a.css("left")}).insertAfter(a),a.remove()),this.originalElement.css("resize",this.originalResizeStyle),b(this.originalElement),this},_mouseCapture:function(a){var b,c,d=!1;for(b in this.handles)c=$(this.handles[b])[0],(c===a.target||$.contains(c,a.target))&&(d=!0);return!this.options.disabled&&d},_mouseStart:function(b){var c,d,e,f=this.options,g=this.element;return this.resizing=!0,this._renderProxy(),c=a(this.helper.css("left")),d=a(this.helper.css("top")),f.containment&&(c+=$(f.containment).scrollLeft()||0,d+=$(f.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:c,top:d},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:g.width(),height:g.height()},this.originalSize=this._helper?{width:g.outerWidth(),height:g.outerHeight()}:{width:g.width(),height:g.height()},this.originalPosition={left:c,top:d},this.sizeDiff={width:g.outerWidth()-g.width(),height:g.outerHeight()-g.height()},this.originalMousePosition={left:b.pageX,top:b.pageY},this.aspectRatio="number"==typeof f.aspectRatio?f.aspectRatio:this.originalSize.width/this.originalSize.height||1,e=$(".coral-resizable-"+this.axis).css("cursor"),$("body").css("cursor","auto"===e?this.axis+"-resize":e),g.addClass("coral-resizable-resizing"),this._propagate("start",b),!0},_mouseDrag:function(a){var b,c,d=this.originalMousePosition,e=this.axis,f=a.pageX-d.left||0,g=a.pageY-d.top||0,h=this._change[e];return this._updatePrevProperties(),h?(b=h.apply(this,[a,f,g]),this._updateVirtualBoundaries(a.shiftKey),(this._aspectRatio||a.shiftKey)&&(b=this._updateRatio(b,a)),b=this._respectSize(b,a),this._updateCache(b),this._propagate("resize",a),c=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),$.isEmptyObject(c)||(this._updatePrevProperties(),this._trigger("resize",a,this.ui()),this._applyChanges()),!1):!1},_mouseStop:function(a){this.resizing=!1;var b,d,e,f,g,h,i,j=this.options,k=this;return this._helper&&(b=this._proportionallyResizeElements,d=b.length&&/textarea/i.test(b[0].nodeName),e=d&&c(b[0],"left")?0:k.sizeDiff.height,f=d?0:k.sizeDiff.width,g={width:k.helper.width()-f,height:k.helper.height()-e},h=parseInt(k.element.css("left"),10)+(k.position.left-k.originalPosition.left)||null,i=parseInt(k.element.css("top"),10)+(k.position.top-k.originalPosition.top)||null,j.animate||this.element.css($.extend(g,{top:i,left:h})),k.helper.height(k.size.height),k.helper.width(k.size.width),this._helper&&!j.animate&&this._proportionallyResize()),$("body").css("cursor","auto"),this.element.removeClass("coral-resizable-resizing"),this._propagate("stop",a,this.ui()),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var a={};return this.position.top!==this.prevPosition.top&&(a.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(a.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(a.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(a.height=this.size.height+"px"),this.helper.css(a),a},_updateVirtualBoundaries:function(a){var c,d,e,f,g,h=this.options;g={minWidth:b(h.minWidth)?h.minWidth:0,maxWidth:b(h.maxWidth)?h.maxWidth:1/0,minHeight:b(h.minHeight)?h.minHeight:0,maxHeight:b(h.maxHeight)?h.maxHeight:1/0},(this._aspectRatio||a)&&(c=g.minHeight*this.aspectRatio,e=g.minWidth/this.aspectRatio,d=g.maxHeight*this.aspectRatio,f=g.maxWidth/this.aspectRatio,c>g.minWidth&&(g.minWidth=c),e>g.minHeight&&(g.minHeight=e),d<g.maxWidth&&(g.maxWidth=d),f<g.maxHeight&&(g.maxHeight=f)),this._vBoundaries=g},_updateCache:function(a){this.offset=this.helper.offset(),b(a.left)&&(this.position.left=a.left),b(a.top)&&(this.position.top=a.top),b(a.height)&&(this.size.height=a.height),b(a.width)&&(this.size.width=a.width)},_updateRatio:function(a){var c=this.position,d=this.size,e=this.axis;return b(a.height)?a.width=a.height*this.aspectRatio:b(a.width)&&(a.height=a.width/this.aspectRatio),"sw"===e&&(a.left=c.left+(d.width-a.width),a.top=null),"nw"===e&&(a.top=c.top+(d.height-a.height),a.left=c.left+(d.width-a.width)),a},_respectSize:function(a){var c=this._vBoundaries,d=this.axis,e=b(a.width)&&c.maxWidth&&c.maxWidth<a.width,f=b(a.height)&&c.maxHeight&&c.maxHeight<a.height,g=b(a.width)&&c.minWidth&&c.minWidth>a.width,h=b(a.height)&&c.minHeight&&c.minHeight>a.height,i=this.originalPosition.left+this.originalSize.width,j=this.position.top+this.size.height,k=/sw|nw|w/.test(d),l=/nw|ne|n/.test(d);return g&&(a.width=c.minWidth),h&&(a.height=c.minHeight),e&&(a.width=c.maxWidth),f&&(a.height=c.maxHeight),g&&k&&(a.left=i-c.minWidth),e&&k&&(a.left=i-c.maxWidth),h&&l&&(a.top=j-c.minHeight),f&&l&&(a.top=j-c.maxHeight),a.width||a.height||a.left||!a.top?a.width||a.height||a.top||!a.left||(a.left=null):a.top=null,a},_getPaddingPlusBorderDimensions:function(a){for(var b=0,c=[],d=[a.css("borderTopWidth"),a.css("borderRightWidth"),a.css("borderBottomWidth"),a.css("borderLeftWidth")],e=[a.css("paddingTop"),a.css("paddingRight"),a.css("paddingBottom"),a.css("paddingLeft")];4>b;b++)c[b]=parseInt(d[b],10)||0,c[b]+=parseInt(e[b],10)||0;return{height:c[0]+c[2],width:c[1]+c[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var a,b=0,c=this.helper||this.element;b<this._proportionallyResizeElements.length;b++)a=this._proportionallyResizeElements[b],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(a)),a.css({height:c.height()-this.outerDimensions.height||0,width:c.width()-this.outerDimensions.width||0})},_renderProxy:function(){var a=this.element,b=this.options;this.elementOffset=a.offset(),this._helper?(this.helper=this.helper||$("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++b.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(a,b){return{width:this.originalSize.width+b}},w:function(a,b){var c=this.originalSize,d=this.originalPosition;return{left:d.left+b,width:c.width-b}},n:function(a,b,c){var d=this.originalSize,e=this.originalPosition;return{top:e.top+c,height:d.height-c}},s:function(a,b,c){return{height:this.originalSize.height+c}},se:function(a,b,c){return $.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[a,b,c]))},sw:function(a,b,c){return $.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[a,b,c]))},ne:function(a,b,c){return $.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[a,b,c]))},nw:function(a,b,c){return $.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[a,b,c]))}},_propagate:function(a,b){$.coral.plugin.call(this,a,[b,this.ui()]),"resize"!==a&&this._trigger(a,b,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),$.coral.plugin.add("resizable","animate",{stop:function(a){var b=$(this).data("coral-resizable"),d=b.options,e=b._proportionallyResizeElements,f=e.length&&/textarea/i.test(e[0].nodeName),g=f&&c(e[0],"left")?0:b.sizeDiff.height,h=f?0:b.sizeDiff.width,i={width:b.size.width-h,height:b.size.height-g},j=parseInt(b.element.css("left"),10)+(b.position.left-b.originalPosition.left)||null,k=parseInt(b.element.css("top"),10)+(b.position.top-b.originalPosition.top)||null;b.element.animate($.extend(i,k&&j?{top:k,left:j}:{}),{duration:d.animateDuration,easing:d.animateEasing,step:function(){var c={width:parseInt(b.element.css("width"),10),height:parseInt(b.element.css("height"),10),top:parseInt(b.element.css("top"),10),left:parseInt(b.element.css("left"),10)};e&&e.length&&$(e[0]).css({width:c.width,height:c.height}),b._updateCache(c),b._propagate("resize",a)}})}}),$.coral.plugin.add("resizable","containment",{start:function(){var b,d,e,f,g,h,i,j=$(this).data("coral-resizable"),k=j.options,l=j.element,m=k.containment,n=m instanceof $?m.get(0):/parent/.test(m)?l.parent().get(0):m;n&&(j.containerElement=$(n),/document/.test(m)||m===document?(j.containerOffset={left:0,top:0},j.containerPosition={left:0,top:0},j.parentData={element:$(document),left:0,top:0,width:$(document).width(),height:$(document).height()||document.body.parentNode.scrollHeight}):(b=$(n),d=[],$(["Top","Right","Left","Bottom"]).each(function(c,e){d[c]=a(b.css("padding"+e))}),j.containerOffset=b.offset(),j.containerPosition=b.position(),j.containerSize={height:b.innerHeight()-d[3],width:b.innerWidth()-d[1]},e=j.containerOffset,f=j.containerSize.height,g=j.containerSize.width,h=c(n,"left")?n.scrollWidth:g,i=c(n)?n.scrollHeight:f,j.parentData={element:n,left:e.left,top:e.top,width:h,height:i}))},resize:function(a){var b,c,d,e,f=$(this).resizable("instance"),g=f.options,h=f.containerOffset,i=f.position,j=f._aspectRatio||a.shiftKey,k={top:0,left:0},l=f.containerElement,m=!0;l[0]!==document&&/static/.test(l.css("position"))&&(k=h),i.left<(f._helper?h.left:0)&&(f.size.width=f.size.width+(f._helper?f.position.left-h.left:f.position.left-k.left),j&&(f.size.height=f.size.width/f.aspectRatio,m=!1),f.position.left=g.helper?h.left:0),i.top<(f._helper?h.top:0)&&(f.size.height=f.size.height+(f._helper?f.position.top-h.top:f.position.top),j&&(f.size.width=f.size.height*f.aspectRatio,m=!1),f.position.top=f._helper?h.top:0),d=f.containerElement.get(0)===f.element.parent().get(0),e=/relative|absolute/.test(f.containerElement.css("position")),d&&e?(f.offset.left=f.parentData.left+f.position.left,f.offset.top=f.parentData.top+f.position.top):(f.offset.left=f.element.offset().left,f.offset.top=f.element.offset().top),b=Math.abs(f.sizeDiff.width+(f._helper?f.offset.left-k.left:f.offset.left-h.left)),c=Math.abs(f.sizeDiff.height+(f._helper?f.offset.top-k.top:f.offset.top-h.top)),b+f.size.width>=f.parentData.width&&(f.size.width=f.parentData.width-b,j&&(f.size.height=f.size.width/f.aspectRatio,m=!1)),c+f.size.height>=f.parentData.height&&(f.size.height=f.parentData.height-c,j&&(f.size.width=f.size.height*f.aspectRatio,m=!1)),m||(f.position.left=f.prevPosition.left,f.position.top=f.prevPosition.top,f.size.width=f.prevSize.width,f.size.height=f.prevSize.height)},stop:function(){var a=$(this).resizable("instance"),b=a.options,c=a.containerOffset,d=a.containerPosition,e=a.containerElement,f=$(a.helper),g=f.offset(),h=f.outerWidth()-a.sizeDiff.width,i=f.outerHeight()-a.sizeDiff.height;a._helper&&!b.animate&&/relative/.test(e.css("position"))&&$(this).css({left:g.left-d.left-c.left,width:h,height:i}),a._helper&&!b.animate&&/static/.test(e.css("position"))&&$(this).css({left:g.left-d.left-c.left,width:h,height:i})}}),$.coral.plugin.add("resizable","alsoResize",{start:function(){var a=$(this).data("coral-resizable"),b=a.options,c=function(a){$(a).each(function(){var a=$(this);a.data("coral-resizable-alsoresize",{width:parseInt(a.width(),10),height:parseInt(a.height(),10),left:parseInt(a.css("left"),10),top:parseInt(a.css("top"),10)})})};"object"!=typeof b.alsoResize||b.alsoResize.parentNode?c(b.alsoResize):b.alsoResize.length?(b.alsoResize=b.alsoResize[0],c(b.alsoResize)):$.each(b.alsoResize,function(a){c(a)})},resize:function(a,b){var c=$(this).data("coral-resizable"),d=c.options,e=c.originalSize,f=c.originalPosition,g={height:c.size.height-e.height||0,width:c.size.width-e.width||0,top:c.position.top-f.top||0,left:c.position.left-f.left||0},h=function(a,c){$(a).each(function(){var a=$(this),d=$(this).data("coral-resizable-alsoresize"),e={},f=c&&c.length?c:a.parents(b.originalElement[0]).length?["width","height"]:["width","height","top","left"],h=$.coral.getStyles(a[0]),i=jQuery.support.boxSizing&&"border-box"===jQuery.css(a,"boxSizing",!1,h);$.each(f,function(b,c){var f=(d[c]||0)+(g[c]||0);f&&f>=0&&(i?$.inArray(c,["width","height"])>=0?a[c](f):a.css(c,f):e[c]=f||null)}),a.css(e)})};"object"!=typeof d.alsoResize||d.alsoResize.nodeType?h(d.alsoResize):$.each(d.alsoResize,function(a,b){h(a,b)})},stop:function(){$(this).removeData("resizable-alsoresize")}}),$.coral.plugin.add("resizable","ghost",{start:function(){var a=$(this).data("coral-resizable"),b=a.options,c=a.size;a.ghost=a.originalElement.clone(),a.ghost.css({opacity:.25,display:"block",position:"relative",height:c.height,width:c.width,margin:0,left:0,top:0}).addClass("coral-resizable-ghost").addClass("string"==typeof b.ghost?b.ghost:""),a.ghost.appendTo(a.helper)},resize:function(){var a=$(this).data("coral-resizable");a.ghost&&a.ghost.css({position:"relative",height:a.size.height,width:a.size.width})},stop:function(){var a=$(this).data("coral-resizable");a.ghost&&a.helper&&a.helper.get(0).removeChild(a.ghost.get(0))}}),$.coral.plugin.add("resizable","grid",{resize:function(){var a,b=$(this).resizable("instance"),c=b.options,d=b.size,e=b.originalSize,f=b.originalPosition,g=b.axis,h="number"==typeof c.grid?[c.grid,c.grid]:c.grid,i=h[0]||1,j=h[1]||1,k=Math.round((d.width-e.width)/i)*i,l=Math.round((d.height-e.height)/j)*j,m=e.width+k,n=e.height+l,o=c.maxWidth&&c.maxWidth<m,p=c.maxHeight&&c.maxHeight<n,q=c.minWidth&&c.minWidth>m,r=c.minHeight&&c.minHeight>n;c.grid=h,q&&(m+=i),r&&(n+=j),o&&(m-=i),p&&(n-=j),/^(se|s|e)$/.test(g)?(b.size.width=m,b.size.height=n):/^(ne)$/.test(g)?(b.size.width=m,b.size.height=n,b.position.top=f.top-l):/^(sw)$/.test(g)?(b.size.width=m,b.size.height=n,b.position.left=f.left-k):((0>=n-j||0>=m-i)&&(a=b._getPaddingPlusBorderDimensions(this)),n-j>0?(b.size.height=n,b.position.top=f.top-l):(n=j-a.height,b.size.height=n,b.position.top=f.top+e.height-n),m-i>0?(b.size.width=m,b.position.left=f.left-k):(m=j-a.height,b.size.width=m,b.position.left=f.left+e.width-m))}})}();/*! cui 2016-11-08 */
!function(){$.component("coral.selectable",$.coral.mouse,{version:"4.0.1",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var a,b=this;this.element.addClass("coral-selectable"),this.dragged=!1,this.refresh=function(){a=$(b.options.filter,b.element[0]),a.addClass("coral-selectee"),a.each(function(){var a=$(this),b=a.offset();$.data(this,"selectable-item",{element:this,$element:a,left:b.left,top:b.top,right:b.left+a.outerWidth(),bottom:b.top+a.outerHeight(),startselected:!1,selected:a.hasClass("coral-selected"),selecting:a.hasClass("coral-selecting"),unselecting:a.hasClass("coral-unselecting")})})},this.refresh(),this.selectees=a.addClass("coral-selectee"),this._mouseInit(),this.helper=$("<div class='coral-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("coral-selectee").removeData("selectable-item"),this.element.removeClass("coral-selectable coral-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(a){var b=this,c=this.options;this.opos=[a.pageX,a.pageY],this.options.disabled||(this.selectees=$(c.filter,this.element[0]),this._trigger("start",a),$(c.appendTo).append(this.helper),this.helper.css({left:a.pageX,top:a.pageY,width:0,height:0}),c.autoRefresh&&this.refresh(),this.selectees.filter(".coral-selected").each(function(){var c=$.data(this,"selectable-item");c.startselected=!0,a.metaKey||a.ctrlKey||(c.$element.removeClass("coral-selected"),c.selected=!1,c.$element.addClass("coral-unselecting"),c.unselecting=!0,b._trigger("unselecting",a,{unselecting:c.element}))}),$(a.target).parents().addBack().each(function(){var c,d=$.data(this,"selectable-item");return d?(c=!a.metaKey&&!a.ctrlKey||!d.$element.hasClass("coral-selected"),d.$element.removeClass(c?"coral-unselecting":"coral-selected").addClass(c?"coral-selecting":"coral-unselecting"),d.unselecting=!c,d.selecting=c,d.selected=c,c?b._trigger("selecting",a,{selecting:d.element}):b._trigger("unselecting",a,{unselecting:d.element}),!1):void 0}))},_mouseDrag:function(a){if(this.dragged=!0,!this.options.disabled){var b,c=this,d=this.options,e=this.opos[0],f=this.opos[1],g=a.pageX,h=a.pageY;return e>g&&(b=g,g=e,e=b),f>h&&(b=h,h=f,f=b),this.helper.css({left:e,top:f,width:g-e,height:h-f}),this.selectees.each(function(){var b=$.data(this,"selectable-item"),i=!1;b&&b.element!==c.element[0]&&("touch"===d.tolerance?i=!(b.left>g||b.right<e||b.top>h||b.bottom<f):"fit"===d.tolerance&&(i=b.left>e&&b.right<g&&b.top>f&&b.bottom<h),i?(b.selected&&(b.$element.removeClass("coral-selected"),b.selected=!1),b.unselecting&&(b.$element.removeClass("coral-unselecting"),b.unselecting=!1),b.selecting||(b.$element.addClass("coral-selecting"),b.selecting=!0,c._trigger("selecting",a,{selecting:b.element}))):(b.selecting&&((a.metaKey||a.ctrlKey)&&b.startselected?(b.$element.removeClass("coral-selecting"),b.selecting=!1,b.$element.addClass("coral-selected"),b.selected=!0):(b.$element.removeClass("coral-selecting"),b.selecting=!1,b.startselected&&(b.$element.addClass("coral-unselecting"),b.unselecting=!0),c._trigger("unselecting",a,{unselecting:b.element}))),b.selected&&(a.metaKey||a.ctrlKey||b.startselected||(b.$element.removeClass("coral-selected"),b.selected=!1,b.$element.addClass("coral-unselecting"),b.unselecting=!0,c._trigger("unselecting",a,{unselecting:b.element})))))}),!1}},_mouseStop:function(a){var b=this;return this.dragged=!1,$(".coral-unselecting",this.element[0]).each(function(){var c=$.data(this,"selectable-item");c.$element.removeClass("coral-unselecting"),c.unselecting=!1,c.startselected=!1,b._trigger("unselected",a,{unselected:c.element})}),$(".coral-selecting",this.element[0]).each(function(){var c=$.data(this,"selectable-item");c.$element.removeClass("coral-selecting").addClass("coral-selected"),c.selecting=!1,c.selected=!0,c.startselected=!0,b._trigger("selected",a,{selected:c.element})}),this._trigger("stop",a),this.helper.remove(),!1}})}();/*! cui 2016-11-08 */
!function(){function a(a,b,c){return[parseFloat(a[0])*(m.test(a[0])?b/100:1),parseFloat(a[1])*(m.test(a[1])?c/100:1)]}function b(a,b){return parseInt($.css(a,b),10)||0}function c(a){var b=a[0];return 9===b.nodeType?{width:a.width(),height:a.height(),offset:{top:0,left:0}}:$.isWindow(b)?{width:a.width(),height:a.height(),offset:{top:a.scrollTop(),left:a.scrollLeft()}}:b.preventDefault?{width:0,height:0,offset:{top:b.pageY,left:b.pageX}}:{width:a.outerWidth(),height:a.outerHeight(),offset:a.offset()}}$.coral=$.coral||{};var d,e,f=Math.max,g=Math.abs,h=Math.round,i=/left|center|right/,j=/top|center|bottom/,k=/[\+\-]\d+(\.[\d]+)?%?/,l=/^\w+/,m=/%$/,n=$.fn.position;$.position={scrollbarWidth:function(){if(void 0!==d)return d;var a,b,c=$("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),e=c.children()[0];return $("body").append(c),a=e.offsetWidth,c.css("overflow","scroll"),b=e.offsetWidth,a===b&&(b=c[0].clientWidth),c.remove(),d=a-b},getScrollInfo:function(a){var b=a.isWindow||a.isDocument?"":a.element.css("overflow-x"),c=a.isWindow||a.isDocument?"":a.element.css("overflow-y"),d="scroll"===b||"auto"===b&&a.width<a.element[0].scrollWidth,e="scroll"===c||"auto"===c&&a.height<a.element[0].scrollHeight;return{width:e?$.position.scrollbarWidth():0,height:d?$.position.scrollbarWidth():0}},getWithinInfo:function(a){var b=$(a||window),c=$.isWindow(b[0]),d=!!b[0]&&9===b[0].nodeType;return{element:b,isWindow:c,isDocument:d,offset:b.offset()||{left:0,top:0},scrollLeft:b.scrollLeft(),scrollTop:b.scrollTop(),width:c||d?b.width():b.outerWidth(),height:c||d?b.height():b.outerHeight()}}},$.fn.position=function(d){if(!d||!d.of)return n.apply(this,arguments);d=$.extend({},d);var m,o,p,q,r,s,t=$(d.of),u=$.position.getWithinInfo(d.within),v=$.position.getScrollInfo(u),w=(d.collision||"flip").split(" "),x={};return s=c(t),t[0].preventDefault&&(d.at="left top"),o=s.width,p=s.height,q=s.offset,r=$.extend({},q),$.each(["my","at"],function(){var a,b,c=(d[this]||"").split(" ");1===c.length&&(c=i.test(c[0])?c.concat(["center"]):j.test(c[0])?["center"].concat(c):["center","center"]),c[0]=i.test(c[0])?c[0]:"center",c[1]=j.test(c[1])?c[1]:"center",a=k.exec(c[0]),b=k.exec(c[1]),x[this]=[a?a[0]:0,b?b[0]:0],d[this]=[l.exec(c[0])[0],l.exec(c[1])[0]]}),1===w.length&&(w[1]=w[0]),"right"===d.at[0]?r.left+=o:"center"===d.at[0]&&(r.left+=o/2),"bottom"===d.at[1]?r.top+=p:"center"===d.at[1]&&(r.top+=p/2),m=a(x.at,o,p),r.left+=m[0],r.top+=m[1],this.each(function(){var c,i,j=$(this),k=j.outerWidth(),l=j.outerHeight(),n=b(this,"marginLeft"),s=b(this,"marginTop"),y=k+n+b(this,"marginRight")+v.width,z=l+s+b(this,"marginBottom")+v.height,A=$.extend({},r),B=a(x.my,j.outerWidth(),j.outerHeight());"right"===d.my[0]?A.left-=k:"center"===d.my[0]&&(A.left-=k/2),"bottom"===d.my[1]?A.top-=l:"center"===d.my[1]&&(A.top-=l/2),A.left+=B[0],A.top+=B[1],e||(A.left=h(A.left),A.top=h(A.top)),c={marginLeft:n,marginTop:s},$.each(["left","top"],function(a,b){$.coral.position[w[a]]&&$.coral.position[w[a]][b](A,{targetWidth:o,targetHeight:p,elemWidth:k,elemHeight:l,collisionPosition:c,collisionWidth:y,collisionHeight:z,offset:[m[0]+B[0],m[1]+B[1]],my:d.my,at:d.at,within:u,elem:j})}),d.using&&(i=function(a){var b=q.left-A.left,c=b+o-k,e=q.top-A.top,h=e+p-l,i={target:{element:t,left:q.left,top:q.top,width:o,height:p},element:{element:j,left:A.left,top:A.top,width:k,height:l},horizontal:0>c?"left":b>0?"right":"center",vertical:0>h?"top":e>0?"bottom":"middle"};k>o&&g(b+c)<o&&(i.horizontal="center"),l>p&&g(e+h)<p&&(i.vertical="middle"),f(g(b),g(c))>f(g(e),g(h))?i.important="horizontal":i.important="vertical",d.using.call(this,a,i)}),j.offset($.extend(A,{using:i}))})},$.coral.position={fit:{left:function(a,b){var c,d=b.within,e=d.isWindow?d.scrollLeft:d.offset.left,g=d.width,h=a.left-b.collisionPosition.marginLeft,i=e-h,j=h+b.collisionWidth-g-e;b.collisionWidth>g?i>0&&0>=j?(c=a.left+i+b.collisionWidth-g-e,a.left+=i-c):j>0&&0>=i?a.left=e:i>j?a.left=e+g-b.collisionWidth:a.left=e:i>0?a.left+=i:j>0?a.left-=j:a.left=f(a.left-h,a.left)},top:function(a,b){var c,d=b.within,e=d.isWindow?d.scrollTop:d.offset.top,g=b.within.height,h=a.top-b.collisionPosition.marginTop,i=e-h,j=h+b.collisionHeight-g-e;b.collisionHeight>g?i>0&&0>=j?(c=a.top+i+b.collisionHeight-g-e,a.top+=i-c):j>0&&0>=i?a.top=e:i>j?a.top=e+g-b.collisionHeight:a.top=e:i>0?a.top+=i:j>0?a.top-=j:a.top=f(a.top-h,a.top)}},flip:{left:function(a,b){var c,d,e=b.within,f=e.offset.left+e.scrollLeft,h=e.width,i=e.isWindow?e.scrollLeft:e.offset.left,j=a.left-b.collisionPosition.marginLeft,k=j-i,l=j+b.collisionWidth-h-i,m="left"===b.my[0]?-b.elemWidth:"right"===b.my[0]?b.elemWidth:0,n="left"===b.at[0]?b.targetWidth:"right"===b.at[0]?-b.targetWidth:0,o=-2*b.offset[0];0>k?(c=a.left+m+n+o+b.collisionWidth-h-f,(0>c||c<g(k))&&(a.left+=m+n+o)):l>0&&(d=a.left-b.collisionPosition.marginLeft+m+n+o-i,(d>0||g(d)<l)&&(a.left+=m+n+o))},top:function(a,b){var c,d,e=b.within,f=e.offset.top+e.scrollTop,h=e.height,i=e.isWindow?e.scrollTop:e.offset.top,j=a.top-b.collisionPosition.marginTop,k=j-i,l=j+b.collisionHeight-h-i,m="top"===b.my[1],n=m?-b.elemHeight:"bottom"===b.my[1]?b.elemHeight:0,o="top"===b.at[1]?b.targetHeight:"bottom"===b.at[1]?-b.targetHeight:0,p=-2*b.offset[1];0>k?(d=a.top+n+o+p+b.collisionHeight-h-f,a.top+n+o+p>k&&(0>d||d<g(k))&&(a.top+=n+o+p)):l>0&&(c=a.top-b.collisionPosition.marginTop+n+o+p-i,a.top+n+o+p>l&&(c>0||g(c)<l)&&(a.top+=n+o+p))}},flipfit:{left:function(){$.coral.position.flip.left.apply(this,arguments),$.coral.position.fit.left.apply(this,arguments)},top:function(){$.coral.position.flip.top.apply(this,arguments),$.coral.position.fit.top.apply(this,arguments)}}},function(){var a,b,c,d,f,g=document.getElementsByTagName("body")[0],h=document.createElement("div");a=document.createElement(g?"div":"body"),c={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},g&&$.extend(c,{position:"absolute",left:"-1000px",top:"-1000px"});for(f in c)a.style[f]=c[f];a.appendChild(h),b=g||document.documentElement,b.insertBefore(a,b.firstChild),h.style.cssText="position: absolute; left: 10.7432222px;",d=$(h).offset().left,e=d>10&&11>d,a.innerHTML="",b.removeChild(a)}()}();/*! cui 2016-11-08 */
!function(){var a={};$.each(["Quad","Cubic","Quart","Quint","Expo"],function(b,c){a[c]=function(a){return Math.pow(a,b+2)}}),$.extend(a,{Sine:function(a){return 1-Math.cos(a*Math.PI/2)},Circ:function(a){return 1-Math.sqrt(1-a*a)},Elastic:function(a){return 0===a||1===a?a:-Math.pow(2,8*(a-1))*Math.sin((80*(a-1)-7.5)*Math.PI/15)},Back:function(a){return a*a*(3*a-2)},Bounce:function(a){for(var b,c=4;a<((b=Math.pow(2,--c))-1)/11;);return 1/Math.pow(4,3-c)-7.5625*Math.pow((3*b-2)/22-a,2)}}),$.each(a,function(a,b){$.easing["easeIn"+a]=b,$.easing["easeOut"+a]=function(a){return 1-b(1-a)},$.easing["easeInOut"+a]=function(a){return.5>a?b(2*a)/2:1-b(-2*a+2)/2}})}();/*! cui 2016-11-08 */
$.grid=$.grid||{};var grid=$.component("coral.grid",{version:"4.0.1",castProperties:["rowEditButtons","data","subGridOptions","initData","subGridRowExpanded","shortCut","rowList","pager","pagerTemplate","celloptions","colModel","picTemplate","rowattr","cellattr"],options:{},grid:{},diff:2,getScrollBarWidth:function(){var a=document.createElement("p");a.style.width="100%",a.style.height="200px";var b=document.createElement("div");b.style.position="absolute",b.style.top="0px",b.style.left="0px",b.style.visibility="hidden",b.style.width="200px",b.style.height="150px",b.style.overflow="hidden",b.appendChild(a),document.body.appendChild(b);var c=a.offsetWidth;b.style.overflow="scroll";var d=a.offsetWidth;return c==d&&(d=b.clientWidth),document.body.removeChild(b),c-d+this.diff},_destroy:function(){var a="",b=$(this.element).attr("id");this.pagers&&(a=$(this.pagers).empty().addClass(b)),$(this.element).empty(),this.element.removeClass("ctrl-init ctrl-init-grid"),this.element.removeClass("coral-grid"),this.element.removeClass(this.options.cls),this.component().replaceWith(this.element).append(a)},_create:function(){var a=this.options,b=this,c=this.element.uniqueId().attr("id");a.id=c;var d={_index:{},altRows:!1,altclass:" coral-priority-secondary ",ajaxGridOptions:{},asyncType:"post",autoSave:!1,autoValid:!0,autoWidth:!0,allowSaveOnError:!0,cls:"",caption:"",colModel:[],colNames:[],cellLayout:1,cellEdit:!1,subGridWidth:22,cellsubmit:"clientArray",clicksToEdit:2,data:[],datatype:"json",direction:"ltr",allowCellSelect:!1,deselectAfterSort:!0,emptyrecords:"无数据",expandColumn:null,height:150,idPrefix:"",initData:!1,customPicgrid:$.noop(),gridview:!1,grouping:!1,groupingView:{groupField:[],groupOrder:[],groupText:[],groupColumnShow:[],groupSummary:[],showSummaryOnHide:!1,sortitems:[],sortnames:[],summary:[],summaryval:[],plusicon:"cui-icon-plus3",minusicon:"cui-icon-minus3",displayField:[],groupSummaryPos:[],formatDisplayField:[],_locgr:!1},subGridOptions:{plusicon:"cui-icon-arrow-right3",minusicon:"cui-icon-arrow-down3",openicon:""},groupHeaders:[],groupHeader:!1,search:!1,remoteFilter:!1,fitStyle:"auto",forceFit:!1,hoverrows:!0,lastsort:0,loadonce:!0,loadui:"enable",loadtext:"加载中，请耐心等候 ...",minWidth:!1,multiselect:!1,multiselectWidth:30,multiboxonly:!1,multikey:"",clickRowToSelect:!0,subGridRowExpanded:null,model:"grid",page:1,pager:"",pagerStyle:"flex",pginput:!0,records:0,rninput:!0,rowEditButtons:[],pgbuttons:!0,showGridHeader:!0,enableHighlight:!1,picTemplate:"picTemplate",postData:{},prmNames:{page:"P_pageNumber",rows:"P_pagesize",sort:"P_orders",order:"sord",search:"_search",nd:"nd",id:"id",oper:"oper",editoper:"edit",addoper:"add",deloper:"del",subgridid:"id",npage:null,totalrows:"totalrows"},rowNum:20,rowNumMax:200,rownumbers:!1,rownumWidth:35,rownumName:"",rowList:[10,20,30],savedRow:[],scrollOffset:this.getScrollBarWidth(),selarrrow:[],singleselect:!1,sortorder:"asc",treeGrid:!1,treeGridModel:"adjacency",treeReader:{},treeANode:-1,tree_root_level:0,generalLevel:!1,onSortableColumns:!1,sortableColumnsOptions:{},onSortableRows:!1,beforeSortableRows:!1,afterSortableRows:!1,editableRows:!1,onSortableStart:!1,onSortableStop:!1,onSortableReceive:!1,onSortableRemove:!1,onSortableLoad:!1,connectGridId:null,containSortOrder:!1,sortSeparator:" ",shrinkToFit:!0,toppager:!1,toolbar:[!1,""],url:"",useProp:!0,viewsortcols:[!1,"vertical",!0],viewrecords:!0,minIndex:null,maxIndex:null,preIndex:null,beforePopulate:null};a=$.extend(!0,{},d,$.grid.defaults,this.options),"pic"==a.model&&(a.model="card"),this.options=a,this.options.isValid=!0,a.postData=$.coral.toFunction(a.postData),a.localReader=$.extend(!0,{root:"data",page:"pageNumber",total:"totalPages",records:"total",repeatitems:!1,cell:"cell",id:"id",userData:"userData",subgrid:{root:"data",repeatitems:!0,cell:"cell"}},a.localReader),a.jsonReader=$.extend(!0,{root:"data",page:"pageNumber",total:"totalPages",records:"total",repeatitems:!1,cell:"cell",id:"id",userData:"userData"},a.jsonReader),this.options.pivotData&&this.options.pivotData.length&&this.jqPivot(this.options.pivotData,this.options.pivotOption,this.options.gridOption,this.options.ajaxOption),this.options.data.length&&(this.normalizeData(),this.refreshIndex()),this.id=c;var e={groupHeader:[],headers:[],cols:[],footers:[],dragStart:function(a,c,d){var e=this;this.resizing={idx:a,startX:c.clientX,sOL:d[0]},e.columnsView.style.cursor="col-resize",this.curGbox=$("#rs_m"+$.grid.coralID(b.options.id),"#"+$.grid.coralID(b.options.id)),this.curGbox.css({display:"block",left:d[0],top:d[1],height:d[2]}),b._trigger("onResizeStart",c,[{index:a}]),document.onselectstart=function(){return!1}},dragMove:function(c){if(this.resizing){var d,e,f=c.clientX-this.resizing.startX,g=this.headers[this.resizing.idx],h="ltr"===b.options.direction?g.width+f:g.width-f;$("#test").html(f),h>33&&(this.curGbox.css({left:this.resizing.sOL+f}),b.options.forceFit===!0?(d=this.headers[this.resizing.idx+a.nv],e="ltr"===b.options.direction?d.width-f:d.width+f,e>33&&(g.newWidth=h,d.newWidth=e)):(this.newWidth="ltr"===b.options.direction?b.options.tblwidth+f:b.options.tblwidth-f,g.newWidth=h))}},dragEnd:function(){if(this.columnsView.style.cursor="default",this.resizing){var c=this.resizing.idx,e=this.headers[c].newWidth||this.headers[c].width;e=parseInt(e,10),this.resizing=!1,$("#rs_m"+$.grid.coralID(b.options.id)).css("display","none"),b.options.colModel[c].width=e,this.headers[c].width=e,this.headers[c].el.style.width=e+"px",this.cols[c].style.width=e+"px",$("table:first",this.rowsView).hasClass("coral-grid-btable-frozen")&&($("tr.jqgfirstrow>td:eq("+c+")",$("table:first",this.rowsView))[0].style.width=e+"px");var f=$("tr.jqg-first-row-header>th:eq("+c+")",$("table:first",this.columnsView));f.length>0&&(f[0].style.width=e+"px"),this.footers.length>0&&(this.footers[c].style.width=e+"px"),b.options.forceFit===!0?(e=this.headers[c+a.nv].newWidth||this.headers[c+a.nv].width,this.headers[c+a.nv].width=e,this.headers[c+a.nv].el.style.width=e+"px",this.cols[c+a.nv].style.width=e+"px",this.footers.length>0&&(this.footers[c+a.nv].style.width=e+"px"),b.options.colModel[c+a.nv].width=e,f=$("tr.jqg-first-row-header>th:eq("+(c+a.nv)+")",$("table:first",this.columnsView)),f.length>0&&(f[0].style.width=e+"px")):(b.options.tblwidth=this.newWidth||b.options.tblwidth,$("table",this.rowsView).css("width",b.options.tblwidth+"px"),$("table:first",this.columnsView).css("width",b.options.tblwidth+"px"),this.columnsView.scrollLeft=this.rowsView.scrollLeft,b.options.footerrow&&($("table:first",this.sDiv).css("width",d.tblwidth+"px"),this.sDiv.scrollLeft=this.rowsView.scrollLeft)),b._trigger("onResizeStop",null,[{newWidth:e,index:c,headers:this.headers}])}this.curGbox=null,document.onselectstart=function(){return!0}},selectionPreserver:function(a){var b=a.options,c=b.selrow,d=b.selarrrow?$.makeArray(b.selarrrow):null,e=a.grid.rowsView.scrollLeft,f=function(){var g;if(b.selrow=null,b.selarrrow=[],b.multiselect&&d&&d.length>0)for(g=0;g<d.length;g++)d[g]!=c&&$(a.element).grid("setSelection",d[g],!1,null);c&&$(a.element).grid("setSelection",c,!1,null),a.grid.rowsView.scrollLeft=e,$(a.element).unbind(".selectionPreserver",f)};$(a.element).bind("gridoncomplete.selectionPreserver",f)}};this.grid=e;var f=this.element.find(">div").filter(function(){return!$(this).hasClass(b.options.id)}),g=$("<div class='coral-grid-rows'></div>");if(0==f.length&&(this.element.prepend("<div></div>"),f=this.element.find(">div").filter(function(){return!$(this).hasClass(b.id)})),b.gridRows=g,b.gridColumns=f,b._analyzeColumns(f),f.addClass("coral-grid-columns").after(g),e.rowsView=document.createElement("div"),$(e.rowsView).addClass("coral-grid-rows-view").appendTo(g),$("<span class='coral-grid-noRecordsTips' id='noRecordsTips_"+$.grid.coralID(b.options.id)+"'>"+b.options.emptyrecords+"</span>").appendTo($(e.rowsView)),e.columnsView=document.createElement("div"),$(e.columnsView).addClass("coral-state-default coral-grid-columns-view").appendTo(f).append("<div class='coral-grid-topRightCell'></div>"),b.pic=$("<ul class='coral-pic'></ul>"),f.addClass("coral-grid-columns").after(b.pic),b.options.grouping===!0&&(b.options.scroll=!1,b.options.rownumbers=!1,b.options.treeGrid=!1,b.options.gridview=!0),this.options.treeGrid===!0){try{$(b.element).grid("setTreeGrid")}catch(h){}"local"!=b.options.datatype&&(b.options.localReader={id:"_id_"})}if(this.options.subGrid)try{$(b.element).grid("setSubGrid")}catch(i){}this.options.multiselect&&(this.options.singleselect=!1),this.options.keyName||(this.options.keyName=!1);for(var j=0;j<this.options.colModel.length;j++)this.options.colModel[j]=$.extend(!0,{},this.options.cmTemplate,this.options.colModel[j].template||{},this.options.colModel[j]),this.options.keyName===!1&&this.options.colModel[j].key===!0&&(this.options.keyName=this.options.colModel[j].name);this.options.multiselect?(this.options.colNames.unshift("<input role='checkbox' id='cb_"+this.options.id+"' class='cbox' type='checkbox'/>"),this.options.colModel.unshift({name:"cb",width:b.options.multiselectWidth,sortable:!1,resizable:!1,hidedlg:!0,search:!1,align:"center",fixed:!0})):this.options.singleselect&&(this.options.colNames.unshift(""),this.options.colModel.unshift({name:"cb",width:b.options.multiselectWidth,sortable:!1,resizable:!1,hidedlg:!0,search:!1,align:"center",fixed:!0})),this.options.rownumbers&&(this.options.colNames.unshift(b.options.rownumName),this.options.colModel.unshift({name:"rn",width:b.options.rownumWidth,sortable:!1,resizable:!1,hidedlg:!0,search:!1,align:"center",fixed:!0})),b._transToGrid(),b._transToPicgrid(),b._transPagers(),b._cvH=$(e.columnsView).height(),"fill"!==a.fitStyle,b._setGridHeight(b.options.height),"grid"==a.model?b.pic.hide():"card"==a.model&&(b.gridRows.hide(),b.gridColumns.hide()),b.setFrozenColumns(),this.component().addClass(a.componentCls),this._populate(),b._setUpEvent(),$(window).unload(function(){b=null}),this._on(this.document,{mousedown:function(a){if(this.options.autoSave&&this._closeOnDocumentClick(a)&&this.restoreAll(a),this._closeOnDocumentClick(a)){$(this.rows.namedItem(this.options.selrow)).removeClass("coral-grid-cell-focus");for(var b=0;b<this.rows.length;b++){var c=$(this.rows[b]).find("td");$(c).hasClass("coral-grid-cell-focus")&&$(c).removeClass("coral-grid-cell-focus")}}}}),1==this.options.showGridHeader&&"card"!=b.options.model?this.showGridHeader():this.hideGridHeader()},_closeOnDocumentClick:function(a){return!$(a.target).closest(".coral-grid").length},_transPagers:function(){var a=this;this.pagers=$("."+this.id),1==this.options.pager?(this.options.pager=$("<div id='pager_0_"+this.id+"'></div>"),this.options.pager.addClass("coral-grid-pager").removeClass(a.id).appendTo(this.element),a._setPager(this.options.pager[0].id,"")):(this.pagers.each(function(b){$(this).addClass("coral-grid-pager").removeClass(a.id).attr("id","pager_"+b++ +"_"+a.id)}),this.pagers&&this.pagers.each(function(b){a._setPager(a.pagers[b].id,"")})),a.options.pager="."+a.id},toolbar:function(){return $(".pager-toolbar",this.element)},_transToPicgrid:function(){var a=this;a.pic.css({height:230,overflow:"auto"})},_transToGrid:function(){var a=this;this.options;-1==$.inArray(a.options.multikey,a._sortkeys)&&(a.options.multikey=!1),a.options.sortorder=a.options.sortorder.toLowerCase(),this.element.addClass("coral-grid"),this.element.addClass(a.options.cls),a._transGridView()},_transGridView:function(){var a,b,c,d,e,f,g,h=this,i=this.options,j=this.grid,k=i.rownumbers===!0?1:0,l=i.multiselect===!0?1:i.singleselect===!0?1:0,m=i.subGrid===!0?1:0,n=i.direction,o="<thead><tr class='coral-grid-labels' role='rowheader'>",p="",q="";if(i.shrinkToFit===!0&&i.forceFit===!0)for(a=i.colModel.length-1;a>=0;a--)if(!i.colModel[a].hidden){i.colModel[a].resizable=!1;break}for($.each(this.options.colModel,function(){"undefined"==typeof this.hidden&&(this.hidden=!1)}),g="<span class='s-ico' style='display:none'><span sort='asc' class='coral-grid-ico-sort coral-icon-asc"+p+" coral-state-disabled cui-icon-arrow-up5 coral-sort-"+n+"'></span>",g+="<span sort='desc' class='coral-grid-ico-sort coral-icon-desc"+q+" coral-state-disabled cui-icon-arrow-down5 coral-sort-"+n+"'></span></span>",a=0;a<i.colNames.length;a++){var r=h.options.headertitles?' title="'+$.grid.stripHtml(h.options.colNames[a])+'"':"",s=i.colModel[a].columnSortable?"coral-columnSortable-disabled":"";o+="<th id='"+i.id+"_"+i.colModel[a].name+"' role='columnheader' class='coral-state-default "+s+" coral-th-column coral-th-"+n+"'"+r+">",c=i.colModel[a].index||i.colModel[a].name,o+=k+m+l>a?"<div id='jqgh_"+i.id+"_"+i.colModel[a].name+"' "+b+">"+i.colNames[a]:"<div id='jqgh_"+i.id+"_"+i.colModel[a].name+"'  title='"+i.colNames[a]+"'"+b+">"+i.colNames[a],i.colModel[a].width?i.colModel[a].width=parseInt(i.colModel[a].width,10):i.colModel[a].width=150,"boolean"!=typeof i.colModel[a].title&&(i.colModel[a].title=!0),c==i.sortname&&(i.lastsort=a),o+=g+"</div></th>"}o+="</tr></thead>",g=null;var t=$("<table class='coral-grid-htable' role='grid' aria-labelledby='gbox_"+this.id+"' cellspacing='0' cellpadding='0' border='0'></table>").append(o);h.gridColumns.find(".coral-grid-columns-view").append(t),$("thead tr:first th",j.columnsView).hover(function(){$(this).addClass("coral-state-hover")},function(){$(this).removeClass("coral-state-hover")}),h._setMultiselect();var u;if("undefined"!=typeof i.width)if("string"==typeof i.width&&"auto"==i.width){var v=$(h.element).innerWidth();h.options.width=v>0?v:"nw",u=v}else u=i.width;h._trigger("beforePopulate",null,[]),this._setColWidth(),$(h.element).append("<div class='coral-grid-resize-mark' id='rs_m"+h.options.id+"'>&#160;</div>"),o=$("thead:first",h.element).get(0);var w="";h.options.footerrow&&(w+="<table role='grid' style='width:"+h.options.tblwidth+"px' class='ui-jqgrid-ftable' cellspacing='0' cellpadding='0' border='0'><tbody><tr role='row' class='ui-widget-content footrow'>");var x=$("tr:first",o),y="<tr class='jqgfirstrow' role='row' style='height:auto'>";if($("th",x).each(function(a){d=i.colModel[a].width,"undefined"==typeof i.colModel[a].resizable&&(i.colModel[a].resizable=!0),i.colModel[a].resizable?(e=document.createElement("span"),$(e).html("&#160;").addClass("coral-grid-resize coral-grid-resize-"+n),$(e).css("cursor","col-resize"),$(this).addClass(i.resizeclass)):e="",$(this).css("width",d+"px").prepend(e);var b="";i.colModel[a].hidden&&($(this).css("display","none"),b="display:none;"),y+="<td role='gridcell' style='height:0px;width:"+d+"px;"+b+"'></td>",j.headers[a]={width:d,el:this},f=i.colModel[a].sortable,"boolean"!=typeof f&&(i.colModel[a].sortable=!0,f=!0);var c=i.colModel[a].name;"cb"!=c&&"subgrid"!=c&&"rn"!=c&&i.viewsortcols[2]&&$(">div",this).addClass("coral-grid-sortable"),f&&(i.viewsortcols[0]?($("div span.s-ico",this).show(),a==i.lastsort&&$("div span.coral-icon-"+i.sortorder,this).removeClass("coral-state-disabled")):a==i.lastsort&&($("div span.s-ico",this).show(),$("div span.coral-icon-"+i.sortorder,this).removeClass("coral-state-disabled"))),i.footerrow&&(w+="<td role='gridcell' "+h._formatCol(a,0,"",null,"",!1)+">&#160;</td>")}).mousedown(function(a){if(1==$(a.target).closest("th>span.coral-grid-resize").length){var b=h._getColumnHeaderIndex(this);return i.forceFit===!0&&(i.nv=h._nextVisible(b)),j.dragStart(b,a,h._getOffset(b)),!1}}).click(function(a){if(i.disableClick)return i.disableClick=!1,!1;var b,c,d="th>div.coral-grid-sortable";i.viewsortcols[2]||(d="th>div>span>span.coral-grid-ico-sort");var e=$(a.target).closest(d);if(1==e.length){var f=h._getColumnHeaderIndex(this);return i.viewsortcols[2]||(b=!0,c=e.attr("sort")),h._sortData($("div",this)[0].id,f,b,c,this),!1}}),h.options.onSortableColumns&&$.fn.sortable)try{$(h.element).grid("sortableColumns",x)}catch(z){}h.options.footerrow&&(w+="</tr></tbody></table>"),y+="</tr>";var A=$("<table id='"+h.options.id+"_table' class='coral-grid-btable' role='grid' cellspacing='0' cellpadding='0' border='0'></table>").append(y);h.gridRows.find(".coral-grid-rows-view").append(A),this.rows=h.gridRows.find(".coral-grid-btable")[0].rows,this.element.prepend("<div class='coral-grid-view'></div>");var B;if(h.options.footerrow&&(j.sDiv=$("<div class='ui-jqgrid-sdiv'></div>")[0],B=$("<div class='ui-jqgrid-hbox'></div>"),$(j.sDiv).append(B).width(j.width).insertAfter(h.gridColumns),$(B).append(w),j.footers=$(".ui-jqgrid-ftable",j.sDiv)[0].rows[0].cells,h.options.rownumbers&&(j.footers[0].className="ui-state-default jqgrid-rownum")),B=null,h.options.caption.length>0&&(j.caption=document.createElement("div"),j.caption.className="coral-grid-caption",$(j.caption).html(h.options.caption),this.element.prepend(j.caption)),$(j.columnsView).add(j.rowsView).parent().appendTo(this.element.find(".coral-grid-view")),i.shrinkToFit===!0&&i.forceFit===!0?($("table:first",j.rowsView).css("width",h.grid.width+"px"),$("table:first",j.columnsView).css("width",h.grid.width+"px")):i.shrinkToFit===!1&&($("table:first",j.rowsView).css("width",h.options.tblwidth+"px"),$("table:first",j.columnsView).css("width",h.options.tblwidth+"px")),h._setOption("width",u),this.grid.cols=this.rows[0].cells,i.groupHeader){this.setGroupHeaders({useColSpanStyle:!0,groupHeaders:i.groupHeaders});var C=$("tr.jqg-third-row-header",o);if(h.options.sortable&&$.fn.sortable)try{$(h.element).grid("sortableColumns",C)}catch(z){}}o=null,t=null,A=null},_sortkeys:["shiftKey","altKey","ctrlKey"],_getColumnHeaderIndex:function(a){var b,c=this,d=c.grid.headers,e=$.grid.getCellIndex(a);for(this.grid.rightfhDiv&&(e=d.length-e-1),b=0;b<d.length;b++)if(a===d[b].el){e=b;break}return e},_analyzeColumns:function(a){var b=0,c=this.options;for(this.options.colModel.length<=0&&a.children().each(function(a){var b=$.parser.parseOptions(this,null,["data"]);if("undefined"!=typeof b.name)c.colModel.push(b),c.colNames.push(b.label||$(this).html());else if("undefined"!=typeof b.header){var d,e=0;$(this).children().each(function(a){var b=$.parser.parseOptions(this,null,["data"]);c.colModel.push(b),c.colNames.push(b.label||$(this).html()),e++,0==a&&(d=b)}),c.groupHeaders.push({startColumnName:d.name,numberOfColumns:e,titleText:b.header})}}),b=0;b<this.options.colModel.length;b++){var d=this.options.colModel[b];"combobox"!=d.formatter&&"combotree"!=d.formatter&&"combogrid"!=d.formatter||("combotree"==d.formatter&&(d.formatoptions.dataStructure="tree"),0!=d.revertCode&&(d.revertCode=!0)),"combobox"!=d.edittype&&"combotree"!=d.edittype&&"autocomplete"!=d.edittype&&"combogrid"!=d.edittype||("combotree"==d.edittype&&(d.editoptions.dataStructure="tree"),d.formatter=d.formatter||"convertCode"),this.transTempData(d)}if(0===this.options.colNames.length)for(b=0;b<this.options.colModel.length;b++)this.options.colNames[b]=this.options.colModel[b].label||this.options.colModel[b].name;return this.options.colNames.length!==this.options.colModel.length?void alert("errors! colNames not equals to colModel!"):void a.children().not(".coral-grid-columns-view").remove()},_updateMultiSelectIndexsOption:function(a){var b=a.minIndex,c=a.maxIndex,d=a.preIndex,e=a.curIndex;return null==b&&(b=c=d=null==d?e:d),b>=e?(b=e,c=d):e>b&&c>e?(b=Math.min(e,d),c=Math.max(e,d)):e>c&&(c=e,b=d),{minIndex:b,maxIndex:c,preIndex:d}},_addShiftKeySelect:function(a,b){var c=this,d=c.options;if(b.rowId){var e=$(c.element),f=!1,g=e.find(".coral-grid-btable")[0].rows,h=g.namedItem(b.rowId).rowIndex;if(a.shiftKey){var i=c._updateMultiSelectIndexsOption({maxIndex:d.maxIndex,minIndex:d.minIndex,preIndex:d.preIndex,curIndex:h});d.minIndex=i.minIndex,d.maxIndex=i.maxIndex,d.preIndex=i.preIndex,e.grid("resetSelection");for(var j=d.minIndex;j<=d.maxIndex;j++){var k=!1;j==d.maxIndex&&(k=!0),e.grid("setSelection",g[j].id,k)}document.selection&&document.selection.empty?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),f=!0}else d.minIndex=d.maxIndex=null,d.preIndex=h;return f}},_setUpEvent:function(){var a,b,c,d,e,f=this,g=this.grid,h=this.options;f.options.cellEdit===!1&&f.options.hoverrows===!0&&$(f.element).bind("mouseover",function(a){var b=!("card"!=f.options.model);b?(e=$(a.target,f.pic).closest("li.gridPanel").find(".rowgrid"),"coral-subgrid"!==$(e).attr("class")&&$(e).addClass("coral-state-hover")):(e=$(a.target,f.rows).closest("tr.jqgrow"),"coral-subgrid"!==$(e).attr("class")&&$(e).addClass("coral-state-hover"))}).bind("mouseout",function(a){var b=!("card"!=f.options.model);e=b?$(a.target,f.pic).closest("li.gridPanel ").find(".rowgrid"):$(a.target,f.rows).closest("tr.jqgrow"),$(e).removeClass("coral-state-hover")}),$(g.rowsView).scroll(function(a){if(h.scroll){var b=$(g.rowsView)[0].scrollTop;void 0===g.scrollTop&&(g.scrollTop=0),b!=g.scrollTop&&(g.scrollTop=b,g.timer&&clearTimeout(g.timer),g.timer=setTimeout(g.populateVisible,h.scrollTimeout))}$(g.columnsView)[0].scrollLeft=$(g.rowsView)[0].scrollLeft;$(g.rowsView)[0].scrollTop;$(".coral-grid-btable-frozen").css("left",-$(g.rowsView)[0].scrollLeft+"px");var c=$(".row-editable",f.element);$(f.element).grid("getInd",f.editRowIndex,!0);c.length>0&&f.editButtonsPos(f.editRowIndex,c),h.footerrow&&(g.sDiv.scrollLeft=$(g.rowsView)[0].scrollLeft)}),$(".coral-grid-btable",f.element).add(f.pic).click(function(a){var g,i=!("card"!=f.options.model);if(d=a.target,e=i?$(d,f.pic).closest("li.gridPanel"):$(d,f.rows).closest("tr.jqgrow"),f.options.allowCellSelect){for(var j=0;j<this.rows.length;j++)$(this.rows[j]).find("td").hasClass("coral-grid-cell-focus")&&$(this.rows[j]).find("td").removeClass("coral-grid-cell-focus");"TD"==d.tagName?$(d).addClass("coral-grid-cell-focus"):$(d).closest("td").addClass("coral-grid-cell-focus")}if(0===$(e).length||e[0].className.indexOf("coral-state-disabled")>-1||$(d,f.element).closest("table.coral-grid-btable").length<0)return this;var k=$(d).hasClass("cbox"),l=$(f.element).triggerHandler("gridBeforeSelectRow",[e[0].id,a]);if(l=f._trigger("beforeSelectRow",a,[{rowId:e[0].id}]),l=l!==!1&&"stop"!==l,"A"!=d.tagName&&("INPUT"!=d.tagName&&"TEXTAREA"!=d.tagName&&"OPTION"!=d.tagName&&"SELECT"!=d.tagName||k)&&l===!0){if(g=e[0].id,c=$(d).closest("td,th").html(),!i){if(b=$.grid.getCellIndex(d),f._addShiftKeySelect(a,{rowId:e[0].id}))return;f._trigger("onSelectCell",a,[{rowId:g,rowIndex:e[0].rowIndex,cellIndex:b,cellHtml:c}])}if(f.options.editableRows&&1==f.options.clicksToEdit&&h.editrow!=g&&(f.restoreRow(h.editrow),f.rowEditButtons&&f.rowEditButtons.remove()),f.options.editableRows&&1==f.options.clicksToEdit&&!k&&(h.editrow=e[0].id,f.editRow(e[0].id,!0)),f.options.cellEdit===!0&&1==f.options.clicksToEdit){var m=f.options.colModel[b].editable,n=f.options.multiselect||f.options.singleselect;if(n&&k&&f.options.clickRowToSelect||n&&!m&&!f.options.multikey)$(f.element).grid("setSelection",g,!0,a);else if(!i)try{$(f.element).grid("editCell",e[0].rowIndex,b,!0)}catch(o){}}else f.options.multikey?a[f.options.multikey]?$(f.element).grid("setSelection",g,!0,a):(f.options.multiselect||f.options.singleselect)&&k?($(f.element).grid("setSelection",g,!0,a),k||f._cancelCheckAll()):(f.options.multiboxonly=!0,f.selectMultikey(f,a,g)):f.selectMultikey(f,a,g)}}),this._on({keydown:function(a){var b,c,g,h,i,j,k,l,m=$.coral.keyCode,n=f.options;if(!n.filterToolbar){switch(a.keyCode){case m.UP:if(a.preventDefault(),d=$(a.target),e=$(d,f.rows).closest("tr.jqgrow"),g=this.rows.namedItem(e[0].id+""),n.allowCellSelect){for(var o=0;o<$(g).find("td").length;o++){var p=$(g).find("td")[o];$(p).hasClass("coral-grid-cell-focus")&&(j=$.grid.getCellIndex(p),k=$(p))}if(this.options.iColFocus=j,i=$(g).prevAll(":visible:eq(0)").find("td")[j],b=$(g).prevAll(":visible:eq(0):not(.jqgfirstrow)"),this.options.focusrow=b[0].id,this.options.iRowFocus=b[0].rowIndex,!b||0==b.length)return;k.removeClass("coral-grid-cell-focus"),$(i).addClass("coral-grid-cell-focus"),b.focus()}break;case m.DOWN:if(a.preventDefault(),d=$(a.target),e=$(d,f.rows).closest("tr.jqgrow"),g=this.rows.namedItem(e[0].id+""),n.allowCellSelect){for(var o=0;o<$(g).find("td").length;o++){var p=$(g).find("td")[o];$(p).hasClass("coral-grid-cell-focus")&&(j=$.grid.getCellIndex(p),k=$(p))}if(this.options.iColFocus=j,h=$(g).nextAll(":visible:eq(0)").find("td")[j],c=$(g).nextAll(":visible:eq(0)"),this.options.focusrow=c[0].id,this.options.iRowFocus=c[0].rowIndex,!c||0==c.length)return;k.removeClass("coral-grid-cell-focus"),$(h).addClass("coral-grid-cell-focus"),c.focus()}break;case m.RIGHT:a.preventDefault(),d=$(a.target),e=$(d,f.rows).closest("tr.jqgrow"),g=this.rows.namedItem(e[0].id+"");for(var o=0;o<$(g).find("td").length;o++){var p=$(g).find("td")[o];$(p).hasClass("coral-grid-cell-focus")&&(l=$.grid.getCellIndex(p),k=$(p))}if(h=$(g).find("td")[l+1],this.options.focusrow=e[0].id,this.options.iRowFocus=e[0].rowIndex,!$(h)||0==$(h).length)return;for(;!$(h).is(":visible")&&l<$(g).find("td").length;)l++,h=$(g).find("td")[l+1];this.options.iColFocus=l+1,k.removeClass("coral-grid-cell-focus"),$(h).addClass("coral-grid-cell-focus"),$(h).focus();break;case m.LEFT:a.preventDefault(),d=$(a.target),e=$(d,f.rows).closest("tr.jqgrow"),g=this.rows.namedItem(e[0].id+"");for(var o=0;o<$(g).find("td").length;o++){var p=$(g).find("td")[o];$(p).hasClass("coral-grid-cell-focus")&&(j=$.grid.getCellIndex(p),k=$(p))}if(i=$(g).find("td")[j-1],this.options.focusrow=e[0].id,this.options.iRowFocus=e[0].rowIndex,!$(i)||0==$(i).length)return;for(;!$(i).is(":visible");){if(0==j)return;j--,i=$(g).find("td")[j-1]}this.options.iColFocus=j-1,k.removeClass("coral-grid-cell-focus"),$(i).addClass("coral-grid-cell-focus"),$(i).focus()}f.options.shortCut&&$.coral.callFunction(n.shortCut,event,this)}}}),$(f.element).dblclick(function(a){if(d=a.target,e=$(d,f.rows).closest("tr.jqgrow"),0!==$(e).length){f.options.editableRows&&h.editrow!=e[0].id&&(f.restoreRow(h.editrow),f.rowEditButtons&&f.rowEditButtons.remove());var b=e[0].rowIndex,c=$.grid.getCellIndex(d);if(f.options.editableRows&&2==f.options.clicksToEdit&&(h.editrow=e[0].id,f.editRow(e[0].id,!0)),f.options.cellEdit===!0&&2==f.options.clicksToEdit){b=e[0].rowIndex;try{$(f.element).grid("editCell",b,c,!0)}catch(g){}}f._trigger("onDblClickRow",null,[{rowId:e[0].id,rowIndex:b,cellIndex:c}])}}).bind("contextmenu",function(c){d=c.target,e=$(d,f.rows).closest("tr.jqgrow"),0!==$(e).length&&(f.options.multiselect||$(f.element).grid("setSelection",e[0].id,!0,c),a=e[0].rowIndex,b=$.grid.getCellIndex(d),f._trigger("onRightClickRow",null,[{rowId:e[0].id,rowIndex:a,cellIndex:b}]))}),$(g.columnsView).mousemove(function(a){return g.resizing?(g.dragMove(a),!1):void 0}),$(".coral-grid-labels",g.columnsView).bind("selectstart",function(){return!1}),$(document).mouseup(function(){return g.resizing?(g.dragEnd(),!1):!0}),this._off($(".coral-paginator-page")),this._on({"click.coral-paginator-page":function(a){var b=f._intNum($(a.target).html(),1);return f.options.page=b,f._clearVals(this.id)?(f._populate(),!1):!1}})},selectMultikey:function(a,b,c){var d=b.target,e=$(d).hasClass("cbox");if(a.options.multiselect&&a.options.multiboxonly)if(e)$(a.element).grid("setSelection",c,!0,b);else{var f=a.options.frozenColumns?a.options.id+"_frozen":"";a.options.clickRowToSelect&&($(a.options.selarrrow).each(function(b,c){var d=a.rows.namedItem(c);$(d).removeClass("coral-state-highlight"),$("#jqg_"+$.grid.coralID(a.options.id)+"_"+$.grid.coralID(c))[a.options.useProp?"prop":"attr"]("checked",!1),f&&($("#"+$.grid.coralID(c),"#"+$.grid.coralID(f)).removeClass("coral-state-highlight"),$("#jqg_"+$.grid.coralID(a.options.id)+"_"+$.grid.coralID(c),"#"+$.grid.coralID(f))[a.options.useProp?"prop":"attr"]("checked",!1))}),a.options.selarrrow=[],$(a.element).grid("setSelection",c,!0,b))}else(e||a.options.clickRowToSelect)&&$(a.element).grid("setSelection",c,!0,b)},restoreAll:function(){this.options.editableRows&&(this.restoreRow(this.options.editrow),this.rowEditButtons&&this.rowEditButtons.remove()),this.options.savedRow.length>0&&!$(this.element).grid("saveCell",this.options.savedRow[0].id,this.options.savedRow[0].ic)},setSelectAll:function(a){var b,c,d=this,e="card"===this.options.model;if(b=e?d.element.find(".coral-pic>li"):d.rows,this.options.multiselect){var f,g=[],h=d.options.frozenColumns===!0?d.options.id+"_frozen":"";a?($(b).each(function(a){if(c=e?a>=0:a>0,c>0&&!$(this).hasClass("coral-subgrid")&&!$(this).hasClass("jqgroup")&&!$(this).hasClass("coral-state-disabled")){var f=$.inArray(this.id,d.options.selarrrow);-1===f&&(e?($(b).find("#jqg_"+$.grid.coralID(d.options.id)+"_"+$.grid.coralID(this.id))[d.options.useProp?"prop":"attr"]("checked",!0),$(b).find(".rowgrid").addClass("coral-state-highlight").attr("aria-selected","true")):($(b).find("#jqg_"+$.grid.coralID(d.options.id)+"_"+$.grid.coralID(this.id))[d.options.useProp?"prop":"attr"]("checked",!0),d._setHeadCheckBox(!0),$(this).addClass("coral-state-highlight").attr("aria-selected","true"),h&&($("#jqg_"+$.grid.coralID(d.options.id)+"_"+$.grid.coralID(d.rows[a].id),d.grid.fbDiv)[d.options.useProp?"prop":"attr"]("checked",!0),$("#"+$.grid.coralID(d.rows[a].id),d.grid.fbDiv).addClass("coral-state-highlight"),d.grid.fhDiv?($("#jqg_"+$.grid.coralID(d.options.id)+"_"+$.grid.coralID(d.rows[a].id),d.grid.fbDiv)[d.options.useProp?"prop":"attr"]("checked",!0),$("#"+$.grid.coralID(d.rows[a].id),d.grid.fbDiv).addClass("coral-state-highlight")):d.grid.rightfhDiv&&($("#jqg_"+$.grid.coralID(d.options.id)+"_"+$.grid.coralID(d.rows[a].id),d.grid.rightfbDiv)[d.options.useProp?"prop":"attr"]("checked",!0),$("#"+$.grid.coralID(d.rows[a].id),d.grid.rightfbDiv).addClass("coral-state-highlight")))),d.options.selarrrow.push(this.id),d.options.selrow=this.id)}}),f=!0,g=[]):(d.options.selarrrow=[],$(b).each(function(a){c=e?a>=0:a>0,c&&($(this).hasClass("coral-subgrid")||$(this).hasClass("coral-state-disabled")||(e?($(b).find("#jqg_"+$.grid.coralID(d.options.id)+"_"+$.grid.coralID(this.id))[d.options.useProp?"prop":"attr"]("checked",!1),$(b).find(".rowgrid").removeClass("coral-state-highlight").attr("aria-selected","false")):($(b).find("#jqg_"+$.grid.coralID(d.options.id)+"_"+$.grid.coralID(this.id))[d.options.useProp?"prop":"attr"]("checked",!1),d._setHeadCheckBox(!1),$(this).removeClass("coral-state-highlight").attr("aria-selected","false"),h&&(d.grid.fhDiv?($("#jqg_"+$.grid.coralID(d.options.id)+"_"+$.grid.coralID(d.rows[a].id),d.grid.fbDiv)[d.options.useProp?"prop":"attr"]("checked",!1),$("#"+$.grid.coralID(d.rows[a].id),d.grid.fbDiv).removeClass("coral-state-highlight")):d.grid.rightfhDiv&&($("#jqg_"+$.grid.coralID(d.options.id)+"_"+$.grid.coralID(d.rows[a].id),d.grid.rightfbDiv)[d.options.useProp?"prop":"attr"]("checked",!1),$("#"+$.grid.coralID(d.rows[a].id),d.grid.rightfbDiv).removeClass("coral-state-highlight")))),g.push(this.id)))}),d.options.selrow=null,f=!1),d._trigger("onSelectAll",null,[{aRowIds:f?d.options.selarrrow:g,status:f}])}},_setMultiselect:function(){var a=this;if(this.options.multiselect){$("#cb_"+$.grid.coralID(a.options.id),this.grid.columnsView).bind("click",function(b){a.setSelectAll(this.checked)})}},_refresh:function(a,b){},reload:function(a){var b=this,c=(this.grid,{}),d=!1,e=[];if("undefined"==typeof a&&(a="json"===this.options.orgdatatype?this.options.url:this.options.data),a||this.options.url?!a&&this.options.url&&(a=this.options.url):a=[],"string"!=typeof a?(c=a,c.data?e=c.data:c.url?(a=c.url,d=!0):a instanceof Array?e=a:c.url||c.data||this.options.url?c.url||c.data||!this.options.url||(a=this.options.url,d=!0):e=this.options.data):d=!0,b.options.treeGrid===!0&&(b.options.datatype=b.options.treedatatype),c&&c.current&&b.grid.selectionPreserver(b),"local"==b.options.datatype?($(b.element).grid("resetSelection"),b.options.data.length&&(b.normalizeData(),b.refreshIndex())):b.options.treeGrid||(b.options.selrow=null,b.options.multiselect&&(b.options.selarrrow=[],b._setHeadCheckBox(!1)),b.options.savedRow=[]),b.options.scroll&&emptyRows(b.grid.rowsView,!0,!1),c&&c.page){var f=c.page;f>b.options.lastpage&&(f=b.options.lastpage),1>f&&(f=1),b.options.page=f,b.grid.prevRowHeight?b.grid.rowsView.scrollTop=(f-1)*b.grid.prevRowHeight*b.options.rowNum:b.grid.rowsView.scrollTop=0;
}if(b.grid.prevRowHeight&&b.options.scroll)delete b.options.lastpage,b._populateVisible();else{var g=b.options.search;1==b.options.localonce?b.options.search=!0:d?(b.options.datatype="json",delete b.options.orgdatatype,b.options.url=a):(b.options.datatype="local",delete b.options.orgdatatype,b.options.data=e),b._populate(),b.options.search=g,b.options.localonce=!1}return!1},resetFrozen:function(){this._hasHorizontalScrollBar()?($(this.grid.rightfbDiv).show(),$(this.grid.rightfhDiv).show()):($(this.grid.rightfbDiv).hide(),$(this.grid.rightfhDiv).hide())},refresh:function(a){var b,c=this,d=this.options,e=d.fitStyle,f=this.element.parent();if(b=f.height(),c.resetFrozen(),this.element.siblings(":visible").each(function(){var a=$(this),c=a.css("position");"absolute"!==c&&"fixed"!==c&&(b-=a.outerHeight(!0))}),$("#"+c.element[0].id).length&&("fill"===e?($.coral.fitParent(this.component(),!0),$(c.element).grid("option","height",b),$(c.element).grid("option","width",c.element.innerWidth()>0?c.element.innerWidth():0)):"width"===e?($.coral.fitParent(this.component(),!1),$(c.element).grid("option","width",c.element.innerWidth()>0?c.element.innerWidth():0),$(c.element).grid("option","height",c.options.height)):"height"===e?($.coral.fitParent(this.component(),!0),$(c.element).grid("option","height",b)):"auto"===e&&($.coral.fitParent(this.component(),!1),$(c.element).grid("option","height",c.options.height)),c.refreshPager(),c._noRecordsTipsPositon(),c.options.frozenColumns===!0&&c.resizeFrozen(),this.element.find(".loading-overlay").length))switch(this.options.loadui){case"disable":break;case"enable":case"block":$(this.element).loading("refresh")}},refreshPager:function(){var a=this;this.pagers&&(this.pagers.each(function(b){var c=$(".paginator-left",a.element).outerWidth()+5,d=$("#"+a.pagers[b].id).width();$(".toolbarpanel",a.element).css({left:c+"px",position:"absolute",top:0,width:d-c+"px"})}),a.options.pager="."+a.id,$(".ctrl-init-toolbar",a.element).length&&$(".ctrl-init-toolbar",a.element).toolbar("refresh"))},setSelectionAll:function(){$("#cb_"+this.options.id).prop("checked")||$("#cb_"+this.options.id).trigger("click")},setSelection:function(a,b,c){function d(a){var b=$(k.grid.rowsView)[0].clientHeight,c=$(k.grid.rowsView)[0].scrollTop,d=k.rows[a].offsetTop,e=k.rows[a].clientHeight;d+e>=b+c?$(k.grid.rowsView)[0].scrollTop=d-(b+c)+e+c:b+c>d&&c>d&&($(k.grid.rowsView)[0].scrollTop=d)}var e,f,g,h,i,j,k=this,l="card"===this.options.model;void 0!==a&&(b=b!==!1,f=l?this.element.find(".coral-pic #"+a)[0]:this.rows.namedItem(a+""),!f||!f.className||f.className.indexOf("coral-state-disabled")>-1||(this.options.scrollrows===!0&&(g=this.rows.namedItem(a).rowIndex,g>=0&&d(g)),this.options.frozenColumns===!0&&(j=this.options.id+"_frozen"),this.options.multiselect?(this._setHeadCheckBox(!1),this.options.selrow=f.id,h=$.inArray(this.options.selrow,this.options.selarrrow),-1===h?(l?"coral-subgrid"!==f.className&&$(f).find(".rowgrid").addClass("coral-state-highlight").attr("aria-selected","true"):"coral-subgrid"!==f.className&&$(f).addClass("coral-state-highlight").attr("aria-selected","true"),e=!0,this.options.selarrrow.push(this.options.selrow)):(l?"coral-subgrid"!==f.className&&$(f).find(".rowgrid").removeClass("coral-state-highlight").attr("aria-selected","false"):"coral-subgrid"!==f.className&&$(f).removeClass("coral-state-highlight").attr("aria-selected","false"),e=!1,this.options.selarrrow.splice(h,1),i=this.options.selarrrow[0],this.options.selrow=void 0===i?null:i),this.rows.length-1===this.options.selarrrow.length&&this._setHeadCheckBox(!0),$("#jqg_"+$.grid.coralID(this.options.id)+"_"+$.grid.coralID(f.id),$(f))[this.options.useProp?"prop":"attr"]("checked",e),j&&(l?-1===h?$("#"+$.grid.coralID(a),"#"+$.grid.coralID(j)).find(".rowgrid").addClass("coral-state-highlight"):$("#"+$.grid.coralID(a),"#"+$.grid.coralID(j)).find(".rowgrid").removeClass("coral-state-highlight"):-1===h?$("#"+$.grid.coralID(a),"#"+$.grid.coralID(j)).addClass("coral-state-highlight"):$("#"+$.grid.coralID(a),"#"+$.grid.coralID(j)).removeClass("coral-state-highlight"),$("#jqg_"+$.grid.coralID(this.options.id)+"_"+$.grid.coralID(a),"#"+$.grid.coralID(j))[this.options.useProp?"prop":"attr"]("checked",e)),b&&this._trigger("onSelectRow",c,[{rowId:f.id,status:e}])):"coral-subgrid"!==f.className&&(this.options.selrow!=f.id?(l?(this.element.find("#"+this.options.selrow+">ul").removeClass("coral-state-highlight").attr({"aria-selected":"false",tabindex:"-1"}),$(f).find(".rowgrid").addClass("coral-state-highlight").attr({"aria-selected":"true",tabindex:"0"}),j&&($("#"+$.grid.coralID(this.options.selrow),"#"+$.grid.coralID(j)).find(".rowgrid").removeClass("coral-state-highlight"),$("#"+$.grid.coralID(a),"#"+$.grid.coralID(j)).find(".rowgrid").addClass("coral-state-highlight"))):($(this.rows.namedItem(this.options.selrow)).removeClass("coral-state-highlight ").attr({"aria-selected":"false",tabindex:"-1"}),$(f).addClass("coral-state-highlight").attr({"aria-selected":"true",tabindex:"0"}),j&&($("#"+$.grid.coralID(this.options.selrow),"#"+$.grid.coralID(j)).removeClass("coral-state-highlight"),$("#"+$.grid.coralID(a),"#"+$.grid.coralID(j)).addClass("coral-state-highlight "))),e=!0,$("#jqg_"+$.grid.coralID(this.options.id)+"_"+$.grid.coralID(f.id),$(f))[this.options.useProp?"prop":"attr"]("checked",e),j&&$("#jqg_"+$.grid.coralID(this.options.id)+"_"+$.grid.coralID(a),"#"+$.grid.coralID(j))[this.options.useProp?"prop":"attr"]("checked",e)):e=!1,this.options.selrow=f.id,b&&this._trigger("onSelectRow",c,[{rowId:f.id,status:e}]))))},_setHeadCheckBox:function(a){var b=this;$("#cb_"+$.grid.coralID(b.options.id),b.grid.columnsView)[b.options.useProp?"prop":"attr"]("checked",a);var c=b.options.frozenColumns?b.options.id+"_frozen":"";c&&$("#cb_"+$.grid.coralID(b.options.id),b.grid.fhDiv)[b.options.useProp?"prop":"attr"]("checked",a)},setFrozenRows:function(a){function b(a){var b=d.rowsView2.find(".coral-grid-btable")[0].rows[0];(a?d.rowsView1:d.rowsView2).children("table.coral-grid-btable-frozen").append($(b).clone())}function c(b){var c=d.rowsView2.find(".coral-grid-btable tr").filter(function(b){return 0==b?!1:a>=b?!0:void 0});d.rowsView2.find(".coral-grid-btable")[0].rows[1];(b?d.rowsView1:d.rowsView2).children("table.coral-grid-btable-frozen").append(c)}var d=this,e=d.grid;d.destroyFrozenRows(),d.rowsView2=$(e.rowsView),d.rowsView2.children("table.coral-grid-btable-frozen").length||($(d.rowsView2).prepend('<table class="coral-grid-btable-frozen" cellspacing="0" cellpadding="0"></table>'),d.rowsView2.children("table.coral-grid-btable-frozen").css({position:"absolute",left:0,top:$(e.columnsView).height()+"px"}));var f=d.element.find(".coral-grid-rows-view").height();b(!1),c(!1);var g=d.rowsView2.find("table.coral-grid-btable-frozen").outerHeight();d.rowsView2.css({"margin-top":g+"px",height:f-g+"px"}),d.rowsView2.find(".coral-grid-btable-frozen").css({left:-$(e.rowsView)[0].scrollLeft+"px",width:d.rowsView2.find(".coral-grid-btable").width()+"px","table-layout":"fixed"})},destroyFrozenRows:function(){function a(a){var b=c.rowsView2.find("table.coral-grid-btable-frozen tr").filter(function(a){return 0!=a});(a?c.rowsView1:c.rowsView2).children("table.coral-grid-btable-frozen")[0].rows[1];$(c.rowsView2.find(".coral-grid-btable tbody:first tr:first")[0]).after(b)}function b(a){(a?c.rowsView1:c.rowsView2).children("table.coral-grid-btable-frozen").remove()}var c=this,d=c.grid;c.rowsView2=$(d.rowsView),c.rowsView2.children("table.coral-grid-btable-frozen").length||($(c.rowsView2).prepend('<table class="coral-grid-btable-frozen" cellspacing="0" cellpadding="0"></table>'),c.rowsView2.children("table.coral-grid-btable-frozen").css({position:"absolute",left:0,top:0}));var e=c.element.find(".coral-grid-rows-view").height(),f=c.rowsView2.find("table.coral-grid-btable-frozen").outerHeight();a(!1),b(!1),c.rowsView2.css({"margin-top":0,height:e+f+"px"})},showHideCol:function(a,b){var c,d=this,e=!1,f=$.support.boxSizing?0:this._intNum(this.options.cellLayout,0);if(d.grid){"string"==typeof a&&(a=[a]),b="none"!=b?"":"none";var g=""===b,h=d.options.groupHeader&&("object"==typeof d.options.groupHeader||$.isFunction(d.options.groupHeader));h&&$(d.element).grid("destroyGroupHeader",!1),$(this.options.colModel).each(function(h){-1!==$.inArray(this.name,a)&&this.hidden===g&&(d.options.frozenColumns===!0&&this.frozen===!0,$("tr",d.grid.columnsView).each(function(){$(this.cells[h]).css("display",b)}),$(d.rows).each(function(){$(this).hasClass("jqgroup")||$(this.cells[h]).css("display",b)}),d.options.footerrow&&$("tr.footrow td:eq("+h+")",d.grid.sDiv).css("display",b),c=this.widthOrg?this.widthOrg:parseInt(this.width,10),"none"===b?d.options.tblwidth-=c+f:d.options.tblwidth+=c+f,this.hidden=!g,e=!0,d._trigger("onShowHideCol",null,[{show:g,name:this.name,index:h}]))}),e===!0&&(d.options.shrinkToFit!==!0||isNaN(d.options.height)||(d.options.tblwidth+=parseInt(d.options.scrollOffset,10)),d._setGridWidth(d.options.shrinkToFit===!0?d.options.tblwidth:d.options.width)),h&&$(d.element).grid("setGroupHeaders",d.options.groupHeader)}},hideCol:function(a){return $(this.element).grid("showHideCol",a,"none")},showCol:function(a){return $(this.element).grid("showHideCol",a,"")},remapColumns:function(a,b,c){function d(b){var c;c=b.length?$.makeArray(b):$.extend({},b),$.each(a,function(a){b[a]=c[this]})}function e(b,c){$(">tr"+(c||""),b).each(function(){var b=this,c=$.makeArray(b.cells);$.each(a,function(){var a=c[this];a&&b.appendChild(a)})})}var f=this;d(f.options.colModel),d(f.options.colNames),d(f.grid.headers),e($("thead:first",f.grid.columnsView),c&&":not(.coral-grid-labels)"),b&&e($("#"+$.grid.coralID(f.options.id)+" tbody:first"),".jqgfirstrow, tr.jqgrow, tr.jqfoot"),f.options.footerrow&&e($("tbody:first",f.grid.sDiv)),f.options.remapColumns&&(f.options.remapColumns.length?d(f.options.remapColumns):f.options.remapColumns=$.makeArray(a)),f.options.lastsort=$.inArray(f.options.lastsort,a),f.options.treeGrid&&(f.options.expColInd=$.inArray(f.options.expColInd,a))},sortableColumns:function(a){function b(){c.options.disableClick=!0}var c=this,d=$.grid.coralID(c.options.id),e={tolerance:"pointer",axis:"x",cancel:".coral-columnSortable-disabled",scrollSensitivity:"1",helper:function(a,b){return b.clone()},items:">th:not(:has(#jqgh_"+d+"_cb,#jqgh_"+d+"_rn,#jqgh_"+d+"_subgrid),:hidden, .coral-columnSortable-disabled)",placeholder:{element:function(a){var b="undefined"==typeof a.attr("rowspan")?"1":"2",c="undefined"==typeof a.attr("colspan")?"1":"2",d=$(document.createElement(a[0].nodeName)).addClass(a[0].className+" coral-sortable-placeholder coral-state-highlight").removeClass("coral-sortable-helper").attr("rowspan",b).attr("colspan",c)[0];return d},update:function(a,b){b.height(a.currentItem.innerHeight()-parseInt(a.currentItem.css("paddingTop")||0,10)-parseInt(a.currentItem.css("paddingBottom")||0,10)),b.width(a.currentItem.innerWidth()-parseInt(a.currentItem.css("paddingLeft")||0,10)-parseInt(a.currentItem.css("paddingRight")||0,10))}},update:function(a,b){var d=$(b.item).parent(),e=$(">th",d),f=c.options.colModel,g={},h=c.options.id+"_";b.itemId=[],$.each(f,function(a){g[this.name]=a});var i=[],j=[];e.each(function(){var a=$(">div",this).get(0).id.replace(/^jqgh_/,"").replace(h,"");a in g&&(i.push(g[a]),j.push(a))}),$.each(b.item,function(a){b.itemId.push(b.item[a].id.replace(/^jqgh_/,"").replace(h,""))}),b.prevItemId=$(b.item[0]).prev("th").attr("id").replace(/^jqgh_/,"").replace(h,""),b.nextItemId=$(b.item[0]).next("th").attr("id").replace(/^jqgh_/,"").replace(h,""),b.targetId=b.position.left>b.originalPosition.left?b.prevItemId:b.nextItemId,$(c.element).grid("remapColumns",i,!0,!0),b.permutation=i,b.permutationOfId=j,c._trigger("onSortableColumns",a,[b]),setTimeout(function(){c.options.disableClick=!1},50)}};if($.extend(e,c.options.sortableColumnsOptions),e.beforesortablecolumns){var f=e.beforesortablecolumns;e.start=function(a,c){b(),f.call(this,a,c)}}else e.start=b;c.options.sortableColumnsOptions.exclude&&(e.items+=":not("+c.options.sortableColumnsOptions.exclude+")"),a.sortable(e).data("sortable").floating=!0},setCaption:function(a){this.options.caption=a,$("span.coral-grid-title, span.coral-grid-title-rtl",this.grid.caption).html(a),$(this.grid.cDiv).show()},setLabel:function(a,b,c,d){var e=this,f=-1;if(e.grid&&"undefined"!=typeof a&&($(e.options.colModel).each(function(b){return this.name==a?(f=b,!1):void 0}),f>=0)){var g=$("tr.coral-grid-labels th:eq("+f+")",e.grid.columnsViews);if(b){var h=$(".s-ico",g);$("[id^=jqgh_]",g).empty().html(b).append(h),e.options.colNames[f]=b}c&&("string"==typeof c?$(g).addClass(c):$(g).css(c)),"object"==typeof d&&$(g).attr(d)}},setCell:function(a,b,c,d,e,f){var g,h,i=this,j=-1;if(i.grid&&(isNaN(b)?$(i.options.colModel).each(function(a){return this.name==b?(j=a,!1):void 0}):j=parseInt(b,10),j>=0)){var k=i.rows.namedItem(a),l=$(i.element).grid("getRowData",a);if(k){var m=$("td:eq("+j+")",k);if((""!==c||f===!0)&&(g=i._formatter(a,c,j,l,"edit"),h=i.options.colModel[j].title?{title:$.grid.stripHtml(g)}:{},i.options.treeGrid&&$(".tree-wrap",$(m)).length>0?$("span",$(m)).html(g).attr(h):$(m).html(g).attr(h),$.fn.afterFmatter.call(i),"local"==i.options.datatype)){var n,o=i.options.colModel[j];n=i.options._index[a],"undefined"!=typeof n&&(i.options.data[n][o.name]=c)}"string"==typeof d?$(m).addClass(d):d&&$(m).css(d),"object"==typeof e&&$(m).attr(e)}}},sortableDisable:function(){$("tbody:first",this.grid.rowsView).sortable("disable")},sortableEnable:function(){$("tbody:first",this.grid.rowsView).sortable("enable")},getCell:function(a,b){var c=!1,d=this,e=-1;if(d.grid){if(isNaN(b)?$(d.options.colModel).each(function(a){return this.name===b?(e=a,!1):void 0}):e=parseInt(b,10),e>=0){var f=d.rows.namedItem(a);if(f)try{c=1==d.options.enableHighlight?$.unformat.call(d,$("td:eq("+e+")",f),{rowId:f.id,colModel:d.options.colModel[e]},e,!0):$.unformat.call(d,$("td:eq("+e+")",f),{rowId:f.id,colModel:d.options.colModel[e]},e)}catch(g){c=$.grid.htmlDecode($("td:eq("+e+")",f).html())}}return c}},getCol:function(a,b,c){var d,e,f,g,h=[],i=0;b="boolean"!=typeof b?!1:b,"undefined"==typeof c&&(c=!1);var j=this,k=-1;if(j.grid){if(isNaN(a)?$(j.options.colModel).each(function(b){return j.options.colModel[b].name===a?(k=b,!1):void 0}):k=parseInt(a,10),k>=0){var l=j.rows.length,m=0;if(l&&l>0){for(;l>m;){if($(j.rows[m]).hasClass("jqgrow")){try{d=1==j.options.enableHighlight?$.unformat.call(j,$(j.rows[m].cells[k]),{rowId:j.rows[m].id,colModel:j.options.colModel[k]},k,!0):$.unformat.call(j,$(j.rows[m].cells[k]),{rowId:j.rows[m].id,colModel:j.options.colModel[k]},k)}catch(n){d=$.grid.htmlDecode(j.rows[m].cells[k].innerHTML)}c?(g=parseFloat(d),i+=g,0===m?(e=g,f=g):(e=Math.min(e,g),f=Math.max(f,g))):b?h.push({id:j.rows[m].id,value:d}):h.push(d)}m++}if(c)switch(c.toLowerCase()){case"sum":h=i;break;case"avg":h=i/l;break;case"count":h=l;break;case"min":h=e;break;case"max":h=f}}}return h}},getCellComponent:function(a,b,c,d,e,f){var g=this;if(g.grid)return this.element.find("#"+a).find("[aria-describedby$="+b+"]").find(".ctrl-init")},_formatter:function(a,b,c,d,e){var f,g=this.options.colModel[c];if("undefined"!=typeof g.formatter){var h={rowId:a,colModel:g,gid:this.options.id,pos:c,model:this.options.model},i=$.coral.toFunction(g.formatter);f=$.isFunction(i)?i.apply(this.element[0],[b,h,d,e]):$.fmatter?$.fn.fmatter.call(this,g.formatter,b,h,d,e):this._cellVal(b)}else f=this._cellVal(b);return f},_getOffset:function(a){var b,c=this,d={},e=$.support.boxSizing?0:c.options.cellLayout;for(d[0]=d[1]=d[2]=0,b=0;a>=b;b++)c.options.colModel[b].hidden!==!1&&"undefined"!=typeof c.options.colModel[b].hidden||(d[0]+=c.options.colModel[b].width+e);return d[0]=d[0]-c.grid.rowsView.scrollLeft,d[2]+=$(c.grid.rowsView).height()+$(c.grid.columnsView).height(),d},_sortData:function(a,b,c,d,e){var f=this;if(this.options.colModel[b].sortable){f.options.b_sortdata=!0;var g;if(!(this.options.savedRow.length>0)){if(c||(this.options.lastsort==b?"asc"==this.options.sortorder?this.options.sortorder="desc":"desc"==this.options.sortorder&&(this.options.sortorder="asc"):this.options.sortorder=this.options.colModel[b].firstsortorder||"asc",this.options.page=1),d){if(this.options.lastsort==b&&this.options.sortorder==d&&!c)return;f.options.sortorder=d}var h=this.grid.headers[this.options.lastsort].el,i=this.options.frozenColumns?e:this.grid.headers[b].el;if($("span.coral-grid-ico-sort",h).addClass("coral-state-disabled"),$(h).attr("aria-selected","false"),this.options.frozenColumns&&(this.grid.fhDiv?(this.grid.fhDiv.find("span.coral-grid-ico-sort").addClass("coral-state-disabled"),this.grid.fhDiv.find("th").attr("aria-selected","false")):this.grid.rightfhDiv&&(this.grid.rightfhDiv.find("span.coral-grid-ico-sort").addClass("coral-state-disabled"),this.grid.rightfhDiv.find("th").attr("aria-selected","false"))),$("span.coral-icon-"+this.options.sortorder,i).removeClass("coral-state-disabled"),$(i).attr("aria-selected","true"),this.options.viewsortcols[0]||(this.options.lastsort!=b?(this.options.frozenColumns&&(this.grid.fhDiv?this.grid.fhDiv.find("span.s-ico").hide():this.grid.rightfhDiv&&this.grid.rightfhDiv.find("span.s-ico").hide()),$("span.s-ico",h).hide(),$("span.s-ico",i).show()):""===this.options.sortname&&$("span.s-ico",i).show()),a=a.substring(5+this.options.id.length+1),this.options.sortname=this.options.colModel[b].index||a,g=this.options.sortorder,"stop"===f._trigger("onSortCol",null,[{id:a,colIndex:b,sortorder:g}]))return void(this.options.lastsort=b);if("local"==this.options.datatype?this.options.deselectAfterSort&&$(this.element).grid("resetSelection"):(this.options.selrow=null,this.options.multiselect&&f._setHeadCheckBox(!1),this.options.selarrrow=[],this.options.savedRow=[]),this.options.scroll){var j=this.grid.rowsView.scrollLeft;emptyRows(this.grid.rowsView,!0,!1),this.grid.columnsView.scrollLeft=j}this.options.subGrid&&"local"==this.options.datatype&&$("td.sgexpanded","#"+$.grid.coralID(this.options.id)).each(function(){$(this).trigger("click")}),this._populate(),this.options.lastsort=b,this.options.sortname!=a&&b&&(this.options.lastsort=b),f.options.b_sortdata=!1}}},_intNum:function(a,b){return a=parseInt(a,10),isNaN(a)?b?b:0:a},_beginReq:function(){var a=$("#noRecordsTips_"+$.grid.coralID(this.options.id));if(a.is(":visible")&&a.hide(),this.refresh(),this.grid.columnsView.loading=!0,!this.options.hiddengrid)switch(this.options.loadui){case"disable":break;case"enable":$(this.element).loading({position:"overlay",text:this.options.loadtext});break;case"block":$("#lui_"+$.grid.coralID(this.options.id)).show(),$(this.element).loading({position:"overlay",text:this.options.loadtext})}},_endReq:function(){var a=this;switch(this._delay(function(){a.refreshPager()},300),this.grid.columnsView.loading=!1,this.options.loadui){case"disable":break;case"enable":$(this.element).loading("hide");break;case"block":$("#lui_"+$.grid.coralID(this.options.id)).hide(),$(this.element).loading("hide")}this.element.find(".coral-grid-htable,.coral-grid-btable").css({"table-layout":"fixed"}),0==$(a.grid.rowsView).find(".jqgrow").length?(a._noRecordsTipsPositon(),$("#noRecordsTips_"+$.grid.coralID(a.options.id)).css("display","inline-block"),$(a.grid.fhDiv).css("display","none"),$(a.grid.fhDiv).css("display","none")):($("#noRecordsTips_"+$.grid.coralID(a.options.id)).css("display","none"),$(a.grid.fhDiv).css("display","block"),$(a.grid.fhDiv).css("display","block"))},_noRecordsTipsPositon:function(){var a=this,b=this.element.width(),c=this.gridRows.height(),d=($("#noRecordsTips_"+$.grid.coralID(a.options.id)).width(),$("#noRecordsTips_"+$.grid.coralID(a.options.id)).height());$("#noRecordsTips_"+$.grid.coralID(a.options.id)).css({"margin-top":(c-d)/2+"px","margin-left":b/2+"px"})},_setColWidth:function(){var a,b,c,d,e=this,f=this.grid,g=0,h=$.support.boxSizing?0:this._intNum(this.options.cellLayout,0),i=0,j=this._intNum(this.options.scrollOffset,0),k=!1,l=0,m=0;$.each(this.options.colModel,function(){if(e.options.grouping&&e.options.autowidth){var a=$.inArray(this.name,e.options.groupingView.groupField);a>=0&&e.options.groupingView.groupColumnShow.length>a&&(this.hidden=!e.options.groupingView.groupColumnShow[a])}this.widthOrg=b=e._intNum(this.width,0),this.hidden!==!1&&"undefined"!=typeof this.hidden||(g+=b+h,this.fixed?l+=b+h:i++,m++)}),isNaN(e.options.width)?e.options.width=f.width=g:f.width=e.options.width,e.options.tblwidth=g,e.options.shrinkToFit===!1&&e.options.forceFit===!0&&(e.options.forceFit=!1),e.options.shrinkToFit===!0&&i>0&&(c=f.width-h*i-l,isNaN(this.options.height)||(c-=j,k=!0),g=0,$.each(e.options.colModel,function(d){this.hidden!==!1&&"undefined"!=typeof this.hidden||this.fixed||(b=Math.round(c*this.width/(e.options.tblwidth-h*i-l)),this.width=b,g+=b,a=d)}),d=0,k?f.width-l-(g+h*i)!==j&&(d=f.width-l-(g+h*i)-j):k||1===Math.abs(f.width-l-(g+h*i))||(d=f.width-l-(g+h*i)-1),e.options.colModel[a].width+=d,e.options.tblwidth=g+d+h*i+l,e.options.tblwidth>e.options.width&&(e.options.colModel[a].width-=e.options.tblwidth-parseInt(e.options.width,10),e.options.tblwidth=e.options.width),e.options.tblwidth)},_nextVisible:function(a){var b,c=a,d=a;for(b=a+1;b<this.options.colModel.length;b++)if(this.options.colModel[b].hidden!==!0){d=b;break}return d-c},_formatCol:function(a,b,c,d,e,f){var g=this;if("card"==g.options.model)return"";var h,i=g.grid,j=g.options.colModel[a],k=j.align,l='style="',m=j.cls,n=j.name,o=[],p="";k&&(l+="text-align:"+k+";"),j.hidden===!0&&(l+="display:none;");var q=$.coral.toFunction(j.cellattr);if(0===b?l+="width: "+i.headers[a].width+"px;":$.isFunction(q)&&(h=q.apply(g.element[0],[{rowId:e,value:c,rawObject:d,colModel:j,rowData:f}]),h&&"string"==typeof h&&(h=h.replace(/style/i,"style").replace(/title/i,"title"),h.indexOf("title")>-1&&(j.title=!1),h.indexOf("class")>-1&&(m=void 0),o=h.split("style"),2===o.length?(o[1]=$.trim(o[1].replace("=","")),0!==o[1].indexOf("'")&&0!==o[1].indexOf('"')||(o[1]=o[1].substring(1)),l+=o[1].replace(/'/gi,'"')):l+='"')),d){var r=void 0==d[n]?"":d[n];r=$.grid.htmlEncode(r),p+="data-org='"+r+"'"}return o.length||(o[0]="",l+='"'),l+=(void 0!==m?' class="'+m+'"':"")+(j.title&&c?' title="'+$.grid.stripHtml(c)+'"':""),l+=' aria-describedby="'+g.options.id+"_"+n+'"',l+o[0]+p},findTextByValue:function(a,b){var c=b.colModel.editoptions.data;if(!c)return a;for(var d=0;d<c.length;d++)if(c[d].text==a)return c[d].value;return a},_cellVal:function(a){return void 0===a||null===a||""===a?"":this.options.autoencode?$.grid.htmlEncode(a):a+""},_addCell:function(a,b,c,d,e,f){if("card"==this.options.model){var g,h;return g=this._formatter(a,b,c,e,"add"),h=this._formatCol(c,d,g,e,a,f),'<div role="gridcell" '+h+">"+g+"</div>"}var g,h,i;if(g=this._formatter(a,b,c,e,"add"),h=this._formatCol(c,d,g,e,a,f),this.options.enableHighlight&&this.options.postData.filters)for(var j=$.grid.parse(this.options.postData.filters).rules,k=0;k<j.length;k++)i=new RegExp(""+j[k].data,"gmi"),""!=j[k].data&&(g=g.replace(i,'<span class="coral-keyword-highlight">'+j[k].data+"</span>"));return'<td role="gridcell" '+h+">"+g+"</td>"},_orderedCols:function(a){var b=this,c=b.options.remapColumns;return c&&c.length||(c=$.map(b.options.colModel,function(a,b){return b})),a&&(c=$.map(c,function(b){return a>b?null:b-a})),c},emptyRows:function(a,b,c){var d=this,e=!("card"!=d.options.model);if(e)$("#"+$.grid.coralID(d.options.id)+" .coral-pic").children().remove();else{if(d.options.deepempty)$("#"+$.grid.coralID(d.options.id)+" tbody:first tr:gt(0)").remove();else if(d.options.filterToolbar){var f=d.gridRows.find(".coral-grid-btable")[0].rows.length>0?d.gridRows.find(".coral-grid-btable")[0].rows[0]:null;$("#"+$.grid.coralID(d.options.id+"_table")+" tbody:first").empty().append(f)}else{var f=$("#"+$.grid.coralID(d.options.id)+" tbody:first tr:first")[0];$("#"+$.grid.coralID(d.options.id)+" tbody:first").empty().append(f)}b&&d.options.scroll&&($(">div:first",a).css({height:"auto"}).children("div:first").css({height:0,display:"none"}),a.scrollTop=0),c===!0&&d.options.treeGrid===!0&&(d.options.data=[],d.options._index={})}},normalizeData:function(){var a,b,c,d,e,f,g,h,i,j,k,l=this.options,m=l.data,n=m.length,o=l.localReader,p=l.colModel,q=o.cell,r=(l.multiselect===!0?1:0)+(l.subGrid===!0?1:0)+(l.rownumbers===!0?1:0),s=l.scroll?$.jgrid.randId():1;if("local"===l.datatype&&o.repeatitems===!0)for(i=this._orderedCols(r),j=this._reader("local"),d=l.keyName===!1?$.isFunction(o.id)?o.id.call(ts,m):o.id:l.keyName,a=0;n>a;a++){for(c=m[a],e=$.grid.getAccessor(c,d),void 0===e&&("number"==typeof d&&null!=p[d+r]&&(e=$.grid.getAccessor(c,p[d+r].name)),void 0===e&&(e=s+a,q&&(f=$.grid.getAccessor(c,q)||c,e=null!=f&&void 0!==f[d]?f[d]:e,f=null))),h={},h[o.id]=e,q&&(c=$.grid.getAccessor(c,q)||c),k=$.isArray(c)?i:j,b=0;b<k.length;b++)g=$.grid.getAccessor(c,k[b]),h[p[b+r].name]=g;$.extend(!0,m[a],h)}},refreshIndex:function(){var a,b,c,d=this,e=d.options.data.length;for(a=d.options.keyName===!1||d.options.loadonce===!0?d.options.localReader.id:d.options.keyName,b=0;e>b;b++)c=$.grid.getAccessor(d.options.data[b],a),d.options._index[c]=b},constructPanel:function(a,b,c,d,e){var f="-1",g="",h=b?"display:none;":"",i="gridPanel coral-row-"+this.options.direction+c;return'<li role="row" id="'+a+'" tabindex="'+f+'" class="'+i+'"'+(""===h?"":' style="'+h+'"')+g+">"},constructTr:function(a,b,c,d,e,f){var g,h,i="-1",j="",k=b?"display:none;":"",l="coral-component-content jqgrow coral-row-"+this.options.direction+c+(f?" coral-state-highlight":"");if(this.options.treeGrid){var m=this.options.treeReader.parent_id_field;null!==e[m]&&"null"!=String(e[m]).toLowerCase()&&(l+=" treeGridRow ")}var n=$.coral.toFunction(this.options.rowattr);if(h=$.isFunction(n)?n.apply(this.element[0],[{rowId:a,rowData:d,currentObj:e}]):{},!$.isEmptyObject(h)){h.hasOwnProperty("id")&&(a=h.id,delete h.id),h.hasOwnProperty("tabindex")&&(i=h.tabindex,delete h.tabindex),h.hasOwnProperty("style")&&(k+=h.style,delete h.style),h.hasOwnProperty("class")&&(l+=" "+h["class"],delete h["class"]);try{delete h.role}catch(o){}for(g in h)h.hasOwnProperty(g)&&(j+=" "+g+"="+h[g])}return'<tr role="row" id="'+a+'" tabindex="'+i+'" class="'+l+'"'+(""===k?"":' style="'+k+'"')+j+">"},_clearVals:function(a){var b,c=this;return(b=c._trigger("onPaging",null,[{pgButton:a}]))?(c.options.selrow=null,c.options.editrow=null,c.options.multiselect&&(c.options.selarrrow=[],c._setHeadCheckBox(!1)),c.options.savedRow=[],!0):!1},_getPagination:function(){},_setPager:function(a,b){var c=this,d="<span class='paginator-left'>{viewrecords}</span><span class='paginator-center'>{prev}{links}{next}{pginput}{navbar}{description}</span><span class='paginator-right'><em>每页</em>{rninput}<em>条</em></span>",e="<div class='paginator-left'>{viewrecords}{rowlist}{first}{prev}{pginput}{next}{last}{navbar}{description}</div><div class='toolbarpanel'>{toolbar}</div>";b+="_"+a;var f=!1;$.isFunction(c.options.pagerTemplate)&&(f=c.options.pagerTemplate.call(c));var g=this.options.direction,h=["first"+b,"prev"+b,"next"+b,"last"+b];"rtl"==g&&h.reverse();var i,j,k,l,m,n="",o="",p="",q="",r="",s="",t="",u="<span class='coral-paginator-pages'></span>",v="<em class='page-item'>第</em><input type='text' class='coral-pg-input'/><em class='page-item'>页</em>",w="<button class='reload-button' id='_reloadGrid' type='button' data-options='customData:{gridId:\""+c.options.id+'"},label:"刷新",text: false,icons: "cui-icon-loop3",onClick: function( e, ui ){$( "#'+c.options.id+'" ).grid( "reload" );}\'>reload</button>',x="<span id='"+h[0]+"' class='page-item coral-paginator-first coral-state-default coral-corner-all' tabindex='0'><span class='cui-icon-first2' title='第一页'></span></span>",y="<span id='"+h[3]+"' class='page-item coral-paginator-last coral-state-default coral-corner-all' tabindex='0'><span class='cui-icon-last2' title='最后一页'></span></span>",z="<span id='"+h[2]+"' class='page-item coral-paginator-next coral-corner-all' tabindex='0'><span class='cui-icon-arrow-right3' title='下一页'></span></span>",A="<span id='"+h[1]+"' class='page-item coral-paginator-prev coral-corner-all' tabindex='0'><span class='cui-icon-arrow-left3' title='前一页'></span></span>",B="<span>|</span>",C="<span class='page-item pager-navbar'></span>",D="<span class='pager-toolbar'></span>",E="<span class='pager-description'></span>";for(i="pg_"+a,j=a+"_left",k=a+"_center",l=a+"_right",o+="<input type='text' class='coral-rn-input' val=''/>",c.options.rninput&&c.options.rowList.length>0,p+="<select class='coral-pg-selbox' role='listbox'>",m=0;m<c.options.rowList.length;m++)p+='<option role="option" value="'+c.options.rowList[m]+'"'+(c.options.rowNum==c.options.rowList[m]?' selected="selected"':"")+">"+c.options.rowList[m]+"</option>";p+="</select>",c.options.viewrecords&&(q+="<span class='page-item coral-paging-info'></span>",r+="<span class='page-item coral-paging-totalpage'></span>"),c.options.pginput===!0&&(n="<td dir='"+g+"'>"+$.grid.format(c.options.pgtext||"","<input class='coral-pg-input' type='text' size='2' maxlength='7' value='0' role='textbox'/>","<span id='sp_1_"+$.grid.coralID(a)+"'></span>")+"</td>"),"flex"==c.options.pagerStyle?(f&&(d=f),t="<span id='"+h[1]+"' class='page-item coral-paginator-prev coral-corner-all' tabindex='0'><span class='cui-icon-arrow-left3'>p</span></span><span class='coral-paginator-pages'></span><span id='"+h[2]+"' class='page-item coral-paginator-next coral-corner-all' tabindex='0'><span class='cui-icon-arrow-right3'>p</span></span><em class='page-item'>第</em><input type='text' class='coral-pg-input'/><em class='page-item'>页</em>",s=d.replace(/\{viewrecords\}/g,q).replace(/\{navbar\}/g,C).replace(/\{reload\}/g,w).replace(/\{-\}/g,B).replace(/\{first\}/g,x).replace(/\{last\}/g,y).replace(/\{next\}/g,z).replace(/\{totalPage\}/g,r).replace(/\{prev\}/g,A).replace(/\{links\}/g,u).replace(/\{pginput\}/g,v).replace(/\{toolbar\}/g,D).replace(/\{description\}/g,E).replace(/\{rowlist\}/g,p).replace(/\{rninput\}/g,o),$("#"+$.grid.coralID(a)).addClass("coral-pager-flex"),$("#"+$.grid.coralID(a)).append("<div id='"+i+"' class='coral-paginator' role='group'>"+s+"</div>"),c._bindpager(a,b)):"tradition"==c.options.pagerStyle&&(f&&(e=f),t="<span id='"+h[0]+"' class='page-item coral-paginator-first coral-state-default coral-corner-all' tabindex='0'><span class='cui-icon-first2'></span></span><span id='"+h[1]+"' class='page-item coral-paginator-prev coral-corner-all' tabindex='0'><span class='cui-icon-arrow-left3'></span></span><em class='page-item'>第</em><input type='text' class='coral-pg-input'/><em class='page-item'>页</em><span id='"+h[2]+"' class='page-item coral-paginator-next coral-corner-all' tabindex='0'><span class='cui-icon-arrow-right3'></span></span><span id='"+h[3]+"' class='page-item coral-paginator-last coral-state-default coral-corner-all' tabindex='0'><span class='cui-icon-last2'></span></span>",s=e.replace(/\{viewrecords\}/g,q).replace(/\{navbar\}/g,C).replace(/\{reload\}/g,w).replace(/\{-\}/g,B).replace(/\{first\}/g,x).replace(/\{last\}/g,y).replace(/\{next\}/g,z).replace(/\{prev\}/g,A).replace(/\{links\}/g,u).replace(/\{totalPage\}/g,r).replace(/\{pginput\}/g,v).replace(/\{toolbar\}/g,D).replace(/\{description\}/g,E).replace(/\{rowlist\}/g,p).replace(/\{rninput\}/g,o),$("#"+$.grid.coralID(a)).addClass("coral-pager-tradition"),$("#"+$.grid.coralID(a)).append("<div id='"+i+"' class='coral-paginator' role='group'>"+s+"</div>"),c._bindpagerTradition(a,b));var F=$.parser.parseOptions($("#"+$.grid.coralID(a))[0],null);c.options.toolbarOptions=F.toolbarOptions,c.options.description=F.description;c.options.navbarOptions||{};F.toolbarOptions=F.toolbarOptions||{},$(".reload-button",c.element).button({componentCls:"page-item pg"}),$(".pager-toolbar",c.element).length&&$(".pager-toolbar",c.element).toolbar(F.toolbarOptions),c.options.description&&$(".pager-description",c.element).html(c.options.description)},_bindpagerTradition:function(a,b){var c=this;$("input.coral-pg-input",$("#"+$.grid.coralID(a))).textbox({
componentCls:"page-item pg",onKeyPress:function(a,b){var d=a.charCode?a.charCode:a.keyCode?a.keyCode:0;if(13==d){var e=c._intNum(c.options.lastpage,1),f=c._intNum(b.text,1);return f>e?(c.options.page=e,$(this).textbox("setValue",c.options.page)):c.options.page=b.text>0?b.text:c.options.page,c._clearVals("user")?(c._populate(),!1):!1}return this},onBlur:function(){var a=(c._intNum(c.options.lastpage,1),$(this).textbox("getValue"));a!==c.options.page&&$(this).textbox("setValue",c.options.page)}}),$("input.coral-rn-input",$("#"+$.grid.coralID(a))).textbox({componentCls:"page-item rn",onKeyPress:function(a,b){var d=a.charCode?a.charCode:a.keyCode?a.keyCode:0;return 13==d?(c.options.rowNum=b.text>0?b.text<c.options.rowNumMax?b.text:c.options.rowNumMax:c.options.rowNum,c._clearVals("records")?(c._populate(),!1):!1):this}}),$(".coral-pg-selbox",$("#"+$.grid.coralID(a))).combobox({componentCls:"page-item rn",panelHeight:"auto",showClose:!1,panelRenderOnShow:!1,onChange:function(a,b){return c.options.page=Math.round(c.options.rowNum*(c.options.page-1)/b.value-.5)+1,c.options.rowNum=b.value,c._clearVals("records")?(c._populate(),!1):!1}}),$("#first"+$.grid.coralID(b)+", #prev"+$.grid.coralID(b)+", #next"+$.grid.coralID(b)+", #last"+$.grid.coralID(b)).click(function(){var a=c._intNum(c.options.page,1),d=c._intNum(c.options.lastpage,1),e=!1,f=!0,g=!0,h=!0,i=!0;if(0===d||1===d?(f=!1,g=!1,h=!1,i=!1):d>1&&a>=1?1===a?(f=!1,g=!1):a===d&&(h=!1,i=!1):d>1&&0===a&&(h=!1,i=!1,a=d-1),this.id==="first"+b&&f&&(c.options.page=1,e=!0),this.id==="prev"+b&&g&&(c.options.page=a-1,e=!0),this.id==="next"+b&&h&&(c.options.page=a+1,e=!0),this.id==="last"+b&&i&&(c.options.page=d,e=!0),e){if(!c._clearVals(this.id))return!1;c._populate()}return!1})},_bindpager:function(a,b){var c=this;$("input.coral-pg-input",$("#"+$.grid.coralID(a))).textbox({componentCls:"page-item pg",onKeyPress:function(a,b){var d=a.charCode?a.charCode:a.keyCode?a.keyCode:0;if(13==d){var e=c._intNum(c.options.lastpage,1),f=c._intNum(b.text,1);return f>e?(c.options.page=e,$(this).textbox("setValue",c.options.page)):c.options.page=b.text>0?b.text:c.options.page,c._clearVals("user")?(c._populate(),!1):!1}return this},onBlur:function(){var a=(c._intNum(c.options.lastpage,1),$(this).textbox("getValue"));a!==c.options.page&&$(this).textbox("setValue",c.options.page)}}),$("input.coral-rn-input",$("#"+$.grid.coralID(a))).textbox({componentCls:"page-item rn",onKeyPress:function(a,b){var d=a.charCode?a.charCode:a.keyCode?a.keyCode:0;return 13==d?(c.options.rowNum=b.text>0?b.text<c.options.rowNumMax?b.text:c.options.rowNumMax:c.options.rowNum,c._clearVals("records")?(c._populate(),!1):!1):this}}),$(".coral-pg-selbox",$("#"+$.grid.coralID(a))).combobox({componentCls:"page-item rn",panelHeight:"auto",showClose:!1,panelRenderOnShow:!1,onChange:function(a,b){return c.options.page=Math.round(c.options.rowNum*(c.options.page-1)/b.newValue-.5)+1,c.options.rowNum=b.newValue,c._clearVals("records")?(c._populate(),!1):!1}}),$(".coral-textbox-btn-ico-search",$("#"+$.grid.coralID(a))).click(function(a){return c.options.page=$(this).prev().val()>0?$(this).prev().val():c.options.page,c._clearVals("user")?(c._populate(),!1):!1}),this._off($(".coral-paginator-page")),this._on({"click.coral-paginator-page":function(a){var b=a.target;$(b).hasClass("coral-state-disabled")?b.style.cursor="default":($(b).addClass("coral-state-hover"),b.style.cursor="pointer")}}),this._on({"mouseenter.coral-paginator-page":function(a){var b=a.target;$(b).hasClass("coral-state-disabled")?b.style.cursor="default":($(b).addClass("coral-state-hover"),b.style.cursor="pointer")},"mouseleave.coral-paginator-page":function(a){var b=a.target;$(b).hasClass("coral-state-disabled")||($(b).removeClass("coral-state-hover"),b.style.cursor="default")}}),$("#first"+$.grid.coralID(b)+", #prev"+$.grid.coralID(b)+", #next"+$.grid.coralID(b)+", #last"+$.grid.coralID(b)).click(function(){var a=c._intNum(c.options.page,1),d=c._intNum(c.options.lastpage,1),e=!1,f=!0,g=!0,h=!0,i=!0;if(0===d||1===d?(f=!1,g=!1,h=!1,i=!1):d>1&&a>=1?1===a?(f=!1,g=!1):a===d&&(h=!1,i=!1):d>1&&0===a&&(h=!1,i=!1,a=d-1),this.id==="first"+b&&f&&(c.options.page=1,e=!0),this.id==="prev"+b&&g&&(c.options.page=a-1,e=!0),this.id==="next"+b&&h&&(c.options.page=a+1,e=!0),this.id==="last"+b&&i&&(c.options.page=d,e=!0),e){if(!c._clearVals(this.id))return!1;c._populate()}return!1})},_updatepager:function(a,b){var c,d,e,f,g,h,i,j,k,l,m=this,n="",o=m.options.pager?"_"+$.grid.coralID(m.options.pager.substr(1)):"",p=m.options.toppager?"_"+m.options.toppager.substr(1):"";if(e=parseInt(m.options.page,10)-1,0>e&&(e=0),e*=parseInt(m.options.rowNum,10),g=e+m.options.reccount,m.options.scroll){var q=$("tbody:first > tr:gt(0)",m.grid.rowsView);e=g-q.length,m.options.reccount=q.length;var r=q.outerHeight()||m.grid.prevRowHeight;if(r){var s=e*r,t=parseInt(m.options.records,10)*r;$(">div:first",m.grid.rowsView).css({height:t}).children("div:first").css({height:s,display:s?"":"none"})}m.grid.rowsView.scrollLeft=m.grid.columnsView.scrollLeft}if(m.options.treeGrid){var q=$("tbody:first > tr:not(.treeGridRow,.jqgfirstrow)",m.grid.rowsView);m.options.reccount=q.length,g=e+m.options.reccount}if(n=$(m.element).find(".coral-grid-pager"),n.length>0){if(i=$.grid.formatter.integer||{},c=m._intNum(m.options.page),d=m._intNum(m.options.lastpage),$(".selbox",n)[this.options.useProp?"prop":"attr"]("disabled",!1),$(".coral-pg-input",n).length>0&&($(".coral-pg-input",n).val(m.options.page),j=m.options.toppager?"#sp_1"+o+",#sp_1"+p:"#sp_1"+o,$(j).html($.fmatter?$.fmatter.util.NumberFormat(m.options.lastpage,i):m.options.lastpage)),m.options.rninput===!0&&$(".coral-rn-input",n).val(m.options.rowNum),m.options.viewrecords&&(0===m.options.reccount?($(".coral-paging-info",n).html(""),$(".coral-paging-totalpage",n).html("")):(f=e+1,h=m.options.records,k=m.options.reccount,l=h%k==0?parseInt(h/k):parseInt(h/k)+1,$.fmatter&&(f=$.fmatter.util.NumberFormat(f,i),g=$.fmatter.util.NumberFormat(g,i),h=$.fmatter.util.NumberFormat(h,i),k=$.fmatter.util.NumberFormat(k,i),l=$.fmatter.util.NumberFormat(l,i)),$(".coral-paging-info",n).html($.grid.format(m.options.recordtext,f,g,h)),$(".coral-paging-totalpage",n).html($.grid.format(m.options.pagetext,l)))),m.options.pgbuttons===!0){var u=[],v=[];m.pagers.each(function(){u.push("#first_"+this.id),u.push("#prev_"+this.id),v.push("#next_"+this.id),v.push("#last_"+this.id)}),0>=c&&(c=d=0),1==c||0===c?($(u.join(",")).addClass("coral-state-disabled").removeClass("coral-state-hover"),m.options.toppager&&$("#first_t"+p+", #prev_t"+p).addClass("coral-state-disabled").removeClass("coral-state-hover")):($(u.join(",")).removeClass("coral-state-disabled"),m.options.toppager&&$("#first_t"+p+", #prev_t"+p).removeClass("coral-state-disabled")),c==d||0===c?($(v.join(",")).addClass("coral-state-disabled").removeClass("coral-state-hover"),m.options.toppager&&$("#next_t"+p+", #last_t"+p).addClass("coral-state-disabled").removeClass("coral-state-hover")):($(v.join(",")).removeClass("coral-state-disabled"),m.options.toppager&&$("#next_t"+p+", #last_t"+p).removeClass("coral-state-disabled")),0==d&&$(v.join(",")).addClass("coral-state-disabled").removeClass("coral-state-hover")}m._paginators()}a===!0&&m.options.rownumbers===!0&&$("td.grid-rownum",m.rows).each(function(a){$(this).html(e+1+a)}),b&&m.options.jqgdnd&&$(m.element).grid("gridDnD","updateDnD"),m._trigger("onComplete",null,[]),m._trigger("afterComplete",null,[])},_paginators:function(){var a,b=this,c=b._intNum(b.options.page,1),d=b._intNum(b.options.lastpage,1),e=3,f=c>2?c+2-e:1,g="";a=e+f>d?d+1:e+f,f>3&&d+2>=a&&(f=a-e),c>2&&d>e&&(f>=2&&(g+="<span class='coral-paginator-page coral-state-default coral-corner-all'  tabindex='0'>1</span>"),f>=3&&(g+="<span class='coral-paginator-page coral-state-default coral-corner-all'  tabindex='0'>2</span>"),3!=f&&1!=f&&2!=f&&(g+="<span class='coral-page-pointer'>...</span>"));for(var h=f;a>h;h++)g+=c==h?"<span class='coral-paginator-page coral-state-default coral-state-active coral-corner-all'  tabindex='0'>"+h+"</span>":"<span class='coral-paginator-page coral-state-default coral-corner-all'  tabindex='0'>"+h+"</span>";a==d?g+="<span class='coral-paginator-page coral-state-default coral-corner-all'>"+d+"</span>":d>=a&&(g+="<span class='coral-page-pointer'>...</span><span class='coral-paginator-page coral-state-default coral-corner-all'>"+d+"</span>"),$(".coral-paginator-pages",b.element).html(g)},_populate:function(a){var b,c=this,d=!("card"!=c.options.model),e=c.grid,f=c.options.scroll&&a===!1,g={},h=c.options.prmNames;c.options.page<=0&&(c.options.page=1),null!==h.search&&(g[h.search]=c.options.search),null!==h.nd&&(g[h.nd]=(new Date).getTime()),null!==h.rows&&(g[h.rows]=c.options.rowNum),null!==h.page&&(g[h.page]=c.options.page),null!==h.sort&&(g[h.sort]=c.options.sortname),null!==h.order&&(g[h.order]=c.options.sortorder),null!==c.options.rowTotal&&null!==h.totalrows&&(g[h.totalrows]=c.options.rowTotal);var i=function(a){if(c._trigger("onLoad",null,[a]),c.options.afterSortableRows&&$.fn.sortable)try{$(c.element).grid("sortableRows")}catch(b){}if(c.options.onSortableLoad&&$.fn.sortable)try{var d=[];if(null==c.options.connectGridId)d="#"+c.element[0].id+" tbody:first";else{for(var e=c.options.connectGridId.split(","),f=0;f<e.length;f++){var g=e[f];d.push("#"+g+" tbody:first")}d=d.join(", ")}$("#"+c.element[0].id).grid("sortableGrid",{connectWith:d})}catch(b){}},j=0;if(a=a||1,a>1?null!==h.npage?(g[h.npage]=a,j=a-1,a=1):i=function(b){c.options.page++,e.columnsView.loading=!1,c._trigger("onLoad",null,[b]),c._populate(a-1)}:null!==h.npage&&delete c.options.postData[h.npage],c.options.grouping){this.groupingSetup();var k,l=c.options.groupingView,m="";for(k=0;k<l.groupField.length;k++){var n=l.groupField[k];$.each(c.options.colModel,function(a,b){b.name===n&&b.index&&(n=b.index)}),m+=n+" "+l.groupOrder[k]+", "}g[h.sort]=m+g[h.sort]}c.options.containSortOrder&&g[h.sort]&&g[h.order]&&(g[h.sort]=g[h.sort]+c.options.sortSeparator+g[h.order]),$.extend(c.options.postData,g);var o=c.options.scroll?c.rows.length-1:1,p=c._trigger("beforeRequest",null,[]);if(p!==!1&&"stop"!==p){if($.isFunction(c.options.datatype))return void c.options.datatype.call(c,c.options.postData,"load_"+c.options.id);b=c.options.datatype.toLowerCase(),c.options.b_sortdata&&c.options.b_sortdata===!0||!c.options.orgdatatype||(b=c.options.orgdatatype,c.options.datatype=b),!c.options.remoteFilter&&c.isFilterAction&&(b="local"),c.options.localonce&&(b="local"),c.options.initData&&(b="initinlocal");var q=function(g,h,k){c.options.orgdatatype=b;var l,m;if(l="local"==c.options.orgdatatype?c.options.localReader:c.options.jsonReader,m=$.grid.getAccessor(g,l.root),c.options.generalLevel===!0||"true"==c.options.generalLevel){var n=c.transformToTreeFormat(m);c.options.data=c.recurrenceNode(n),c.options.data=c.transformToArrayFormat(c.options.data),m=c.options.data}return c._trigger("beforeProcessing",null,[{content:g,state:h,xhr:k}])?(c._addJSONData(g,e.rowsView,o,a>1,j),(c.options.loadonce||c.options.treeGrid)&&(c.options.datatype="local",c.options.orgpage=c.options.page),d||c._hasScrollOffset(),i&&i.call(c,g),c._trigger("afterLoad",null,[{content:g}]),f&&e.populateVisible(),1===a&&c._endReq(),0==m.length&&1!=parseInt(c.options.page)&&parseInt(c.options.lastpage)<parseInt(c.options.page)&&$(c.element).grid("reload",{page:c.options.lastpage}),g=null,void c.refresh()):void c._endReq()};switch(b){case"initinlocal":b="json",q(c.options.initData,null,null),this.options.initData=!1;break;case"json":case"jsonp":this.xhr&&this.xhr.abort(),this.xhr=$.ajax(this._ajaxSettings()),this.xhr.success(function(a,b,c){q(a,b,c)}).error(function(b,d,e){c._trigger("onLoadError",null,[{xhr:b,st:d,err:e}]),1===a&&c._endReq(),b=null,c.refresh()}).complete(function(a,b){a===c.xhr&&(c.xhr=null)});break;case"local":case"clientside":c._beginReq(),c.options.datatype="local";var r=c._addLocalData();this._addJSONData(r,e.rowsView,o,a>1,j),c.options.b_sortdata||(c.refresh(),i&&i.call(c,r),c._trigger("AfterLoad",null,[r]),f&&e.populateVisible()),c._endReq(),c.options.frozenColumns&&c._setFrozenHeight()}}},_setFrozenHeight:function(){var a=this,b="",c=0,d=0,e=0;this.grid.fhDiv&&(c=this.grid.fhDiv.height(),this.grid.fbDiv.css("top",c),$("tr",a.grid.fbDiv).slice(1).each(function(){b=$(this).attr("id"),d=parseFloat($("td:first",this).height()),e=parseFloat($("#"+b,a.gridRows).find("td:first").height()),e>d?$("td",this).each(function(){$(this).height(e)}):d>e&&$("td",$("#"+b,a.gridRows)).each(function(){$(this).height(d)})})),this.grid.rightfhDiv&&(c=this.grid.rightfhDiv.height(),this.grid.rightfbDiv.css("top",c),$("tr",a.grid.rightfbDiv).slice(1).each(function(){b=$(this).attr("id"),d=parseFloat($("td:first",this).height()),e=parseFloat($("#"+b,a.gridRows).find("td:first").height()),e>d?$("td",this).each(function(){$(this).height(e)}):d>e&&$("td",$("#"+b,a.gridRows)).each(function(){$(this).height(d)})}))},_ajaxSettings:function(){var a=this,b=this.options;return $.extend({url:b.url,type:b.asyncType,beforeSend:function(b,c){var d=!0;return d=a._trigger("beforeSend",null,{xhr:b,settings:c}),void 0===d&&(d=!0),d===!1?!1:void a._beginReq()},data:$.isFunction(b.serializeGridData)?b.serializeGridData.call(this,b.postData):b.postData,dataType:"json"},$.grid.ajaxOptions,b.ajaxGridOptions)},_reader:function(a){var b,c,d=this,e=[],f=0;for(c=0;c<this.options.colModel.length;c++)b=this.options.colModel[c],"cb"!==b.name&&"subgrid"!==b.name&&"rn"!==b.name&&(e[f]="local"==a?b.name:"xml"==a||"xmlstring"===a?b.xmlmap||b.name:b.jsonmap||b.name,d.options.keyName!==!1&&b.key===!0&&(d.options.keyName=e[f]),f++);return e},_addMulti:function(a,b,c,d){var e=this,f=!("card"!=e.options.model),g='<input role="checkbox" type="checkbox" id="jqg_'+e.options.id+"_"+a+'" class="cbox" name="jqg_'+e.options.id+"_"+a+'"'+(d?'checked="checked"':"")+"/>",h=e._formatCol(b,c,"",null,a,!0);return f?g:'<td role="gridcell" '+h+">"+g+"</td>"},_addSingle:function(a,b,c){var d=this,e=!("card"!=d.options.model),f='<input role="radio" type="radio" id="jqg_'+d.options.id+"_"+a+'" class="cbox" name="jqg_'+d.options.id+'"/>',g=d._formatCol(b,c,"",null,a,!0);return e?f:'<td role="gridcell" '+g+">"+f+"</td>"},_addRowNum:function(a,b,c,d){var e=(parseInt(c,10)-1)*parseInt(d,10)+1+b,f=this._formatCol(a,b,e,null,b,!0);return'<td role="gridcell" class="coral-state-default grid-rownum" '+f+">"+e+"</td>"},_customPanel:function(a,b,c){var d=this,e={},f="",g="",h="",i="";if(e=$.coralApply($.coral.toFunction(d.options.picTemplate),d.element[0],[{rowData:a,ni:b,muti:c,getData:!0}]),"undefined"==typeof e)return"";var j=e.src;j||(j="src"),f=e.coreData||(a.src?"<img src='"+a.src+"'/>":""),g=e.itemData||"",h=e.toolbarsData||"",i=e.buttonsData||"";var k=[];return k.push("<ul class='rowgrid coral-component-content coral-corner-all'>"),""!=f&&(k.push("<li class='gridModel1 gridModel'>"),k.push(f),k.push("<div class='valigh-fix'></div>"),h.length>0&&k.push("<div class='gridtoolbars'><div class='bgopacity'>&#160;</div>"+h+"</div>"),k.push("</li>")),g.length>0&&(k.push("<li class='gridModel2 gridModel'>"),k.push("<div class='griditem'>"+g+"</div>"),k.push("</li>")),(e.muti&&c.length>0||i.length>0)&&(k.push("<li class='gridModel3 gridModel'>"),(g.length>0||i.length>0)&&(k.push("<ul class='griditem'>"),c.length>0&&e.muti&&k.push("<li class='gridCheckbox'>"+c+"</li>"),i.length>0&&k.push("<li class='gridbuttons'>"+i+"</li>"),k.push("</ul>")),k.push("</li>")),k.push("</ul>"),k.join("")},_addJSONData:function(a,b,c,d,e){var f=this,g=!("card"!=f.options.model),h=new Date;if(a){-1!==f.options.treeANode||f.options.scroll?c=c>1?c:1:(f.emptyRows(b,!1,!0),c=1);var i,j,k="_id_",l="local"!=f.options.datatype&&f.options.loadonce||"jsonstring"==f.options.datatype;l&&(f.options.data=[],f.options._index={},f.options.localReader.id=k),f.options.reccount=0,"local"==f.options.datatype?(i=f.options.localReader,j="local"):(i=f.options.jsonReader,j="json");var m,n,o,p,q,r,s,t,u,v,w,x,y=this,z=0,A=[],B=f.options.multiselect?1:0,C=f.options.subGrid?1:0,D=f.options.rownumbers===!0?1:0,E={},F=[],G=[],H=[],I=f.options.altRows===!0?" "+f.options.altclass:"";0==B&&(B=f.options.singleselect?1:0),f.options.page=$.grid.getAccessor(a,i.page)||0,x=$.grid.getAccessor(a,i.total),f.options.lastpage=void 0===x?1:x,f.options.records=$.grid.getAccessor(a,i.records)||0,f.options.total=$.grid.getAccessor(a,i.total)||0,f.options.userData=$.grid.getAccessor(a,i.userData)||{},i.repeatitems||(p=A=f._reader(j)),t=f.options.keyName===!1?$.isFunction(i.id)?i.id.call(f,a):i.id:f.options.keyName,A.length>0&&!isNaN(t)&&(f.options.remapColumns&&f.options.remapColumns.length&&(t=$.inArray(t,f.options.remapColumns)),t=A[t]),s=$.grid.getAccessor(a,i.root),s||(s=[]),r=s.length,n=0,r>0&&f.options.page<=0&&(f.options.page=1);var J,K,L=parseInt(f.options.rowNum,10),M=f.options.scroll?$.grid.randId():1,N=!1;e&&(L*=e+1),"local"!==f.options.datatype||f.options.deselectAfterSort||(N=!0);var O,P=$.isFunction(f.options.afterInsertRow),Q=[],R=!1;for(f.options.grouping&&(R=f.options.groupingView.groupCollapse===!0,O=this.groupingPrepare);r>n;){if(q=s[n],v=$.grid.getAccessor(q,t),void 0===v&&(v=M+n,0===A.length&&i.cell)){var S=$.grid.getAccessor(q,i.cell);v=void 0!==S?S[t]||v:v,S=null}v=f.options.idPrefix+v,J=1===c?0:c,w=(J+n)%2==1?I:"",N&&(K=f.options.multiselect?-1!==$.inArray(v,f.options.selarrrow):v===f.options.selrow);var T=F.length;G.length;for(F.push(""),D&&F.push(f._addRowNum(0,n,f.options.page,f.options.rowNum)),B&&(f.options.singleselect?(F.push(f._addSingle(v,D,n,K)),H.push(f._addSingle(v,D,n,K))):(F.push(f._addMulti(v,D,n,K)),H.push(f._addMulti(v,D,n,K)))),C&&F.push($(f.element).grid("addSubGridCell",B+D,n+c)),i.repeatitems&&(i.cell&&(q=$.grid.getAccessor(q,i.cell)),p||(p=this._orderedCols(B+C+D))),o=0;o<p.length;o++)m=$.grid.getAccessor(q,p[o]),E[f.options.colModel[o+B+C+D].name]=m,F.push(this._addCell(v,m,o+B+C+D,n+c,q,E));if("card"==f.options.model?(G[T]=f.constructPanel(v,R,w,E,q),G.push(f._customPanel(E,D,H)),G.push("</li>")):(F[T]=f.constructTr(v,R,w,E,q,K),F.push("</tr>")),f.options.grouping&&(Q.push(F),f.options.groupingView._locgr||O.call(y,E,n),F=[]),(l||f.options.treeGrid===!0)&&(E[k]=v,f.options.data.push(E),f.options._index[v]=f.options.data.length-1),f.options.gridview===!1&&(g?$("#"+$.grid.coralID(f.options.id)+" .coral-pic").append(G.join("")):$("#"+$.grid.coralID(f.options.id)+" .coral-grid-btable tbody:first").append(F.join("")),$(f).triggerHandler("gridAfterInsertRow",[v,E,q]),P&&f.options.afterInsertRow.call(f,v,E,q),F=[],G=[],H=[]),E={},z++,n++,z==L)break}if(f.options.gridview===!0&&(u=f.options.treeANode>-1?f.options.treeANode:0,f.options.grouping?l||(this.groupingRender(Q,f.options.colModel.length,f.options.page,L),Q=null):f.options.treeGrid===!0&&u>0?$(f.rows[u]).after(F.join("")):f.options.filterToolbar?$("#"+$.grid.coralID(f.options.id+"_table")+" tbody:first").append(F.join("")):$("#"+$.grid.coralID(f.options.id)+" tbody:first").append(F.join(""))),$.fn.afterFmatter.call(f),f.options.subGrid===!0)try{$(f.element).grid("addSubGrid",B+D)}catch(U){}if(f.options.totaltime=new Date-h,z>0&&0===f.options.records&&(f.options.records=r),F=null,f.options.treeGrid===!0)try{$(f.element).grid("setTreeNode",u+1,z+u+1)}catch(V){}if(f.options.treeGrid||f.options.scroll||g||(f.grid.rowsView.scrollTop=0),f.options.reccount=z,f.options.treeANode=-1,f.options.userDataOnFooter&&$(f.element).grid("footerData",f.options.userData,!0),l&&!f.options.orgdatatype&&(f.options.records=r,f.options.lastpage=Math.ceil(r/L)),d||f._updatepager(!1,!0),l){for(;r>z&&s[z];){if(q=s[z],v=$.grid.getAccessor(q,t),void 0===v&&(v=M+z,0===A.length&&i.cell)){var W=$.grid.getAccessor(q,i.cell);v=W[t]||v,W=null}if(q){for(v=f.options.idPrefix+v,i.repeatitems&&(i.cell&&(q=$.grid.getAccessor(q,i.cell)),p||(p=f._orderedCols(B+C+D))),o=0;o<p.length;o++)m=$.grid.getAccessor(q,p[o]),E[f.options.colModel[o+B+C+D].name]=m;E[k]=v,f.options.grouping&&O.call(y,E,z),f.options.data.push(E),f.options._index[v]=f.options.data.length-1,E={}}z++}f.options.grouping&&(this.groupingRender(Q,f.options.colModel.length,f.options.page,L),Q=null)}}},_addLocalData:function(){function a(b){var c,d,e,g,i,j=0;if(void 0!==b.groups){for(d=b.groups.length&&"OR"===b.groupOp.toString().toUpperCase(),d&&o.orBegin(),c=0;c<b.groups.length;c++){j>0&&d&&o.or();try{a(b.groups[c])}catch(k){alert(k)}j++}d&&o.orEnd()}if(void 0!==b.rules){if(j>0){var l=o.select();o=$.grid.from(l),f.options.ignoreCase&&(o=o.ignoreCase())}try{for(e=b.rules.length&&"OR"===b.groupOp.toString().toUpperCase(),e&&o.orBegin(),c=0;c<b.rules.length;c++)i=b.rules[c],g=b.groupOp.toString().toUpperCase(),n[i.op]&&i.field&&(j>0&&g&&"OR"===g&&(o=o.or()),o=n[i.op](o,g)(i.field,i.data,h[i.field])),j++;e&&o.orEnd()}catch(m){alert(m)}}}var b,c,d,e,f=this,g=!1,h={},i=[],j=[];if($.isArray(f.options.data)){var k,l,m=f.options.grouping?f.options.groupingView:!1;if($.each(f.options.colModel,function(){if(d=this.sorttype||"text","date"==d||"datetime"==d?(this.formatter&&"string"==typeof this.formatter&&"date"==this.formatter?(c=this.formatoptions&&this.formatoptions.srcformat?this.formatoptions.srcformat:$.grid.formatter.date.srcformat,e=this.formatoptions&&this.formatoptions.newformat?this.formatoptions.newformat:$.grid.formatter.date.newformat):c=e=this.datefmt||"Y-m-d",h[this.name]={stype:d,srcfmt:c,newfmt:e}):h[this.name]={stype:d,srcfmt:"",newfmt:""},f.options.grouping)for(l=0,k=m.groupField.length;k>l;l++)if(this.name===m.groupField[l]){var a=this.name;this.index&&(a=this.index),i[l]=h[a],j[l]=a}g||this.index!=f.options.sortname&&this.name!=f.options.sortname||(b=this.name,g=!0)}),f.options.treeGrid)return void $(f.element).grid("sortTree",b,f.options.sortorder,h[b].stype,h[b].srcfmt);var n={eq:function(a){return a.equals},ne:function(a){return a.notEquals},lt:function(a){return a.less},le:function(a){return a.lessOrEquals},gt:function(a){return a.greater},ge:function(a){return a.greaterOrEquals},cn:function(a){return a.contains},nc:function(a,b){return"OR"===b?a.orNot().contains:a.andNot().contains},bw:function(a){return a.startsWith},bn:function(a,b){return"OR"===b?a.orNot().startsWith:a.andNot().startsWith},en:function(a,b){return"OR"===b?a.orNot().endsWith:a.andNot().endsWith},ew:function(a){return a.endsWith},ni:function(a,b){return"OR"===b?a.orNot().equals:a.andNot().equals},"in":function(a){return a.equals},nu:function(a){return a.isNull},nn:function(a,b){return"OR"===b?a.orNot().isNull:a.andNot().isNull}},o=$.grid.from(f.options.data);if(f.options.ignoreCase&&(o=o.ignoreCase()),f.options.search===!0){var p=f.options.postData.filters;if(p)"string"==typeof p&&(p=$.grid.parse(p)),a(p);else try{o=n[f.options.postData.searchOper](o)(f.options.postData.searchField,f.options.postData.searchString,h[f.options.postData.searchField])}catch(q){}}if(f.options.grouping)for(l=0;k>l;l++)o.orderBy(j[l],m.groupOrder[l],i[l].stype,i[l].srcfmt);b&&f.options.sortorder&&g&&f.options.sortname&&("DESC"==f.options.sortorder.toUpperCase()?o.orderBy(f.options.sortname,"d",h[b].stype,h[b].srcfmt):o.orderBy(f.options.sortname,"a",h[b].stype,h[b].srcfmt));var r=o.select(),s=f._trigger("afterFilter",null,[{queryResults:o.select(),getData:!0}]).result;s&&(r=s);var t=parseInt(f.options.rowNum,10),u=r.length,v=parseInt(f.options.page,10),w=Math.ceil(u/t),x={};if((f.options.search||f.options.resetsearch)&&f.options.grouping&&f.options.groupingView._locgr){f.options.groupingView.groups=[];var y,z,A,B=f.groupingPrepare;if(f.options.footerrow&&f.options.userDataOnFooter){for(z in f.options.userData)f.options.userData.hasOwnProperty(z)&&(f.options.userData[z]=0);A=!0}for(y=0;u>y;y++){if(A)for(z in f.options.userData)f.options.userData[z]+=parseFloat(r[y][z]||0);B.call($(this),r[y],y,t)}}return r=-1==f.options.rowNum?r.slice((v-1)*t,v*u):r.slice((v-1)*t,v*t),o=null,h=null,f.options.orgdatatype?(x[f.options.localReader.total]=f.options.lastpage,x[f.options.localReader.page]=f.options.orgpage,x[f.options.localReader.records]=f.options.records):(x[f.options.localReader.total]=w,x[f.options.localReader.page]=v,x[f.options.localReader.records]=u),x[f.options.localReader.root]=r,x[f.options.localReader.userData]=f.options.userData,r=null,x}},getColProp:function(a){var b={},c=this;if(!c.grid)return!1;for(var d=c.options.colModel,e=0;e<d.length;e++)if(d[e].name==a){b=d[e];break}return b},transTempData:function(a){function b(a,c){for(var d=0;d<a.length;d++)a[d].children&&b(a[d].children,c),c.tempData[a[d].id]=a[d]}var c,d;if(a.editoptions&&a.editoptions.data&&"tree"===a.editoptions.dataStructure&&(a.editoptions.tempData={},c=a.editoptions.textField||"name",d=a.editoptions.valueField||"id",b(a.editoptions.data,a.editoptions)),a.formatoptions&&a.formatoptions.data&&"tree"===a.formatoptions.dataStructure&&(a.formatoptions.tempData={},c=a.formatoptions.textField||"name",d=a.formatoptions.valueField||"id",b(a.formatoptions.data,a.formatoptions)),a.formatoptions&&a.formatoptions.data&&"tree"!==a.formatoptions.dataStructure){a.formatoptions.tempData={},c=a.formatoptions.textField||"text",d=a.formatoptions.valueField||"value";for(var e=0;e<a.formatoptions.data.length;e++)a.formatoptions.tempData[a.formatoptions.data[e][d]]=a.formatoptions.data[e]}if(a.editoptions&&a.editoptions.data&&"tree"!==a.editoptions.dataStructure){a.editoptions.tempData={},c=a.editoptions.textField||"text",d=a.editoptions.valueField||"value";for(var e=0;e<a.editoptions.data.length;e++)a.editoptions.tempData[a.editoptions.data[e][d]]=a.editoptions.data[e]}return a},setColProp:function(a,b){if(b=this.transTempData(b),this.grid&&b)for(var c=this.options.colModel,d=0;d<c.length;d++)if(c[d].name==a){$.extend(this.options.colModel[d],b);break}},destroyGroupHeader:function(a){"undefined"==typeof a&&(a=!0);var b,c,d,e,f,g,h,i=this,j=i.grid,k=$("table.coral-grid-htable thead",j.columnsView),l=i.options.colModel;if(j){for($(this.element).unbind(".setGroupHeaders"),b=$("<tr>",{role:"rowheader"}).addClass("coral-grid-labels"),e=j.headers,c=0,d=e.length;d>c;c++){h=l[c].hidden?"none":"",f=$(e[c].el).width(e[c].width).css("display",h);try{f.removeAttr("rowSpan")}catch(m){f.attr("rowSpan",1)}b.append(f),g=f.children("span.coral-grid-resize"),g.length>0&&(g[0].style.height=""),f.children("div")[0].style.top=""}$(k).children("tr.coral-grid-labels").remove(),$(k).prepend(b),a===!0&&$(i.element).grid("option",{groupHeader:null})}},setGroupHeaders:function(a){a=$.extend({useColSpanStyle:!1,groupHeaders:[]},a||{}),this.options.groupHeader=a;var b,c,d,e,f,g,h,i,j,k,l,m,n,o=this,p=0,q=o.options.colModel,r=q.length,s=o.grid.headers,t=$("table.coral-grid-htable",o.grid.columnsView),u=t.children("thead").children("tr.coral-grid-labels:last").addClass("jqg-second-row-header"),v=t.children("thead"),w=t.find(".jqg-first-row-header");void 0===w[0]?w=$("<tr>",{role:"row","aria-hidden":"true"}).addClass("jqg-first-row-header").css("height","auto"):w.empty();var x,y=function(a,b){for(var c=0,d=b.length;d>c;c++)if(b[c].startColumnName===a)return c;return-1};for(o.element.find(".coral-grid-columns-view>table").prepend(v),d=$("<tr>",{role:"rowheader"}).addClass("coral-gird-labels jqg-third-row-header"),b=0;r>b;b++)if(f=s[b].el,g=$(f),c=q[b],h={height:"0px",width:s[b].width+"px",display:c.hidden?"none":""},$("<th>",{role:"gridcell"}).css(h).addClass("coral-first-th-"+o.options.direction).appendTo(w),f.style.width="",i=y(c.name,a.groupHeaders),i>=0){for(j=a.groupHeaders[i],k=j.numberOfColumns,l=j.titleText,m=0,i=0;k>i&&r>b+i;i++)q[b+i].hidden||m++;e=$("<th>").attr({role:"columnheader"}).addClass("coral-state-default coral-th-column-header coral-th-"+o.options.direction).css({"border-top":"0px none"}).html(l),m>0&&e.attr("colspan",String(m)),o.options.headertitles&&e.attr("title",e.text()),0===m&&e.hide(),g.before(e),d.append(f),p=k-1}else 0===p?a.useColSpanStyle?g.attr("rowspan","2"):($("<th>",{role:"columnheader"}).addClass("coral-state-default coral-th-column-header coral-th-"+o.options.direction).css({display:c.hidden?"none":"","border-top":"0px none"}).insertBefore(g),d.append(f)):(d.append(f),p--);n=$(o.element).find(".coral-grid-htable").children("thead"),n.prepend(w),d.insertAfter(u),t.append(n),a.useColSpanStyle&&(t.find("span.coral-gird-resize").each(function(){var a=$(this).parent();a.is(":visible")&&(this.style.cssText="height: "+a.height()+"px !important; cursor: col-resize;")}),t.find("div.coral-gird-sortable").each(function(){var a=$(this),b=a.parent();b.is(":visible")&&b.is(":has(span.coral-gird-resize)")&&a.css("top",(b.height()-a.outerHeight())/2+"px")})),x=n.find("tr.jqg-first-row-header"),$(o.element).bind("gridonresizestop.setGroupHeaders",function(a,b,c){x.find("th").eq(c).width(b)})},getGridParam:function(a){var b=this;if(b&&b.grid)return a?"undefined"!=typeof b.options[a]?b.options[a]:null:b.p},setGridParam:function(a){this.grid&&"object"==typeof a&&$.extend(!0,this.options,a)},_setOption:function(a,b){var c=this,d=this.options;this.grid&&$.extend(!0,d[a],b),"height"==a&&(c._setGridHeight(b),c._hasScrollOffset()),"width"==a&&(c._setGridWidth(b),c._hasScrollOffset()),"model"==a&&("grid"==b?(c.pic.hide(),c.gridRows.show(),c.gridColumns.show()):"card"==b&&(c.gridRows.hide(),c.gridColumns.hide(),c.pic.show())),"datatype"==a&&(this.options.orgdatatype=b),this._super(a,b)},_hasScrollOffset:function(){var a=this,b=this.grid;return"hidden"!=b.rowsView.style.overflow&&"no"!=b.rowsView.scroll&&b.rowsView.scrollHeight>b.rowsView.offsetHeight?($(b.columnsView).css("padding-right",a.options.scrollOffset+"px"),!0):($(b.columnsView).css("padding-right",""),$(b.rowsView).css("padding-right",""),!1)},_hasHorizontalScrollBar:function(){var a=this,b=this.grid;a.rightFrozenWidth;return"hidden"!=b.rowsView.style.overflow&&"no"!=b.rowsView.scroll&&b.rowsView.scrollWidth-b.rowsView.clientWidth>0},_setGridWidth:function(a,b){if(this.grid&&0!=a&&this.rows){var c,d,e,f,g=this,h=this.grid,i=0,j=$.support.boxSizing?0:g.options.cellLayout,k=0,l=!1,m=g.options.scrollOffset,n=0,o=0;if("boolean"!=typeof b&&(b=g.options.shrinkToFit),!isNaN(a)){a=parseInt(a,10),g.grid.width=g.options.width=a,g.options.footerrow&&$(g.grid.sDiv).css("width",a+"px"),b===!1&&g.options.forceFit===!0&&(g.options.forceFit=!1),$.each(g.options.colModel,function(){this.hidden!==!1&&"undefined"!=typeof this.hidden||(c=this.widthOrg?this.widthOrg:parseInt(this.width,10),i+=c+j,this.fixed?n+=c+j:k++,o++)});var p=!1;if(g.options.minWidth&&i>$(g.element).width()&&(p=!0),b===!0||p){if(0===k)return;g.options.tblwidth=i,e=a-j*k-n,isNaN(g.options.height)||($(g.grid.rowsView)[0].clientHeight<$(g.grid.rowsView)[0].scrollHeight||1===g.rows.length)&&(l=!0,e-=m),i=0;var q=g.grid.cols.length>0;if($.each(g.options.colModel,function(a){if((this.hidden===!1||"undefined"==typeof this.hidden)&&!this.fixed){if(c=this.widthOrg?this.widthOrg:parseInt(this.width,10),p||(c=Math.round(e*c/(g.options.tblwidth-j*k-n))),0>c)return;this.width=c,i+=c,g.grid.headers[a].width=c,g.grid.headers[a].el.style.width=c+"px";var b=$("tr.jqg-first-row-header>th:eq("+a+")",$("table:first",g.grid.columnsView));b.length>0&&(b[0].style.width=c+"px"),g.options.footerrow&&(g.grid.footers[a].style.width=c+"px"),q&&(g.grid.cols[a].style.width=c+"px"),d=a}}),!d)return;if(f=0,p?f=g.options.colModel[d].width:(l?a-n-(i+j*k)!==m&&(f=a-n-(i+j*k)-m):1!==Math.abs(a-n-(i+j*k))&&(f=a-n-(i+j*k)),g.options.colModel[d].width+=f-1),g.options.tblwidth=i+f+j*k+n,g.options.tblwidth>a){var r=g.options.tblwidth-parseInt(a,10);g.options.tblwidth=a,c=g.options.colModel[d].width=g.options.colModel[d].width-r}else c=g.options.colModel[d].width;g.grid.headers[d].width=c,g.grid.headers[d].el.style.width=c+"px",q&&(g.grid.cols[d].style.width=c+"px"),g.options.footerrow&&(g.grid.footers[d].style.width=c+"px")}$(h.rowsView).width(a),$(h.columnsView).width(a),g.options.tblwidth&&($("table:first",h.rowsView).css("width",g.options.tblwidth+"px"),$("table:first",h.columnsView).css("width",g.options.tblwidth+"px"),g.grid.columnsView.scrollLeft=g.grid.rowsView.scrollLeft,
g.options.footerrow&&$("table:first",g.grid.sDiv).css("width",g.options.tblwidth+"px"))}}},_setGridHeight:function(a){var b=this,c=b.grid;!("card"!=b.options.model);if(b.grid){var d=$(b.grid.rowsView);b.options.frozenColumns===!0&&$("#"+$.grid.coralID(b.options.id)+"_frozen").parent().height(d.height()-16);var e="auto";"auto"===String(a).toLowerCase()?(a="auto",e="auto",b.pic.css({height:"auto"}),d.css({height:"auto"})):(e=a-b.element.find(".coral-grid-pager").height()-$(c.caption).height(),b.pic.css({height:e+(isNaN(e)?"":"px")}),e=a-$(c.columnsView).outerHeight(!0)-b.element.find(".coral-grid-pager").outerHeight(!0)-$(c.caption).height(),d.css({height:e+(isNaN(e)?"":"px")})),b.options.height=a,b.options.scroll&&b.grid.populateVisible()}},getDataIDs:function(){var a,b=[],c=0,d=0,e=!("card"!=this.options.model);if(e){var f=this.element.find("ul.coral-pic").children("li.gridPanel");if(a=f.length,a&&a>0)for(;a>c;)b[c]=f[c].id,c++}else if(a=this.rows.length,a&&a>0)for(;a>c;)$(this.rows[c]).hasClass("jqgrow")&&(b[d]=this.rows[c].id,d++),c++;return b},setRowData:function(a,b,c){var d,e,f=this,g=!0;if(!this.grid)return!1;var h,i,j=this,k=typeof c,l={};if(i=j.rows.namedItem(a),!i)return!1;if(b)try{if($(this.options.colModel).each(function(c){d=this.name,void 0!==b[d]&&(l[d]=this.formatter&&"string"==typeof this.formatter&&"date"==this.formatter?$.unformat.date.call(j,b[d],this):b[d],h=j._formatter(a,b[d],c,b,"edit"),e=this.title?{title:$.grid.stripHtml(h)}:{},j.options.treeGrid===!0&&d==j.options.expandColumn?$("td:eq("+c+") > span:first",i).html(h).attr(e):$("td:eq("+c+")",i).html(h).attr(e),$.fn.afterFmatter.call(f))}),"local"==j.options.datatype){var m=$.grid.stripPref(j.options.idPrefix,a),n=j.options._index[m];if(j.options.treeGrid)for(var o in j.options.treeReader)l.hasOwnProperty(j.options.treeReader[o])&&delete l[j.options.treeReader[o]];"undefined"!=typeof n&&(j.options.data[n]=$.extend(!0,j.options.data[n],l)),l=null}}catch(p){g=!1}return g&&("string"===k?$(i).addClass(c):"object"===k&&$(i).css(c),j._trigger("aftercomplete")),g},delRowData:function(a){var b,c,d,e=!1,f=this,g=!("card"!=f.options.model);if(!g){if(b=f.rows.namedItem(a),!b)return!1;d=b.rowIndex,$(b).remove(),f.options.records--,f.options.reccount--,f._updatepager(!0,!1),e=!0,f.options.multiselect&&(c=$.inArray(a,f.options.selarrrow),-1!=c&&f.options.selarrrow.splice(c,1)),a==f.options.selrow&&(f.options.selrow=null),a==f.options.editrow&&(f.options.editrow=null,f.rowEditButtons&&f.rowEditButtons.remove());var h=$.each(f.options.savedRow,function(a,b){return b.id==d?(c=a,!0):void 0});if(h.length&&-1!=c&&f.options.savedRow.splice(c,1),"local"==f.options.datatype){var i=$.grid.stripPref(f.options.idPrefix,a),j=f.options._index[i];"undefined"!=typeof j&&(f.options.data.splice(j,1),f.refreshIndex())}if(f.options.altRows===!0&&e){var k=f.options.altclass;$(f.rows).each(function(a){a%2==1?$(this).addClass(k):$(this).removeClass(k)})}return f.getDataIDs().length||f._cancelCheckAll(),this.options.frozenColumns&&this._setFrozenHeight(),e}if(b=f.pic.children("#"+a)[0],!b)return!1;if($(b).remove(),f.options.records--,f.options.reccount--,f._updatepager(!0,!1),e=!0,f.options.multiselect&&(c=$.inArray(a,f.options.selarrrow),-1!=c&&f.options.selarrrow.splice(c,1)),a==f.options.selrow&&(f.options.selrow=null),"local"==f.options.datatype){var i=$.grid.stripPref(f.options.idPrefix,a),j=f.options._index[i];"undefined"!=typeof j&&(f.options.data.splice(j,1),f.refreshIndex())}},_cancelCheckAll:function(){var a=this;a.options.multiselect&&$("#cb_"+$.grid.coralID(a.options.id),a.grid.columnsView)[a.options.useProp?"prop":"attr"]("checked",!1)},resetSelection:function(a){var b,c,d,e=this;e.options.frozenColumns===!0&&(d=e.options.id+"_frozen"),"undefined"!=typeof a?(c=a===e.options.selrow?e.options.selrow:a,$("#"+$.grid.coralID(e.options.id)+" tbody:first tr#"+$.grid.coralID(c)).removeClass("coral-state-highlight").attr("aria-selected","false"),d&&$("#"+$.grid.coralID(c),"#"+$.grid.coralID(d)).removeClass("coral-state-highlight"),e.options.multiselect&&($("#jqg_"+$.grid.coralID(e.options.id)+"_"+$.grid.coralID(c),"#"+$.grid.coralID(e.options.id))[e.options.useProp?"prop":"attr"]("checked",!1),d&&$("#jqg_"+$.grid.coralID(e.options.id)+"_"+$.grid.coralID(c),"#"+$.grid.coralID(d))[e.options.useProp?"prop":"attr"]("checked",!1),e._setHeadCheckBox(!1)),c=null):e.options.multiselect?($(e.options.selarrrow).each(function(a,c){b=e.rows.namedItem(c),$(b).removeClass("coral-state-highlight").attr("aria-selected","false"),$("#jqg_"+$.grid.coralID(e.options.id)+"_"+$.grid.coralID(c))[e.options.useProp?"prop":"attr"]("checked",!1),d&&($("#"+$.grid.coralID(c),"#"+$.grid.coralID(d)).removeClass("coral-state-highlight"),$("#jqg_"+$.grid.coralID(e.options.id)+"_"+$.grid.coralID(c),"#"+$.grid.coralID(d))[e.options.useProp?"prop":"attr"]("checked",!1))}),e._setHeadCheckBox(!1),e.options.selarrrow=[]):e.options.selrow&&($("#"+$.grid.coralID(e.options.id)+" tbody:first tr#"+$.grid.coralID(e.options.selrow)).removeClass("coral-state-highlight").attr("aria-selected","false"),d&&$("#"+$.grid.coralID(e.options.selrow),"#"+$.grid.coralID(d)).removeClass("coral-state-highlight"),e.options.selrow=null),e.options.cellEdit===!0&&parseInt(e.options.iCol,10)>=0&&parseInt(e.options.iRow,10)>=0&&($("td:eq("+e.options.iCol+")",e.rows[e.options.iRow]).removeClass("edit-cell coral-state-highlight"),$(e.rows[e.options.iRow]).removeClass("selected-row coral-state-hover")),e.options.savedRow=[]},getRowData:function(a){var b,c,d,e,f={},g=!1,h=0,i=this,j=!("card"!=i.options.model);if(j){if("undefined"==typeof a)g=!0,b=[],c=i.pic.children("li").length;else{if(e=i.pic.children("#"+a)[0],!e)return f;c=2}for(var k="_id_";c>h;){if(g&&(e=i.pic.children("li")[h]),$(e).hasClass("gridPanel")){for(var l=0;l<i.options.data.length;l++)i.options.data[l][k]==e.id&&(f=i.options.data[l]);g&&(b.push(f),f={})}h++}}else{if("undefined"==typeof a)g=!0,b=[],c=i.rows.length;else{if(e=i.rows.namedItem(a),!e)return f;c=2}for(;c>h;)g&&(e=i.rows[h]),$(e).hasClass("jqgrow")&&($('td[role="gridcell"]',e).each(function(a){if(d=i.options.colModel[a].name,"cb"!==d&&"subgrid"!==d&&"rn"!==d)if(i.options.treeGrid===!0&&d==i.options.expandColumn)f[d]=$.grid.htmlDecode($("span:first",this).html());else try{1==i.options.enableHighlight?f[d]=$.unformat.call(i,this,{rowId:e.id,colModel:i.options.colModel[a]},a,!0):f[d]=$.unformat.call(i,this,{rowId:e.id,colModel:i.options.colModel[a]},a,"get")}catch(b){f[d]=$.grid.htmlDecode($(this).html())}}),g&&(b.push(f),f={})),h++}return b?b:f},addRowData:function(a,b,c,d){c||(c="last");var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=!1,v="";if(b){$.isArray(b)?(o=!0,p=a):(b=[b],o=!1);var w=this,x=b.length,y=!("card"!=w.options.model);k=w.options.rownumbers===!0?1:0,i=w.options.multiselect===!0?1:w.options.singleselect===!0?1:0,j=w.options.subGrid===!0?1:0,o||("undefined"!=typeof a?a+="":(a=$.grid.randId(),w.options.keyName!==!1&&(p=w.options.keyName,"undefined"!=typeof b[0][p]&&(a=b[0][p]+"")))),q=w.options.altclass;for(var z=0,A="",B={},C=!!$.isFunction(w.options.afterInsertRow);x>z;){if(r=b[z],f=[],h=[],g=[],o){try{a=r[p]+""}catch(D){a=$.grid.randId()}A=w.options.altRows===!0&&(w.rows.length-1)%2===0?q:""}for(A+=" new-row ",t=a,a=w.options.idPrefix+a,k&&(v=w._formatCol(0,1,"",null,a,!0),f[f.length]='<td role="gridcell" aria-describedby="'+w.options.id+'_rn" class="coral-state-default grid-rownum" '+v+">0</td>"),i&&(n=this.options.singleselect?'<input role="radio" type="radio" id="jqg_'+w.options.id+"_"+a+'" name="jqg_'+w.options.id+'" class="cbox"/>':'<input role="checkbox" type="checkbox" id="jqg_'+w.options.id+"_"+a+'" name="jqg_'+w.options.id+"_"+a+'" class="cbox"/>',v=w._formatCol(k,1,"",null,a,!0),f[f.length]='<td role="gridcell" aria-describedby="'+w.options.id+'_cb" '+v+">"+n+"</td>",h.push(n)),j&&(f[f.length]=$(w).grid("addSubGridCell",i+k,1)),m=i+j+k;m<w.options.colModel.length;m++)s=w.options.colModel[m],e=s.name,B[e]=r[e],n=w._formatter(a,$.grid.getAccessor(r,e),m,r),v=w._formatCol(m,1,n,r,a,!0),f[f.length]='<td role="gridcell" aria-describedby="'+w.options.id+"_"+e+'" '+v+">"+n+"</td>";if(y?(g.unshift(w.constructPanel(a,!1,A,B,B)),g.push(w._customPanel(B,k,h)),g.push("</li>")):(f.unshift(w.constructTr(a,!1,A,B,B,!1)),f[f.length]="</tr>"),y)$("#"+$.grid.coralID(w.options.id)+" .coral-pic").append(g.join(""));else if(0===w.rows.length)$("table:first",w.grid.rowsView).append(f.join(""));else switch(c){case"last":$(w.rows[w.rows.length-1]).after(f.join("")),l=w.rows.length-1;break;case"first":$(w.rows[0]).after(f.join("")),l=1;break;case"after":l=w.rows.namedItem(d),l&&($(w.rows[l.rowIndex+1]).hasClass("coral-subgrid")?$(w.rows[l.rowIndex+1]).after(f):$(l).after(f.join(""))),l++;break;case"before":l=w.rows.namedItem(d),l&&($(l).before(f.join("")),l=l.rowIndex),l--}w.options.subGrid===!0&&$(w).grid("addSubGrid",i+k,l),w.options.records++,w.options.reccount++,w._trigger("afterInsertRow",null,[{rowId:a,data:r}]),C&&w.options.afterInsertRow.call(w,a,r,r),z++,"local"==w.options.datatype&&(B[w.options.localReader.id]=t,w.options._index[t]=w.options.data.length,w.options.data.push(B),B={})}w.options.altRows!==!0||o||("last"==c?(w.rows.length-1)%2==1&&$(w.rows[w.rows.length-1]).addClass(q):$(w.rows).each(function(a){a%2==1?$(this).addClass(q):$(this).removeClass(q)})),w._updatepager(!0,!0),u=!0,$("#noRecordsTips_"+$.grid.coralID(w.options.id)).hide(),$.fn.afterFmatter.call(w)}return this.options.frozenColumns&&this._setFrozenHeight(),u},footerData:function(a,b){function c(a){var b;for(b in a)if(a.hasOwnProperty(b))return!1;return!0}var d,e,f="set",g=!1,h={};void 0==a&&(f="get"),"boolean"!=typeof b&&(b=!0),f=f.toLowerCase();var i,j=this;return j.grid&&j.options.footerrow?"set"===f&&c(a)?!1:(g=!0,$(this.options.colModel).each(function(c){d=this.name,"set"===f?void 0!==a[d]&&(i=b?j._formatter("",a[d],c,a,"edit"):a[d],e=this.title?{title:$.grid.stripHtml(i)}:{},$("tr.footrow td:eq("+c+")",j.grid.sDiv).html(i).attr(e),g=!0):"get"===f&&(h[d]=$("tr.footrow td:eq("+c+")",j.grid.sDiv).html())}),$.fn.afterFmatter.call(j),"get"===f?h:g):!1},clearGridData:function(a){var b=this,c=!("card"!=b.options.model);if(b.grid){if("boolean"!=typeof a&&(a=!1),c)$("#"+$.grid.coralID(b.options.id)+" .coral-pic").empty();else if(b.options.deepempty)$("#"+$.grid.coralID(b.options.id)+" tbody:first tr:gt(0)").remove();else{var d=$(" tbody:first tr:first",b.element)[0];$(" tbody:first",b.element).empty().append(d)}b.options.footerrow&&a&&$(".coral-grid-ftable td",b.grid.sDiv).html("&#160;"),b.options.selrow=null,b.options.selarrrow=[],b.options.savedRow=[],b.options.records=0,b.options.page=1,b.options.lastpage=0,b.options.reccount=0,b.options.data=[],b.options._index={},b._updatepager(!0,!1),b._cancelCheckAll()}},sortableRows:function(){var a={};a.sortableRowsOptions&&$.extend(a,a.sortableRowsOptions);var b=this;b.grid&&(b.options.treeGrid||$.fn.sortable&&(a=$.extend({cursor:"move",axis:"y",items:".jqgrow"},a||{}),a.change=function(a,c){c.prevItemId=$(c.placeholder[0]).prev("tr").attr("id"),c.nextItemId=$(c.placeholder[0]).next("tr").attr("id"),c.targetId=c.position.top>c.originalPosition.top?c.prevItemId:c.nextItemId,$("#"+b.id+" #"+c.targetId).siblings().removeClass("coral-state-target"),$("#"+b.id+" #"+c.targetId).addClass("coral-state-target"),b._trigger("onSortableRows",a,[c])},a.start=function(a,c){if($(c.item).css("border-width","0px"),c.originalPermutation=[],c.item.is("tr")?$("td",c.item).each(function(a){this.style.width=b.grid.cols[a].style.width}):$("td",c.item.find("tr:first")).each(function(a){this.style.width=b.grid.cols[a].style.width}),b.options.subGrid){var d=$(c.item).attr("id");try{$(b).grid("collapseSubGridRow",d)}catch(a){}}$("tr.jqgrow",b.element.find(".coral-grid-btable")).each(function(){""!==this.id&&c.originalPermutation.push(this.id)}),b.sortableRowOriginalPermutation=c.originalPermutation,b._trigger("beforeSortableRows",a,[c])},a.update=function(a,c){$(c.item).css("border-width",""),c.itemId=[],c.permutation=[],c.originalPermutation=b.sortableRowOriginalPermutation||[],b.options.rownumbers===!0?$("td.grid-rownum",b.rows).each(function(a){$(this).html(a+1+(parseInt(b.options.page,10)-1)*parseInt(b.options.rowNum,10)),c.permutation.push(b.rows[a+1].id)}):$("tr.jqgrow",b.grid.rowsView).each(function(a){c.permutation.push(this.id)}),$.each(c.item,function(a){c.itemId.push(c.item[a].id)}),c.prevItemId=$(c.item[0]).prev("tr").attr("id"),c.nextItemId=$(c.item[0]).next("tr").attr("id"),c.targetId=c.position.top>c.originalPosition.top?c.prevItemId:c.nextItemId;var d=$.data(b.element[0],"dns-ref");if(d){var e=$.data(d,"dns");if(e.dragToSort){c.item.remove(),e.dragToSort=!1;var f=0;if(c.targetId){for(;f<e.dataItems.length;f++)$(d).grid("delRowData",e.dataItems[f].id);b.element.grid("addRowData",e.rowid,e.dataItems,"after",c.targetId)}}}$("#"+b.id+" #"+c.targetId).removeClass("coral-state-target"),b._trigger("afterSortableRows",a,[c])},$("tbody:first",b.grid.rowsView).sortable(a)))},destroySortableRows:function(a){var b=this;b.grid&&$.fn.sortable&&$("tbody:first",b.grid.rowsView).sortable("destroy")},sortableGrid:function(a){var b,c,d,e,f,g,h,i=this;$("tbody:first",i.element).sortable({appendTo:"body",connectWith:a.connectWith,helper:function(a,c){b=$(a.target).parent("tr")[0].id;var d=$("<div></div>");d.append($(a.target).parent("tr").clone());var e=$("#"+b).closest(".ctrl-init-grid ")[0].id;return h=$("#"+e).grid("getCol","id"),d},start:function(a,c){b=c.item[0].id,e=$(c.placeholder[0]).prev("tr").attr("id"),nextItemId=$(c.placeholder[0]).next("tr").attr("id"),f=this.closest(".ctrl-init-grid ").id,grid1=$("#"+e).closest(".ctrl-init-grid ")[0].id,d=$("#"+f).grid("getRowData",b),e==b&&(e=$("#"+e).prev("tr").attr("id")),e?prevItem=$("#"+f).grid("getRowData",e):(e=null,prevItem=null),nextItemId?nextItem=$("#"+f).grid("getRowData",nextItemId):(nextItemId=null,nextItem=null),i._trigger("onSortableStart",a,{originalPermutation:h})},stop:function(a,c){b=c.item[0].id;var d,e=$("#"+b).prev("tr").attr("id"),f=$("#"+b).next("tr").attr("id");if(e?(d=$("#"+e).closest(".ctrl-init-grid ")[0].id,prevItem=$("#"+d).grid("getRowData",e)):(e=null,prevItem=null),f?(d=$("#"+f).closest(".ctrl-init-grid ")[0].id,nextItem=$("#"+d).grid("getRowData",f)):(f=null,nextItem=null),d==grid1){var g=$("#"+d).grid("getCol","id");i._trigger("onSortableStop",a,{datafrom:grid1,currentGrid:d,itemId:b,prevItemId:e,nextItemId:f,originalPermutation:h,permutation:g,prevItem:prevItem,nextItem:nextItem})}},activate:function(a,c){b=c.item[0].id,f=this.closest(".ctrl-init-grid ").id,g=$("#"+f).grid("getCol","id")},remove:function(a,c){f=this.closest(".ctrl-init-grid ").id,$("#"+f+" tbody:first").append(c.item.clone()),$("#"+grid1).grid("delRowData",b);var g=$("#"+f).grid("getCol","id");e?prevItem=$("#"+grid1).grid("getRowData",e):(e=null,prevItem=null),nextItemId?nextItem=$("#"+grid1).grid("getRowData",nextItemId):(nextItemId=null,nextItem=null),i._trigger("onSortableRemove",a,{datafrom:grid1,deleteData:d,itemId:b,originalPrevItemId:e,originalNextItemId:nextItemId,originalPermutation:h,permutation:g,originalPrevItem:prevItem,originalNextItem:nextItem})},receive:function(a,d){b=d.item[0].id,f=this.closest(".ctrl-init-grid ").id,c=$("#"+f).grid("getRowData",b),$("#"+f).grid("addRowData",b,c,"first"),$("#"+b).remove();var e=$("#"+f).grid("getCol","id"),h=$("#"+b).prev("tr").attr("id"),j=$("#"+b).next("tr").attr("id");h?prevItem=$("#"+f).grid("getRowData",h):(h=null,prevItem=null),j?nextItem=$("#"+f).grid("getRowData",j):(j=null,nextItem=null),i._trigger("onSortableReceive",a,{datafrom:grid1,currentGrid:f,itemId:b,item:c,prevItemId:h,nextItemId:j,originalPermutation:g,permutation:e,prevItem:prevItem,nextItem:nextItem})}})},gridDnS:function(a){var b=this;if(b.grid&&!b.options.treeGrid&&$.fn.draggable&&$.fn.droppable){var c="<table id='grid_dns' class='coral-grid-dns'></table>";if(void 0===$("#grid_dns")[0]&&$("body").append(c),a.connectWith){a.connectWith=a.connectWith.split(","),a.connectWith=$.map(a.connectWith,function(a){return $.trim(a)});var d=a.connectWith.join(" .coral-grid-btable>tbody, ")+" .coral-grid-btable>tbody";if(a=$.extend({onstart:null,onstop:null,beforedrop:null,ondrop:null,dragcopy:!1,dropbyname:!1,droppos:"first",autoid:!0,rowid:"id",dataItems:[],autoidprefix:"dns_"},a||{}),$.data(b.element[0],"dns",a),"0"!=b.options.reccount&&!b.options.jqgdns){$.data(b.element,"dns");$("tr.jqgrow:not(.coral-sortable)",b.element).draggable({revert:"invalid",helper:function(a,c){var d=$(a.target).parent("tr")[0].id,e=0,f=$("<div></div>"),g=b.element.grid("option","selarrrow").concat();if($.data(b.element[0],"dns").dataItems=[],$.inArray(d,g)>-1){for(e;e<g.length;e++)$.data(b.element[0],"dns").dataItems.push($(b.element).grid("getRowData",g[e])),f.append($(".coral-grid-btable>tbody #"+g[e],b.element).clone());return f}return $.data(b.element[0],"dns").dataItems.push(b.element.grid("getRowData",d)),f.append($(a.target).parent("tr").clone()),f},connectToSortable:d,cursor:"move",appendTo:"#grid_dns",zIndex:5e3,start:function(c,d){if(b.options.subGrid){var e=$(d.helper).attr("id");try{$(b.element).grid("collapseSubGridRow",e)}catch(f){}}$.data(b.element[0],"dns").dragToSort=!0;for(var g=0;g<$.data(b.element[0],"dns").connectWith.length;g++)"0"==$($.data(b.element[0],"dns").connectWith[g]).grid("option","reccount")&&$($.data(b.element[0],"dns").connectWith[g]).grid("addRowData","jqg_empty_row",{});d.helper.addClass("coral-state-highlight"),$("td",d.helper.find("tr:first")).each(function(a){this.style.width=b.grid.headers[a].width+"px"}),a.onstart&&$.isFunction(a.onstart)&&a.onstart.call($($t),c,d)},stop:function(c,d){if(d.helper.dropped&&!a.dragcopy){var e=$(d.helper).attr("id");void 0===e&&(e=$(this).attr("id")),$(b.element).grid("delRowData",e)}for(var f=0;f<$.data(b.element[0],"dns").connectWith.length;f++)$($.data(b.element[0],"dns").connectWith[f]).grid("delRowData","jqg_empty_row");a.onstop&&$.isFunction(a.onstop)&&a.onstop.call($($t),c,d)}})}b.options.jqgdns=!0;for(var e=0;e<a.connectWith.length;e++){var f=a.connectWith[e];$.data($(f)[0],"dns-ref",b.element[0])}}}},gridDnD:function(a){function b(){var a=$.data(c.element,"dnd");$("tr.jqgrow:not(.coral-draggable)",c.element).draggable($.isFunction(a.drag)?a.drag.call($(c.element),a):a.drag)}var c=this;if(c.grid&&!c.options.treeGrid&&$.fn.draggable&&$.fn.droppable){var d="<table id='jqgrid_dnd' class='coral-grid-dnd'></table>";if(void 0===$("#jqgrid_dnd")[0]&&$("body").append(d),"string"==typeof a&&"updateDnD"==a&&c.options.jqgdnd===!0)return void b();if(a.connectWith){a.connectWith=a.connectWith.split(","),a.connectWith=$.map(a.connectWith,function(a){return $.trim(a)});var e=a.connectWith.join(" .coral-grid-btable>tbody, ")+" .coral-grid-btable>tbody";a=$.extend({drag:function(a){return $.extend({start:function(b,d){if(c.options.subGrid){var e=$(d.helper).attr("id");try{$(c.element).grid("collapseSubGridRow",e)}catch(f){}}for(var g=0;g<$.data(c.element,"dnd").connectWith.length;g++)"0"==$($.data(c.element,"dnd").connectWith[g]).grid("option","reccount")&&$($.data(c.element,"dnd").connectWith[g]).grid("addRowData","jqg_empty_row",{});d.helper.addClass("coral-state-highlight"),$("td",d.helper).each(function(a){this.style.width=c.grid.headers[a].width+"px"}),a.onstart&&$.isFunction(a.onstart)&&a.onstart.call($($t),b,d)},stop:function(b,d){if(d.helper.dropped&&!a.dragcopy){var e=$(d.helper).attr("id");void 0===e&&(e=$(this).attr("id")),$(c.element).grid("delRowData",e)}for(var f=0;f<$.data(c.element,"dnd").connectWith.length;f++)$($.data(c.element,"dnd").connectWith[f]).grid("delRowData","jqg_empty_row");a.onstop&&$.isFunction(a.onstop)&&a.onstop.call($($t),b,d)}},a.drag_opts||{})},drop:function(a){return $.extend({accept:function(a){if(!$(a).hasClass("jqgrow"))return a;var b=$(a).closest("table.coral-grid-btable");if(b.length>0&&void 0!==$.data(c.element,"dnd")){var d=$.data(c.element,"dnd").connectWith;return-1!=$.inArray("#"+$.grid.coralID(this.id),d)}return!1},drop:function(b,d){if($(d.draggable).hasClass("jqgrow")){var e=$(d.draggable).attr("id"),f=d.draggable.parents(".coral-grid").grid("getRowData",e);if(!a.dropbyname){var g,h=0,i={},j=$("#"+$.grid.coralID(this.id)).grid("option","colModel");try{for(var k in f)f.hasOwnProperty(k)&&(g=j[h].name,"cb"!=g&&"rn"!=g&&"subgrid"!=g?f.hasOwnProperty(k)&&j[h]&&(i[g]=f[k]):h++,h++);f=i}catch(l){}}if(d.helper.dropped=!0,a.beforedrop&&$.isFunction(a.beforedrop)){var m=a.beforedrop.call(this,b,d,f,$("#"+$.grid.coralID(c.options.id)),$(this));"undefined"!=typeof m&&null!==m&&"object"==typeof m&&(f=m)}if(d.helper.dropped){var n;a.autoid&&($.isFunction(a.autoid)?n=a.autoid.call(this,f):(n=Math.ceil(1e3*Math.random()),n=a.autoidprefix+n)),$("#"+$.grid.coralID(this.id)).grid("addRowData",n,f,a.droppos)}a.ondrop&&$.isFunction(a.ondrop)&&a.ondrop.call(this,b,d,f)}}},a.drop_opts||{})},onstart:null,onstop:null,beforedrop:null,ondrop:null,drop_opts:{activeClass:"coral-state-active",hoverClass:"coral-state-hover"},drag_opts:{revert:"invalid",helper:"clone",connectToSortable:e,cursor:"move",appendTo:"#jqgrid_dnd",zIndex:5e3},dragcopy:!1,dropbyname:!1,droppos:"first",autoid:!0,autoidprefix:"dnd_"},a||{}),$.data(c.element,"dnd",a),"0"==c.options.reccount||c.options.jqgdnd||b(),c.options.jqgdnd=!0;for(var f=0;f<a.connectWith.length;f++){var g=a.connectWith[f];$(g).droppable($.isFunction(a.drop)?a.drop.call($(c),a):a.drop)}}}},getInd:function(a,b){var c,d=!1;return c=this.rows.namedItem(a),c&&(d=b===!0?c:c.rowIndex),d}});$.extend($.grid,{htmlDecode:function(a){return a&&("&nbsp;"==a||"&#160;"==a||1===a.length&&160===a.charCodeAt(0))?"":a?String(a).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/\'/g,"&acute;"):a},htmlEncode:function(a){return a?String(a).replace(/&/g,"&amp;").replace(/\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\'/g,"&acute;"):a},format:function(a){var b=$.makeArray(arguments).slice(1);return void 0===a&&(a=""),a.replace(/\{(\d+)\}/g,function(a,c){return b[c]})},getCellIndex:function(a){var b=$(a);return b.is("tr")?-1:(b=(b.is("td")||b.is("th")?b:b.closest("td,th"))[0],b.cellIndex)},stripHtml:function(a){a+="";var b=/<("[^"]*"|'[^']*'|[^'">])*>/gi;return a?(a=a.replace(b,""),a&&"&nbsp;"!==a&&"&#160;"!==a?a.replace(/\"/g,"'"):""):a},stripPref:function(a,b){var c=$.type(a);return"string"!=c&&"number"!=c||(a=String(a),b=""!==a?String(b).replace(String(a),""):b),b},stringToDoc:function(a){var b;if("string"!=typeof a)return a;try{var c=new DOMParser;b=c.parseFromString(a,"text/xml")}catch(d){b=new ActiveXObject("Microsoft.XMLDOM"),b.async=!1,b.loadXML(a)}return b&&b.documentElement&&"parsererror"!=b.documentElement.tagName?b:null},parse:function(jsonString){var js=jsonString;return"while(1);"==js.substr(0,9)&&(js=js.substr(9)),"/*"==js.substr(0,2)&&(js=js.substr(2,js.length-4)),js||(js="{}"),$.grid.useJSON===!0&&"object"==typeof JSON&&"function"==typeof JSON.parse?JSON.parse(js):eval("("+js+")")},parseDate:function(a,b){var c,d,e,f={m:1,d:1,y:1970,h:0,i:0,s:0,u:0},g=/[\\\/:_;.,\t\T\s-]/;if(b&&null!==b&&void 0!==b){b=$.trim(b),b=b.split(g),void 0!==$.grid.formatter.date.masks[a]&&(a=$.grid.formatter.date.masks[a]),a=a.split(g);var h=$.grid.formatter.date.monthNames,i=$.grid.formatter.date.AmPm,j=function(a,b){return 0===a?12===b&&(b=0):12!==b&&(b+=12),b};for(c=0,d=a.length;d>c;c++)"M"==a[c]&&(e=$.inArray(b[c],h),-1!==e&&12>e&&(b[c]=e+1,f.m=b[c])),"F"==a[c]&&(e=$.inArray(b[c],h),-1!==e&&e>11&&(b[c]=e+1-12,f.m=b[c])),"a"==a[c]&&(e=$.inArray(b[c],i),-1!==e&&2>e&&b[c]==i[e]&&(b[c]=e,f.h=j(b[c],f.h))),"A"==a[c]&&(e=$.inArray(b[c],i),-1!==e&&e>1&&b[c]==i[e]&&(b[c]=e-2,f.h=j(b[c],f.h))),void 0!==b[c]&&(f[a[c].toLowerCase()]=parseInt(b[c],10));f.m=parseInt(f.m,10)-1;var k=f.y;k>=70&&99>=k?f.y=1900+f.y:k>=0&&69>=k&&(f.y=2e3+f.y),void 0!==f.j&&(f.d=f.j),void 0!==f.n&&(f.m=parseInt(f.n,10)-1)}return new Date(f.y,f.m,f.d,f.h,f.i,f.s,f.u)},coralID:function(a){return String(a).replace(/[!"#$%&'()*+,.\/:;<=>?@\[\\\]\^`{|}~]/g,"\\$&")},guid:1,uidPref:"coralg",randId:function(a){return(a?a:$.grid.uidPref)+$.grid.guid++},getAccessor:function(a,b){var c,d,e,f=[];if("function"==typeof b)return b(a);if(c=a[b],void 0===c)try{if("string"==typeof b&&(f=b.split(".")),e=f.length)for(c=a;c&&e--;)d=f.shift(),c=c[d]}catch(g){}return c},ajaxOptions:{},from:function(source){var QueryObject=function(d,q){"string"==typeof d&&(d=$.data(d));var self=this,_data=d,_usecase=!0,_trim=!1,_query=q,_stripNum=/[\$,%]/g,_lastCommand=null,_lastField=null,_orDepth=0,_negate=!1,_queuedOperator="",_sorting=[],_useProperties=!0,_usePinyin=!0;if("object"!=typeof d||!d.push)throw"data provides is not an array";return d.length>0&&(_useProperties="object"==typeof d[0]),this._hasData=function(){return null===_data?!1:0!==_data.length},this._getStr=function(a){var b=[];return _trim&&b.push("jQuery.trim("),b.push("String("+a+")"),_trim&&b.push(")"),_usecase||b.push(".toLowerCase()"),b.join("")},this._strComp=function(a){return"string"==typeof a?".toString()":""},this._group=function(a,b){return{field:a.toString(),unique:b,items:[]}},this._toStr=function(a){return _trim&&(a=$.trim(a)),a=a.toString().replace(/\\/g,"\\\\").replace(/\"/g,'\\"'),_usecase?a:a.toLowerCase()},this._funcLoop=function(a){var b=[];return $.each(_data,function(c,d){b.push(a(d))}),b},this._append=function(a){var b;for(null===_query?_query="":_query+=""===_queuedOperator?" && ":_queuedOperator,b=0;_orDepth>b;b++)_query+="(";_negate&&(_query+="!"),_query+="("+a+")",_negate=!1,_queuedOperator="",_orDepth=0},this._setCommand=function(a,b){_lastCommand=a,_lastField=b},this._resetNegate=function(){_negate=!1},this._repeatCommand=function(a,b){return null===_lastCommand?self:null!==a&&null!==b?_lastCommand(a,b):null===_lastField?_lastCommand(a):_useProperties?_lastCommand(_lastField,a):_lastCommand(a)},this._equals=function(a,b){return 0===self._compare(a,b,1)},this._compare=function(a,b,c){var d=Object.prototype.toString;return void 0===c&&(c=1),void 0===a&&(a=null),void 0===b&&(b=null),null===a&&null===b?0:null===a&&null!==b?1:null!==a&&null===b?-1:"[object Date]"===d.call(a)&&"[object Date]"===d.call(b)?b>a?-c:a>b?c:0:(_usecase||"number"==typeof a||"number"==typeof b||(a=String(a).toLowerCase(),b=String(b).toLowerCase()),b>a?-c:a>b?c:0)},this._performSort=function(){0!==_sorting.length&&(_data=self._doSort(_data,0))},this._doSort=function(a,b){var c=_sorting[b].by,d=_sorting[b].dir,e=_sorting[b].type,f=_sorting[b].datefmt;if(b==_sorting.length-1)return self._getOrder(a,c,d,e,f);b++;for(var g=self._getGroup(a,c,d,e,f),h=[],i=0;i<g.length;i++)for(var j=self._doSort(g[i].items,b),k=0;k<j.length;k++)h.push(j[k]);return h},this._getOrder=function(a,b,c,d,e){var f,g,h,i,j=[],k=[],l="a"==c?1:-1;void 0===d&&(d="text"),i="float"==d||"number"==d||"currency"==d||"numeric"==d?function(a){var b=parseFloat(String(a).replace(_stripNum,""));return isNaN(b)?0:b}:"int"==d||"integer"==d?function(a){return a?parseFloat(String(a).replace(_stripNum,"")):0}:"date"==d||"datetime"==d?function(a){return $.grid.parseDate(e,a).getTime()}:$.isFunction(d)?d:function(a){return a||(a=""),$.trim(String(a).toUpperCase())},$.each(a,function(a,c){g=""!==b?$.grid.getAccessor(c,b):c,void 0===g&&(g=""),g=i(g,c),k.push({vSort:g,index:a})}),k.sort(function(a,b){return a=a.vSort,b=b.vSort,self._compare(a,b,l)}),h=0;for(var m=a.length;m>h;)f=k[h].index,j.push(a[f]),h++;return j},this._getGroup=function(a,b,c,d,e){var f,g=[],h=null,i=null;return $.each(self._getOrder(a,b,c,d,e),function(a,c){f=$.grid.getAccessor(c,b),void 0===f&&(f=""),self._equals(i,f)||(i=f,null!==h&&g.push(h),h=self._group(b,f)),h.items.push(c)}),null!==h&&g.push(h),g},this.ignoreCase=function(){return _usecase=!1,self},this.useCase=function(){return _usecase=!0,self},this.trim=function(){return _trim=!0,self},this.noTrim=function(){return _trim=!1,self},this.execute=function(){var match=_query,results=[];return null===match?self:($.each(_data,function(){eval(match)&&results.push(this)}),_data=results,self)},this.data=function(){return _data},this.select=function(a){if(self._performSort(),!self._hasData())return[];if(self.execute(),$.isFunction(a)){var b=[];return $.each(_data,function(c,d){b.push(a(d))}),b}return _data},this.hasMatch=function(){return self._hasData()?(self.execute(),_data.length>0):!1},this.andNot=function(a,b,c){return _negate=!_negate,self.and(a,b,c)},this.orNot=function(a,b,c){return _negate=!_negate,self.or(a,b,c)},this.not=function(a,b,c){return self.andNot(a,b,c)},this.and=function(a,b,c){return _queuedOperator=" && ",void 0===a?self:self._repeatCommand(a,b,c)},this.or=function(a,b,c){return _queuedOperator=" || ",void 0===a?self:self._repeatCommand(a,b,c)},this.orBegin=function(){return _orDepth++,self},this.orEnd=function(){return null!==_query&&(_query+=")"),self},this.isNot=function(a){return _negate=!_negate,self.is(a)},this.is=function(a){return self._append("this."+a),self._resetNegate(),self},this._compareValues=function(a,b,c,d,e){var f;f=_useProperties?"jQuery.grid.getAccessor(this,'"+b+"')":"this",void 0===c&&(c=null);var g=c,h=void 0===e.stype?"text":e.stype;if(null!==c)switch(h){case"int":case"integer":g=isNaN(Number(g))||""===g?"0":g,f="parseInt("+f+",10)",g="parseInt("+g+",10)";break;case"float":case"number":case"numeric":g=String(g).replace(_stripNum,""),g=isNaN(Number(g))||""===g?"0":g,f="parseFloat("+f+")",g="parseFloat("+g+")";break;case"date":case"datetime":g=String($.grid.parseDate(e.newfmt||"Y-m-d",g).getTime()),f='jQuery.grid.parseDate("'+e.srcfmt+'",'+f+").getTime()";break;default:f=self._getStr(f),g=self._getStr('"'+self._toStr(g)+'"')}return self._append(f+" "+d+" "+g),self._setCommand(a,b),self._resetNegate(),self},this.equals=function(a,b,c){return self._compareValues(self.equals,a,b,"==",c)},this.notEquals=function(a,b,c){return self._compareValues(self.equals,a,b,"!==",c)},this.isNull=function(a,b,c){return self._compareValues(self.equals,a,null,"===",c)},this.greater=function(a,b,c){return self._compareValues(self.greater,a,b,">",c)},this.less=function(a,b,c){return self._compareValues(self.less,a,b,"<",c)},this.greaterOrEquals=function(a,b,c){return self._compareValues(self.greaterOrEquals,a,b,">=",c)},this.lessOrEquals=function(a,b,c){return self._compareValues(self.lessOrEquals,a,b,"<=",c)},this.startsWith=function(a,b){var c=void 0===b||null===b?a:b,d=_trim?$.trim(c.toString()).length:c.toString().length;return _useProperties?self._append(self._getStr("jQuery.grid.getAccessor(this,'"+a+"')")+".substr(0,"+d+") == "+self._getStr('"'+self._toStr(b)+'"')):(d=_trim?$.trim(b.toString()).length:b.toString().length,self._append(self._getStr("this")+".substr(0,"+d+") == "+self._getStr('"'+self._toStr(a)+'"'))),self._setCommand(self.startsWith,a),self._resetNegate(),self},this.endsWith=function(a,b){var c=void 0===b||null===b?a:b,d=_trim?$.trim(c.toString()).length:c.toString().length;return _useProperties?self._append(self._getStr("jQuery.grid.getAccessor(this,'"+a+"')")+".substr("+self._getStr("jQuery.grid.getAccessor(this,'"+a+"')")+".length-"+d+","+d+') == "'+self._toStr(b)+'"'):self._append(self._getStr("this")+".substr("+self._getStr("this")+'.length-"'+self._toStr(a)+'".length,"'+self._toStr(a)+'".length) == "'+self._toStr(a)+'"'),self._setCommand(self.endsWith,a),self._resetNegate(),self},this.contains=function(a,b){return _useProperties?_usePinyin?self._append(self._getStr("jQuery.grid.getAccessor(this,'"+a+"')")+'.indexOf("'+self._toStr(b)+'",0) > -1 || '+self._getStr("pinyinEngine.toPinyin(jQuery.grid.getAccessor(this,'"+a+'\'), false, "")')+'.indexOf("'+self._toStr(b)+'",0) > -1'):self._append(self._getStr("jQuery.grid.getAccessor(this,'"+a+"')")+'.indexOf("'+self._toStr(b)+'",0) > -1'):_usePinyin?self._append(self._getStr("this")+'.indexOf("'+self._toStr(a)+'",0) > -1 || '+pinyinEngine.toPinyin(self._getStr("this"),!1,"")+'.indexOf("'+self._toStr(b)+'",0) > -1'):self._append(self._getStr("this")+'.indexOf("'+self._toStr(a)+'",0) > -1'),
self._setCommand(self.contains,a),self._resetNegate(),self},this.groupBy=function(a,b,c,d){return self._hasData()?self._getGroup(_data,a,b,c,d):null},this.orderBy=function(a,b,c,d){return b=void 0===b||null===b?"a":$.trim(b.toString().toLowerCase()),null!==c&&void 0!==c||(c="text"),null!==d&&void 0!==d||(d="Y-m-d"),"desc"!=b&&"descending"!=b||(b="d"),"asc"!=b&&"ascending"!=b||(b="a"),_sorting.push({by:a,dir:b,type:c,datefmt:d}),self},self};return new QueryObject(source,null)},getMethod:function(a){return this.getAccessor($.fn.grid,a)},extend:function(a){$.extend($.fn.grid,a),this.no_legacy_api||$.fn.extend(a)}}),grid=$.component("coral.grid",$.coral.grid,{_isArray:function(a){return"[object Array]"===Object.prototype.toString.apply(a)},transformToArrayFormat:function(a){var b="children",c=[];if(this._isArray(a))for(var d=0,e=a.length;e>d;d++)c.push(a[d]),a[d][b]&&(c=c.concat(this.transformToArrayFormat(a[d][b])));else c.push(a),a[b]&&(c=c.concat(this.transformToArrayFormat(a[b])));return c},transformToTreeFormat:function(a){var b,c,d="id",e=this.options.treeReader.parent_id_field,f="children";if(this._isArray(a)){var g=[],h=[];for(b=0,c=a.length;c>b;b++)a[b][this.options.treeReader.loaded]=!0,h[a[b][d]]=a[b];for(b=0,c=a.length;c>b;b++)h[a[b][e]]&&a[b][d]!=a[b][e]?(h[a[b][e]][f]||(h[a[b][e]][f]=[]),h[a[b][e]][f].push(a[b])):g.push(a[b]);return g}return[a]},setSonNodeLevel:function(a,b){var c=this;if(a.children)for(var d=a.children.length,e=0;d>e;e++){var f=b+1;a.children[e].level=f,c.setSonNodeLevel(a.children[e],f)}},getNodeLevel:function(a,b){for(var c=this,d=0;d<a.length;d++)a[d].level=b,c.setSonNodeLevel(a[d],b);return a},recurrenceNode:function(a){var b=this,c=b.getNodeLevel(a,0);return c},setTreeNode:function(a,b){var c=this;if(c.grid&&c.options.treeGrid)for(var d,e,f,g,h,i,j,k,l=c.options.expColInd,m=c.options.treeReader.expanded_field,n=c.options.treeReader.leaf_field,o=c.options.treeReader.level_field,p=c.options.treeReader.icon_field,q=c.options.treeReader.loaded;b>a;){var r,s=c.rows[a].id,t=c.options._index[s];if(j=c.options.data[t],"nested"==c.options.treeGridModel&&(j[n]||(d=parseInt(j[c.options.treeReader.left_field],10),e=parseInt(j[c.options.treeReader.right_field],10),j[n]=e===d+1?"true":"false",c.rows[a].cells[c.options._treeleafpos].innerHTML=j[n])),f=parseInt(j[o],10),0===c.options.tree_root_level?(g=f+1,h=f):(g=f,h=f-1),i="<div class='tree-wrap tree-wrap-"+c.options.direction+"' style='width:"+18*g+"px;'>",i+="<div style='"+("rtl"==c.options.direction?"right:":"left:")+18*h+"px;' class=' ",void 0!==j[q]&&("true"==j[q]||j[q]===!0?j[q]=!0:j[q]=!1),"true"==j[n]||j[n]===!0?(i+=(void 0!==j[p]&&""!==j[p]?j[p]:c.options.treeIcons.leaf)+" tree-leaf treeclick",j[n]=!0,k="leaf"):(j[n]=!1,k=""),j[m]=("true"==j[m]||j[m]===!0)&&j[q],i+=j[m]===!1?j[n]===!0?"'":c.options.treeIcons.plus+" tree-plus treeclick'":j[n]===!0?"'":c.options.treeIcons.minus+" tree-minus treeclick'",i+="></div></div>",$(c.rows[a].cells[l]).wrapInner("<span class='cell-wrapper"+k+"'></span>").prepend(i),f!==parseInt(c.options.tree_root_level,10)){var u=$(c.element).grid("getNodeParent",j);r=u&&u.hasOwnProperty(m)?u[m]:!0,r||$(c.rows[a]).css("display","none")}$(c.rows[a].cells[l]).find("div.treeclick").bind("click",function(a){var b=a.target||a.srcElement,d=$(b,c.rows).closest("tr.jqgrow")[0].id,e=c.options._index[d];return c.options.data[e][n]||(c.options.data[e][m]?($(c.element).grid("collapseRow",c.options.data[e]),$(c.element).grid("collapseNode",c.options.data[e])):($(c.element).grid("expandRow",c.options.data[e]),$(c.element).grid("expandNode",c.options.data[e]))),!1}),c.options.ExpandColClick===!0&&$(c.rows[a].cells[l]).find("span.cell-wrapper").css("cursor","pointer").bind("click",function(a){var b=a.target||a.srcElement,d=$(b,c.rows).closest("tr.jqgrow")[0].id,e=c.options._index[d];return c.options.data[e][n]||(c.options.data[e][m]?($(c.element).grid("collapseRow",c.options.data[e]),$(c.element).grid("collapseNode",c.options.data[e])):($(c.element).grid("expandRow",c.options.data[e]),$(c.element).grid("expandNode",c.options.data[e]))),$(c.element).grid("setSelection",d),!1}),a++}},setTreeGrid:function(){var a,b,c,d=this,e=0,f=!1,g=[];if(d.options.treeGrid){d.options.treedatatype||$.extend(d.options,{treedatatype:d.options.datatype}),d.options.subGrid=!1,d.options.altRows=!1,d.options.gridview=!0,null===d.options.rowTotal&&(d.options.rowNum=1e4),d.options.multiselect=!1,d.options.rowList=[],d.options.expColInd=0,a="coral-icon-triangle-1-"+("rtl"==d.options.direction?"w":"e"),d.options.treeIcons=$.extend({plus:"cui-icon-arrow-right3",minus:"cui-icon-arrow-down3",leaf:"cui-icon-file-empty2"},d.options.treeIcons||{}),"nested"==d.options.treeGridModel?d.options.treeReader=$.extend({level_field:"level",left_field:"lft",right_field:"rgt",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},d.options.treeReader):"adjacency"==d.options.treeGridModel&&(d.options.treeReader=$.extend({level_field:"level",parent_id_field:"parent",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},d.options.treeReader));for(c in d.options.colModel)if(d.options.colModel.hasOwnProperty(c)){b=d.options.colModel[c].name,b!=d.options.expandColumn||f||(f=!0,d.options.expColInd=e),e++;for(var h in d.options.treeReader)d.options.treeReader[h]==b&&g.push(b)}$.each(d.options.treeReader,function(a,b){b&&-1===$.inArray(b,g)&&("leaf_field"===a&&(d.options._treeleafpos=e),e++,d.options.colNames.push(b),d.options.colModel.push({name:b,width:1,hidden:!0,sortable:!1,resizable:!1,hidedlg:!0,editable:!0,search:!1}))})}},expandRow:function(a){var b=this;if(b.grid&&b.options.treeGrid){var c=$(b.element).grid("getNodeChildren",a),d=b.options.treeReader.expanded_field,e=b.rows;$(c).each(function(){var a=$.grid.getAccessor(this,b.options.localReader.id);$(e.namedItem(a)).css("display",""),this[d]&&$(b.element).grid("expandRow",this)})}},collapseRow:function(a){var b=this;if(b.grid&&b.options.treeGrid){var c=$(b.element).grid("getNodeChildren",a),d=b.options.treeReader.expanded_field,e=b.rows;$(c).each(function(){var a=$.grid.getAccessor(this,b.options.localReader.id);$(e.namedItem(a)).css("display","none"),this[d]&&$(b.element).grid("collapseRow",this)})}},getRootNodes:function(){var a=[],b=this;if(b.grid&&b.options.treeGrid){switch(b.options.treeGridModel){case"nested":var c=b.options.treeReader.level_field;$(b.options.data).each(function(){parseInt(this[c],10)===parseInt(b.options.tree_root_level,10)&&a.push(this)});break;case"adjacency":var d=b.options.treeReader.parent_id_field;$(b.options.data).each(function(){null!==this[d]&&"null"!=String(this[d]).toLowerCase()||a.push(this)})}return a}},getNodeDepth:function(a){var b=null;return this.each(function(){if(this.grid&&this.options.treeGrid){var c=this;switch(that.options.treeGridModel){case"nested":var d=that.options.treeReader.level_field;b=parseInt(a[d],10)-parseInt(that.options.tree_root_level,10);break;case"adjacency":b=$(c).grid("getNodeAncestors",a).length}}}),b},getNodeParent:function(a){var b=null,c=this;if(c.grid&&c.options.treeGrid){switch(c.options.treeGridModel){case"nested":var d=c.options.treeReader.left_field,e=c.options.treeReader.right_field,f=c.options.treeReader.level_field,g=parseInt(a[d],10),h=parseInt(a[e],10),i=parseInt(a[f],10);$(c.options.data).each(function(){return parseInt(this[f],10)===i-1&&parseInt(this[d],10)<g&&parseInt(this[e],10)>h?(b=this,!1):void 0});break;case"adjacency":var j=c.options.treeReader.parent_id_field,k=c.options.localReader.id;$(c.options.data).each(function(){return this[k]==a[j]?(b=this,!1):void 0})}return b}},getNodeChildren:function(a){var b=[],c=this;if(c.grid&&c.options.treeGrid){switch(c.options.treeGridModel){case"nested":var d=c.options.treeReader.left_field,e=c.options.treeReader.right_field,f=c.options.treeReader.level_field,g=parseInt(a[d],10),h=parseInt(a[e],10),i=parseInt(a[f],10);$(this.options.data).each(function(){parseInt(this[f],10)===i+1&&parseInt(this[d],10)>g&&parseInt(this[e],10)<h&&b.push(this)});break;case"adjacency":var j=c.options.treeReader.parent_id_field,k=c.options.localReader.id;$(this.options.data).each(function(){this[j]==a[k]&&b.push(this)})}return b}},getFullTreeNode:function(a){var b=[];return this.each(function(){var c,d=this;if(d.grid&&that.options.treeGrid)switch(that.options.treeGridModel){case"nested":var e=that.options.treeReader.left_field,f=that.options.treeReader.right_field,g=that.options.treeReader.level_field,h=parseInt(a[e],10),i=parseInt(a[f],10),j=parseInt(a[g],10);$(this.options.data).each(function(){parseInt(this[g],10)>=j&&parseInt(this[e],10)>=h&&parseInt(this[e],10)<=i&&b.push(this)});break;case"adjacency":if(a){b.push(a);var k=that.options.treeReader.parent_id_field,l=that.options.localReader.id;$(this.options.data).each(function(a){for(c=b.length,a=0;c>a;a++)if(b[a][l]==this[k]){b.push(this);break}})}}}),b},getNodeAncestors:function(a){var b=[];return this.each(function(){if(this.grid&&this.options.treeGrid)for(var c=$(this).grid("getNodeParent",a);c;)b.push(c),c=$(this).grid("getNodeParent",c)}),b},isVisibleNode:function(a){var b=!0;return this.each(function(){var c=this;if(c.grid&&that.options.treeGrid){var d=$(c).grid("getNodeAncestors",a),e=that.options.treeReader.expanded_field;$(d).each(function(){return b=b&&this[e],b?void 0:!1})}}),b},isNodeLoaded:function(a){var b,c=this;if(c.grid&&c.options.treeGrid){var d=c.options.treeReader.leaf_field;return b=void 0!==a?void 0!==a.loaded?a.loaded:!!(a[d]||$(c.element).grid("getNodeChildren",a).length>0):!1}},expandNode:function(a){if(this.grid&&this.options.treeGrid){var b=this.options.treeReader.expanded_field,c=this.options.treeReader.parent_id_field,d=this.options.treeReader.loaded,e=this.options.treeReader.level_field,f=this.options.treeReader.left_field,g=this.options.treeReader.right_field;if(!a[b]){var h=$.grid.getAccessor(a,this.options.localReader.id),i=$("#"+$.grid.coralID(h),this.grid.rowsView)[0],j=this.options._index[h];$(this.element).grid("isNodeLoaded",this.options.data[j])?(a[b]=!0,$("div.treeclick",i).removeClass(this.options.treeIcons.plus+" tree-plus").addClass(this.options.treeIcons.minus+" tree-minus")):this.grid.columnsView.loading||(a[b]=!0,$("div.treeclick",i).removeClass(this.options.treeIcons.plus+" tree-plus").addClass(this.options.treeIcons.minus+" tree-minus"),this.options.treeANode=i.rowIndex,this.options.datatype=this.options.treedatatype,"nested"==this.options.treeGridModel?$(this.element).grid("option",{postData:{nodeid:h,n_left:a[f],n_right:a[g],n_level:a[e]}}):$(this.element).grid("option",{postData:{nodeid:h,parentid:a[c],n_level:a[e]}}),$(this.element).grid("reload"),a[d]=!0,"nested"==this.options.treeGridModel?$(this.element).grid("option",{postData:{nodeid:"",n_left:"",n_right:"",n_level:""}}):$(this.element).grid("option",{postData:{nodeid:"",parentid:"",n_level:""}}))}}},collapseNode:function(a){if(this.grid&&this.options.treeGrid){var b=this.options.treeReader.expanded_field;if(a[b]){a[b]=!1;var c=$.grid.getAccessor(a,this.options.localReader.id),d=$("#"+$.grid.coralID(c),this.grid.rowsView)[0];$("div.treeclick",d).removeClass(this.options.treeIcons.minus+" tree-minus").addClass(this.options.treeIcons.plus+" tree-plus")}}},sortTree:function(a,b,c,d){if(this.grid&&this.options.treeGrid){var e,f,g,h,i,j=[],k=this,l=$(k.element).grid("getRootNodes");for(h=$.grid.from(l),h.orderBy(a,b,c,d),i=h.select(),e=0,f=i.length;f>e;e++)g=i[e],j.push(g),$(k.element).grid("collectChildrenSortTree",j,g,a,b,c,d);$.each(j,function(a){var b=$.grid.getAccessor(this,k.options.localReader.id);$("#"+$.grid.coralID(k.options.id)+" tbody tr:eq("+a+")").after($("tr#"+$.grid.coralID(b),k.grid.rowsView))}),h=null,i=null,j=null}},collectChildrenSortTree:function(a,b,c,d,e,f){if(this.grid&&this.options.treeGrid){var g,h,i,j,k,l;for(j=$(this.element).grid("getNodeChildren",b),k=$.grid.from(j),k.orderBy(c,d,e,f),l=k.select(),g=0,h=l.length;h>g;g++)i=l[g],a.push(i),$(this.element).grid("collectChildrenSortTree",a,i,c,d,e,f)}},setTreeRow:function(a,b){var c=!1;return this.each(function(){var d=this;d.grid&&d.options.treeGrid&&(c=$(d).grid("setRowData",a,b))}),c},delTreeNode:function(a){return this.each(function(){var b,c,d,e,f=this,g=that.options.localReader.id,h=that.options.treeReader.left_field,i=that.options.treeReader.right_field;if(f.grid&&that.options.treeGrid){var j=that.options._index[a];if(void 0!==j){b=parseInt(that.options.data[j][i],10),c=b-parseInt(that.options.data[j][h],10)+1;var k=$(f).grid("getFullTreeNode",that.options.data[j]);if(k.length>0)for(var l=0;l<k.length;l++)$(f).grid("delRowData",k[l][g]);if("nested"===that.options.treeGridModel){if(d=$.grid.from(that.options.data).greater(h,b,{stype:"integer"}).select(),d.length)for(e in d)d.hasOwnProperty(e)&&(d[e][h]=parseInt(d[e][h],10)-c);if(d=$.grid.from(that.options.data).greater(i,b,{stype:"integer"}).select(),d.length)for(e in d)d.hasOwnProperty(e)&&(d[e][i]=parseInt(d[e][i],10)-c)}}}})},addChildNode:function(a,b,c){var d=this[0];if(c){var e,f,g,h,i,j,k,l,m=that.options.treeReader.expanded_field,n=that.options.treeReader.leaf_field,o=that.options.treeReader.level_field,p=that.options.treeReader.parent_id_field,q=that.options.treeReader.left_field,r=that.options.treeReader.right_field,s=that.options.treeReader.loaded,t=0,u=b;if("undefined"==typeof a||null===a){if(i=that.options.data.length-1,i>=0)for(;i>=0;)t=Math.max(t,parseInt(that.options.data[i][that.options.localReader.id],10)),i--;a=t+1}var v=$(d).grid("getInd",b);if(k=!1,void 0===b||null===b||""===b)b=null,u=null,e="last",h=that.options.tree_root_level,i=that.options.data.length+1;else{e="after",f=that.options._index[b],g=that.options.data[f],b=g[that.options.localReader.id],h=parseInt(g[o],10)+1;var w=$(d).grid("getFullTreeNode",g);w.length?(i=w[w.length-1][that.options.localReader.id],u=i,i=$(d).grid("getInd",u)+1):i=$(d).grid("getInd",b)+1,g[n]&&(k=!0,g[m]=!0,$(d.rows[v]).find("span.cell-wrapperleaf").removeClass("cell-wrapperleaf").addClass("cell-wrapper").end().find("div.tree-leaf").removeClass(that.options.treeIcons.leaf+" tree-leaf").addClass(that.options.treeIcons.minus+" tree-minus"),that.options.data[f][n]=!1,g[s]=!0)}if(j=i+1,c[m]=!1,c[s]=!0,c[o]=h,c[n]=!0,"adjacency"===that.options.treeGridModel&&(c[p]=b),"nested"===that.options.treeGridModel){var x,y,z;if(null!==b){if(l=parseInt(g[r],10),x=$.grid.from(that.options.data),x=x.greaterOrEquals(r,l,{stype:"integer"}),y=x.select(),y.length)for(z in y)y.hasOwnProperty(z)&&(y[z][q]=y[z][q]>l?parseInt(y[z][q],10)+2:y[z][q],y[z][r]=y[z][r]>=l?parseInt(y[z][r],10)+2:y[z][r]);c[q]=l,c[r]=l+1}else{if(l=parseInt($(d).grid("getCol",r,!1,"max"),10),y=$.grid.from(that.options.data).greater(q,l,{stype:"integer"}).select(),y.length)for(z in y)y.hasOwnProperty(z)&&(y[z][q]=parseInt(y[z][q],10)+2);if(y=$.grid.from(that.options.data).greater(r,l,{stype:"integer"}).select(),y.length)for(z in y)y.hasOwnProperty(z)&&(y[z][r]=parseInt(y[z][r],10)+2);c[q]=l+1,c[r]=l+2}}if(null===b||$(d).grid("isNodeLoaded",g)||k){if(that.options.generalLevel===!0||"true"==that.options.generalLevel){var A=that.transformToTreeFormat(c);that.options.data=that.recurrenceNode(A),that.options.data=that.transformToArrayFormat(that.options.data)}$(d).grid("addRowData",a,c,e,u),$(d).grid("setTreeNode",i,j)}g&&!g[m]&&$(d.rows[v]).find("div.treeclick").click()}},refreshDescription:function(a){this.options.toolbarOptions&&this.options.description&&$(".pager-description",this.element).html(a)},hideGridHeader:function(){this.element.find(".coral-grid-columns").hide()},showGridHeader:function(){this.element.find(".coral-grid-columns").show()},valid:function(a,b){var c,d,e,f,g,h={},i=!1,j=0,k=this;k.errorResults=[];var l;if("undefined"!=typeof a&&a){if(g=k.rows.namedItem(a),!g)return h;d=2}else i=!0,c=[],d=k.rows.length;for(;d>j;)i&&(g=k.rows[j]),$(g).hasClass("jqgrow")&&($('td[role="gridcell"]',g).each(function(a){var c;if(e=k.options.colModel[a].name,f=k.options.colModel[a].editable,(!b||b&&e==b)&&"cb"!==e&&"subgrid"!==e&&"rn"!==e){if(k.options.treeGrid===!0&&e==k.options.expandColumn)h[e]=$.grid.htmlDecode($("span:first",this).html());else try{var d=$.grep(k.options.savedRow,function(a){return a.id==g.id||k.rows[a.id].id==g.id});l=k.options.savedRow.length&&d.length&&f?"edittype":null,h[e]=$.unformat.call(k,this,{rowId:g.id,colModel:k.options.colModel[a]},a,"get",l)}catch(i){h[e]=$.grid.htmlDecode($(this).html())}var m=$.extend(k.options.colModel[a].formatoptions||{},k.options.colModel[a].editoptions||{}),n=$.Event();n.target=this;var o=$(this).find(".ctrl-form-element");if(o.length>0)for(var a=0;a<o.length;a++){var p={validoptions:m,notComponent:!1,showRequiredMark:$.noop,hasTips:!1,component:k.getCellComponent(g.id,e),element:$(o[a]),value:h[e]};c=$.validate.validateField(n,p)}else{var p={validoptions:m,notComponent:!0,showRequiredMark:$.noop,hasTips:!1,component:$(this),element:$(this),value:h[e]};c=$.validate.validateField(n,p)}c.length?(k.options.allowSaveOnError?$(this).addClass("coral-gridcell-error").attr("data-errors",c):$(this).addClass("coral-gridcell-error"),k.errorResults.push({rowId:g.id,rowIndex:j,cellIndex:a,errors:c})):$(this).removeClass("coral-gridcell-error").removeAttr("data-errors")}}),i&&(c.push(h),h={})),j++;return this.options.isValid=!(this.errorResults.length>0),this.options.isValid},clearErrors:function(a,b){var c,d,e,f={},g=!1,h=0,i=this;if(this.errorResults=this.errorResults||[],"undefined"!=typeof a&&a){if(e=i.rows.namedItem(a),!e)return f;d=2;var j=i.errorResults.length;for(j;j>0;j--)i.errorResults[j-1].rowId==e.id&&i.errorResults.splice(j-1,1)}else g=!0,c=[],d=i.rows.length,i.errorResults=[];for(;d>h;)g&&(e=i.rows[h]),$(e).hasClass("jqgrow")&&$('td[role="gridcell"]',e).each(function(a){$(this).removeClass("coral-gridcell-error coral-validate-error").removeAttr("data-errors")}),h++;this.options.isValid=!(this.errorResults.length>0)},getCellErrors:function(){return that.errorResults},resizeFrozen:function(){var a=this.options.caption?$(this.grid.cDiv).outerHeight():0,b=$(".coral-grid-htable","#"+$.grid.coralID(this.options.id)).outerHeight();if(this.options.toppager&&(a+=$($t.grid.topDiv).outerHeight()),this.options.toolbar[0]===!0&&"bottom"!=this.options.toolbar[1]&&(a+=$(this.grid.uDiv).outerHeight()),this.grid.fhDiv){var c=$("th",this.grid.columnsView).height();$(this.grid.fhDiv).css({top:a}),$("th",this.grid.fhDiv).each(function(){$(this).height(c)}),$(this.grid.fbDiv).css({top:parseInt(a,10)+parseInt(b,10)}),$(this.grid.fbDiv).height($(this.grid.rowsView).height()-this.getScrollBarWidth()+2)}if(this.grid.rightfhDiv){var c=$("th",this.grid.columnsView).height();$("th",this.grid.rightfhDiv).each(function(){$(this).height(c)}),$(this.grid.rightfhDiv).css({top:a}),$(this.grid.rightfbDiv).css({top:parseInt(a,10)+parseInt(b,10)}),$(this.grid.rightfbDiv).height($(this.grid.rowsView).height()-this.getScrollBarWidth()+2)}},setFrozenColumns:function(){if(this.grid){var a=this,b=a.options.colModel,c=0,d=b.length,e=d-1,f=-1,g=-1,h=!1;if(!(a.options.subGrid===!0||a.options.treeGrid===!0||a.options.cellEdit===!0||a.options.sortable||a.options.scroll||a.options.grouping)){for(a.options.rownumbers&&c++,(a.options.multiselect||a.options.singleselect)&&c++;d>c&&b[c].frozen===!0;)h=!0,g=c,c++;for(;e>0&&b[e].frozen===!0;)h=!0,f=e,e--;if(f>0&&(g=-1),h){var i=a.options.caption?$(a.grid.cDiv).outerHeight():0,j=$(".coral-grid-htable","#"+$.grid.coralID(a.options.id)).outerHeight();a.options.toppager&&(i+=$(a.grid.topDiv).outerHeight()),a.options.toolbar[0]===!0&&"bottom"!=a.options.toolbar[1]&&(i+=$(a.grid.uDiv).outerHeight()),g>=0&&(a.grid.fhDiv=$('<div style="position:absolute;left:0px;top:'+i+'px;" class="frozen-div-left coral-state-default coral-grid-columns coral-grid-columns-view"></div>'),a.grid.fbDiv=$('<div style="position:absolute;left:0px;top:'+(parseInt(i,10)+parseInt(j,10))+'px;overflow-y:hidden" class="frozen-bdiv coral-grid-rows coral-grid-rows-view"></div>'),$("#"+$.grid.coralID(a.options.id)).append(a.grid.fhDiv)),f>=0&&(a.grid.rightfhDiv=$('<div style="position:absolute;right:0;top:'+i+'px;" class="frozen-div-right coral-state-default coral-grid-columns coral-grid-columns-view"></div>'),a.grid.rightfbDiv=$('<div style="position:absolute;right:0;top:'+(parseInt(i,10)+parseInt(j,10))+'px;overflow-y:hidden" class="frozen-bdiv coral-grid-rows coral-grid-rows-view"></div>'),$("#"+$.grid.coralID(a.options.id)).append(a.grid.rightfhDiv));var k=$(".coral-grid-htable","#"+$.grid.coralID(a.options.id)).clone(!0),l=$(".coral-grid-htable","#"+$.grid.coralID(a.options.id)).clone(!0);if(a.rightFrozenWidth=0,a.options.groupHeader){g>=0&&$("tr.jqg-first-row-header, tr.jqg-third-row-header",k).each(function(){$("th:gt("+g+")",this).remove()}),f>=0&&$("tr.jqg-first-row-header, tr.jqg-third-row-header",l).each(function(){$("th:lt("+f+")",this).remove()});var m=-1,n=-1;$("tr.jqg-second-row-header th",k).each(function(){var a=parseInt($(this).attr("colspan"),10);return a&&(m+=a,n++),m===g?!1:void 0}),m!==g&&(n=g),$("tr.jqg-second-row-header",k).each(function(){$("th:gt("+n+")",this).remove()})}else g>=0&&$("tr",k).each(function(){$("th:gt("+g+")",this).remove()}),f>=0&&$("tr",l).each(function(){$("th:lt("+f+")",this).remove();var b=a.getScrollBarWidth()-2;$(this).append("<th style='width:"+b+"px;' class='coral-state-default'>&nbsp;</th>")});$(k).width(1),$(l).width(1),g>=0&&$(a.grid.fhDiv).append(k).mousemove(function(b){return a.grid.resizing?(a.grid.dragMove(b),!1):void 0}),f>=0&&$(a.grid.rightfhDiv).append(l).mousemove(function(b){return a.grid.resizing?(a.grid.dragMove(b),!1):void 0}),$(a.element).bind("gridonresizestop.setFrozenColumns",function(b,c){var e=c.index,h=c.newWidth;if(g>=0){var i=$(".coral-grid-htable",a.grid.fhDiv);$("th:eq("+e+")",i).width(h);var j=$(".coral-grid-btable",a.grid.fbDiv);$("tr:first td:eq("+e+")",j).width(h)}if(f>=0){var i=$(".coral-grid-htable",a.grid.rightfhDiv);$("th:eq("+(d-e-1)+")",i).width(h);var j=$(".coral-grid-btable",a.grid.rightfbDiv);$("tr:first td:eq("+(d-e-1)+")",j).width(h),a.resetFrozen()}}),$(a.element).bind("gridonsortcol.setFrozenColumns",function(b,c){var d=(c.id,c.colIndex);if(g>=0){var e=$("tr.coral-grid-labels:last th:eq("+a.options.lastsort+")",a.grid.fhDiv),h=$("tr.coral-grid-labels:last th:eq("+d+")",a.grid.fhDiv);$("span.coral-grid-ico-sort",e).addClass("coral-state-disabled"),$(e).attr("aria-selected","false"),$("span.coral-icon-"+a.options.sortorder,h).removeClass("coral-state-disabled"),$(h).attr("aria-selected","true"),a.options.viewsortcols[0]||a.options.lastsort!=d&&($("span.s-ico",e).hide(),$("span.s-ico",h).show())}if(f>=0){d=a.grid.headers.length-d-1;var e=$("tr.coral-grid-labels:last th:eq("+a.options.lastsort+")",a.grid.rightfhDiv),h=$("tr.coral-grid-labels:last th:eq("+d+")",a.grid.rightfhDiv);$("span.coral-grid-ico-sort",e).addClass("coral-state-disabled"),$(e).attr("aria-selected","false"),$("span.coral-icon-"+a.options.sortorder,h).removeClass("coral-state-disabled"),$(h).attr("aria-selected","true"),a.options.viewsortcols[0]||a.options.lastsort!=d&&($("span.s-ico",e).hide(),$("span.s-ico",h).show())}}),g>=0&&$("#"+$.grid.coralID(a.options.id)).append(a.grid.fbDiv),f>=0&&$("#"+$.grid.coralID(a.options.id)).append(a.grid.rightfbDiv),jQuery(a.grid.rowsView).scroll(function(){g>=0&&jQuery(a.grid.fbDiv).scrollTop(jQuery(this).scrollTop()),f>=0&&jQuery(a.grid.rightfbDiv).scrollTop(jQuery(this).scrollTop())});var o=0,p=0,q=0;g>=0&&$(a.grid.fbDiv).mousewheel(function(b,c){var d=-(b.deltaY*b.deltaFactor);p=$(a.grid.rowsView).scrollTop(),o=p,o+=d,$(a.grid.rowsView).scrollTop(o),q=$(a.grid.rowsView).scrollTop(),q==p?o-=d:b.preventDefault()}),f>=0&&$(a.grid.rightfbDiv).mousewheel(function(b,c){var d=-(b.deltaY*b.deltaFactor);p=$(a.grid.rowsView).scrollTop(),o=p,o+=d,$(a.grid.rowsView).scrollTop(o),q=$(a.grid.rowsView).scrollTop(),q==p?o-=d:b.preventDefault()}),a.options.hoverrows===!0&&$("#"+$.grid.coralID(a.options.id)).unbind("mouseover").unbind("mouseout"),$(a.element).bind("gridaftercomplete.setFrozenColumns",function(){$("#"+$.grid.coralID(a.options.id)+"_frozen").remove();var b,c;g>=0&&(b=$("#"+$.grid.coralID(a.options.id)+"_table").clone(!0),jQuery(a.grid.fbDiv).height(jQuery(a.grid.rowsView).height()-a.getScrollBarWidth()+2),$("tr",b).each(function(){$("td:gt("+g+")",this).remove(),!a.options.singleselect||$("td:eq(0)>input",this).attr("name",$("td:eq(0)>input",this).attr("name")+"_forzen")}),$(b).width(1).attr("id",a.options.id+"_frozen"),$(a.grid.fbDiv).append(b),a.options.hoverrows===!0&&($("tr.jqgrow",b).hover(function(){$(this).addClass("coral-state-hover"),$("#"+$.grid.coralID(this.id),"#"+$.grid.coralID(a.options.id)).addClass("coral-state-hover")},function(){$(this).removeClass("coral-state-hover"),$("#"+$.grid.coralID(this.id),"#"+$.grid.coralID(a.options.id)).removeClass("coral-state-hover")}),$("tr.jqgrow","#"+$.grid.coralID(a.options.id)).hover(function(){$(this).addClass("coral-state-hover"),$("#"+$.grid.coralID(this.id),"#"+$.grid.coralID(a.options.id)+"_frozen").addClass("coral-state-hover")},function(){$(this).removeClass("coral-state-hover"),$("#"+$.grid.coralID(this.id),"#"+$.grid.coralID(a.options.id)+"_frozen").removeClass("coral-state-hover")})),b=null),f>=0&&($(a.grid.rowsView)[0].scrollHeight-$(a.grid.rowsView)[0].clientHeight>0&&a.grid.rightfbDiv.css({right:a.getScrollBarWidth()-2+"px"}),c=$("#"+$.grid.coralID(a.options.id)+"_table").clone(!0),jQuery(a.grid.rightfbDiv).height(jQuery(a.grid.rowsView).height()-a.getScrollBarWidth()+2),$("tr",c).each(function(){$("td:lt("+f+")",this).remove(),!a.options.singleselect||$("td:eq(0)>input",this).attr("name",$("td:eq(0)>input",this).attr("name")+"_forzen")}),$(c).width(1).attr("id",a.options.id+"_frozen"),$(a.grid.rightfbDiv).append(c),a.options.hoverrows===!0&&($("tr.jqgrow",c).hover(function(){$(this).addClass("coral-state-hover"),$("#"+$.grid.coralID(this.id),"#"+$.grid.coralID(a.options.id)).addClass("coral-state-hover")},function(){$(this).removeClass("coral-state-hover"),$("#"+$.grid.coralID(this.id),"#"+$.grid.coralID(a.options.id)).removeClass("coral-state-hover")}),$("tr.jqgrow","#"+$.grid.coralID(a.options.id)).hover(function(){$(this).addClass("coral-state-hover"),$("#"+$.grid.coralID(this.id),"#"+$.grid.coralID(a.options.id)+"_frozen").addClass("coral-state-hover")},function(){$(this).removeClass("coral-state-hover"),$("#"+$.grid.coralID(this.id),"#"+$.grid.coralID(a.options.id)+"_frozen").removeClass("coral-state-hover")})),c=null)}),a.options.frozenColumns=!0}}}},destroyFrozenColumns:function(){if(this.grid&&this.options.frozenColumns===!0){var a=this;if($(a.grid.fhDiv).remove(),$(a.grid.fbDiv).remove(),$(a.grid.rightfhDiv).remove(),$(a.grid.rightfbDiv).remove(),a.grid.fhDiv=null,a.grid.fbDiv=null,a.grid.rightfhDiv=null,a.grid.rightfbDiv=null,$(this.element).unbind(".setFrozenColumns"),a.options.hoverrows===!0){var b;$("#"+$.grid.coralID(a.options.id)).bind("mouseover",function(a){b=$(a.target).closest("tr.jqgrow"),"coral-subgrid"!==$(b).attr("class")&&$(b).addClass("coral-state-hover")}).bind("mouseout",function(a){b=$(a.target).closest("tr.jqgrow"),$(b).removeClass("coral-state-hover")})}this.options.frozenColumns=!1}}}),$.extend($.grid,{template:function(a){var b,c=$.makeArray(arguments).slice(1),d=c.length;return null==a&&(a=""),a.replace(/\{([\w\-]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?\}/g,function(a,e){if(!isNaN(parseInt(e,10)))return c[parseInt(e,10)];for(b=0;d>b;b++)if($.isArray(c[b]))for(var f=c[b],g=f.length;g--;)if(e===f[g].nm)return f[g].v})}}),grid=$.component("coral.grid",$.coral.grid,{groupingSetup:function(){var a,b,c,d=this,e=d.options.colModel,f=d.options.groupingView;if(null===f||"object"!=typeof f&&!$.isFunction(f))this.options.grouping=!1;else if(f.groupField.length){for(void 0===f.visibiltyOnNextGrouping&&(f.visibiltyOnNextGrouping=[]),f.lastvalues=[],f._locgr||(f.groups=[]),f.counters=[],a=0;a<f.groupField.length;a++)f.groupOrder[a]||(f.groupOrder[a]="asc"),f.groupText[a]||(f.groupText[a]="{0}"),"boolean"!=typeof f.groupColumnShow[a]&&(f.groupColumnShow[a]=!0),"boolean"!=typeof f.groupSummary[a]&&(f.groupSummary[a]=!1),f.groupSummaryPos[a]||(f.groupSummaryPos[a]="footer"),f.groupColumnShow[a]===!0?(f.visibiltyOnNextGrouping[a]=!0,$(this.element).grid("showCol",f.groupField[a])):(f.visibiltyOnNextGrouping[a]=$("#"+$.grid.coralID(d.options.id+"_"+f.groupField[a])).is(":visible"),$(this.element).grid("hideCol",f.groupField[a]));for(f.summary=[],f.hideFirstGroupCol&&(f.formatDisplayField[0]=function(a){return a}),b=0,c=e.length;c>b;b++)f.hideFirstGroupCol&&(e[b].hidden||f.groupField[0]!==e[b].name||(e[b].formatter=function(){return""})),e[b].summaryType&&(e[b].summaryDivider?f.summary.push({nm:e[b].name,st:e[b].summaryType,v:"",sd:e[b].summaryDivider,vd:"",sr:e[b].summaryRound,srt:e[b].summaryRoundType||"round"}):f.summary.push({nm:e[b].name,st:e[b].summaryType,v:"",sr:e[b].summaryRound,srt:e[b].summaryRoundType||"round"}))}else d.options.grouping=!1},groupingPrepare:function(a,b){var c,d,e,f,g,h=this,i=this.options.groupingView,j=i.groupField.length,k=0;for(c=0;j>c;c++)d=i.groupField[c],f=i.displayField[c],e=a[d],g=null==f?null:a[f],null==g&&(g=e),void 0!==e&&(0===b?(i.groups.push({idx:c,dataIndex:d,value:e,displayValue:g,startRow:b,cnt:1,summary:[]}),i.lastvalues[c]=e,i.counters[c]={cnt:1,pos:i.groups.length-1,summary:$.extend(!0,[],i.summary)},$.each(i.counters[c].summary,function(){$.isFunction(this.st)?this.v=this.st.call(this,this.v,this.nm,a):(this.v=h.groupingCalculations.handler(this.st,this.v,this.nm,this.sr,this.srt,a),"avg"===this.st.toLowerCase()&&this.sd&&(this.vd=h.groupingCalculations.handler(this.st,this.vd,this.sd,this.sr,this.srt,a)))}),i.groups[i.counters[c].pos].summary=i.counters[c].summary):"object"==typeof e||($.isArray(i.isInTheSameGroup)&&$.isFunction(i.isInTheSameGroup[c])?i.isInTheSameGroup[c].call(this,i.lastvalues[c],e,c,i):i.lastvalues[c]===e)?1===k?(i.groups.push({idx:c,dataIndex:d,value:e,displayValue:g,startRow:b,cnt:1,summary:[]}),i.lastvalues[c]=e,i.counters[c]={cnt:1,pos:i.groups.length-1,summary:$.extend(!0,[],i.summary)},$.each(i.counters[c].summary,function(){$.isFunction(this.st)?this.v=this.st.call(this,this.v,this.nm,a):(this.v=h.groupingCalculations.handler(this.st,this.v,this.nm,this.sr,this.srt,a),"avg"===this.st.toLowerCase()&&this.sd&&(this.vd=h.groupingCalculations.handler(this.st,this.vd,this.sd,this.sr,this.srt,a)))}),i.groups[i.counters[c].pos].summary=i.counters[c].summary):(i.counters[c].cnt+=1,i.groups[i.counters[c].pos].cnt=i.counters[c].cnt,$.each(i.counters[c].summary,function(){$.isFunction(this.st)?this.v=this.st.call(this,this.v,this.nm,a):(this.v=h.groupingCalculations.handler(this.st,this.v,this.nm,this.sr,this.srt,a),"avg"===this.st.toLowerCase()&&this.sd&&(this.vd=h.groupingCalculations.handler(this.st,this.vd,this.sd,this.sr,this.srt,a)))}),i.groups[i.counters[c].pos].summary=i.counters[c].summary):(i.groups.push({idx:c,dataIndex:d,value:e,displayValue:g,startRow:b,cnt:1,summary:[]}),i.lastvalues[c]=e,k=1,i.counters[c]={cnt:1,pos:i.groups.length-1,summary:$.extend(!0,[],i.summary)},$.each(i.counters[c].summary,function(){$.isFunction(this.st)?this.v=this.st.call(this,this.v,this.nm,a):(this.v=h.groupingCalculations.handler(this.st,this.v,this.nm,this.sr,this.srt,a),"avg"===this.st.toLowerCase()&&this.sd&&(this.vd=h.groupingCalculations.handler(this.st,this.vd,this.sd,this.sr,this.srt,a)))}),i.groups[i.counters[c].pos].summary=i.counters[c].summary));return this},groupingToggle:function(a){var b=this,c=b.options.groupingView,d=a.split("_"),e=parseInt(d[d.length-2],10);d.splice(d.length-2,2);var f,g,h=d.join("_"),i=c.minusicon,j=c.plusicon,k=$("#"+$.grid.coralID(a)),l=k.length?k[0].nextSibling:null,m=$("#"+$.grid.coralID(a)+" span.tree-wrap-"+b.options.direction),n=function(a){var b=$.map(a.split(" "),function(a){return a.substring(0,h.length+1)===h+"_"?parseInt(a.substring(h.length+1),10):void 0});return b.length>0?b[0]:void 0;
},o=!1,p=b.options.frozenColumns?b.options.id+"_frozen":!1,q=p?$("#"+$.grid.coralID(a),"#"+$.grid.coralID(p)):!1,r=q&&q.length?q[0].nextSibling:null;if(m.hasClass(i)){if(c.showSummaryOnHide){if(l)for(;l&&(f=n(l.className),!(void 0!==f&&e>=f));)$(l).hide(),l=l.nextSibling,p&&($(r).hide(),r=r.nextSibling)}else if(l)for(;l&&(f=n(l.className),!(void 0!==f&&e>=f));)$(l).hide(),l=l.nextSibling,p&&($(r).hide(),r=r.nextSibling);m.removeClass(i).addClass(j),o=!0}else{if(l)for(g=void 0;l;){if(f=n(l.className),void 0===g&&(g=void 0===f),void 0!==f){if(e>=f)break;f===e+1&&($(l).show().find(">td>span.tree-wrap-"+b.options.direction).removeClass(i).addClass(j),p&&$(r).show().find(">td>span.tree-wrap-"+b.options.direction).removeClass(i).addClass(j))}else g&&($(l).show(),p&&$(r).show());l=l.nextSibling,p&&(r=r.nextSibling)}m.removeClass(j).addClass(i)}return this._trigger("onClickGroup",null,[{headId:a,collapsed:o}]),!1},groupingRender:function(a,b,c,d){function e(a,b,c){var d,e=!1;if(0===b)e=c[a];else{var f=c[a].idx;if(0===f)e=c[a];else for(d=a;d>=0;d--)if(c[d].idx===f-b){e=c[d];break}}return e}function f(a,c,d,f){var g,h,i=e(a,c,d),k=j.options.colModel,l=i.cnt,m="";for(h=f;b>h;h++){var n="<td "+j._formatCol(h,1,"")+">&#160;</td>",o="{0}";$.each(i.summary,function(){if(this.nm===k[h].name){k[h].summaryTpl&&(o=k[h].summaryTpl),"string"==typeof this.st&&"avg"===this.st.toLowerCase()&&(this.sd&&this.vd?this.v=this.v/this.vd:this.v&&l>0&&(this.v=this.v/l));try{this.groupCount=i.cnt,this.groupIndex=i.dataIndex,this.groupValue=i.value,g=this.formatter("",this.v,h,this)}catch(a){g=this.v}return n="<td "+j._formatCol(h,1,"")+">"+$.grid.format(o,g)+"</td>",!1}}),m+=n}return m}var g,h,i,j=this,k=j.options.groupingView,l="",m="",n=k.groupCollapse?k.plusicon:k.minusicon,o=[],p=k.groupField.length;n+=" tree-wrap-"+j.options.direction,$.each(j.options.colModel,function(a,b){var c;for(c=0;p>c;c++)if(k.groupField[c]===b.name){o[c]=a;break}});var q,r=0,s=$.makeArray(k.groupSummary);s.reverse(),q=j.options.multiselect?' colspan="2"':"",$.each(k.groups,function(e,t){if(k._locgr&&!(t.startRow+t.cnt>(c-1)*d&&t.startRow<c*d))return!0;r++,h=j.options.id+"ghead_"+t.idx,g=h+"_"+e,m="<span style='cursor:pointer;' class='icon "+n+"' onclick=\"jQuery('#"+$.grid.coralID(j.options.id)+"').grid('groupingToggle','"+g+"');return false;\"></span>";try{$.isArray(k.formatDisplayField)&&$.isFunction(k.formatDisplayField[t.idx])?(t.displayValue=k.formatDisplayField[t.idx].call(this,t.displayValue,t.value,j.options.colModel[o[t.idx]],t.idx,k),i=t.displayValue):i=this.formatter(g,t.displayValue,o[t.idx],t.value)}catch(u){i=t.displayValue}"header"===k.groupSummaryPos[t.idx]?(l+='<tr id="'+g+'"'+(k.groupCollapse&&t.idx>0?' style="display:none;" ':" ")+'role="row" class= "coral-component-content jqgroup coral-row-'+j.options.direction+" "+h+'"><td style="padding-left:'+12*t.idx+'px;"'+q+">"+m+$.grid.template(k.groupText[t.idx],i,t.cnt,t.summary)+"</td>",l+=f(e,0,k.groups,k.groupColumnShow[t.idx]===!1?""===q?2:3:""===q?1:2),l+="</tr>"):l+='<tr id="'+g+'"'+(k.groupCollapse&&t.idx>0?' style="display:none;" ':" ")+'role="row" class= "coral-component-content jqgroup coral-row-'+j.options.direction+" "+h+'"><td style="padding-left:'+12*t.idx+'px;" colspan="'+(k.groupColumnShow[t.idx]===!1?b-1:b)+'">'+m+$.grid.template(k.groupText[t.idx],i,t.cnt,t.summary)+"</td></tr>";var v=p-1===t.idx;if(v){var w,x,y=k.groups[e+1],z=0,A=t.startRow,B=void 0!==y?y.startRow:k.groups[e].startRow+k.groups[e].cnt;for(k._locgr&&(z=(c-1)*d,z>t.startRow&&(A=z)),w=A;B>w&&a[w-z];w++)l+=a[w-z].join("");if("header"!==k.groupSummaryPos[t.idx]){var C;if(void 0!==y){for(C=0;C<k.groupField.length&&y.dataIndex!==k.groupField[C];C++);r=k.groupField.length-C}for(x=0;r>x;x++)if(s[x]){var D="";k.groupCollapse&&!k.showSummaryOnHide&&(D=' style="display:none;"'),l+="<tr"+D+' jqfootlevel="'+(t.idx-x)+'" role="row" class="coral-component-content jqfoot coral-row-'+j.options.direction+'">',l+=f(e,x,k.groups,0),l+="</tr>"}r=C}}}),$("#"+$.grid.coralID(j.options.id)+" tbody:first").append(l),l=null},groupingGroupBy:function(a,b){var c=this;"string"==typeof a&&(a=[a]);var d=c.options.groupingView;c.options.grouping=!0,void 0===d.visibiltyOnNextGrouping&&(d.visibiltyOnNextGrouping=[]);var e;for(e=0;e<d.groupField.length;e++)!d.groupColumnShow[e]&&d.visibiltyOnNextGrouping[e]&&$(this).grid("showCol",d.groupField[e]);for(e=0;e<a.length;e++)d.visibiltyOnNextGrouping[e]=$("#"+$.grid.coralID(c.options.id)+"_"+$.grid.coralID(a[e])).is(":visible");c.options.groupingView=$.extend(c.options.groupingView,b||{}),d.groupField=a,$(this).trigger("reloadGrid")},groupingRemove:function(a){var b=this;if(void 0===a&&(a=!0),b.options.grouping=!1,a===!0){var c,d=b.options.groupingView;for(c=0;c<d.groupField.length;c++)!d.groupColumnShow[c]&&d.visibiltyOnNextGrouping[c]&&$(this).grid("showCol",d.groupField);$("tr.jqgroup, tr.jqfoot","#"+$.grid.coralID(b.options.id)+" tbody:first").remove(),$("tr.jqgrow:hidden","#"+$.grid.coralID(b.options.id)+" tbody:first").show()}else $(this).trigger("reloadGrid")},groupingCalculations:{handler:function(a,b,c,d,e,f){var g={sum:function(){return parseFloat(b||0)+parseFloat(f[c]||0)},min:function(){return""===b?parseFloat(f[c]||0):Math.min(parseFloat(b),parseFloat(f[c]||0))},max:function(){return""===b?parseFloat(f[c]||0):Math.max(parseFloat(b),parseFloat(f[c]||0))},count:function(){return""===b&&(b=0),f.hasOwnProperty(c)?b+1:0},avg:function(){return g.sum()}};if(!g[a])throw"grid Grouping No such method: "+a;var h=g[a]();if(null!=d)if("fixed"===e)h=h.toFixed(d);else{var i=Math.pow(10,d);h=Math.round(h*i)/i}return h}}}),grid=$.component("coral.grid",$.coral.grid,{setSubGrid:function(){var a,b,c=this,d={plusicon:"coral-icon-plus",minusicon:"coral-icon-minus",openicon:"coral-icon-carat-1-sw",expandOnLoad:!1,delayOnLoad:50,selectOnExpand:!1,selectOnCollapse:!1,reloadOnExpand:!0};if(c.options.subGridOptions=$.extend(d,c.options.subGridOptions||{}),c.options.colNames.unshift(""),c.options.colModel.unshift({name:"subgrid",width:$.grid.cell_width?c.options.subGridWidth+$t.options.cellLayout:c.options.subGridWidth,sortable:!1,resizable:!1,hidedlg:!0,search:!1,fixed:!0}),a=c.options.subGridModel,a[0])for(a[0].align=$.extend([],a[0].align||[]),b=0;b<a[0].name.length;b++)a[0].align[b]=a[0].align[b]||"left"},addSubGridCell:function(a,b){var c,d,e="";return e=this._formatCol(a,b),d=this.options.id,c=this.options.subGridOptions.plusicon,'<td role="gridcell" aria-describedby="'+d+'_subgrid" class="coral-sgcollapsed sgcollapsed" '+e+"><a style='cursor:pointer;'><span class='coral-icon "+c+"'></span></a></td>"},addSubGrid:function(a,b){var c=this;if(c.grid){var d,e,f,g,h,i=function(a,b,d){var e=$("<td align='"+c.options.subGridModel[0].align[d]+"'></td>").html(b);$(a).append(e)},j=function(a,b){var d,e,f,g=$("<table cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>"),h=$("<tr></tr>");for(e=0;e<c.options.subGridModel[0].name.length;e++)d=$("<th class='coral-state-default coral-th-subgrid coral-th-column coral-th-"+c.options.direction+"'></th>"),$(d).html(c.options.subGridModel[0].name[e]),$(d).width(c.options.subGridModel[0].width[e]),$(h).append(d);$(g).append(h),a&&(f=c.options.xmlReader.subgrid,$(f.root+" "+f.row,a).each(function(){if(h=$("<tr class='coral-component-content coral-subtblcell'></tr>"),f.repeatitems===!0)$(f.cell,this).each(function(a){i(h,$(this).text()||"&#160;",a)});else{var a=c.options.subGridModel[0].mapping||c.options.subGridModel[0].name;if(a)for(e=0;e<a.length;e++)i(h,$(a[e],this).text()||"&#160;",e)}$(g).append(h)}));var j=$("table:first",c.grid.bDiv).attr("id")+"_";return $("#"+$.grid.coralID(j+b)).append(g),c.grid.hDiv.loading=!1,$("#load_"+$.grid.coralID(c.options.id)).hide(),!1},k=function(a,b){var d,e,f,g,h,j,k=$("<table cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>"),l=$("<tr></tr>");for(f=0;f<c.options.subGridModel[0].name.length;f++)d=$("<th class='coral-state-default coral-th-subgrid coral-th-column coral-th-"+c.options.direction+"'></th>"),$(d).html(c.options.subGridModel[0].name[f]),$(d).width(c.options.subGridModel[0].width[f]),$(l).append(d);if($(k).append(l),a&&(h=c.options.jsonReader.subgrid,e=$.grid.getAccessor(a,h.root),void 0!==e))for(f=0;f<e.length;f++){if(g=e[f],l=$("<tr class='coral-component-content coral-subtblcell'></tr>"),h.repeatitems===!0)for(h.cell&&(g=g[h.cell]),j=0;j<g.length;j++)i(l,g[j]||"&#160;",j);else{var m=c.options.subGridModel[0].mapping||c.options.subGridModel[0].name;if(m.length)for(j=0;j<m.length;j++)i(l,g[m[j]]||"&#160;",j)}$(k).append(l)}var n=$("table:first",c.grid.bDiv).attr("id")+"_";return $("#"+$.grid.coralID(n+b)).append(k),c.grid.hDiv.loading=!1,$("#load_"+$.grid.coralID(c.options.id)).hide(),!1},l=function(a){var b,d,e,f;if(b=$(a).attr("id"),d={nd_:(new Date).getTime()},d[c.options.prmNames.subgridid]=b,!c.options.subGridModel[0])return!1;if(c.options.subGridModel[0].params)for(f=0;f<c.options.subGridModel[0].params.length;f++)for(e=0;e<c.options.colModel.length;e++)c.options.colModel[e].name===c.options.subGridModel[0].params[f]&&(d[c.options.colModel[e].name]=$("td:eq("+e+")",a).text().replace(/\&#160\;/gi,""));if(!c.grid.hDiv.loading)switch(c.grid.hDiv.loading=!0,$("#load_"+$.grid.coralID(c.options.id)).show(),c.options.subgridtype||(c.options.subgridtype=c.options.datatype),$.isFunction(c.options.subgridtype)?c.options.subgridtype.call(c,d):c.options.subgridtype=c.options.subgridtype.toLowerCase(),c.options.subgridtype){case"xml":case"json":$.ajax($.extend({type:c.options.mtype,url:$.isFunction(c.options.subGridUrl)?c.options.subGridUrl.call(c,d):c.options.subGridUrl,dataType:c.options.subgridtype,data:$.isFunction(c.options.serializeSubGridData)?c.options.serializeSubGridData.call(c,d):d,complete:function(a){"xml"===c.options.subgridtype?j(a.responseXML,b):k($.grid.parse(a.responseText),b),a=null}},$.grid.ajaxOptions,c.options.ajaxSubgridOptions||{}))}return!1},m=0;$.each(c.options.colModel,function(){this.hidden!==!0&&"rn"!==this.name&&"cb"!==this.name||m++});var n=c.rows.length,o=1;for(void 0!==b&&b>0&&(o=b,n=b+1);n>o;)$(c.rows[o]).hasClass("jqgrow")&&(c.options.scroll&&$(c.rows[o].cells[a]).unbind("click"),$(c.rows[o].cells[a]).bind("click",function(){var b=$(this).parent("tr")[0];if(e=c.options.id,d=b.id,h=$("#"+e+"_"+d+"_expandedContent"),$(this).hasClass("sgcollapsed")){if(g=$(c).triggerHandler("jqGridSubGridBeforeExpand",[e+"_"+d,d]),g=g!==!1&&"stop"!==g,g&&$.isFunction(c.options.subGridBeforeExpand)&&(g=c.options.subGridBeforeExpand.call(c,e+"_"+d,d)),g===!1)return!1;c.options.subGridOptions.reloadOnExpand===!0||c.options.subGridOptions.reloadOnExpand===!1&&!h.hasClass("coral-subgrid")?(f=a>=1?"<td colspan='"+a+"'>&#160;</td>":"",$(b).after("<tr role='row' id='"+e+"_"+d+"_expandedContent' class='coral-subgrid coral-sg-expanded'>"+f+"<td class='coral-component-content subgrid-cell'><span class='coral-icon "+c.options.subGridOptions.openicon+"'></span></td><td colspan='"+parseInt(c.options.colNames.length-1-m,10)+"' class='coral-component-content subgrid-data'><div id="+e+"_"+d+" class='tablediv'></div></td></tr>"),$(c).triggerHandler("jqGridSubGridRowExpanded",[e+"_"+d,d]),$.isFunction(c.options.subGridRowExpanded)?c.options.subGridRowExpanded.call(c,e+"_"+d,d):l(b)):h.show().removeClass("coral-sg-collapsed").addClass("coral-sg-expanded"),$(this).html("<a style='cursor:pointer;'><span class='coral-icon "+c.options.subGridOptions.minusicon+"'></span></a>").removeClass("sgcollapsed").addClass("sgexpanded"),c.options.subGridOptions.selectOnExpand&&$(c).jqGrid("setSelection",d)}else if($(this).hasClass("sgexpanded")){if(g=$(c).triggerHandler("jqGridSubGridRowColapsed",[e+"_"+d,d]),g=g!==!1&&"stop"!==g,g&&$.isFunction(c.options.subGridRowColapsed)&&(g=c.options.subGridRowColapsed.call(c,e+"_"+d,d)),g===!1)return!1;c.options.subGridOptions.reloadOnExpand===!0?h.remove(".coral-subgrid"):h.hasClass("coral-subgrid")&&h.hide().addClass("coral-sg-collapsed").removeClass("coral-sg-expanded"),$(this).html("<a style='cursor:pointer;'><span class='coral-icon "+c.options.subGridOptions.plusicon+"'></span></a>").removeClass("sgexpanded").addClass("sgcollapsed"),c.options.subGridOptions.selectOnCollapse&&$(c).jqGrid("setSelection",d)}return!1})),o++;if(c.options.subGridOptions.expandOnLoad===!0){var p=c.options,q=p.rownumbers===!0?1:0,r=p.multiselect===!0?1:p.singleselect===!0?1:0,s=q+r;$(c.rows).filter(".jqgrow").each(function(a,b){$(b.cells[s]).click()})}c.subGridXml=function(a,b){j(a,b)},c.subGridJson=function(a,b){k(a,b)}}},expandSubGridRow:function(a){var b=this;if((b.grid||a)&&b.options.subGrid===!0){var c=$(this).jqGrid("getInd",a,!0);if(c){var d=$("td.sgcollapsed",c)[0];d&&$(d).trigger("click")}}},collapseSubGridRow:function(a){var b=this;if((b.grid||a)&&b.options.subGrid===!0){var c=$(this).jqGrid("getInd",a,!0);if(c){var d=$("td.sgexpanded",c)[0];d&&$(d).trigger("click")}}},toggleSubGridRow:function(a){var b=this;if((b.grid||a)&&b.options.subGrid===!0){var c=$(this).jqGrid("getInd",a,!0);if(c){var d=$("td.sgcollapsed",c)[0];d?$(d).trigger("click"):(d=$("td.sgexpanded",c)[0],d&&$(d).trigger("click"))}}}}),grid=$.component("coral.grid",$.coral.grid,{filterToolbar:function(a){var b=$.grid.search;options=$.extend({autosearch:!0,autosearchDelay:500,searchOnEnter:!0,beforeSearch:null,afterSearch:null,beforeClear:null,afterClear:null,searchurl:"",stringResult:!1,groupOp:"AND",defaultSearch:"bw",searchOperators:!1,resetIcon:"x",operands:{eq:"==",ne:"!",lt:"<",le:"<=",gt:">",ge:">=",bw:"^",bn:"!^","in":"=",ni:"!=",ew:"|",en:"!@",cn:"~",nc:"!~",nu:"#",nn:"!#"}},b,a||{});var c=this;if(!c.options.filterToolbar){$(c).data("filterToolbar")||$(c).data("filterToolbar",options),c.options.force_regional&&(options=$.extend(options,b));var d,e=function(){var a,b,d,e={},f=0,g={};$.each(c.options.colModel,function(){var h="text"==this.stype?"textbox":this.stype,i=$("#gsh_"+c.options.idPrefix+c.element[0].id+"_"+$.grid.coralID(this.name)+" .ctrl-init",this.frozen===!0&&c.options.frozenColumns===!0?c.grid.fhDiv:c.grid.columnsView);if(b=this.index||this.name,d=options.searchOperators?i[h]("component").parent().prev().children("a").attr("soper")||options.defaultSearch:this.searchoptions&&this.searchoptions.sopt?this.searchoptions.sopt[0]:"select"===this.stype?"eq":options.defaultSearch,a="custom"===this.stype&&$.isFunction(this.searchoptions.custom_value)&&i.length>0&&"SPAN"===i[0].nodeName.toUpperCase()?this.searchoptions.custom_value.call(c,i.children(".customelement:first"),"get"):i.hasClass("ctrl-init")?i[h]("getValue"):void 0,a||"nu"===d||"nn"===d)e[b]=a,g[b]=d,f++;else try{delete c.options.postData[b]}catch(j){}});var h=f>0;if(options.stringResult===!0||"local"===c.options.datatype||options.searchOperators===!0){var i='{"groupOp":"'+options.groupOp+'","rules":[',j=0;$.each(e,function(a,b){j>0&&(i+=","),i+='{"field":"'+a+'",',i+='"op":"'+g[a]+'",',b+="",i+='"data":"'+b.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}',j++}),i+="]}",$.extend(c.options.postData,{filters:i}),$.each(["searchField","searchString","searchOper"],function(a,b){c.options.postData.hasOwnProperty(b)&&delete c.options.postData[b]})}else $.extend(c.options.postData,e);var k;c.options.searchurl&&(k=c.options.url,$(c).grid("option",{url:c.options.searchurl}));var l="stop"===$(c).triggerHandler("jqGridToolbarBeforeSearch");!l&&$.isFunction(options.beforeSearch)&&(l=options.beforeSearch.call(c)),l||(c.isFilterAction=c.isFilterAction!==!1,$(c.element[0]).grid("option",{search:h}).grid("reload"),c.isFilterAction=!1),k&&$(c.element[0]).grid("option",{url:k}),$.isFunction(options.afterSearch)&&options.afterSearch.call(c)},f=function(a){var b,d={},e=0;a="boolean"!=typeof a?!0:a,$.each(c.options.colModel,function(){var a,f=$("#gs_"+c.options.idPrefix+$.grid.coralID(this.name),this.frozen===!0&&c.options.frozenColumns===!0?c.grid.fhDiv:c.grid.columnsView);switch(this.searchoptions&&void 0!==this.searchoptions.defaultValue&&(a=this.searchoptions.defaultValue),b=this.index||this.name,this.stype){case"select":if(f.find("option").each(function(b){return 0===b&&(this.selected=!0),$(this).val()===a?(this.selected=!0,!1):void 0}),void 0!==a)d[b]=a,e++;else try{delete c.options.postData[b]}catch(g){}break;case"text":if(f.val(a||""),void 0!==a)d[b]=a,e++;else try{delete c.options.postData[b]}catch(h){}break;case"custom":$.isFunction(this.searchoptions.custom_value)&&f.length>0&&"SPAN"===f[0].nodeName.toUpperCase()&&this.searchoptions.custom_value.call(c,f.children(".customelement:first"),"set",a||"")}});var f=e>0;if(c.options.resetsearch=!0,options.stringResult===!0||"local"===c.options.datatype){var g='{"groupOp":"'+options.groupOp+'","rules":[',h=0;$.each(d,function(a,b){h>0&&(g+=","),g+='{"field":"'+a+'",',g+='"op":"eq",',b+="",g+='"data":"'+b.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}',h++}),g+="]}",$.extend(c.options.postData,{filters:g}),$.each(["searchField","searchString","searchOper"],function(a,b){c.options.postData.hasOwnProperty(b)&&delete c.options.postData[b]})}else $.extend(c.options.postData,d);var i;c.options.searchurl&&(i=c.options.url,$(c).grid("option",{url:c.options.searchurl}));var j="stop"===$(c).triggerHandler("jqGridToolbarBeforeClear");!j&&$.isFunction(options.beforeClear)&&(j=options.beforeClear.call(c)),j||a&&$(c).grid("option",{search:f}).trigger("reload",[{page:1}]),i&&$(c).grid("option",{url:i}),$.isFunction(options.afterClear)&&options.afterClear()},g=function(){var a=$("tr.coral-search-toolbar",c.grid.columnsView),b=c.options.frozenColumns===!0?$("tr.coral-search-toolbar",c.grid.fhDiv):!1;"none"===a.css("display")?(a.show(),b&&b.show()):(a.hide(),b&&b.hide())},h=function(a,b,d){$("#sopt_menu").remove(),b=parseInt(b,10),d=parseInt(d,10)+18;for(var f,g,h=$(".coral-grid-view").css("font-size")||"11px",i='<ul id="sopt_menu" class="coral-search-menu" role="menu" tabindex="0" style="font-size:'+h+";left:"+b+"px;top:"+d+'px; cursor:pointer;">',j=$(a).attr("soper"),k=[],l=0,m=$(a).attr("colname"),n=c.options.colModel.length;n>l&&c.options.colModel[l].name!==m;)l++;var o=c.options.colModel[l],p=$.extend({},o.searchoptions);for(p.sopt||(p.sopt=[],p.sopt[0]="select"===o.stype?"eq":options.defaultSearch),$.each(options.odata,function(){k.push(this.oper)}),l=0;l<p.sopt.length;l++)g=$.inArray(p.sopt[l],k),-1!==g&&(f=j===options.odata[g].oper?"coral-state-highlight":"",i+='<li class="coral-menu-item '+f+'" role="presentation"><a class="coral-corner-all coral-menu-item" tabindex="0" role="menuitem" value="'+options.odata[g].oper+'" oper="'+options.operands[options.odata[g].oper]+'"><table cellspacing="0" cellpadding="0" border="0"><tr><td width="25px">'+options.operands[options.odata[g].oper]+"</td><td>"+options.odata[g].text+"</td></tr></table></a></li>");i+="</ul>",$("body").append(i),$("#sopt_menu").addClass("coral-menu coral-component coral-component-content coral-corner-all"),$("#sopt_menu > li > a").hover(function(){$(this).addClass("coral-state-hover")},function(){$(this).removeClass("coral-state-hover")}).click(function(){var b=$(this).attr("value"),c=$(this).attr("oper");if($("#sopt_menu").hide(),$(a).text(c).attr("soper",b),options.autosearch===!0){var d=$(a).parent().next().children()[0].firstChild.firstChild;($(d).val()||"nu"===b||"nn"===b)&&e()}})},i=$("<tr class='coral-search-toolbar' role='row'></tr>");$.each(c.options.colModel,function(a){var b,f,g,h,j,k,l,m=this,n="",o="=",p=$("<th role='columnheader' class='coral-state-default coral-th-"+c.options.direction+"' id='gsh_"+c.options.id+"_"+m.name+"' ></th>"),q=$("<div></div>"),r=$("<table class='coral-search-table' cellspacing='0'><tr><td class='coral-search-oper' headers=''></td><td class='coral-search-input' headers=''></td><td class='coral-search-clear' headers=''></td></tr></table>");if(this.hidden===!0&&$(p).css("display","none"),this.search=this.search!==!1,void 0===this.stype&&(this.stype="text"),b=$.extend({},this.searchoptions||{},{name:m.index||m.name,id:"gs_"+c.options.idPrefix+m.name,oper:"search"}),this.search){if(options.searchOperators){for(f=b.sopt?b.sopt[0]:"select"===m.stype?"eq":options.defaultSearch,g=0;g<options.odata.length;g++)if(options.odata[g].oper===f){o=options.operands[f]||"";break}h=null!=b.searchtitle?b.searchtitle:options.operandTitle,n="<a title='"+h+"' style='padding-right: 0.5em;cursor:pointer;' soper='"+f+"' class='soptclass' colname='"+this.name+"'>"+o+"</a>"}switch($("td:eq(0)",r).attr("colindex",a).append(n),void 0===b.clearSearch&&(b.clearSearch=!0),b.clearSearch?(j=options.resetTitle||"Clear Search Value",$("td:eq(2)",r).append("<a title='"+j+"' style='padding-right: 0.3em;padding-left: 0.3em;cursor:pointer;' class='clearsearchclass'>"+options.resetIcon+"</a>")):$("td:eq(2)",r).hide(),this.surl&&(b.dataUrl=this.surl),k="",b.defaultValue&&(k=$.isFunction(b.defaultValue)?b.defaultValue.call(c):b.defaultValue),l=$.grid.createEl.call(c,m.stype,b,k,!1,$.extend({},$.grid.ajaxOptions,c.options.ajaxSelectOptions||{})),$(l).css({width:"100%"}).addClass("coral-widget-content coral-corner-all"),$("td:eq(1)",r).append(l),$(q).append(r),$.extend(options,{onKeyPress:function(a,b){var c=a.charCode||a.keyCode||0;return 13===c?(e(),!1):void 0},onKeyDown:function(a,b){var c=a.which;switch(c){case 13:return!1;case 9:case 16:case 37:case 38:case 39:case 40:case 27:break;default:d&&clearTimeout(d),d=setTimeout(function(){e()},500)}},onChange:function(){e(this)}}),this.stype){case"combobox":var s,t=this.searchoptions;s=$.extend(options,t),$(l)[this.stype](s);var u=options.onClick;options=$.extend({},options,{onClick:function(a,b){u&&u.apply(l,[a,b])}});break;case"text":options.valueChangedOnKeyUp=!0,$(l).textbox(options)}}$(p).append(q),$(i).append(p),options.searchOperators||$("td:eq(0)",r).hide()}),$("table thead",c.grid.columnsView).append(i),options.searchOperators&&($(".soptclass",i).click(function(a){var b=$(this).offset(),c=b.left,d=b.top;h(this,c,d),a.stopPropagation()}),$("body").on("click",function(a){"soptclass"!==a.target.className&&$("#sopt_menu").hide()})),$(".clearsearchclass",i).click(function(){var a=$(this).parents("tr:first"),b=parseInt($("td.coral-search-oper",a).attr("colindex"),10),d=$.extend({},c.options.colModel[b].searchoptions||{}),f=d.defaultValue?d.defaultValue:"";"select"===c.options.colModel[b].stype?f?$("td.coral-search-input select",a).val(f):$("td.coral-search-input select",a)[0].selectedIndex=0:$("td.coral-search-input input",a).val(f),options.autosearch===!0&&e()}),this.options.filterToolbar=!0,this.triggerToolbar=e,this.clearToolbar=f,this.toggleToolbar=g}},destroyFilterToolbar:function(){this.options.filterToolbar&&(this.triggerToolbar=null,this.clearToolbar=null,this.toggleToolbar=null,this.options.filterToolbar=!1,$(this.grid.columnsView).find("table thead tr.coral-search-toolbar").remove())}});/*! cui 2016-11-08 */
function _pivotfilter(a,b){var c,d,e,f=[];if(!this||"function"!=typeof a||a instanceof RegExp)throw new TypeError;for(e=this.length,c=0;e>c;c++)if(this.hasOwnProperty(c)&&(d=this[c],a.call(b,d,c,this))){f.push(d);break}return f}$.assocArraySize=function(a){var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c},$.component("coral.grid",$.coral.grid,{pivotSetup:function(a,b){var c=[],d=this,e=[],f=[],g=[],h=[],i={grouping:!0,groupingView:{groupField:[],groupSummary:[],groupSummaryPos:[]}},j=[],k=$.extend({rowTotals:!1,rowTotalsText:"Total",colTotals:!1,groupSummary:!0,groupSummaryPos:"header",frozenStaticCols:!1},b||{});return this.element.each(function(){function b(a,b,c){var d;return d=_pivotfilter.call(a,b,c),d.length>0?d[0]:null}function l(a,b){var c,e=0,f=!0;for(c in a){if(a[c]!=d[e]){f=!1;break}if(e++,e>=d.length)break}return f&&(q=b),f}function m(a,b,c,d){var e;switch(a){case"sum":e=parseFloat(b||0)+parseFloat(d[c]||0);break;case"count":""!==b&&null!=b||(b=0),e=d.hasOwnProperty(c)?b+1:0;break;case"min":e=""===b||null==b?parseFloat(d[c]||0):Math.min(parseFloat(b),parseFloat(d[c]||0));break;case"max":e=""===b||null==b?parseFloat(d[c]||0):Math.max(parseFloat(b),parseFloat(d[c]||0))}return e}function n(a,b,c,d){var e,f,i,j,k=b.length,l="",n=[];for($.isArray(c)?(j=c.length,n=c):(j=1,n[0]=c),g=[],h=[],g.root=0,i=0;j>i;i++){var o,p=[];for(e=0;k>e;e++){if(null==c)f=$.trim(b[e].member)+"_"+b[e].aggregator,o=f,n[0]=o;else{o=c[i].replace(/\s+/g,"");try{f=1===k?l+o:l+o+"_"+b[e].aggregator+"_"+String(e)}catch(q){}}f=isNaN(parseInt(f,10))?f:f+" ",d[f]=p[f]=m(b[e].aggregator,d[f],b[e].member,a),1>=i&&"_r_Totals"!==o&&""===l&&(l=o)}g[f]=p,h[f]=n[i]}return d}function o(a){var b,d,e,f,g;for(e in a)if(a.hasOwnProperty(e)){if("object"!=typeof a[e]){if("level"===e){if(void 0===K[a.level]&&(K[a.level]="",a.level>0&&"_r_Totals"!==a.text&&(j[a.level-1]={useColSpanStyle:!1,groupHeaders:[]})),K[a.level]!==a.text&&a.children.length&&"_r_Totals"!==a.text&&a.level>0){j[a.level-1].groupHeaders.push({titleText:a.label,numberOfColumns:0});var h=j[a.level-1].groupHeaders.length-1,i=0===h?M:L+u;if(a.level-1===(k.rowTotals?1:0)&&h>0){var l=j[a.level-1].groupHeaders[h-1].numberOfColumns;l&&(i=l+1+k.aggregates.length)}j[a.level-1].groupHeaders[h].startColumnName=c[i].name,j[a.level-1].groupHeaders[h].numberOfColumns=c.length-i,L=c.length}K[a.level]=a.text}if(a.level===t&&"level"===e&&t>0)if(u>1){var m=1;for(b in a.fields)1===m&&j[t-1].groupHeaders.push({startColumnName:b,numberOfColumns:1,titleText:a.text}),m++;j[t-1].groupHeaders[j[t-1].groupHeaders.length-1].numberOfColumns=m-1}else j.splice(t-1,1)}if(null!=a[e]&&"object"==typeof a[e]&&o(a[e]),"level"===e&&a.level>0){d=0;for(b in a.fields)if(a.fields.hasOwnProperty(b)){g={};for(f in k.aggregates[d])if(k.aggregates[d].hasOwnProperty(f))switch(f){case"member":case"label":case"aggregator":break;default:g[f]=k.aggregates[d][f]}u>1?(g.name=b,g.label=k.aggregates[d].label||a.label):(g.name=a.text,g.label="_r_Totals"===a.text?k.rowTotalsText:a.label),c.push(g),d++}}}}var p,q,r,s,t,u,v,w,x=a.length,y=0;if(k.rowTotals&&k.yDimension.length>0){var z=k.yDimension[0].dataName;k.yDimension.splice(0,0,{dataName:z}),k.yDimension[0].converter=function(){return"_r_Totals"}}if(s=$.isArray(k.xDimension)?k.xDimension.length:0,t=k.yDimension.length,u=$.isArray(k.aggregates)?k.aggregates.length:0,0===s||0===u)throw"xDimension or aggregates optiona are not set!";var A;for(r=0;s>r;r++)A={name:k.xDimension[r].dataName,frozen:k.frozenStaticCols},null==k.xDimension[r].isGroupField&&(k.xDimension[r].isGroupField=!0),A=$.extend(!0,A,k.xDimension[r]),c.push(A);for(var B=s-1,C={};x>y;){p=a[y];var D=[],E=[];v={},r=0;do D[r]=$.trim(p[k.xDimension[r].dataName]),v[k.xDimension[r].dataName]=D[r],r++;while(s>r);var F=0;if(q=-1,w=b(e,l,D)){if(q>=0){if(F=0,t>=1){for(F=0;t>F;F++)E[F]=$.trim(p[k.yDimension[F].dataName]),k.yDimension[F].converter&&$.isFunction(k.yDimension[F].converter)&&(E[F]=k.yDimension[F].converter.call(this,E[F],D,E));w=n(p,k.aggregates,E,w)}else 0===t&&(w=n(p,k.aggregates,null,w));e[q]=w}}else{if(F=0,t>=1){for(F=0;t>F;F++)E[F]=$.trim(p[k.yDimension[F].dataName]),k.yDimension[F].converter&&$.isFunction(k.yDimension[F].converter)&&(E[F]=k.yDimension[F].converter.call(this,E[F],D,E));v=n(p,k.aggregates,E,v)}else 0===t&&(v=n(p,k.aggregates,null,v));e.push(v)}var G,H=0,I=null,J=null;for(G in g)if(g.hasOwnProperty(G)){if(0===H)C.children&&void 0!==C.children||(C={text:G,level:0,children:[],label:G}),I=C.children;else{for(J=null,r=0;r<I.length;r++)if(I[r].text===G){J=I[r];break}J?I=J.children:(I.push({children:[],text:G,level:H,fields:g[G],label:h[G]}),I=I[I.length-1].children)}H++}y++}var K=[],L=c.length,M=L;t>0&&(j[t-1]={useColSpanStyle:!1,groupHeaders:[]}),o(C);var N;if(k.colTotals){for(var O=e.length;O--;)for(r=s;r<c.length;r++)N=c[r].name,f[N]?f[N]+=parseFloat(e[O][N]||0):f[N]=parseFloat(e[O][N]||0);if(k.colTotalsText)for(var P=0;P<k.colTotalsText.length;P++)f[k.colTotalsText[P].colName]=k.colTotalsText[P].text}if(B>0)for(r=0;B>r;r++)c[r].isGroupField&&(i.groupingView.groupField.push(c[r].name),i.groupingView.groupSummary.push(k.groupSummary),i.groupingView.groupSummaryPos.push(k.groupSummaryPos));else i.grouping=!1;i.sortname=c[B].name,i.groupingView.hideFirstGroupCol=!0}),{colModel:c,rows:e,groupOptions:i,groupHeaders:j,summary:f}},jqPivot:function(a,b,c,d){function e(a){var d,e=f.pivotSetup(a,b),g=$.assocArraySize(e.summary)>0,h=$.grid.from(e.rows);for(d=0;d<e.groupOptions.groupingView.groupField.length;d++)h.orderBy(e.groupOptions.groupingView.groupField[d],"a","text","");$.extend(!0,f.options,{data:h.select(),userData:g?e.summary:{},datatype:"local",footerrow:g,userDataOnFooter:g,colModel:e.colModel,viewrecords:!0,groupHeader:!0,groupHeaders:b.rowTotals?e.groupHeaders[1]&&e.groupHeaders[1].groupHeaders:e.groupHeaders[0]&&e.groupHeaders[0].groupHeaders,sortname:b.xDimension[0].dataName},e.groupOptions,c||{});e.groupHeaders;b.frozenStaticCols&&$(this.element).grid("setFrozenColumns")}var f=this;"string"==typeof a?$.ajax($.extend({url:data,dataType:"json",success:function(a){e($.grid.getAccessor(a,d&&d.reader?d.reader:"rows"))}},ajaxOpt||{})):e(a)}});/*! cui 2016-11-08 */
$.grid=$.grid||{},$.extend($.grid,{showModal:function(a){a.w.show()},closeModal:function(a){a.w.hide().attr("aria-hidden","true"),a.o&&a.o.remove()},hideModal:function(a,b){if(b=$.extend({jqm:!0,gb:""},b||{}),b.onClose){var c=b.onClose(a);if("boolean"==typeof c&&!c)return}if($.fn.jqm&&b.jqm===!0)$(a).attr("aria-hidden","true").jqmHide();else{if(""!==b.gb)try{$(".jqgrid-overlay:first",b.gb).hide()}catch(d){}$(a).hide().attr("aria-hidden","true")}},findPos:function(a){var b=0,c=0;if(a.offsetParent)do b+=a.offsetLeft,c+=a.offsetTop;while(a=a.offsetParent);return[b,c]},createModal:function(a,b,c,d,e,f,g){var h,i=document.createElement("div"),j=this;g=$.extend({},g||{}),h="rtl"==$(c.gbox).attr("dir"),i.className="coral-component coral-component-content coral-corner-all coral-jqdialog",i.id=a.themodal;var k=document.createElement("div");k.className="coral-jqdialog-titlebar coral-component-header coral-corner-all coral-helper-clearfix",k.id=a.modalhead,$(k).append("<span class='coral-jqdialog-title'>"+c.caption+"</span>");var l=$("<a href='javascript:void(0)' class='coral-jqdialog-titlebar-close coral-corner-all'></a>").hover(function(){l.addClass("coral-state-hover")},function(){l.removeClass("coral-state-hover")}).append("<span class='coral-icon coral-icon-closethick'></span>");$(k).append(l),h?(i.dir="rtl",$(".coral-jqdialog-title",k).css("float","right"),$(".coral-jqdialog-titlebar-close",k).css("left","0.3em")):(i.dir="ltr",$(".coral-jqdialog-title",k).css("float","left"),$(".coral-jqdialog-titlebar-close",k).css("right","0.3em"));var m=document.createElement("div");$(m).addClass("coral-jqdialog-content coral-component-content").attr("id",a.modalcontent),$(m).append(b),i.appendChild(m),$(i).prepend(k),f===!0?$("body").append(i):"string"==typeof f?$(f).append(i):$(i).insertBefore(d),$(i).css(g),"undefined"==typeof c.jqModal&&(c.jqModal=!0);var n={};if($.fn.jqm&&c.jqModal===!0){if(0===c.left&&0===c.top&&c.overlay){var o=[];o=this.findPos(e),c.left=o[0]+4,c.top=o[1]+4}n.top=c.top+"px",n.left=c.left}else 0===c.left&&0===c.top||(n.left=c.left,n.top=c.top+"px");if($("a.coral-jqdialog-titlebar-close",k).click(function(){var b=$("#"+$.grid.jqID(a.themodal)).data("onClose")||c.onClose,d=$("#"+$.grid.jqID(a.themodal)).data("gbox")||c.gbox;return j.hideModal("#"+$.grid.jqID(a.themodal),{gb:d,jqm:c.jqModal,onClose:b}),!1}),0!==c.width&&c.width||(c.width=300),0!==c.height&&c.height||(c.height=200),!c.zIndex){var p=$(d).parents("*[role=dialog]").filter(":first").css("z-index");p?c.zIndex=parseInt(p,10)+2:c.zIndex=950}var q=0;if(h&&n.left&&!f&&(q=$(c.gbox).width()-(isNaN(c.width)?0:parseInt(c.width,10))-8,n.left=parseInt(n.left,10)+parseInt(q,10)),n.left&&(n.left+="px"),$(i).css($.extend({width:isNaN(c.width)?"auto":c.width+"px",height:isNaN(c.height)?"auto":c.height+"px",zIndex:c.zIndex,overflow:"hidden"},n)).attr({tabIndex:"-1",role:"dialog","aria-labelledby":a.modalhead,"aria-hidden":"true"}),"undefined"==typeof c.drag&&(c.drag=!0),"undefined"==typeof c.resize&&(c.resize=!0),c.drag)if($(k).css("cursor","move"),$.fn.jqDrag)$(i).jqDrag(k);else try{$(i).draggable({handle:$("#"+$.grid.jqID(k.id))})}catch(r){}if(c.resize)if($.fn.jqResize)$(i).append("<div class='jqResize coral-resizable-handle coral-resizable-se coral-icon coral-icon-gripsmall-diagonal-se coral-icon-grip-diagonal-se'></div>"),$("#"+$.grid.jqID(a.themodal)).jqResize(".jqResize",a.scrollelm?"#"+$.grid.jqID(a.scrollelm):!1);else try{$(i).resizable({handles:"se, sw",alsoResize:a.scrollelm?"#"+$.grid.jqID(a.scrollelm):!1})}catch(s){}c.closeOnEscape===!0&&$(i).keydown(function(b){if(27==b.which){var d=$("#"+$.grid.jqID(a.themodal)).data("onClose")||c.onClose;j.hideModal(this,{gb:c.gbox,jqm:c.jqModal,onClose:d})}})},viewModal:function(a,b){if(b=$.extend({toTop:!0,overlay:10,modal:!1,overlayClass:"coral-component-overlay",onShow:this.showModal,onHide:this.closeModal,gbox:"",jqm:!0,jqM:!0},b||{}),$.fn.jqm&&b.jqm===!0)b.jqM?$(a).attr("aria-hidden","false").jqm(b).jqmShow():$(a).attr("aria-hidden","false").jqmShow();else{""!==b.gbox&&($(".jqgrid-overlay:first",b.gbox).show(),$(a).data("gbox",b.gbox)),$(a).show().attr("aria-hidden","false");try{$(":input:visible",a)[0].focus()}catch(c){}}},info_dialog:function(a,b,c,d){var e={width:290,height:"auto",dataheight:"auto",drag:!0,resize:!1,caption:"<b>"+a+"</b>",left:250,top:170,zIndex:1e3,jqModal:!0,modal:!1,closeOnEscape:!0,align:"center",buttonalign:"center",buttons:[]};$.extend(e,d||{});var f=e.jqModal,g=this;$.fn.jqm&&!f&&(f=!1);var h="";if(e.buttons.length>0)for(var i=0;i<e.buttons.length;i++)"undefined"==typeof e.buttons[i].id&&(e.buttons[i].id="info_button_"+i),h+="<a href='javascript:void(0)' id='"+e.buttons[i].id+"' class='fm-button coral-state-default coral-corner-all'>"+e.buttons[i].text+"</a>";var j=isNaN(e.dataheight)?e.dataheight:e.dataheight+"px",k="text-align:"+e.align+";",l="<div id='info_id'>";l+="<div id='infocnt' style='margin:0px;padding-bottom:1em;width:100%;overflow:auto;position:relative;height:"+j+";"+k+"'>"+b+"</div>",l+=c?"<div class='coral-component-content coral-helper-clearfix' style='text-align:"+e.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'><a href='javascript:void(0)' id='closedialog' class='fm-button coral-state-default coral-corner-all'>"+c+"</a>"+h+"</div>":""!==h?"<div class='coral-component-content coral-helper-clearfix' style='text-align:"+e.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'>"+h+"</div>":"",l+="</div>";try{"false"==$("#info_dialog").attr("aria-hidden")&&this.hideModal("#info_dialog",{jqm:f}),$("#info_dialog").remove()}catch(m){}this.createModal({themodal:"info_dialog",modalhead:"info_head",modalcontent:"info_content",scrollelm:"infocnt"},l,e,"","",!0),h&&$.each(e.buttons,function(a){$("#"+$.grid.jqID(this.id),"#info_id").bind("click",function(){return e.buttons[a].onClick.call($("#info_dialog")),!1})}),$("#closedialog","#info_id").click(function(){return g.hideModal("#info_dialog",{jqm:f}),!1}),$(".fm-button","#info_dialog").hover(function(){$(this).addClass("coral-state-hover")},function(){$(this).removeClass("coral-state-hover")}),$.isFunction(e.beforeOpen)&&e.beforeOpen(),this.viewModal("#info_dialog",{onHide:function(a){a.w.hide().remove(),a.o&&a.o.remove()},modal:e.modal,jqm:f}),$.isFunction(e.afterOpen)&&e.afterOpen();try{$("#info_dialog").focus()}catch(n){}},createEl:function(a,b,c,d,e){function f(a,b,c){b.hasOwnProperty("id")||$(a).attr("id",$.grid.randId())}var g="",h=this;switch(a){case"textarea":g=document.createElement("textarea"),d?b.cols||$(g).css({width:"98%"}):b.cols||(b.cols=20),b.rows||(b.rows=2),("&nbsp;"==c||"&#160;"==c||1==c.length&&160==c.charCodeAt(0))&&(c=""),g.setAttribute("value",c),f(g,b),$(g).attr({role:"textbox",multiline:"true"});break;case"select":g=document.createElement("select"),g.setAttribute("role","select");var i,j=[];if(b.multiple===!0?(i=!0,g.multiple="multiple",$(g).attr("aria-multiselectable","true")):i=!1,"undefined"!=typeof b.dataUrl)$.ajax($.extend({url:b.dataUrl,type:"GET",dataType:"html",context:{elem:g,options:b,vl:c},success:function(a){var b,c=[],d=this.elem,e=this.vl,g=$.extend({},this.options),i=g.multiple===!0;if($.isFunction(g.buildSelect)){var j=g.buildSelect.call(h,a);b=$(j).html()}else b=$(a).html();b&&($(d).append(b),f(d,g),"undefined"==typeof g.size&&(g.size=i?3:1),i?(c=e.split(","),c=$.map(c,function(a){return $.trim(a)})):c[0]=$.trim(e),setTimeout(function(){$("option",d).each(function(a){0===a&&d.multiple&&(this.selected=!1),$(this).attr("role","option"),($.inArray($.trim($(this).text()),c)>-1||$.inArray($.trim($(this).val()),c)>-1)&&(this.selected="selected")})},0))}},e||{}));else if(b.value){var k;"undefined"==typeof b.size&&(b.size=i?3:1),i&&(j=c.split(","),j=$.map(j,function(a){return $.trim(a)})),"function"==typeof b.value&&(b.value=b.value());var l,m,n,o=void 0===b.separator?":":b.separator,p=void 0===b.delimiter?";":b.delimiter;if("string"==typeof b.value)for(l=b.value.split(p),k=0;k<l.length;k++)m=l[k].split(o),m.length>2&&(m[1]=$.map(m,function(a,b){return b>0?a:void 0}).join(o)),n=document.createElement("option"),n.setAttribute("role","option"),n.value=m[0],n.innerHTML=m[1],g.appendChild(n),i||$.trim(m[0])!=$.trim(c)&&$.trim(m[1])!=$.trim(c)||(n.selected="selected"),i&&($.inArray($.trim(m[1]),j)>-1||$.inArray($.trim(m[0]),j)>-1)&&(n.selected="selected");else if("object"==typeof b.value){var q=b.value;for(var r in q)q.hasOwnProperty(r)&&(n=document.createElement("option"),n.setAttribute("role","option"),n.value=r,n.innerHTML=q[r],g.appendChild(n),i||$.trim(r)!=$.trim(c)&&$.trim(q[r])!=$.trim(c)||(n.selected="selected"),i&&($.inArray($.trim(q[r]),j)>-1||$.inArray($.trim(r),j)>-1)&&(n.selected="selected"))}f(g,b,["value"])}break;case"datepicker":case"autocomplete":case"autocompletetree":case"text":case"password":case"button":var s;s="button"==a?"button":"textbox",g=document.createElement("input"),"datepicker"==a?g.type="text":"autocomplete"==a?g.type="text":g.type=a,g.setAttribute("value",c),f(g,b),"button"!=a&&(d?b.size||$(g).css({width:"98%"}):b.size||(b.size=20)),$(g).attr("role",s);break;case"image":case"file":g=document.createElement("input"),g.type=a,f(g,b);break;case"custom":g=document.createElement("span");try{if(!$.isFunction(b.custom_element))throw"e1";var t=b.custom_element.call(h,c,b);if(!t)throw"e2";t=$(t).addClass("customelement").attr({id:b.id,name:b.name}),$(g).empty().append(t)}catch(u){"e1"==u&&this.info_dialog($.grid.errors.errcap,"function 'custom_element' "+$.grid.edit.msg.nodefined,$.grid.edit.bClose),"e2"==u?this.info_dialog($.grid.errors.errcap,"function 'custom_element' "+$.grid.edit.msg.novalue,$.grid.edit.bClose):this.info_dialog($.grid.errors.errcap,"string"==typeof u?u:u.message,$.grid.edit.bClose)}break;case"checkbox":g=document.createElement("input"),g.type=a,g.setAttribute("value",c),f(g,b);break;case"combobox":case"combotree":case"combogrid":g=document.createElement("input"),g.type="text",g.setAttribute("value",c),f(g,b)}return g},checkDate:function(a,b){var c,d=function(a){return a%4!==0||a%100===0&&a%400!==0?28:29},e=function(a){for(var b=1;a>=b;b++)this[b]=31,4!=b&&6!=b&&9!=b&&11!=b||(this[b]=30),2==b&&(this[b]=29);return this},f={};if(a=a.toLowerCase(),c=-1!=a.indexOf("/")?"/":-1!=a.indexOf("-")?"-":-1!=a.indexOf(".")?".":"/",a=a.split(c),b=b.split(c),3!=b.length)return!1;for(var g,h=-1,i=-1,j=-1,k=0;k<a.length;k++){var l=isNaN(b[k])?0:parseInt(b[k],10);f[a[k]]=l,g=a[k],-1!=g.indexOf("y")&&(h=k),-1!=g.indexOf("m")&&(j=k),-1!=g.indexOf("d")&&(i=k)}g="y"==a[h]||"yyyy"==a[h]?4:"yy"==a[h]?2:-1;var m,n=e(12);return-1===h?!1:(m=f[a[h]].toString(),2==g&&1==m.length&&(g=1),m.length!=g||0===f[a[h]]&&"00"!=b[h]?!1:-1===j?!1:(m=f[a[j]].toString(),m.length<1||f[a[j]]<1||f[a[j]]>12?!1:-1===i?!1:(m=f[a[i]].toString(),!(m.length<1||f[a[i]]<1||f[a[i]]>31||2==f[a[j]]&&f[a[i]]>d(f[a[h]])||f[a[i]]>n[f[a[j]]]))))},isEmpty:function(a){return!(!a.match(/^\s+$/)&&""!==a)},checkTime:function(a){var b,c=/^(\d{1,2}):(\d{2})([ap]m)?$/;if(!this.isEmpty(a)){if(b=a.match(c),!b)return!1;if(b[3]){if(b[1]<1||b[1]>12)return!1}else if(b[1]>23)return!1;if(b[2]>59)return!1}return!0},checkValues:function(a,b,c,d,e){var f,g,h,i,j;if("undefined"==typeof d)if("string"==typeof b){for(g=0,j=c.options.colModel.length;j>g;g++)if(c.options.colModel[g].name==b){f=c.options.colModel[g].editrules,b=g;try{h=c.options.colModel[g].formoptions.label}catch(k){}break}}else b>=0&&(f=c.options.colModel[b].editrules);else f=d,h=void 0===e?"_":e;if(f){if(h||(h=c.options.colNames[b]),f.required===!0&&this.isEmpty(a))return[!1,h+": "+$.grid.edit.msg.required,""];var l=f.required!==!1;if(f.number===!0&&(l!==!1||!this.isEmpty(a))&&isNaN(a))return[!1,h+": "+$.grid.edit.msg.number,""];if("undefined"!=typeof f.minValue&&!isNaN(f.minValue)&&parseFloat(a)<parseFloat(f.minValue))return[!1,h+": "+$.grid.edit.msg.minValue+" "+f.minValue,""];if("undefined"!=typeof f.maxValue&&!isNaN(f.maxValue)&&parseFloat(a)>parseFloat(f.maxValue))return[!1,h+": "+$.grid.edit.msg.maxValue+" "+f.maxValue,""];var m;if(f.email===!0&&!(l===!1&&this.isEmpty(a)||(m=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i,m.test(a))))return[!1,h+": "+$.grid.edit.msg.email,""];if(f.integer===!0&&(l!==!1||!this.isEmpty(a))){if(isNaN(a))return[!1,h+": "+$.grid.edit.msg.integer,""];if(a%1!==0||-1!=a.indexOf("."))return[!1,h+": "+$.grid.edit.msg.integer,""]}if(f.date===!0&&!(l===!1&&this.isEmpty(a)||(i=c.options.colModel[b].formatoptions&&c.options.colModel[b].formatoptions.newformat?c.options.colModel[b].formatoptions.newformat:c.options.colModel[b].datefmt||"Y-m-d",this.checkDate(i,a))))return[!1,h+": "+$.grid.edit.msg.date+" - "+i,""];if(f.time===!0&&!(l===!1&&this.isEmpty(a)||this.checkTime(a)))return[!1,h+": "+$.grid.edit.msg.date+" - hh:mm (am/pm)",""];if(f.url===!0&&!(l===!1&&this.isEmpty(a)||(m=/^(((https?)|(ftp)):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i,m.test(a))))return[!1,h+": "+$.grid.edit.msg.url,""];if(f.custom===!0&&(l!==!1||!this.isEmpty(a))){if($.isFunction(f.custom_func)){var n=f.custom_func.call(c,a,h);return $.isArray(n)?n:[!1,$.grid.edit.msg.customarray,""]}return[!1,$.grid.edit.msg.customfcheck,""]}}return[!0,"",""]}});/*! cui 2016-11-08 */
$.component("coral.grid",$.coral.grid,{editCell:function(a,b,c){var d,e,f,g,h=this;if(h.grid&&h.options.cellEdit===!0){if(b=parseInt(b,10),h.options.knv||$(h.element).grid("GridNav"),h.options.savedRow.length>0){if(c===!0&&a==h.options.iRow&&b==h.options.iCol)return;if(h.rows[h.options.savedRow[0].id]&&!$(h.element).grid("saveCell",h.options.savedRow[0].id,h.options.savedRow[0].ic))return}else window.setTimeout(function(){$("#"+$.grid.coralID(h.options.knv)).attr("tabindex","-1").focus()},0);if(g=h.options.colModel[b],d=g.name,"subgrid"!=d&&"cb"!=d&&"rn"!=d){if(f=$("td:eq("+b+")",h.rows[a]),g.editable!==!0||c!==!0||f.hasClass("not-editable-cell"))parseInt(h.options.iCol,10)>=0&&parseInt(h.options.iRow,10)>=0&&($("td:eq("+h.options.iCol+")",h.rows[h.options.iRow]).removeClass("edit-cell coral-state-highlight"),$(h.rows[h.options.iRow]).removeClass("selected-row coral-state-hover")),f.addClass("edit-cell coral-state-highlight"),$(h.rows[a]).addClass("selected-row coral-state-hover"),e=f.html().replace(/\&#160\;/gi,""),$(h.element).triggerHandler("jqGridSelectCell",[h.rows[a].id,d,e,a,b]),$.isFunction(h.options.onSelectCell)&&h.options.onSelectCell.call(h,h.rows[a].id,d,e,a,b);else{parseInt(h.options.iCol,10)>=0&&parseInt(h.options.iRow,10)>=0&&($("td:eq("+h.options.iCol+")",h.rows[h.options.iRow]).removeClass("edit-cell coral-state-highlight"),$(h.rows[h.options.iRow]).removeClass("selected-row coral-state-hover")),$(f).addClass("edit-cell coral-state-highlight"),$(h.rows[a]).addClass("selected-row coral-state-hover");try{e=$.unformat.call(h,f,{rowId:h.rows[a].id,colModel:g},b)}catch(i){e=g.edittype&&"textarea"==g.edittype?$(f).text():$(f).html()}if(h.options.autoencode&&(e=$.grid.htmlDecode(e)),!h._trigger("beforeEditCell",null,[{rowId:h.rows[a].id,name:d,cellValue:e,rowIndex:a,cellIndex:b}]))return;if(h.options.savedRow.push({id:a,ic:b,name:d,value:e}),("&nbsp;"===e||"&#160;"===e||1===e.length&&160===e.charCodeAt(0))&&(e=""),$.isFunction(h.options.formatCell)){var j=h.options.formatCell.call(h,h.rows[a].id,d,e,a,b);void 0!==j&&(e=j)}var k=g.editoptions,l={id:a+"_"+d,name:d};k=$.extend({},k||{},l);var m=$.grid.createEl.call(h,g.edittype,k,e,!0,$.extend({},$.grid.ajaxOptions,h.options.ajaxSelectOptions||{}));$(f).html("").append(m).attr("tabindex","0");var n=function(c){if(27===c.keyCode&&($("input.hasDatepicker",f).length>0?$(".coral-datepicker").is(":hidden")?$(h.element).grid("restoreCell",a,b):$("input.hasDatepicker",f).datepicker("hide"):$(h.element).grid("restoreCell",a,b)),13===c.keyCode)return $(h.element).grid("saveCell",a,b),!1;if(9===c.keyCode){if(h.grid.columnsView.loading)return!1;c.shiftKey?$(h.element).grid("prevCell",a,b):$(h.element).grid("nextCell",a,b)}c.stopPropagation()},o={onKeyDown:n,value:$(m).val()},p=g.edittype,q=$(h.element).grid("getRowData",h.rows[a].id);switch(g.edittype){case"text":case"textarea":k=$.extend({},k,o),$(m).textbox(k);break;case"datepicker":k=$.extend({},k,o),$(m).datepicker(k);break;case"radio":k=$.extend({},k,o),$(m).radio(k),"Yes"==$(m).val()?$(m).radio("check"):$(m).radio("uncheck");break;case"checkbox":k=$.extend({},k,o),$(m).checkbox(k),"Yes"==$(m).val()?$(m).checkbox("check"):$(m).checkbox("uncheck");break;case"autocomplete":var r=$(m).val(),s="string"==typeof k.source;k=$.extend({},k,o);var t=k.postMode||"value";k.postMode=t,k=$.extend({},k,{onKeyDown:n}),$(m).autocomplete(k),s?(k.postMode="text",$(m).autocomplete(k),$(m).autocomplete("setValue",r)):"value"==t?$(m).autocomplete("setValue",r):($(m).autocomplete("setValue",r),$(m).autocomplete("setText",r));break;case"combobox":case"combotree":case"combogrid":if(k=$.extend({},k,o),g.cellEditoptions)var u=h.getCellEditOptions(g,$(m).val(),k,q,l,o);p=u&&u.type?u.type:g.edittype,k=u&&u.cOpts?u.cOpts:k,p="text"==p?"textbox":p,$(m)[p](k)}window.setTimeout(function(){$(m).focus()},0),h._trigger("afterEditCell",null,[{rowId:h.rows[a].id,name:d,cellValue:e,rowIndex:a,celIndex:b}])}h.options.iCol=b,h.options.iRow=a}}},getCellEditOptions:function(a,b,c,d,e,f){var g=$.coral.toFunction(a.cellEditoptions).call(this,b,c,d),h=g&&g.type?g.type:a.edittype;return g=g&&g.cellEditoptions?$.extend({},g.cellEditoptions,e,f):c,c=g||c,{cOpts:g,type:h}},GridNav:function(){function a(a,b,d){if("v"==d.substr(0,1)){var e=$(c.grid.rowsView)[0].clientHeight,f=$(c.grid.rowsView)[0].scrollTop,g=c.rows[a].offsetTop+c.rows[a].clientHeight,h=c.rows[a].offsetTop;"vd"==d&&g>=e&&($(c.grid.rowsView)[0].scrollTop=$(c.grid.rowsView)[0].scrollTop+c.rows[a].clientHeight),"vu"==d&&f>h&&($(c.grid.rowsView)[0].scrollTop=$(c.grid.rowsView)[0].scrollTop-c.rows[a].clientHeight)}if("h"==d){var i=$(c.grid.rowsView)[0].clientWidth,j=$(c.grid.rowsView)[0].scrollLeft,k=c.rows[a].cells[b].offsetLeft+c.rows[a].cells[b].clientWidth,l=c.rows[a].cells[b].offsetLeft;k>=i+parseInt(j,10)?$(c.grid.rowsView)[0].scrollLeft=$(c.grid.rowsView)[0].scrollLeft+c.rows[a].cells[b].clientWidth:j>l&&($(c.grid.rowsView)[0].scrollLeft=$(c.grid.rowsView)[0].scrollLeft-c.rows[a].cells[b].clientWidth)}}function b(a,b){var d,e;if("lft"==b)for(d=a+1,e=a;e>=0;e--)if(c.options.colModel[e].hidden!==!0){d=e;break}if("rgt"==b)for(d=a-1,e=a;e<c.options.colModel.length;e++)if(c.options.colModel[e].hidden!==!0){d=e;break}return d}var c=this;if(c.grid&&c.options.cellEdit===!0){c.options.knv=c.options.id+"_kn";var d,e,f=$("<span style='width:0px;height:0px;background-color:black;' tabindex='0'><span tabindex='-1' style='width:0px;height:0px;background-color:grey' id='"+c.options.knv+"'></span></span>");$(f).insertBefore(c.grid.columnsView),$("#"+c.options.knv).focus().keydown(function(f){switch(e=f.keyCode,"rtl"==c.options.direction&&(37===e?e=39:39===e&&(e=37)),e){case 38:c.options.iRow-1>0&&(a(c.options.iRow-1,c.options.iCol,"vu"),$(c.element).grid("editCell",c.options.iRow-1,c.options.iCol,!1));break;case 40:c.options.iRow+1<=c.rows.length-1&&(a(c.options.iRow+1,c.options.iCol,"vd"),$(c.element).grid("editCell",c.options.iRow+1,c.options.iCol,!1));break;case 37:c.options.iCol-1>=0&&(d=b(c.options.iCol-1,"lft"),a(c.options.iRow,d,"h"),$(c.element).grid("editCell",c.options.iRow,d,!1));break;case 39:c.options.iCol+1<=c.options.colModel.length-1&&(d=b(c.options.iCol+1,"rgt"),a(c.options.iRow,d,"h"),$(c.element).grid("editCell",c.options.iRow,d,!1));break;case 13:parseInt(c.options.iCol,10)>=0&&parseInt(c.options.iRow,10)>=0&&$(c.element).grid("editCell",c.options.iRow,c.options.iCol,!0);break;default:return!0}return!1})}},saveCell:function(a,b){var c,d=this;if(d.grid&&d.options.cellEdit===!0){if(c=d.options.savedRow.length>=1?0:null,null!==c){var e,f,g=$("td:eq("+b+")",d.rows[a]),h=d.options.colModel[b],i=h.name,j=$.grid.coralID(i);if(this.options.autoValid){var k=this.valid(d.rows[a].id,h.name);if(!this.options.allowSaveOnError&&!k)return $.message("请确认是否输入正确！"),k}var l=h.edittype;if(h.cellEditoptions){var m=$(d.element).grid("getRowData",d.rows[a].id),n=$("#"+a+"_"+j,d.rows[a]),o=$.coral.toFunction(h.cellEditoptions).call(this,$(n)[$(n).attr("component-role")]("getValue"),h.editoptions,m);l=o&&o.type?o.type:l}switch(l){case"select":if(h.editoptions.multiple){var n=$("#"+a+"_"+j,d.rows[a]),p=[];e=$(n).val(),e?e.join(","):e="",$("option:selected",n).each(function(a,b){p[a]=$(b).text()}),f=p.join(",")}else e=$("#"+a+"_"+j+" option:selected",d.rows[a]).val(),f=$("#"+a+"_"+j+" option:selected",d.rows[a]).text();h.formatter&&(f=e);break;case"checkbox":var q=["Yes","No"];h.editoptions&&(q=h.editoptions.value.split(":")),e=$("#"+a+"_"+j,d.rows[a]).is(":checked")?q[0]:q[1],f=e;break;case"password":case"text":case"textarea":e=$("#"+a+"_"+j,d.rows[a]).val(),f=e;break;case"button":e=$("#"+a+"_"+j,d.rows[a]).val(),f=e;break;case"custom":try{if(!h.editoptions||!$.isFunction(h.editoptions.custom_value))throw"e1";if(e=h.editoptions.custom_value.call(d,$(".customelement",g),"get"),void 0===e)throw"e2";f=e}catch(r){"e1"==r&&$.grid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+$.grid.edit.msg.nodefined,jQuery.jgrid.edit.bClose),"e2"==r?$.grid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+$.grid.edit.msg.novalue,jQuery.jgrid.edit.bClose):$.grid.info_dialog(jQuery.jgrid.errors.errcap,r.message,jQuery.jgrid.edit.bClose)}break;case"datepicker":e=$("#"+a+"_"+j,d.rows[a]).val(),f=e;$("#"+a+"_"+j,d.rows[a]);break;case"combobox":case"combogrid":case"combotree":e=$("#"+a+"_"+j,d.rows[a])[l]("getValues").toString(),f=$("#"+a+"_"+j,d.rows[a])[l]("getText"),h.formatter&&(f=e);break;case"autocomplete":f=$("#"+a+"_"+j,d.rows[a])[l]("getText"),e="string"==typeof h.editoptions.source?f:$("#"+a+"_"+j,d.rows[a])[l]("getValue"),h.formatter&&"value"==h.postMode&&(f=e)}if(f!==d.options.savedRow[c].value){var s=$(d).triggerHandler("jqGridBeforeSaveCell",[d.rows[a].id,i,e,a,b]);if(s&&(e=s,f=s),$.isFunction(d.options.beforeSaveCell)){var t=d.options.beforeSaveCell.call(d,d.rows[a].id,i,e,a,b);t&&(e=t,f=t)}var u=$.grid.checkValues(e,b,d);if(u[0]===!0){var v=$(d).triggerHandler("jqGridBeforeSubmitCell",[d.rows[a].id,i,e,a,b])||{};if($.isFunction(d.options.beforeSubmitCell)&&(v=d.options.beforeSubmitCell.call(d,d.rows[a].id,i,e,a,b),v||(v={})),$("input.hasDatepicker",g).length>0&&$("input.hasDatepicker",g).datepicker("hide"),"remote"==d.options.cellsubmit)if(d.options.cellurl){var w={};d.options.autoencode&&(e=$.grid.htmlEncode(e)),w[i]=e;var x,y,z;z=d.options.prmNames,x=z.id,y=z.oper,w[x]=$.grid.stripPref(d.options.idPrefix,d.rows[a].id),w[y]=z.editoper,w=$.extend(v,w),$("#lui_"+$.grid.coralID(d.options.id)).show(),d.grid.columnsView.loading=!0,$.ajax($.extend({url:d.options.cellurl,data:$.isFunction(d.options.serializeCellData)?d.options.serializeCellData.call(d,w):w,type:"POST",complete:function(c,h){if($("#lui_"+d.options.id).hide(),d.grid.columnsView.loading=!1,"success"==h){var j=$(d).triggerHandler("jqGridAfterSubmitCell",[d,c,w.id,i,e,a,b])||[!0,""];j[0]===!0&&$.isFunction(d.options.afterSubmitCell)&&(j=d.options.afterSubmitCell.call(d,c,w.id,i,e,a,b)),j[0]===!0?($(g).empty(),$(d.element).grid("setCell",d.rows[a].id,b,f,!1,!1,!0),$(g).addClass("dirty-cell"),$(d.rows[a]).addClass("edited"),$(d).triggerHandler("jqGridAfterSaveCell",[d.rows[a].id,i,e,a,b]),$.isFunction(d.options.afterSaveCell)&&d.options.afterSaveCell.call(d,d.rows[a].id,i,e,a,b),d.options.savedRow.splice(0,1)):($.grid.info_dialog($.grid.errors.errcap,j[1],$.grid.edit.bClose),$(d.element).grid("restoreCell",a,b))}},error:function(c,e,f){$("#lui_"+$.grid.coralID(d.options.id)).hide(),d.grid.columnsView.loading=!1,$(d).triggerHandler("jqGridErrorCell",[c,e,f]),$.isFunction(d.options.errorCell)?(d.options.errorCell.call(d,c,e,f),$(d.element).grid("restoreCell",a,b)):($.grid.info_dialog($.grid.errors.errcap,c.status+" : "+c.statusText+"<br/>"+e,$.grid.edit.bClose),$(d.element).grid("restoreCell",a,b))}},$.grid.ajaxOptions,d.options.ajaxCellOptions||{}))}else try{$.grid.info_dialog($.grid.errors.errcap,$.grid.errors.nourl,$.grid.edit.bClose),$(d.element).grid("restoreCell",a,b)}catch(r){}"clientArray"==d.options.cellsubmit&&($(g).empty(),$(d.element).grid("setCell",d.rows[a].id,b,f,!1,!1,!0),$(g).addClass("dirty-cell"),$(d.rows[a]).addClass("edited"),d._trigger("afterSaveCell",null,[{rowId:d.rows[a].id,name:i,cellValue:e,rowIndex:a,celIndex:b}]),d.options.savedRow.splice(0,1))}else try{window.setTimeout(function(){$.grid.info_dialog($.grid.errors.errcap,e+" "+u[1],$.grid.edit.bClose)},100),$(d.element).grid("restoreCell",a,b)}catch(r){}}else $(d.element).grid("restoreCell",a,b)}window.setTimeout(function(){$("#"+$.grid.coralID(d.options.knv)).attr("tabindex","-1").focus()},0)}},restoreCell:function(a,b){var c,d=this;if(d.grid&&d.options.cellEdit===!0){if(c=d.options.savedRow.length>=1?0:null,null!==c){var e=$("td:eq("+b+")",d.rows[a]);$(e).empty().attr("tabindex","-1"),$(d.element).grid("setCell",d.rows[a].id,b,d.options.savedRow[c].value,!1,!1,!0),$(d).triggerHandler("jqGridAfterRestoreCell",[d.rows[a].id,d.options.savedRow[c].value,a,b]),$.isFunction(d.options.afterRestoreCell)&&d.options.afterRestoreCell.call(d,d.rows[a].id,d.options.savedRow[c].value,a,b),d.options.savedRow.splice(0,1)}window.setTimeout(function(){$("#"+d.options.knv).attr("tabindex","-1").focus()},0)}},nextCell:function(a,b){var c=this,d=!1;if(c.grid&&c.options.cellEdit===!0){for(var e=b+1;e<c.options.colModel.length;e++)if(c.options.colModel[e].editable===!0){d=e;break}d!==!1?$(c.element).grid("editCell",a,d,!0):c.options.savedRow.length>0&&$(c.element).grid("saveCell",a,b)}},prevCell:function(a,b){var c=this,d=!1;if(c.grid&&c.options.cellEdit===!0){for(var e=b-1;e>=0;e--)if(c.options.colModel[e].editable===!0){d=e;break}d!==!1?$(c.element).grid("editCell",a,d,!0):c.options.savedRow.length>0&&$(c.element).grid("saveCell",a,b)}},getChangedCells:function(a){var b=[];a||(a="all");var c,d=this,e=!0;if(d.grid&&d.options.cellEdit===!0)return $(d.rows).each(function(f){var g={};if($(this).hasClass("edited")){if($("td",this).each(function(b){if(c=d.options.colModel[b].name,"cb"!==c&&"subgrid"!==c){if($(this).hasClass("coral-gridcell-error"))return e=!1,!1;if("dirty"==a){if($(this).hasClass("dirty-cell"))try{g[c]=$.unformat.call(d,this,{rowId:d.rows[f].id,colModel:d.options.colModel[b]},b)}catch(h){g[c]=$.jgrid.htmlDecode($(this).html())}}else try{g[c]=$.unformat.call(d,this,{rowId:d.rows[f].id,colModel:d.options.colModel[b]},b)}catch(h){g[c]=$.jgrid.htmlDecode($(this).html())}}}),!e)return!1;g.id=this.id,b.push(g)}}),e||(b=[]),b}});/*! cui 2016-11-08 */
"use strict";$.coral.grid.inlineEdit=$.coral.grid.inlineEdit||{},$.component("coral.grid",$.coral.grid,{editButtonsPos:function(a,b){var c,d,e,f,g=this;c=$(g.element).grid("getDataIDs"),d=$(g.element).grid("getInd",a,!0),f=g.element.find(".coral-grid-rows-view").outerHeight(),e=g.element.find(".coral-grid-btable").outerHeight(),e+$(d).outerHeight()>f&&a==c[c.length-1]?b.position({my:"left-"+b.outerWidth()/2+" top-2",at:"right-"+$(d).outerWidth()/2+" top-"+$(b).outerHeight(),collision:"fit",of:$(d)}):b.position({my:"left-"+b.outerWidth()/2+" top-2",at:"right-"+$(d).outerWidth()/2+" top+"+$(d).outerHeight(),collision:"fit",of:$(d)})},editRow:function(a,b,c,d,e,f,g,h,i){var j={},k=$.makeArray(arguments).slice(1);"object"===$.type(k[0])?j=k[0]:("undefined"!=typeof b&&(j.keys=b),$.isFunction(c)&&(j.oneditfunc=c),$.isFunction(d)&&(j.successfunc=d),"undefined"!=typeof e&&(j.url=e),"undefined"!=typeof f&&(j.extraparam=f),$.isFunction(g)&&(j.aftersavefunc=g),$.isFunction(h)&&(j.errorfunc=h),$.isFunction(i)&&(j.afterrestorefunc=i)),j=$.extend(!0,{keys:!0,oneditfunc:null,successfunc:null,url:"clientArray",extraparam:{},aftersavefunc:null,errorfunc:null,afterrestorefunc:null,restoreAfterError:!0,mtype:"POST"},$.coral.grid.inlineEdit,j);var l,m,n,o,p,q=this,r=0,s=null,t={};if(q.grid&&(o=$(q.element).grid("getInd",a,!0),q.options.editrow=a,q.editRowIndex=a,o!==!1&&(n=$(o).attr("editable")||"0",0!=q._trigger("beforeInlineEditRow",null,[{rowId:a,options:j}])&&"0"==n&&!$(o).hasClass("not-editable-row")))){if(this.options.rowEditButtons){var u=$("<div class='row-editable coral-grid-rows'><div class='row-editable-btns coral-state-highlight'><div class='grid_edit_toolbar'></div></div></div>"),v=[],w={type:"button",id:"update",label:$.grid.edit.bUpdate,name:"update",onClick:function(){q.saveRow(o.id,null,"clientArray")}},x={type:"button",id:"cancel",label:$.grid.edit.bCancel,name:"cancel",onClick:function(){q.restoreRow(o.id),u.remove(),q._trigger("afterInlineCancelRow",null,[{rowId:o.id,options:j,isUpdated:!$(o.id).hasClass("new-row")}])}};0===this.options.rowEditButtons.length&&(this.options.rowEditButtons=["update","cancel"]);for(var y=0;y<this.options.rowEditButtons.length;y++)"update"==this.options.rowEditButtons[y]?v.push(w):"cancel"==this.options.rowEditButtons[y]?v.push(x):v.push(this.options.rowEditButtons[y]);this.rowEditButtons=u,q.element.find(".row-editable").remove(),q.element.find(".coral-grid-view").prepend(u[0]),$(".grid_edit_toolbar",q.element).toolbar({data:v}),this._delay(function(){this.editButtonsPos(a,u)})}p=q.options.colModel,$('td[role="gridcell"]',o).each(function(b){l=p[b].name;var c=q.options.treeGrid===!0&&l==q.options.ExpandColumn;if(c)m=$("span:first",this).html();else try{m=$.unformat.call(q,this,{rowId:a,colModel:p[b]},b)}catch(d){m=p[b].edittype&&"textarea"==p[b].edittype?$(this).text():$(this).html()}if("cb"!=l&&"subgrid"!=l&&"rn"!=l&&(q.options.autoencode&&(m=$.grid.htmlDecode(m)),t[l]=m,p[b].editable===!0)){null===s&&(s=b),c?$("span:first",this).html(""):$(this).html("");var e=$.extend({},p[b].editoptions||{},{id:a+"_"+l,name:l});p[b].edittype||(p[b].edittype="text"),("&nbsp;"==m||"&#160;"==m||1==m.length&&160==m.charCodeAt(0))&&(m="");var f=$.grid.createEl.call(q,p[b].edittype,e,m,!1,$.extend({},$.grid.ajaxOptions,q.options.ajaxSelectOptions||{}));$(f).addClass("editable"),c?$("span:first",this).append(f):$(this).append(f);var g=p[b].editoptions||{},h=g.postMode||"value";$.extend(g,{onValidError:function(a,b){$(f).parents("td").addClass("coral-gridcell-error"),a.stopPropagation()},onValidSuccess:function(a,b){$(f).parents("td").removeClass("coral-gridcell-error"),a.stopPropagation()},onKeyDown:function(a,b){},onClick:function(a,b){a.stopPropagation()},dataCustom:{rowId:a,gridId:q.options.id}});var i=p[b].edittype;switch(i){case"autocomplete":var j=$(f).val(),k="string"==typeof g.source,n=g.onSelect;g=$.extend({},g,{onSelect:function(a,b){$(f).closest("td").attr("data-org",k?b.value:b.text),n&&n.apply(f,[a,b])}}),k?(g.postMode="text",$(f).autocomplete(g),$(f).autocomplete("setValue",j)):($(f).autocomplete(g),"value"==h?$(f).autocomplete("setValue",j):($(f).autocomplete("setValue",j),$(f).autocomplete("setText",j)));break;case"checkbox":$(f).checkbox(g);var o=["Yes","No"];g&&g.value&&(o=g.value.split(":")),$(f).val()==o[0]?$(f).checkbox("check"):$(f).checkbox("uncheck");break;case"combogrid":case"combobox":case"combotree":$(f)[i](g),$(f)[i]("setValues",$(f).val().split(","));break;case"text":case"textarea":$(f).textbox(g);break;default:$(f)[i](g)}r++}}),r>0&&(t.id=a,q.options.savedRow.push(t),$(o).attr("editable","1"),$("td:eq("+s+") input",o).focus(),j.keys===!0&&$(o).bind("keydown",function(b){if(27===b.keyCode){if($(q.element).grid("restoreRow",a,j.afterrestorefunc),q.options._inlinenav)try{$(q.element).grid("showAddEditButtons")}catch(c){}return!1}if(13===b.keyCode){var d=b.target;if("TEXTAREA"==d.tagName)return!0;if($(q.element).grid("saveRow",a,j)&&q.options._inlinenav)try{$(q.element).grid("showAddEditButtons")}catch(e){}return!1}}),q._trigger("onInlineEditRow",null,[{rowId:a,options:j}]))}},saveRow:function(a,b,c,d,e,f,g){var h=$.makeArray(arguments).slice(1),i={};"object"===$.type(h[0])?i=h[0]:($.isFunction(b)&&(i.successfunc=b),"undefined"!=typeof c&&(i.url=c),"undefined"!=typeof d&&(i.extraparam=d),$.isFunction(e)&&(i.aftersavefunc=e),$.isFunction(f)&&(i.errorfunc=f),$.isFunction(g)&&(i.afterrestorefunc=g)),i=$.extend(!0,{successfunc:null,url:null,extraparam:{},aftersavefunc:null,errorfunc:null,afterrestorefunc:null,restoreAfterError:!0,mtype:"POST"},$.grid.inlineEdit,i);var j,k,l,m,n,o=!1,p=this,q={},r={},s={};if(!p.grid)return o;if(n=$(p.element).grid("getInd",a,!0),n===!1)return o;if(this.options.autoValid){var t=this.valid(n.id);if(!this.options.allowSaveOnError&&!t)return $.message("请确认是否输入正确！"),t}if(k=$(n).attr("editable"),i.url=i.url?i.url:p.options.editurl,i.url=i.url?i.url:"clientArray","1"===k){var u;if($('td[role="gridcell"]',n).each(function(a){if(u=p.options.colModel[a],j=u.name,"cb"!=j&&"subgrid"!=j&&u.editable===!0&&"rn"!=j&&!$(this).hasClass("not-editable-cell")){var b=u.edittype;switch(b){case"checkbox":var c=["Yes","No"];u.editoptions&&(c=u.editoptions.value.split(":")),q[j]=$("input",this).is(":checked")?c[0]:c[1];break;case"datepicker":q[j]=$("input[type='hidden']",this).val();break;case"autocomplete":"string"==typeof u.editoptions.source?q[j]=$(".ctrl-init-"+b,this)[b]("getText"):q[j]=$(".ctrl-init-"+b,this)[b]("getValue");break;case"text":case"password":case"textarea":case"button":q[j]=$("input, textarea",this).val();break;case"combogrid":case"combobox":case"combotree":q[j]=$(".ctrl-init-"+b,this)[b]("getValues").toString(),r[j]=$(".ctrl-init-"+b,this)[b]("getText"),u.formatter&&u.formatter==b&&(r={});break;case"custom":try{if(!u.editoptions||!$.isFunction(u.editoptions.custom_value))throw"e1";if(q[j]=u.editoptions.custom_value.call(p,$(".customelement",this),"get"),void 0===q[j])throw"e2"}catch(d){"e1"==d&&$.grid.info_dialog($.grid.errors.errcap,"function 'custom_value' "+$.grid.edit.msg.nodefined,$.grid.edit.bClose),"e2"==d?$.grid.info_dialog($.grid.errors.errcap,"function 'custom_value' "+$.grid.edit.msg.novalue,$.grid.edit.bClose):$.grid.info_dialog($.grid.errors.errcap,d.message,$.grid.edit.bClose)}}if(m=$.grid.checkValues(q[j],a,p),m[0]===!1)return m[1]=q[j]+" "+m[1],!1;p.options.autoencode&&(q[j]=$.grid.htmlEncode(q[j])),"clientArray"!==i.url&&u.editoptions&&""===q[j]&&(s[j]="null")}}),m[0]===!1){try{var v=$.grid.findPos($("#"+$.grid.coralID(a),p.grid.bDiv)[0]);$.grid.info_dialog($.grid.errors.errcap,m[1],$.grid.edit.bClose,{left:v[0],top:v[1]})}catch(w){alert(m[1])}return o}var x,y,z;if(y=p.options.prmNames,z=y.oper,x=p.options.keyName===!1?y.id:p.options.keyName,q&&(q[z]=y.editoper,q[x]=a,"undefined"==typeof p.options.inlineData&&(p.options.inlineData={}),q=$.extend({},q,p.options.inlineData,i.extraparam)),"clientArray"==i.url){p.options.autoencode&&$.each(q,function(a,b){q[a]=$.grid.htmlDecode(b)});var A=$(p.element).grid("setRowData",a,q);$(n).attr("editable","0");for(var B=0;B<p.options.savedRow.length;B++)if(p.options.savedRow[B].id==a){l=B;break}l>=0&&p.options.savedRow.splice(l,1),o=A,o&&(p.options.editrow=null),p.options.rowEditButtons&&p.rowEditButtons.hide(),p._trigger("afterInlineSaveRow",null,[{rowId:a,options:i,status:A}]),$.isFunction(i.aftersavefunc)&&i.aftersavefunc.call(p,a,A),$(n).unbind("keydown")}else $("#lui_"+$.grid.coralID(p.options.id)).show(),s=$.extend({},q,s),s[x]=$.grid.stripPref(p.options.idPrefix,s[x]),$.ajax($.extend({url:i.url,data:$.isFunction(p.options.serializeRowData)?p.options.serializeRowData.call(p,s):s,type:i.mtype,async:!1,complete:function(b,c){if($("#lui_"+$.grid.coralID(p.options.id)).hide(),"success"===c){var d,e=!0;if(d=p._trigger("inlineSuccessSaveRow",null,[{res:b,rowId:a,options:i}]),$.isArray(d)||(d=[!0,q]),d[0]&&$.isFunction(i.successfunc)&&(d=i.successfunc.call(p,b)),$.isArray(d)?(e=d[0],q=d[1]?d[1]:q):e=d,e===!0){p.options.autoencode&&$.each(q,function(a,b){q[a]=$.grid.htmlDecode(b)}),q=$.extend({},q,r),$(p.element).grid("setRowData",a,q),$(n).attr("editable","0");for(var f=0;f<p.options.savedRow.length;f++)if(p.options.savedRow[f].id==a){l=f;break}l>=0&&p.options.savedRow.splice(l,1),$(p).triggerHandler("gridInlineAfterSaveRow",[a,b,q,i]),$.isFunction(i.aftersavefunc)&&i.aftersavefunc.call(p,a,b),o=!0,p.options.editrow=null,p.rowEditButtons&&p.rowEditButtons.hide(),p._trigger("afterInlineSaveRow",null,[{rowId:a,options:i,status:A}]),$(n).unbind("keydown")}else $(p).triggerHandler("gridInlineErrorSaveRow",[a,b,c,null,i]),$.isFunction(i.errorfunc)&&i.errorfunc.call(p,a,b,c,null),i.restoreAfterError===!0&&$(p.element).grid("restoreRow",a,i.afterrestorefunc)}},error:function(b,c,d){if($("#lui_"+$.grid.coralID(p.options.id)).hide(),$(p).triggerHandler("gridInlineErrorSaveRow",[a,b,c,d,i]),$.isFunction(i.errorfunc))i.errorfunc.call(p,a,b,c,d);else try{$.grid.info_dialog($.grid.errors.errcap,'<div class="coral-state-error">'+b.responseText+"</div>",$.grid.edit.bClose,{buttonalign:"right"})}catch(e){alert(b.responseText)}i.restoreAfterError===!0&&$(p.element).grid("restoreRow",a,i.afterrestorefunc)}},$.grid.ajaxOptions,p.options.ajaxRowOptions||{}))}return o&&$(n).removeClass("new-row"),o},restoreRow:function(a,b){var c=$.makeArray(arguments).slice(1),d={};"object"===$.type(c[0])?d=c[0]:$.isFunction(b)&&(d.afterrestorefunc=b),d=$.extend(!0,$.grid.inlineEdit,d);var e,f,g=this,h={};if(g.grid&&(f=$(g.element).grid("getInd",a,!0),g.options.editrow&&a==g.options.editrow&&(g.options.editrow=null,g.clearErrors(a)),f!==!1)){for(var i=0;i<g.options.savedRow.length;i++)if(g.options.savedRow[i].id==a){e=i;break}if(e>=0){if($.isFunction($.fn.datepicker))try{$("input.hasDatepicker","#"+$.grid.coralID(f.id)).datepicker("hide")}catch(j){}$.each(g.options.colModel,function(){this.editable===!0&&this.name in g.options.savedRow[e]&&(h[this.name]=g.options.savedRow[e][this.name])}),$(g.element).grid("setRowData",a,h),$(f).attr("editable","0").unbind("keydown"),g.options.savedRow.splice(e,1),$("#"+$.grid.coralID(a),"#"+$.grid.coralID(g.options.id)).hasClass("grid-new-row")&&setTimeout(function(){$(g.element).grid("delRowData",a)},0)}$(g).triggerHandler("gridInlineAfterRestoreRow",[a]),$.isFunction(d.afterrestorefunc)&&d.afterrestorefunc.call(g,a),g.options.rowEditButtons&&g.rowEditButtons.hide()}},addRow:function(a){if(a=$.extend(!0,{rowID:"new_row",initdata:{},position:"first",useDefValues:!0,useFormatter:!1,addRowParams:{extraparam:{}}},a||{}),this.grid){var b=this;if(a.useDefValues===!0&&$(b.options.colModel).each(function(){if(this.editoptions&&this.editoptions.defaultValue){var c=this.editoptions.defaultValue,d=$.isFunction(c)?c.call(b):c;a.initdata[this.name]=d}}),$(b.element).grid("addRowData",a.rowID,a.initdata,a.position),$("#"+$.grid.coralID(a.rowID),"#"+$.grid.coralID(b.options.id)).addClass("grid-new-row"),a.useFormatter)$("#"+$.grid.coralID(a.rowID)+" .coral-inline-edit","#"+$.grid.coralID(b.options.id)).click();else{var c=b.options.prmNames,d=c.oper;a.addRowParams.extraparam[d]=c.addoper,$(b.element).grid("editRow",a.rowID,a.addRowParams),$(b.element).grid("setSelection",a.rowID)}}},clearEdited:function(a){var b=$(this.getInd(a,!0));b.removeClass("edited"),b.children("td").removeClass("dirty-cell")},inlineNav:function(a,b){return b=$.extend({edit:!0,editicon:"coral-icon-pencil",add:!0,addicon:"coral-icon-plus",save:!0,saveicon:"coral-icon-disk",cancel:!0,cancelicon:"coral-icon-cancel",addParams:{useFormatter:!1,rowID:"new_row"},editParams:{},restoreAfterSelect:!0},$.grid.nav,b||{}),this.each(function(){if(this.grid){var c,d=this,e=$.grid.coralID(d.options.id);if(d.options._inlinenav=!0,b.addParams.useFormatter===!0){var f,g=d.options.colModel;for(f=0;f<g.length;f++)if(g[f].formatter&&"actions"===g[f].formatter){if(g[f].formatoptions){var h={keys:!1,onEdit:null,onSuccess:null,afterSave:null,onError:null,afterRestore:null,extraparam:{},url:null},i=$.extend(h,g[f].formatoptions);b.addParams.addRowParams={keys:i.keys,oneditfunc:i.onEdit,successfunc:i.onSuccess,url:i.url,extraparam:i.extraparam,aftersavefunc:i.afterSavef,errorfunc:i.onError,afterrestorefunc:i.afterRestore}}break}}b.add&&$(d.element).grid("navButtonAdd",a,{caption:b.addtext,title:b.addtitle,buttonicon:b.addicon,id:d.options.id+"_iladd",onClickButton:function(){$(d.element).grid("addRow",b.addParams),b.addParams.useFormatter||($("#"+e+"_ilsave").removeClass("coral-state-disabled"),$("#"+e+"_ilcancel").removeClass("coral-state-disabled"),$("#"+e+"_iladd").addClass("coral-state-disabled"),$("#"+e+"_iledit").addClass("coral-state-disabled"))}}),b.edit&&$(d.element).grid("navButtonAdd",a,{caption:b.edittext,title:b.edittitle,buttonicon:b.editicon,id:d.options.id+"_iledit",onClickButton:function(){var a=$(d.element).grid("getGridParam","selrow");a?($(d.element).grid("editRow",a,b.editParams),$("#"+e+"_ilsave").removeClass("coral-state-disabled"),$("#"+e+"_ilcancel").removeClass("coral-state-disabled"),$("#"+e+"_iladd").addClass("coral-state-disabled"),$("#"+e+"_iledit").addClass("coral-state-disabled")):($.grid.viewModal("#alertmod",{gbox:"#gbox_"+e,jqm:!0}),$("#jqg_alrt").focus())}}),b.save&&($(d.element).grid("navButtonAdd",a,{caption:b.savetext||"",title:b.savetitle||"Save row",buttonicon:b.saveicon,id:d.options.id+"_ilsave",onClickButton:function(){var a=d.options.savedRow[0].id;if(a){var c=d.options.prmNames,f=c.oper;b.editParams.extraparam||(b.editParams.extraparam={}),$("#"+$.grid.coralID(a),"#"+e).hasClass("grid-new-row")?b.editParams.extraparam[f]=c.addoper:b.editParams.extraparam[f]=c.editoper,$(d.element).grid("saveRow",a,b.editParams)&&$(d.element).grid("showAddEditButtons")}else $.grid.viewModal("#alertmod",{gbox:"#gbox_"+e,jqm:!0}),$("#jqg_alrt").focus()}}),$("#"+e+"_ilsave").addClass("coral-state-disabled")),b.cancel&&($(d.element).grid("navButtonAdd",a,{caption:b.canceltext||"",title:b.canceltitle||"Cancel row editing",buttonicon:b.cancelicon,id:d.options.id+"_ilcancel",onClickButton:function(){var a=d.options.savedRow[0].id;a?($(d.element).grid("restoreRow",a,b.editParams),$(d.element).grid("showAddEditButtons")):($.grid.viewModal("#alertmod",{gbox:"#gbox_"+e,jqm:!0}),$("#jqg_alrt").focus())}}),$("#"+e+"_ilcancel").addClass("coral-state-disabled")),b.restoreAfterSelect===!0&&(c=$.isFunction(d.options.beforeSelectRow)?d.options.beforeSelectRow:!1,d.options.beforeSelectRow=function(a,e){var f=!0;return d.options.savedRow.length>0&&d.options._inlinenav===!0&&a!==d.options.selrow&&null!==d.options.selrow&&(d.options.selrow==b.addParams.rowID?$(d.element).grid("delRowData",d.options.selrow):$(d.element).grid("restoreRow",d.options.selrow,b.editParams),$(d.element).grid("showAddEditButtons")),c&&(f=c.call(d,a,e)),f})}})},showAddEditButtons:function(){return this.each(function(){if(this.grid){var a=$.grid.coralID(this.options.id);$("#"+a+"_ilsave").addClass("coral-state-disabled"),$("#"+a+"_ilcancel").addClass("coral-state-disabled"),$("#"+a+"_iladd").removeClass("coral-state-disabled"),$("#"+a+"_iledit").removeClass("coral-state-disabled")}})}});/*! cui 2016-11-08 */
!function(){"use strict";function a(b,c,d){for(var e=0;e<b.length;e++)b[e].id==c?d.push(b[e].name):b[e].children&&a(b[e].children,c,d)}$.fmatter={},$.extend($.fmatter,{isBoolean:function(a){return"boolean"==typeof a},isObject:function(a){return a&&("object"==typeof a||$.isFunction(a))||!1},isString:function(a){return"string"==typeof a},isNumber:function(a){return"number"==typeof a&&isFinite(a)},isNull:function(a){return null===a},isUndefined:function(a){return"undefined"==typeof a},isValue:function(a){return this.isObject(a)||this.isString(a)||this.isNumber(a)||this.isBoolean(a)},isEmpty:function(a){return!this.isString(a)&&this.isValue(a)?!1:this.isValue(a)?(a=$.trim(a).replace(/\&nbsp\;/gi,"").replace(/\&#160\;/gi,""),""===a):!0}}),$.fn.fmatter=function(a,b,c,d,e){var f=b;if(c=$.extend({},$.grid.formatter,c),"edit"===e&&c.rowId+""&&$("#"+c.rowId,this.element).children("td[aria-describedby$='"+c.colModel.name+"']").attr("data-org",f),"edit"===e&&c.colModel.cellEditoptions){var g=$.coral.toFunction(c.colModel.cellEditoptions).call(this,f,c,d);return a=g&&g.type?g.type:a,"combobox"===a||"combogrid"===a||"combotree"===a||"convertCode"===a?$.fn.fmatter.convertCode.call(this,b,c,d,e):f}try{f=$.fn.fmatter[a].call(this,b,c,d,e)}catch(h){}return f},$.fmatter.util={NumberFormat:function(a,b){if($.fmatter.isNumber(a)||(a*=1),$.fmatter.isNumber(a)){var c,d=0>a,e=a+"",f=b.decimalSeparator?b.decimalSeparator:".";if($.fmatter.isNumber(b.decimalPlaces)){var g=b.decimalPlaces,h=Math.pow(10,g);if(e=Math.round(a*h)/h+"",c=e.lastIndexOf("."),g>0)for(0>c?(e+=f,c=e.length-1):"."!==f&&(e=e.replace(".",f));e.length-1-c<g;)e+="0"}if(b.thousandsSeparator){var i=b.thousandsSeparator;c=e.lastIndexOf(f),c=c>-1?c:e.length;for(var j=e.substring(c),k=-1,l=c;l>0;l--)k++,k%3===0&&l!==c&&(!d||l>1)&&(j=i+j),j=e.charAt(l-1)+j;e=j}return e=b.prefix?b.prefix+e:e,e=b.suffix?e+b.suffix:e}return a},DateFormat:function(a,b,c,d){var e,f,g,h=/\\.|[dDjlNSwzWFmMntLoYyaABgGhHisueIOPTZcrU]/g,i=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,j=/[^-+\dA-Z]/g,k=new RegExp("^/Date\\((([-+])?[0-9]+)(([-+])([0-9]{2})([0-9]{2}))?\\)/$"),l="string"==typeof b?b.match(k):null,m=function(a,b){for(a=String(a),b=parseInt(b,10)||2;a.length<b;)a="0"+a;return a},n={m:1,d:1,y:1970,h:0,i:0,s:0,u:0},o=0,p=["i18n"];if(p.i18n={dayNames:d.dayNames,monthNames:d.monthNames},a in d.masks&&(a=d.masks[a]),isNaN(b-0)||"u"!=String(a).toLowerCase())if(b.constructor===Date)o=b;else if(null!==l){if(o=new Date(parseInt(l[1],10)),l[3]){var q=60*Number(l[5])+Number(l[6]);q*="-"==l[4]?1:-1,q-=o.getTimezoneOffset(),o.setTime(Number(Number(o)+60*q*1e3))}}else{for(b=String(b).split(/[\\\/:_;.,\t\T\s-]/),a=a.split(/[\\\/:_;.,\t\T\s-]/),f=0,g=a.length;g>f;f++)"M"==a[f]&&(e=$.inArray(b[f],p.i18n.monthNames),-1!==e&&12>e&&(b[f]=e+1)),"F"==a[f]&&(e=$.inArray(b[f],p.i18n.monthNames),-1!==e&&e>11&&(b[f]=e+1-12)),b[f]&&(n[a[f].toLowerCase()]=parseInt(b[f],10));if(n.f&&(n.m=n.f),0===n.m&&0===n.y&&0===n.d)return"&#160;";n.m=parseInt(n.m,10)-1;var r=n.y;r>=70&&99>=r?n.y=1900+n.y:r>=0&&69>=r&&(n.y=2e3+n.y),o=new Date(n.y,n.m,n.d,n.h,n.i,n.s,n.u)}else o=new Date(1e3*parseFloat(b));c in d.masks?c=d.masks[c]:c||(c="Y-m-d");var s=o.getHours(),t=o.getMinutes(),u=o.getDate(),v=o.getMonth()+1,w=o.getTimezoneOffset(),x=o.getSeconds(),y=o.getMilliseconds(),z=o.getDay(),A=o.getFullYear(),B=(z+6)%7+1,C=(new Date(A,v-1,u)-new Date(A,0,1))/864e5,D={d:m(u),D:p.i18n.dayNames[z],j:u,l:p.i18n.dayNames[z+7],N:B,S:d.S(u),w:z,z:C,W:5>B?Math.floor((C+B-1)/7)+1:Math.floor((C+B-1)/7)||((new Date(A-1,0,1).getDay()+6)%7<4?53:52),F:p.i18n.monthNames[v-1+12],m:m(v),M:p.i18n.monthNames[v-1],n:v,t:"?",L:"?",o:"?",Y:A,y:String(A).substring(2),a:12>s?d.AmPm[0]:d.AmPm[1],A:12>s?d.AmPm[2]:d.AmPm[3],B:"?",g:s%12||12,G:s,h:m(s%12||12),H:m(s),i:m(t),s:m(x),u:y,e:"?",I:"?",O:(w>0?"-":"+")+m(100*Math.floor(Math.abs(w)/60)+Math.abs(w)%60,4),P:"?",T:(String(o).match(i)||[""]).pop().replace(j,""),Z:"?",c:"?",r:"?",U:Math.floor(o/1e3)};return c.replace(h,function(a){return a in D?D[a]:a.substring(1)})}},$.fn.fmatter.defaultFormat=function(a,b,c,d){return $.fmatter.isValue(a)&&""!==a?a:b.defaultValue?b.defaultValue:"&#160;"},$.fn.fmatter.email=function(a,b,c,d){return $.fmatter.isEmpty(a)?$.fn.fmatter.defaultFormat(a,b):'<a href="mailto:'+a+'">'+a+"</a>"},$.fn.fmatter.combobox=function(a,b,c,d){var e,f=$.extend({},b.combobox);return $.fmatter.isUndefined(b.colModel.formatoptions)||(f=$.extend({},f,b.colModel.formatoptions)),e=f.disabled===!0?'disabled="disabled"':"",($.fmatter.isEmpty(a)||$.fmatter.isUndefined(a))&&(a=""),a+="",'<input class="parseformatter" data-formatter="combobox" data-pos="'+b.pos+'" type="text" value="'+a+'" '+e+"/>"},$.fn.fmatter.combotree=function(a,b,c,d){var e,f=$.extend({},b.combotree);return $.fmatter.isUndefined(b.colModel.formatoptions)||(f=$.extend({},f,b.colModel.formatoptions)),e=f.disabled===!0?'disabled="disabled"':"",($.fmatter.isEmpty(a)||$.fmatter.isUndefined(a))&&(a=""),a+="",'<input class="parseformatter" data-formatter="combotree" data-pos="'+b.pos+'" type="text" value="'+a+'" '+e+"/>"},$.fn.fmatter.combogrid=function(a,b,c,d){var e,f=$.extend({},b.combogrid);return $.fmatter.isUndefined(b.colModel.formatoptions)||(f=$.extend({},f,b.colModel.formatoptions)),e=f.disabled===!0?'disabled="disabled"':"",($.fmatter.isEmpty(a)||$.fmatter.isUndefined(a))&&(a=""),a+="",'<input class="parseformatter" data-formatter="combogrid" data-pos="'+b.pos+'" type="text" value="'+a+'" '+e+"/>"},$.fn.fmatter.autocomplete=function(a,b,c,d){var e,f=$.extend({},b.autocomplete);return $.fmatter.isUndefined(b.colModel.formatoptions)||(f=$.extend({},f,b.colModel.formatoptions)),e=f.disabled===!0?'disabled="disabled"':"",($.fmatter.isEmpty(a)||$.fmatter.isUndefined(a))&&(a=""),a+="",'<input class="parseformatter" data-formatter="autocomplete" data-pos="'+b.pos+'" type="text" value="'+a+'" '+e+"/>"},$.fn.fmatter.toolbar=function(a,b,c,d){var e,f=$.extend({},b.toolbar);return $.fmatter.isUndefined(b.colModel.formatoptions)||(f=$.extend({},f,b.colModel.formatoptions)),e=f.disabled===!0?'disabled="disabled"':"",($.fmatter.isEmpty(a)||$.fmatter.isUndefined(a))&&(a=""),a+="",'<div class="parseformatter" data-formatter="toolbar" data-pos="'+b.pos+'" '+e+"/>"},$.fn.fmatter.text=function(a,b,c,d){var e,f=$.extend({},b.textbox);return $.fmatter.isUndefined(b.colModel.formatoptions)||(f=$.extend({},f,b.colModel.formatoptions)),e=f.disabled===!0?'disabled="disabled"':"",($.fmatter.isEmpty(a)||$.fmatter.isUndefined(a))&&(a=""),a+="",'<input class="parseformatter" data-formatter="textbox" data-pos="'+b.pos+'" type="text" value="'+a+'" '+e+"/>"},$.fn.fmatter.datepicker=function(a,b,c,d){var e,f=$.extend({},b.datepicker);return $.fmatter.isUndefined(b.colModel.formatoptions)||(f=$.extend({},f,b.colModel.formatoptions)),e=f.disabled===!0?'disabled="disabled"':"",($.fmatter.isEmpty(a)||$.fmatter.isUndefined(a))&&(a=""),a+="",'<input class="parseformatter" data-formatter="datepicker" data-pos="'+b.pos+'" type="text" value="'+a+'" '+e+"/>"},$.fn.fmatter.textarea=function(a,b,c,d){var e,f=$.extend({},b.textbox);return $.fmatter.isUndefined(b.colModel.formatoptions)||(f=$.extend({},f,b.colModel.formatoptions)),e=f.disabled===!0?'disabled="disabled"':"",($.fmatter.isEmpty(a)||$.fmatter.isUndefined(a))&&(a=""),a+="",'<textarea class="parseformatter" data-formatter="textbox" data-pos="'+b.pos+'" '+e+"/>"+a+"</textarea>"},$.fn.fmatter.progressbar=function(a,b,c,d){var e,f=$.extend({},b.progressbar);return $.fmatter.isUndefined(b.colModel.formatoptions)||(f=$.extend({},f,b.colModel.formatoptions)),e=f.disabled===!0?'disabled="disabled"':"",($.fmatter.isEmpty(a)||$.fmatter.isUndefined(a))&&(a=""),a+="",'<div class="parseformatter" data-formatter="progressbar" data-pos="'+b.pos+'" '+e+"/>"},$.fn.fmatter.convertCode=function(b,c,d,e){var f=c.colModel.formatoptions||c.colModel.editoptions||{},g=f.postMode||"value",h="convertCode";if(c.colModel.cellEditoptions){var i=$.coral.toFunction(c.colModel.cellEditoptions).call(this,b,f,d);f=i&&i.cellEditoptions?i.cellEditoptions:f,h=i&&i.type?i.type:"convertCode"}if("convertCode"!==h&&"combobox"!==h&&"combogrid"!==h)return b;var j,k,l=f.data,m=f.dataStructure||"list",n=f.separator||",";if("tree"==m?(j=f.valueField||"id",k=f.textField||"name"):(j="combogrid"==c.colModel.edittype?f.valueField||"id":f.valueField||"value",k="combogrid"==c.colModel.edittype?f.textField||"name":f.textField||"text"),"undefined"==typeof b||null===b)return"";if("value"!=g)return b;"combobox"==c.colModel.edittype&&f.code&&(l=f.code),"combotree"==c.colModel.edittype&&f.code&&(l=f.code),"combogrid"==c.colModel.edittype&&f.code&&(l=f.code),"combotree"==c.colModel.edittype&&(m="tree"),"autocomplete"==c.colModel.edittype&&"string"==typeof f.code&&(l=f.code),"autocomplete"==c.colModel.edittype&&f.source&&(l=f.source);var o=[],p=!1,q=b.toString().split(n);if(c.colModel.cellEditoptions)if("tree"==m)for(var r=0;r<q.length;r++)a(l,q[r],o);else for(var r=0;r<q.length;r++){for(var s=0;s<l.length;s++)l[s][j]==q[r]&&(o.push(l[s][k]),p=!0);p||f.forceSelection||o.push(q[r]),p=!1}else for(var r=0;r<q.length;r++){var t=f.tempData[q[r]];t&&(o.push(f.tempData[q[r]][k]),p=!0),p||f.forceSelection||o.push(q[r]),p=!1}return o.join(n)},$.fn.fmatter.checkbox=function(a,b){var c,d=$.extend({},b.checkbox),e=["Yes","No"];return $.fmatter.isUndefined(b.colModel.formatoptions)||(d=$.extend({},d,b.colModel.formatoptions),b.colModel.formatoptions&&b.colModel.formatoptions.value&&(e=b.colModel.formatoptions.value.split(":"))),c=d.disabled===!0?'disabled="disabled"':"",($.fmatter.isEmpty(a)||$.fmatter.isUndefined(a))&&(a=""),a+="",'<input class="parseformatter" data-formatter="checkbox" value=\''+a+"' data-pos=\""+b.pos+'" type="checkbox" '+c+"/>"},$.fn.afterFmatter=function(a){var b=this;$(".parseformatter",b.element).each(function(){$(this).removeClass("parseformatter");var a=$(this).attr("data-pos"),c=$(this).attr("data-formatter"),d=""===$.trim($(this).val())?"":$(this).val(),e=$.extend({},b.options.colModel[a].formatoptions,{dataCustom:{rowId:$(this).closest("tr")[0].id,gridId:b.options.id}});switch(c){case"combobox":case"combotree":case"combogrid":case"textbox":e.value=d;break;case"toolbar":case"progressbar":break;case"checkbox":var f=["Yes","No"];c&&b.options.colModel[a].formatoptions.value&&(f=b.options.colModel[a].formatoptions.value.split(":")),$(this).val()==f[0]?e.checked=!0:e.checked=!1}$(this)[c](e)})},$.fn.fmatter.link=function(a,b){var c={target:b.target},d="";return $.fmatter.isUndefined(b.colModel.formatoptions)||(c=$.extend({},c,b.colModel.formatoptions)),c.target&&(d="target="+c.target),$.fmatter.isEmpty(a)?$.fn.fmatter.defaultFormat(a,b):"<a "+d+' href="'+a+'">'+a+"</a>"},$.fn.fmatter.showlink=function(a,b){var c,d={baseLinkUrl:b.baseLinkUrl,showAction:b.showAction,addParam:b.addParam||"",target:b.target,idName:b.idName},e="";return $.fmatter.isUndefined(b.colModel.formatoptions)||(d=$.extend({},d,b.colModel.formatoptions)),d.target&&(e="target="+d.target),c=d.baseLinkUrl+d.showAction+"?"+d.idName+"="+b.rowId+d.addParam,$.fmatter.isString(a)||$.fmatter.isNumber(a)?"<a "+e+' href="'+c+'">'+a+"</a>":$.fn.fmatter.defaultFormat(a,b)},$.fn.fmatter.integer=function(a,b){var c=$.extend({},b.integer);return $.fmatter.isUndefined(b.colModel.formatoptions)||(c=$.extend({},c,b.colModel.formatoptions)),$.fmatter.isEmpty(a)?c.defaultValue:$.fmatter.util.NumberFormat(a,c)},$.fn.fmatter.number=function(a,b){var c=$.extend({},b.number);return $.fmatter.isUndefined(b.colModel.formatoptions)||(c=$.extend({},c,b.colModel.formatoptions)),$.fmatter.isEmpty(a)?c.defaultValue:$.fmatter.util.NumberFormat(a,c)},$.fn.fmatter.currency=function(a,b){var c=$.extend({},b.currency);return $.fmatter.isUndefined(b.colModel.formatoptions)||(c=$.extend({},c,b.colModel.formatoptions)),$.fmatter.isEmpty(a)?c.defaultValue:$.fmatter.util.NumberFormat(a,c)},$.fn.fmatter.date=function(a,b,c,d){var e=$.extend({},b.date);$.fmatter.isUndefined(b.colModel.formatoptions)||(e=$.extend({},e,b.colModel.formatoptions));var f=e.srcDateFormat||e.dateFormat;"long"==e.valueType&&(e.restrictConvert=void 0==e.restrictConvert?!0:e.restrictConvert,a=$.coral.longToStringDate(a,e));var g=$.coral.parseDate(f,a||"",e);return $.coral.formatDate(e.dateFormat,g,e)||""},$.fn.fmatter.select=function(a,b){a+="";var c,d,e=!1,f=[];if($.fmatter.isUndefined(b.colModel.formatoptions)?$.fmatter.isUndefined(b.colModel.editoptions)||(e=b.colModel.editoptions.value,c=void 0===b.colModel.editoptions.separator?":":b.colModel.editoptions.separator,d=void 0===b.colModel.editoptions.delimiter?";":b.colModel.editoptions.delimiter):(e=b.colModel.formatoptions.value,c=void 0===b.colModel.formatoptions.separator?":":b.colModel.formatoptions.separator,d=void 0===b.colModel.formatoptions.delimiter?";":b.colModel.formatoptions.delimiter),e){var g,h=b.colModel.editoptions.multiple===!0,i=[];if(h&&(i=a.split(","),i=$.map(i,function(a){return $.trim(a)})),$.fmatter.isString(e)){for(var j=e.split(d),k=0,l=0;l<j.length;l++)if(g=j[l].split(c),g.length>2&&(g[1]=$.map(g,function(a,b){return b>0?a:void 0}).join(c)),h)$.inArray(g[0],i)>-1&&(f[k]=g[1],k++);else if($.trim(g[0])==$.trim(a)){f[0]=g[1];break}}else $.fmatter.isObject(e)&&(h?f=$.map(i,function(a){return e[a]}):f[0]=e[a]||"")}return a=f.join(", "),""===a?$.fn.fmatter.defaultFormat(a,b):a},$.fn.fmatter.rowactions=function(a,b,c,d){var e={keys:!1,onEdit:null,onSuccess:null,afterSave:null,onError:null,afterRestore:null,extraparam:{},url:null,delOptions:{},editOptions:{}};a=$.grid.coralID(a),b=$.grid.coralID(b);var f=$("#"+b)[0].options.colModel[d];$.fmatter.isUndefined(f.formatoptions)||(e=$.extend(e,f.formatoptions)),$.fmatter.isUndefined($("#"+b)[0].options.editOptions)||(e.editOptions=$("#"+b)[0].options.editOptions),$.fmatter.isUndefined($("#"+b)[0].options.delOptions)||(e.delOptions=$("#"+b)[0].options.delOptions);var g=$("#"+b)[0],h=function(c,d){$.isFunction(e.afterSave)&&e.afterSave.call(g,c,d),$("tr#"+a+" div.coral-inline-edit, tr#"+a+" div.coral-inline-del","#"+b+".coral-grid-btable:first").show(),$("tr#"+a+" div.coral-inline-save, tr#"+a+" div.coral-inline-cancel","#"+b+".coral-grid-btable:first").hide()},i=function(c){$.isFunction(e.afterRestore)&&e.afterRestore.call(g,c),$("tr#"+a+" div.coral-inline-edit, tr#"+a+" div.coral-inline-del","#"+b+".coral-grid-btable:first").show(),$("tr#"+a+" div.coral-inline-save, tr#"+a+" div.coral-inline-cancel","#"+b+".coral-grid-btable:first").hide()};if($("#"+a,"#"+b).hasClass("grid-new-row")){var j=g.options.prmNames,k=j.oper;e.extraparam[k]=j.addoper}switch(c){case"edit":$("#"+b).grid("editRow",a,e.keys,e.onEdit,e.onSuccess,e.url,e.extraparam,h,e.onError,i),$("tr#"+a+" div.coral-inline-edit, tr#"+a+" div.coral-inline-del","#"+b+".coral-grid-btable:first").hide(),$("tr#"+a+" div.coral-inline-save, tr#"+a+" div.coral-inline-cancel","#"+b+".coral-grid-btable:first").show(),$(g).triggerHandler("jqGridAfterGridComplete");break;case"save":$("#"+b).grid("saveRow",a,e.onSuccess,e.url,e.extraparam,h,e.onError,i)&&($("tr#"+a+" div.coral-inline-edit, tr#"+a+" div.coral-inline-del","#"+b+".coral-grid-btable:first").show(),$("tr#"+a+" div.coral-inline-save, tr#"+a+" div.coral-inline-cancel","#"+b+".coral-grid-btable:first").hide(),$(g).triggerHandler("jqGridAfterGridComplete"));break;case"cancel":$("#"+b).grid("restoreRow",a,i),$("tr#"+a+" div.coral-inline-edit, tr#"+a+" div.coral-inline-del","#"+b+".coral-grid-btable:first").show(),$("tr#"+a+" div.coral-inline-save, tr#"+a+" div.coral-inline-cancel","#"+b+".coral-grid-btable:first").hide(),$(g).triggerHandler("jqGridAfterGridComplete");break;case"del":$("#"+b).grid("delGridRow",a,e.delOptions);break;case"formedit":$("#"+b).grid("setSelection",a),$("#"+b).grid("editGridRow",a,e.editOptions)}},$.fn.fmatter.actions=function(a,b){var c={keys:!1,editbutton:!0,delbutton:!0,editformbutton:!1};$.fmatter.isUndefined(b.colModel.formatoptions)||(c=$.extend(c,b.colModel.formatoptions));var d,e=b.rowId,f="";return"undefined"==typeof e||$.fmatter.isEmpty(e)?"":(c.editformbutton?(d="onclick=jQuery.fn.fmatter.rowactions('"+e+"','"+b.gid+"','formedit',"+b.pos+"); onmouseover=jQuery(this).addClass('coral-state-hover'); onmouseout=jQuery(this).removeClass('coral-state-hover'); ",f=f+"<div title='"+$.grid.nav.edittitle+"' style='float:left;cursor:pointer;' class='coral-pg-div coral-inline-edit' "+d+"><span class='coral-icon coral-icon-pencil'></span></div>"):c.editbutton&&(d="onclick=jQuery.fn.fmatter.rowactions('"+e+"','"+b.gid+"','edit',"+b.pos+"); onmouseover=jQuery(this).addClass('coral-state-hover'); onmouseout=jQuery(this).removeClass('coral-state-hover') ",f=f+"<div title='"+$.grid.nav.edittitle+"' style='float:left;cursor:pointer;' class='coral-pg-div coral-inline-edit' "+d+"><span class='coral-icon coral-icon-pencil'></span></div>"),c.delbutton&&(d="onclick=jQuery.fn.fmatter.rowactions('"+e+"','"+b.gid+"','del',"+b.pos+"); onmouseover=jQuery(this).addClass('coral-state-hover'); onmouseout=jQuery(this).removeClass('coral-state-hover'); ",f=f+"<div title='"+$.grid.nav.deltitle+"' style='float:left;margin-left:5px;' class='coral-pg-div coral-inline-del' "+d+"><span class='coral-icon coral-icon-trash'></span></div>"),d="onclick=jQuery.fn.fmatter.rowactions('"+e+"','"+b.gid+"','save',"+b.pos+"); onmouseover=jQuery(this).addClass('coral-state-hover'); onmouseout=jQuery(this).removeClass('coral-state-hover'); ",f=f+"<div title='"+$.grid.edit.bSubmit+"' style='float:left;display:none' class='coral-pg-div coral-inline-save' "+d+"><span class='coral-icon coral-icon-disk'></span></div>",d="onclick=jQuery.fn.fmatter.rowactions('"+e+"','"+b.gid+"','cancel',"+b.pos+"); onmouseover=jQuery(this).addClass('coral-state-hover'); onmouseout=jQuery(this).removeClass('coral-state-hover'); ",f=f+"<div title='"+$.grid.edit.bCancel+"' style='float:left;display:none;margin-left:5px;' class='coral-pg-div coral-inline-cancel' "+d+"><span class='coral-icon coral-icon-cancel'></span></div>","<div style='margin-left:8px;'>"+f+"</div>")},$.unformat=function(a,b,c,d,e){var f,g,e=e||"formatter",h=b.colModel[e],i=b.colModel.formatoptions||{},j=/([\.\*\_\'\(\)\{\}\+\?\\])/g,k=b.colModel.unformat||$.fn.fmatter[h]&&$.fn.fmatter[h].unformat;if(k=$.coral.toFunction(k),("combobox"==b.colModel.edittype&&b.colModel.revertCode||"combotree"==b.colModel.edittype&&b.colModel.revertCode||"combogrid"==b.colModel.edittype&&b.colModel.revertCode||"datepicker"==b.colModel.edittype&&b.colModel.revertCode||"autocomplete"==b.colModel.edittype&&b.colModel.revertCode||b.colModel.revertCode)&&("autocomplete"==h||"datepicker"==h||"combobox"==h||"combotree"==h||"combogrid"==h||(h="convertCode")),"undefined"!=typeof k&&$.isFunction(k))f=k.call(this,$(a).text(),b,a);else if(!$.fmatter.isUndefined(h)&&$.fmatter.isString(h)){var l,m=$.grid.formatter||{};switch(h){case"integer":i=$.extend({},m.integer,i),g=i.thousandsSeparator.replace(j,"\\$1"),l=new RegExp(g,"g"),f=$(a).text().replace(l,"");break;case"number":i=$.extend({},m.number,i),g=i.thousandsSeparator.replace(j,"\\$1"),l=new RegExp(g,"g"),f=$(a).text().replace(l,"").replace(i.decimalSeparator,".");break;case"currency":i=$.extend({},m.currency,i),g=i.thousandsSeparator.replace(j,"\\$1"),l=new RegExp(g,"g"),f=$(a).text(),i.prefix&&i.prefix.length&&(f=f.substr(i.prefix.length)),i.suffix&&i.suffix.length&&(f=f.substr(0,f.length-i.suffix.length)),f=f.replace(l,"").replace(i.decimalSeparator,".");break;case"checkbox":f=$.unformat.checkbox(a,b,c,d);break;case"select":f=$.unformat.select(a,b,c,d);break;case"date":f=$.unformat.date(a,b,c,d);break;case"combobox":case"combogrid":case"combotree":f=$.unformat[h](a,b,c,d);break;case"datepicker":f=$.unformat.datepicker(a,b,c,d);break;case"autocomplete":f=$.unformat.autocomplete(a,b,c,d);break;case"text":case"textarea":f=$.unformat.textbox(a,b,c,d);break;case"convertCode":f=b.colModel.postMode?"value"==b.colModel.postMode?$.unformat.convertCode(a,b,c,d):$(a).text():1==b.colModel.revertCode?$.unformat.convertCode(a,b,c,d):$(a).text();break;case"actions":return"";default:f=$(a).text()}}return"text"==b.colModel.edittype?void 0!==f?f:d===!0?$(a).text():$.coral.decode($(a).html()):void 0!==f?f:d===!0?$(a).text():$.grid.htmlDecode($(a).html())},$.unformat.autocomplete=function(a,b,c,d){var e=$(a).text();if(d===!0)return e;var f=$.extend({},$.fmatter.isUndefined(b.colModel.formatoptions)?b.colModel.editoptions:b.colModel.formatoptions);void 0===f.separator?":":f.separator,void 0===f.delimiter?";":f.delimiter;return b.colModel.revertCode?$(a).find(".ctrl-init").autocomplete("getValue").toString():$(a).find(".ctrl-init").autocomplete("getText")},$.unformat.combobox=function(a,b,c,d){var e=$(a).text();if(d===!0)return e;var f=$.extend({},$.fmatter.isUndefined(b.colModel.formatoptions)?b.colModel.editoptions:b.colModel.formatoptions);void 0===f.separator?":":f.separator,void 0===f.delimiter?";":f.delimiter;return b.colModel.revertCode?$(a).find(".ctrl-init").combobox("getValue"):$(a).find(".ctrl-init").combobox("getText")},$.unformat.combotree=function(a,b,c,d){var e=$(a).text();if(d===!0)return e;var f=$.extend({},$.fmatter.isUndefined(b.colModel.formatoptions)?b.colModel.editoptions:b.colModel.formatoptions);void 0===f.separator?":":f.separator,void 0===f.delimiter?";":f.delimiter;return b.colModel.revertCode?$(a).find(".ctrl-init").combotree("getValue").toString():$(a).find(".ctrl-init").combotree("getText")},$.unformat.combogrid=function(a,b,c,d){var e=$(a).text();if(d===!0)return e;var f=$.extend({},$.fmatter.isUndefined(b.colModel.formatoptions)?b.colModel.editoptions:b.colModel.formatoptions);void 0===f.separator?":":f.separator,void 0===f.delimiter?";":f.delimiter;return b.colModel.revertCode?$(a).find(".ctrl-init").combogrid("getValue"):$(a).find(".ctrl-init").combogrid("getText")},$.unformat.textbox=function(a,b,c,d){var e=$(a).text();if(d===!0)return e;var f=$.extend({},$.fmatter.isUndefined(b.colModel.formatoptions)?b.colModel.editoptions:b.colModel.formatoptions);void 0===f.separator?":":f.separator,void 0===f.delimiter?";":f.delimiter;return $(a).find(".ctrl-init").textbox("getValue")},$.unformat.datepicker=function(a,b,c,d){var e=$(a).text();if(d===!0)return e;var f=$.extend({},$.fmatter.isUndefined(b.colModel.formatoptions)?b.colModel.editoptions:b.colModel.formatoptions);void 0===f.separator?":":f.separator,void 0===f.delimiter?";":f.delimiter;return $(a).find(".ctrl-init").datepicker("getValue")},$.unformat.convertCode=function(a,b,c,d){return $(a).attr("data-org")},$.unformat.select=function(a,b,c,d){var e=[],f=$(a).text();if(d===!0)return f;var g=$.extend({},$.fmatter.isUndefined(b.colModel.formatoptions)?b.colModel.editoptions:b.colModel.formatoptions),h=void 0===g.separator?":":g.separator,i=void 0===g.delimiter?";":g.delimiter;if(g.value){var j,k=g.value,l=g.multiple===!0,m=[];if(l&&(m=f.split(","),m=$.map(m,function(a){return $.trim(a)})),$.fmatter.isString(k)){for(var n=k.split(i),o=0,p=0;p<n.length;p++)if(j=n[p].split(h),j.length>2&&(j[1]=$.map(j,function(a,b){return b>0?a:void 0}).join(h)),l)$.inArray(j[1],m)>-1&&(e[o]=j[0],o++);else if($.trim(j[1])==$.trim(f)){e[0]=j[0];break}}else($.fmatter.isObject(k)||$.isArray(k))&&(l||(m[0]=f),e=$.map(m,function(a){var b;return $.each(k,function(c,d){return d==a?(b=c,!1):void 0}),"undefined"!=typeof b?b:void 0}));return e.join(", ")}return f||""},$.unformat.date=function(a,b){b.colModel.formatoptions&&(b.colModel.formatoptions.restrictConvert=void 0==b.colModel.formatoptions.restrictConvert?!0:b.colModel.formatoptions.restrictConvert);var c=$.extend({},b.formatoptions||b.colModel.formatoptions);if(c.revertCode){if("long"==c.valueType){var a=$(a).attr("data-org");return parseInt(a)}return $(a).attr("data-org")}return $(a).text()},$.unformat.checkbox=function(a,b){var c=$.extend({},$.fmatter.isUndefined(b.colModel.formatoptions)?b.colModel.editoptions:b.colModel.formatoptions),d=c.value?c.value.split(":"):["Yes","No"];return $("input",a).is(":checked")?d[0]:d[1]}}();/*! cui 2016-11-08 */
$.component("coral.textbox",$.coral.inputbase,{version:$.coral.version,castProperties:["dataCustom","title","buttons","buttonOptions","triggers","showRequiredMark","hideRequiredMark","formatterText","valid","onValidSuccess","onValidError"],options:{swfPath:$.coral.contextPath+"/jquery-cui/resource/swfupload.swf",hasTips:!1,showStar:!0,showClose:!1,dataCustom:null,autoDecode:!1,value:"",readonly:!1,readonlyInput:!1,disabled:!1,required:!1,isLabel:!1,title:null,buttons:[],useHiddenInput:!0,errMsg:null,errMsgPosition:"leftBottom",placeholder:"",type:"text",labelField:null,starBefore:!1,valueChangedOnKeyUp:!1,delSpace:!1,onClick:null,onChange:null,onBlur:null,onFocus:null,onKeyDown:null,onKeyUp:null,onKeyPress:null,onEnter:null,onMouseEnter:null,onMouseLeave:null,onCreate:null,onValidSuccess:null,onValidError:null,onValidWarn:null,onUploadSuccess:null,buttonOptions:null,triggers:null,excluded:!1},button:function(){return null!==this.options.buttonOptions?this.$button:void 0},component:function(){return this.textboxWrapper},focus:function(){if(this.options.disabled||this.options.isLabel||this.options.readonly||this.options.readonlyInput)return!1;if("hidden"!=this.element.attr("type")){return this.element.focus(),!0}},_create:function(){var a=this;a.options.hasTips&&(a.options.title=!0),this._initElement(),this.options.dataCustom&&this.element.attr("data-custom",this.options.dataCustom),this.setValue(this.element.val(),!1),this.originalValue=this.getValue(),this._bindEvents(),null!==this.options.buttonOptions&&this._outerButtons(),a._trigger("onCreate",null,[])},_getButtonEl:function(){return $("<button type='button'></button>").addClass("coral-textbox-button")},reset:function(){this.setValue(this.originalValue)},_initSimple:function(){var a=this;a.element.uniqueId().attr("id")},_initUpload:function(){var a=this,b=a.element.uniqueId().attr("id");a.select=[],$(this.element).wrap('<span class="coral-file-default"></span>').before("<span class='coral-file'>请选择...</span>").before("<div id='"+b+"_upload'></div>").before("<div id='"+b+"_queue'></div>").hide(),a.uploader=$("#"+b+"_upload"),a.uploader.uploadify({swf:this.options.swfPath,uploader:a.options.uploadUrl,queueID:b+"_queue",height:"28",width:"800",buttonText:"浏览",onDialogOpen:function(){a.select=[]},onDialogClose:function(){},onSelect:function(b){a.select.push(b.name),a.textboxWrapper.find(".coral-file").html(a.select.join(",")),a.textboxWrapper.find("object").attr("title",a.select.join(","))},onCancel:function(a){},onQueueComplete:function(c){setTimeout(function(){$("#"+b+"_queue").dialog("close"),a.select=[]},3500)},onUploadSuccess:function(b,c,d){a._trigger("onUploadSuccess",null,[{file:b,data:c,response:d}])},auto:!1}),$("#"+b+"_queue").dialog({autoOpen:!1,modal:!1,resizable:!1,onOpen:function(){a.uploader.uploadify("upload","*")}})},upload:function(a){var b=this,c=b.element[0].id;0!==this.select.length&&$("#"+c+"_queue").dialog("open")},cancel:function(a){this.uploader.uploadify("cancel")},clear:function(a){this.select=[],this.textboxWrapper.find(".coral-file").html("请选择..."),this.textboxWrapper.find("object").attr("title","请选择..."),this.uploader.uploadify("cancel")},_getIcon:function(a){var b=[];if("undefined"==typeof a||null==a||""==a)return[];if("object"==typeof a)for(var c in a){var d={};d[a[c].icon]=a[c].click,b.push(d)}else{var e=$.trim(a).split(",");for(var c in e){var f=e[c].split(" "),d={};d[f[0]]=f[1],b.push(d)}}return b},_triggerClick:function(a,b,c){var d=this,e=null,f=this.options;if(b=$.Event(b),f.controllerName){var g=$.controller(f.controllerName);return e=g[a],e.apply(g,[b].concat(c))}return e=$.coral.toFunction(a),e.apply(d.element[0],[b].concat(c))},_updateLabel:function(a){this.uiLabel.html(a)},_initElement:function(){var a=this,b=a.options;if(this.className="coral-textbox-default coral-validation-textbox tabbable "+this.element[0].className,this.compClass="coral-textbox",this.hiddenClass="",this.classBorder="","hidden"==this.element.attr("type")&&(this.compClass=this.compClass+" hide"),"TEXTAREA"==this.element[0].tagName&&(this.compClass="coral-textbox coral-textbox-textarea"),this.createInput(),this.textboxWrapper=$(this.textboxWrapper),this.elementBorder=$(this.elementBorder),this.element=$(this.textboxInput),this.options.useHiddenInput?this.textboxHidden=$(this.textboxWrapper[0].lastChild):this.textboxHidden=this.element,this.options.buttons.length>0&&this._createButtonPanel(),b.labelField&&(this.uiLabel=$('<label class="coral-label">'+b.labelField+"</label>"),this.elementBorder.before(this.uiLabel),this.textboxWrapper.addClass("coral-hasLabel"),this._createLabel()),"file"==a.element.attr("type")&&("uploadify"==a.options.formatter&&a._initUpload(),"simple"!=a.options.formatter&&"undefined"!=typeof a.options.formatter||a._initSimple()),a.options.icons){var c=[],d=null;if(0!=(c=a._getIcon(a.options.icons)).length?d=!0:0!=(c=a._getIcon(a.options.texticons)).length&&(d=!1),null!=d){this.uiDialogButtonPanel=$('<span class="coral-textbox-btn-icons coral-corner-right"></span>'),a.elementBorder.append(this.uiDialogButtonPanel);for(var e in c)$.each(c[e],function(b,c){var e=$('<span class="coral-textbox-btn-ico icon"></span>');d?e.addClass(b):e.addClass("coral-textbox-btn-textico").html(b),e.bind("click"+a.eventNamespace,function(b){a.options.disabled||a._triggerClick(c,b,[{value:a.element.val()}])}),a.uiDialogButtonPanel.append(e)});this.rightPos=this.uiDialogButtonPanel.outerWidth()}}return"undefined"!=typeof this.element.attr("name")?this.options.name=this.element.attr("name"):this.options.name&&this.element.attr("name",this.options.name),"TEXTAREA"===this.element[0].tagName?""!==$.trim(this.element.text())?this.options.value=this.element.text():this.options.value&&this.element.text(this.options.value):""!==$.trim(this.element.val())?this.options.value=this.element.val():this.options.value&&this.element.val(this.options.value),b.width&&this.textboxWrapper.css("width",b.width),b.height&&this._setOption("height",b.height),b.readonlyInput&&this._setReadonlyInput(),b.readonly&&this._setReadonly(),"boolean"==typeof b.isLabel&&b.isLabel?(this._setReadonly(),this.options.readonly=!0,void this.component().addClass("coral-isLabel")):("boolean"==typeof b.disabled&&b.disabled&&this._setOption("disabled",b.disabled),this.options.showClose&&this.clearIcon.css("right",this.rightPos?this.rightPos:0),this.element.attr("placeholder",b.placeholder),b.placeholder&&""===this.element.val()&&this._showPlaceholder(),void this._updateTitle())},_setReadonlyInput:function(){"undefined"!=typeof this.element.attr("readonly")?this.options.readonlyInput=this.element.prop("readonly"):this.options.readonlyInput&&this.element.prop("readonly",this.options.readonlyInput),this.element.prop("readonly")&&this.component().addClass("coral-readonlyInput")},_setReadonly:function(){this.options.readonlyInput=!0,this._setReadonlyInput(),this.component().removeClass("coral-readonlyInput").addClass("coral-readonly"),this.element.removeClass("tabbable")},_updateTitle:function(){var a=this,b=this.options;1==b.title?a.element.attr("title",a.element.val()):0==b.title?a.element.attr("title",""):a.element.attr("title",b.title)},_showPlaceholder:function(){if(!$.support.placeholder){var a=this,b=$("<span class='coral-textbox-placeholder-label'>"+a.options.placeholder+"</span>");$(a.element).after(b)}},_hidePlaceholder:function(){if(!$.support.placeholder){var a=this;a.textboxWrapper.find(".coral-textbox-placeholder-label").remove()}},_bindEvents:function(){var a,b=this,c=this.options;coral.eventsQueue.push({instance:this,args:[{"mouseenter.coral-textbox-border":function(a){"boolean"==typeof c.isLabel&&c.isLabel||"boolean"==typeof c.readonly&&c.readonly||(b.component().addClass("coral-textbox-hover"),this._trigger("onMouseEnter",a,[]))},"mouseleave.coral-textbox-border":function(a){"boolean"==typeof c.isLabel&&c.isLabel||"boolean"==typeof c.readonly&&c.readonly||(b.component().removeClass("coral-textbox-hover"),this._trigger("onMouseLeave",a,[]))},click:function(a){b._hidePlaceholder(),this._trigger("onClick",a,[])},"click.coral-textbox-placeholder-label":function(a){b._hidePlaceholder(),b.element.focus()},dblclick:function(a){this._trigger("onDblClick",a,[])},blur:function(b){return this.component().removeClass("coral-state-focus"),""===this.element.val()&&this._showPlaceholder(),a?void(a=!1):(this._setValue(this.element.val(),!0),void this._trigger("onBlur",b,[]))},focusin:function(a){return c.isLabel||c.readonly||c.readonlyInput?void this._trigger("onFocus",a,[{value:this.textboxHidden.val(),text:this.element.val()}]):(this.options.formatterText&&this.setText(this.getValue()),this.component().addClass("coral-state-focus"),void this._trigger("onFocus",a,[{value:this.textboxHidden.val(),text:this.element.val()}]))},keydown:function(a){if(!(c.isLabel||c.readonly||c.readonlyInput)){$.validate.restrictInput(this.element,a),c.shortCut&&$.coral.callFunction(c.shortCut,a,this);var b=this._trigger("onKeyDown",a,[{value:this.textboxHidden.val(),text:this.element.val(),id:this.options.id}]);return 13==a.keyCode&&(this._setValue(this.element.val(),!0),this._trigger("onEnter",a,[{value:this.textboxHidden.val(),text:this.element.val()}])),this._hidePlaceholder(),b}},keypress:function(a){return c.isLabel||c.readonly||c.readonlyInput?void 0:this._trigger("onKeyPress",a,[{value:this.textboxHidden.val(),text:this.element.val()}])},keyup:function(a){c.isLabel||c.readonly||c.readonlyInput||(this.options.valueChangedOnKeyUp&&this._setValue(this.element.val(),!0,!1),$.validate.restrictInput(this.element,a),this._trigger("onKeyUp",a,[{value:this.textboxHidden.val(),text:this.element.val(),id:this.options.id}]))},"click.coral-input-clearIcon":function(a){a.preventDefault(),this.setValue("",!0),this.options.placeholder&&this._showPlaceholder(),this._trigger("onCloseClick",event,[])},"mousedown.coral-input-clearIcon":function(b){b.stopPropagation(),a=!0}}]}),coral.eventsTimer||(coral.eventsTimer=setTimeout(function(){coral.eventsParser()},50))},_setOption:function(a,b){var c=this;if("id"!==a&&"name"!==a&&"type"!==a){if("height"===a&&b&&(this.component().outerHeight(b),this.textboxWrapper.find(".coral-textbox-btn-textico").css({"line-height":b-6+"px",height:b+"px"})),"width"===a&&b&&this.component().outerWidth(b),this._super(a,b),"placeholder"===a&&(this.element.attr("placeholder",this.options.placeholder),""===this.getValue()&&this._showPlaceholder()),"texticons"==a){var d=c._getIcon(c.options.texticons),e=$('<span class="coral-textbox-btn-icons coral-corner-right"></span>');c.elementBorder.find(".coral-textbox-btn-icons").replaceWith(e);for(var f in d)$.each(d[f],function(a,b){var d=$('<span class="coral-textbox-btn-ico icon"></span>').addClass("coral-textbox-btn-textico").html(a);d.bind("click"+c.eventNamespace,function(a){c.options.disabled||c._triggerClick(b,a,[{value:c.element.val()}])}),e.append(d)})}"value"===a&&(c._updateTitle(),c.setValue(b,!1)),"isLabel"===a&&("boolean"==typeof b&&b?(this._setReadonly(),this.component().removeClass("coral-readonly").addClass("coral-isLabel")):"boolean"!=typeof b||b||(this.element.prop("readonly",!1),this.options.readonly=!1,this.options.isLabel=!1,this.options.readonlyInput=!1,this.element.addClass("tabbable"),this.component().removeClass("coral-isLabel coral-readonly"))),"readonly"===a&&("boolean"==typeof b&&b?(this._setReadonly(),this.component().removeClass("coral-isLabel").addClass("coral-readonly")):"boolean"!=typeof b||b||(this.element.prop("readonly",!1),this.options.readonly=!1,this.options.readonlyInput=!1,this.element.prop("readonly",!1),this.element.addClass("tabbable"),this.component().removeClass("coral-isLabel coral-readonly"))),"readonlyInput"===a&&("boolean"==typeof b&&b?(this._setReadonlyInput(),this.component().removeClass("coral-isLabel").addClass("coral-readonlyInput")):"boolean"!=typeof b||b||(this.element.prop("readonly",!1),this.options.readonlyInput=!1,this.component().removeClass("coral-isLabel coral-readonlyInput"))),"disabled"===a&&(b?this.element.prop("disabled",!0):this.element.prop("disabled",!1)),"labelField"===a&&c._updateLabel(b),"title"===a&&c._updateTitle(),"hasTips"===a&&c._updateTitle()}},_destroy:function(){this.textboxWrapper.replaceWith(this.element),this.element.val(""),this.element.removeAttr("value"),this.element.removeClass("coral-textbox-default").removeClass("coral-validation-textbox").removeClass("coral-textbox-hover").removeClass("coral-textbox-textarea").removeClass("coral-textbox-input").removeAttr("placeholder").removeAttr("title").removeAttr("readonly").removeAttr("disabled")},disable:function(){this._setOption("disabled",!0)},enable:function(){this._setOption("disabled",!1)},getHtml:function(){return this.element.text()},setHtml:function(){this.element.text(value),this._updateTitle()},getValue:function(){var a=this.textboxHidden.val();return this.options.autoDecode&&(a=$.coral.decode(a)),this.options.delSpace&&(a=a.trim()),a},getValidateValue:function(){return this.getText()},getText:function(){return this.component().hasClass("coral-state-focus")?this.element.val():this.textboxHidden.val()},_setValue:function(a,b,c){a=null===a||"undefined"==typeof a?"":a;var d=a;c=c!==!1;var e=$.coral.toFunction(this.options.formatterText);$.isFunction(e)&&(d=e.apply(this.options.element,[{value:a}])),c&&this.setText(d),this.textboxHidden.val(a),this.options.value=a,b&&this.previous!=a&&this._trigger("onChange",null,[{value:a,text:d}]),this.previous=a,""!==a&&this._hidePlaceholder()},setValue:function(a,b,c){a=null===a||"undefined"==typeof a?"":a,this.options.autoDecode&&(a=$.coral.encode(a)),this._setValue(a,b,c)},setText:function(a){this.element.is("textarea")?(this.element.val(a),this.element.text(a)):this.element.val(a),this._updateTitle()},formValue:function(){var a={},b=this.element.attr("name");return b?(a[b]=this.getValue(),a):null}});/*! cui 2016-11-08 */
$.component("coral.toolbar",{version:"4.0.2",castProperties:["data","dataCustom","dropdownOptions"],options:{clickToDisplay:1,id:null,name:null,dataCustom:{},responsive:!0,disabled:!1,cls:null,url:null,title:!1,method:"get",data:null,width:"auto",height:null,isOverflow:!0,dropdownOptions:{button:{text:!1,label:"更多"},panelPosition:{my:"right top",at:"right bottom"},atGroup:0},align:0,autoDisplay:!1,margin:5,onCreate:null,onClick:null,onLoad:null},_jion:function(a,b){var c=[];return $.each(a,function(a,b){c.push($(b))}),$.each(b,function(a,b){c.push($(b))}),c},_hideMenus:function(){$(".coral-tieredmenu").hide()},_create:function(){this.isLoaded=!1,this.groupLength=1,this._initElements(),this._bindEvents()},_bindEvents:function(){var a=this;this._on(this.document,{mousedown:function(b){1==a.options.clickToDisplay&&a.options.autoDisplay&&a.uiBox.toggleClass("coral-toolbar-click-active",!1)}})},_initElements:function(){this.options;this.uiBox=$('<div class="coral-toolbar"></div>'),this.uiBorder=$('<div class="coral-toolbar-border"></div>'),this.uiBox.append(this.uiBorder),this.uiBox.insertAfter(this.element),this.element.appendTo(this.uiBorder),"undefined"!=typeof this.element.attr("id")?this.options.id=this.element.attr("id"):this.options.id&&this.element.attr("id",this.options.id),"undefined"!=typeof this.element.attr("name")?this.options.name=this.element.attr("name"):this.options.name&&this.element.attr("name",this.options.name),this.uiAfter=$("<button type='button' data-frozen='true' class='coral-toolbar-after-element ctrl-toolbar-element'></button>").menubutton({label:this.options.dropdownOptions.button.label,text:this.options.dropdownOptions.button.text,renderType:"button",icons:"cui-icon-arrow-down3 right",data:[],position:this.options.dropdownOptions.panelPosition}),this.uiAfter.menubutton("component").addClass("coral-toolbar-item coral-toolbar-after"),this.uiAfter.menubutton("hide"),this._loadData(),this.options.width&&this.uiBox.css({width:this.options.width}),0==this.options.clickToDisplay&&this.uiBox.addClass("coral-toolbar-click-active")},reload:function(a){this.isLoaded=!1,this.groupLength=1;var b=this.options;"string"!=typeof a?b.data=a:b.url=a,this.element.html(""),this.uiAfter=$("<button type='button' data-frozen='true' class='coral-toolbar-after-element ctrl-toolbar-element'></button>").menubutton({label:this.options.dropdownOptions.button.label,text:this.options.dropdownOptions.button.text,renderType:"button",icons:"cui-icon-arrow-down3 right",data:[],position:this.options.dropdownOptions.panelPosition}),this.uiAfter.menubutton("component").addClass("coral-toolbar-item coral-toolbar-after"),this.uiAfter.menubutton("hide"),this._loadData()},_loadData:function(){var a=this,b=this.options;b.url?$.ajax({type:b.method,url:b.url,data:{},dataType:"json",success:function(b){a._initData(b)},error:function(){$.alert("Json Format Error!")}}):b.data&&this._initData(b.data)},_initData:function(a){"object"==typeof a&&(this._addItems(null,a),this._trigger("onLoad",null,{}),this.isLoaded=!0,this._setFrozenElements(),this._position()),this.options.disabled&&this._setDisabled(this.options.disabled)},_addItems:function(a,b,c){if("object"==typeof b){for(var d=this,e=[],f=b.length,g=0;f>g;g++){var h=b[g];""!=h&&$.isEmptyObject(h)||e.push(d._createItem(h))}if(this._appendItems(a,e,c),this._initItems(e),!this.element.find(".coral-toolbar-after-element").length){var i=this._getGroupNameByIndex(this.options.dropdownOptions.atGroup),j=this.element.find("[group-role='"+i+"']");j.length?j.after(this.uiAfter.menubutton("component")):this.element.append(this.uiAfter.menubutton("component"))}}},_createItem:function(a){var b=a.type||"button",c=null;"-"===a?b="seperator":"->"===a?b="grouper":""===a?b="blank":"more"===a&&(b="more");var d=this._createEl(b);if(c=a,"button"===b&&"undefined"!=typeof a.icon&&""!=a.icon){var e=this._getIcon(a.icon);delete c.icon,null!=e.ico1&&null==e.ico2?c.icons=e.ico1:null==e.ico1&&null!=e.ico2?c.icons=e.ico2+" right":null!=e.ico1&&null!=e.ico2&&(c.icons=e.ico1+" left, "+e.ico2+" right")}return{$el:d,coralType:b,options:c}},_align:function(){if(1==this.groupLength){var a=this.options;if("center"==a.align){var b=this._createEl("grouper").attr("grouper-role","center"),c=this._createEl("grouper").attr("grouper-role","right");this.element.prepend(b),this.element.find("[group-role='left']").removeClass("group-left").addClass("group-center").attr("group-role","center"),this.element.find(".ctrl-toolbar-element").attr("group","center"),this.element.append(c)}else if("right"==a.align){var c=this._createEl("grouper").attr("grouper-role","right");this.element.find("[group-role='left']").removeClass("group-left").addClass("group-right").attr("group-role","right"),this.element.find(".ctrl-toolbar-element").attr("group","right"),this.element.prepend(c)}}},_appendItems:function(a,b,c){var d=this;if(this.isLoaded){var e=this._getGroupNameByIndex(c),f=this.element.find("[group-role='"+e+"']"),g=f.find(".ctrl-toolbar-element:not(.coral-toolbar-separator)").length;if(null==a||a==g)for(var h in b)b[h].$el.attr("group",e),b[h].$el.appendTo(f);else if(0==a)for(var i in b)b[i].$el.attr("group",e),b[i].$el.prependTo(f);else for(var j in b){b[j].$el.attr("group",e);var k=f.find(".ctrl-toolbar-element:eq("+a+")"),l=k.attr("component-role");l?k[l]("component").before(b[j].$el):k.before(b[j].$el)}}else{var m=0,n=d._createGrouper(m,this.groupLength);this.element.append(n),$.each(b,function(a,b){"grouper"==b.coralType?(m+=1,n=d._createGrouper(m,d.groupLength),d.element.append(b.$el.attr("grouper-role",n.attr("group-role"))),d.element.append(n)):(n.append(b.$el.attr("group",n.attr("group-role"))),b.options&&1==b.options.frozen&&b.$el.attr("data-frozen",!0))}),this._align()}},_initItems:function(a){var b=this;for(var c in a)if("seperator"!==a[c].coralType&&"grouper"!==a[c].coralType&&"blank"!==a[c].coralType&&"more"!==a[c].coralType){var d=a[c].$el,e=a[c].coralType.toLowerCase(),f=a[c].options;f.componentCls=" coral-toolbar-item "+f.componentCls||"","html"!==a[c].coralType?(b.options.title&&(f.title=!0),d[e](f),d.off(".toolbaronclick").on(e+"onclick.toolbaronclick",function(a,c){if(c=c||{},c.id=c.id||a.currentTarget.id,"splitbutton"==$(a.currentTarget).attr("component-role"),b.uiAfter.length){var d=$(a.currentTarget).attr("component-role");"splitbutton"!=d&&"button"!=d||b.uiAfter.menubutton("hidePanel")}b._trigger("onClick",a,c)}),d.off(".toolbaronmouseenter").on(e+"onmouseenter.toolbaronmouseenter",function(a,c){var d=$(a.currentTarget).attr("component-role");"splitbutton"!=d&&"menubutton"!=d||0==b.options.clickToDisplay&&b.options.autoDisplay&&($(a.currentTarget)[d]("hideAllMenus"),$(a.currentTarget)[d]("showMenu"))})):d.attr("id",f.id).append(f.content)}},_createEl:function(a){var b;switch(a){case"button":b=$("<button type='button'></button>");break;case"checkbox":b=$("<input type='checkbox' />");break;case"textbox":case"combobox":b=$("<input type='text' />");break;case"datepicker":b=$("<input type='text' />");break;case"splitbutton":case"menubutton":b=$("<button type='button'></button>");break;case"seperator":b=$("<div class='coral-toolbar-item coral-toolbar-separator coral-toolbar-separator-horizontal'></div>");break;case"grouper":this.groupLength+=1,b=$("<div class='coral-toolbar-item coral-toolbar-grouper'></div>");break;case"html":b=$("<div class='coral-toolbar-item coral-toolbar-html'></div>");break;case"blank":b=$("<span class='coral-toolbar-item coral-toolbar-blank'></span>");break;case"more":return b=this.uiAfter.menubutton("component");default:b=$("<span class='coral-toolbar-item'></span>")}return b.addClass("ctrl-toolbar-element")},_createGrouper:function(a,b){var c=$();if(1==b||3==b)switch(a){case 0:c=$("<span class='coral-toolbar-group group-left' group-role='left'></span>");break;case 1:c=$("<span class='coral-toolbar-group group-center' group-role='center'></span>");break;case 2:c=$("<span class='coral-toolbar-group group-right' group-role='right'></span>");break;default:c=$("<span class='coral-toolbar-group' group-role='default'></span>")}else if(2==b)switch(a){case 0:c=$("<span class='coral-toolbar-group group-left' group-role='left'></span>");break;case 1:c=$("<span class='coral-toolbar-group group-right' group-role='right'></span>");break;default:c=$("<span class='coral-toolbar-group' group-role='default'></span>")}return c},_getGroupNameByIndex:function(a){if("number"!=typeof a)return"left";if(1==this.groupLength)return"left";if(2==this.groupLength)return 0==a?"left":"right";if(3==this.groupLength)switch(a){case 0:return"left";case 1:return"center";case 2:return"right"}},_getGrouper:function(){return this.element.find(".coral-toolbar-grouper")},_resetGrouper:function(){var a=this._getGrouper();a.length&&a.width(1)},_resetToolbarItems:function(){var a=this,b=this._getElements(2);this._resetGrouper(),$.each(b,function(b,c){var d=$(c),e=a._getComponentByElement(d);if(e.css({left:""}),e.hasClass("coral-menubutton-button-item")){var f=d.attr("group"),g=a.element.find("[group-role='"+f+"']");if(g.find("[data-frozen='true']").length){var h=g.find("[data-frozen='true']:eq(0)"),i=a._getComponentByElement(h);i.before(e.removeClass("coral-menubutton-button-item"))}else g.append(e.removeClass("coral-menubutton-button-item"))}}),this.uiAfter.menubutton("hidePanel"),this.uiAfter.menubutton("hide"),this.uiBorder.css({width:"auto"})},_position:function(){if(!this.element.is(":visible")||!this.options.responsive)return this._resetToolbarItems(),void this.component().addClass("coral-toolbar-initHidden");this.component().removeClass("coral-toolbar-initHidden");var a=this.options;this._resetGrouper(),this.totalWidth=this._totalWidth(),a.isOverflow&&this.uiBox.width()>0?this.uiBorder.width(this.uiBox.width()):this.uiBorder.width(Math.max(this.totalWidth,this.uiBox.width())),this._toolbarWidth()-this.totalWidth<0?this.uiAfter.menubutton("show"):this.uiAfter.menubutton("hide"),this._positionItems(this.element)},_positionItems:function(a){var b=(this.options,this.options.margin),c=!1,d=0,e=$(),f={right:"auto"};this._prePosition(),this.element.find(".coral-toolbar-item:not(.coral-state-hidden)").each(function(a,g){var h=$(g);return c?!0:(e.length&&(d=d+e.outerWidth()+b),f.left=d+"px",h.css(f),void(e=h))}),this._handlerDropdownItems()},_handlerDropdownItems:function(){var a=this,b=this._filter(this._getElements(0),".ctrl-init-splitbutton,.ctrl-init-menubutton");a._hideMenus(),$.each(b,function(b,c){var d=$(c),e=a._getComponentByElement(d);try{switch(d.attr("component-role")){case"splitbutton":e.hasClass("coral-menubutton-button-item")?d.splitbutton("menu").tieredmenu("option",{my:"left top",at:"right top",of:d.splitbutton("uiDropdownButton")}):d.splitbutton("menu").tieredmenu("option",{my:"left top",at:"left bottom",of:d});break;case"menubutton":e.hasClass("coral-menubutton-button-item")?d.menubutton("menu").tieredmenu("option",{my:"left top",at:"right top"}):d.menubutton("menu").tieredmenu("option",{my:"left top",at:"left bottom"})}}catch(f){console.log(" There is a error happened.")}finally{}})},_getComponentByElement:function(a){var b=$(),c=a.attr("component-role");return b=c?a[c]("component"):a},_filter:function(a,b){var c=[];return $.each(a,function(a,d){var e=$(d);e.is(b)&&c.push(e)}),c},_prePosition:function(){var a=this,b=(this.options,this.options.margin),c=0,d=!1,e=[],f=$(),g=[];g=this.uiAfter.is(":visible")?this._getElements(3):this._getElements(2);var g=this._jion(a._getFrozenElements(),a._filter(g,":not([data-frozen='true'])"));$.each(g,function(g,h){var i=a._getComponentByElement($(h)),j=!i.hasClass("coral-menubutton-button-item");if(d)return j?i.hasClass("coral-toolbar-grouper")||"true"==$(h).attr("data-frozen")?!0:(e.push(i),!0):!0;if(f.length&&f.is(":visible")&&(c=c+f.outerWidth()+b),!j){var k=a.element.find("[group-role='"+$(h).attr("group")+"']");if(k.attr("group-role")==$(h).attr("group")&&k.find("[data-frozen='true']").length){var l=k.find("[data-frozen='true']:eq(0)");l.attr("component-role")?l[l.attr("component-role")]("component").before(i.removeClass("coral-menubutton-button-item")):l.before(i.removeClass("coral-menubutton-button-item"))}else i.removeClass("coral-menubutton-button-item").appendTo(k)}return c+i.outerWidth()>a._toolbarWidth()?(d=!0,i.hasClass("coral-toolbar-grouper")||"true"==$(h).attr("data-frozen")?!0:(j?e.push(i):a.uiAfter.menubutton("prepend",i),!0)):void(f=i)}),this.isLoaded?a.uiAfter.menubutton("prepend",e):a.uiAfter.menubutton("append",e),this._setGrouperWidth()},_setGrouperWidth:function(){var a=this._getGrouper(),b=this._toolbarWidth()-this._totalWidth(!0,this.uiAfter.is(":visible"))-this.options.margin,c=this._getWidthByGroupRole("left"),d=this._getWidthByGroupRole("right"),e=(b-c+d)/2,f=b-e;return 0>b?void a.width(1):void(1==a.length?a.width(b):2==a.length&&(e>0&&f>0&&!this.uiAfter.is(":visible")?($(a[0]).width(e+1),$(a[1]).width(f+1)):($(a[1]).width(b+1),$(a[0]).width(1))))},_getWidthByGroupRole:function(a){var b=this.options,c=0,d=this.element.find("[group-role='"+a+"']"),e=d.find(".coral-toolbar-item");return d.length&&e.length?($.each(e,function(a,d){var f=$(d);c+=f.outerWidth()+b.margin,a==e.length-1&&(c-=b.margin)}),c):0},_toolbarWidth:function(){return this.uiBorder.innerWidth()},_setFrozenElements:function(){var a=this._getElements(3),b=!1;$.each(a,function(a,c){var d=$(c);d.hasClass("coral-toolbar-after-element")&&(b=!0),b&&!d.hasClass("coral-toolbar-grouper")&&d.attr("data-frozen",!0)})},_getFrozenElements:function(){return this.uiAfter.is(":visible")?this.element.find("[data-frozen='true']"):this.element.find("[data-frozen='true']:not(.coral-toolbar-after-element)")},_getElements:function(a){var b=$(),c=this.element.find(".ctrl-toolbar-element"),d=this.uiAfter.menubutton("buttons").find(".ctrl-toolbar-element");switch(b=this._jion(c,d),a){case 0:b=this._filter(b,":not(.coral-toolbar-after-element,.coral-toolbar-grouper,.coral-toolbar-separator)");break;case 1:b=this._filter(b,":not(.coral-toolbar-after-element,.coral-toolbar-grouper)");break;case 2:b=this._filter(b,":not(.coral-toolbar-after-element)");break;case 3:}return b},_getComponents:function(a,b){var c=$(),d=this.element.find(".coral-toolbar-item"),e=this.uiAfter.menubutton("buttonElements");switch(c=this._jion(d,e),a=a||1){case 0:c=this._filter(c,":not(.coral-toolbar-after,.coral-toolbar-grouper,.coral-toolbar-separator)");break;case 1:c=this._filter(c,":not(.coral-toolbar-after,.coral-toolbar-grouper)");break;case 2:c=this._filter(c,":not(.coral-toolbar-after)");break;case 3:}return b||($itemAll=this._filter(c,".coral-state-hidden")),c},getTotalWidth:function(a){return this._totalWidth(a)},_totalWidth:function(a,b){var c=this.options,d=0,e=$();e=b?this.element.find(".coral-toolbar-item:not(.coral-state-hidden)"):this.element.find(".coral-toolbar-item:not(.coral-state-hidden,.coral-toolbar-after)");var f=this.uiAfter.menubutton("buttons").find(".coral-toolbar-item:not(.coral-state-hidden)");return e.each(function(a,b){var g=$(b);d=d+g.outerWidth()+c.margin,a!=e.length-1||f.length||(d-=c.margin)}),a?d-c.margin:(this.uiAfter.menubutton("showPanel"),f.each(function(a,b){var e=$(b);d=d+e.outerWidth()+c.margin,a==f.length-1&&(d-=c.margin)}),this.uiAfter.menubutton("hidePanel"),d)},_getIcon:function(a){var b,c={ico1:null,ico2:null},d=[];return null==a?c:(b=$.trim(a),b.indexOf(",")>=0?(d=b.split(","),c.ico1=""==d[0]?null:d[0],c.ico2=""==d[1]?null:d[1]):c.ico1=b,c)},getLength:function(){return this._getElements(0).length},isExist:function(a){return!!this._getSubCoral(a)},_getGroupElementsLength:function(a){if(!("number"!=typeof a||a>this.groupLength-1)){var b=this._getGroupNameByIndex(a),c=this.element.find("[group-role='"+b+"']");return c.find(".ctrl-toolbar-element:not(.coral-toolbar-separator)").length}},add:function(a,b,c){if("object"==typeof b){if("string"==typeof a)return this._addByParentId(a,b);c=c||0;var d=parseInt(a);null!=a&&isNaN(d)||0>d||d>this._getGroupElementsLength(c)||($.isArray(b)||(b=[b]),0==this._getGroupElementsLength(c)&&(a=null),this._addItems(a,b,c),this._refresh())}},_addByParentId:function(a,b){var c=this._getSubCoral(a);if(c){var d=c.$el;switch(c.type){case"splitbutton":d.splitbutton("menu").tieredmenu("add",null,b);break;case"menubutton":d.menubutton("menu").tieredmenu("add",null,b);break;case"tieredmenu":d.tieredmenu("add",a,b)}}},getSubCoral:function(a){var b=this;return"string"==typeof a?b._getSubCoral(a):b._getSubCoralByIndex(a)},_getSubCoralByIndex:function(a){var b=this,c=parseInt(a);return isNaN(c)||0>c||c>this.getLength()-1?!1:b._getSubCoral(c)},_findElementsByAttr:function(a,b,c){var d=[];return $.each(a,function(a,e){var f=$(e);c==f.attr(b)&&d.push(f)}),d},_getSubCoral:function(a){var b=this._findElementsByAttr(this._getElements(0),"id",a),c=this._findElementsByAttr(this._getElements(0),"component-role","splitbutton"),d=this._findElementsByAttr(this._getElements(0),"component-role","menubutton"),e=null,f=null,g=null;return"number"==typeof a?(g=$(this._getElements(0)[a]),f={$el:g,type:g.attr("component-role")}):b.length?f={$el:b[0],type:b[0].attr("component-role")}:(e=this._findSubCoralInMenuItems(c,a),c.length&&e?f={$el:e,type:"tieredmenu"}:(e=this._findSubCoralInMenuItems(d,a),d.length&&e?f={$el:e,type:"tieredmenu"}:f))},_findSubCoralInMenuItems:function(a,b){if(a.length){var c=null;return $.each(a,function(a,d){var e=$(d),f=e.attr("component-role"),g=$(d)[f]("menu");g.find("[data-id='"+b+"']").length&&(c=g)}),c}},removeAll:function(){$.each(this._getElements(1),function(a,b){var c=$(b),d=c.attr("component-role");d&&c[d]("destroy"),c.remove()}),this._refresh()},remove:function(a){"string"==typeof a?this._removeById(a):this._removeByIndex(a),this._refresh()},_removeById:function(a){var b=this._getSubCoral(a);if(b){var c=b.$el;if(c.hasClass("coral-toolbar-html"))return void c.remove();switch(b.type){case"tieredmenu":c.tieredmenu("removeItem",a);break;default:var d=c.attr("component-role");c[d]("destroy"),c.remove()}}},_removeByIndex:function(a){var b=parseInt(a);if(isNaN(b)||0>b||b>this.getLength()-1)return!1;var c=$(this._getElements(0)[b]),d=c.attr("component-role");d&&c[d]("component").remove(),c.remove()},update:function(a,b){var c=this;"string"==typeof a?c._updateById(a,b):c._updateByIndex(a,b),this._refresh()},_updateById:function(a,b){var c=this._getSubCoral(a);if(c){var d=c.$el;switch(c.type){case"tieredmenu":d.tieredmenu("updateItem",a,b);break;case"button":d.button("update",b);break;case"splitbutton":d.splitbutton("button").button("update",b);break;case"menubutton":d.menubutton("button").button("update",b)}}},_updateByIndex:function(a,b){var c=parseInt(a);if(isNaN(c)||0>c||c>this.getLength()-1)return!1;var d=this._getSubCoral(a);if(d){var e=d.$el;switch(d.type){case"button":e.button("update",b);break;case"splitbutton":e.splitbutton("button").button("update",b);break;case"menubutton":e.menubutton("button").button("update",b)}}},component:function(){return this.uiBox},_uiBorder:function(){return this.uiBorder},disable:function(){this._setDisabled(!0)},enable:function(){this._setDisabled(!1)},_setDisabled:function(a){var b=this._getElements(0);$.each(b,function(b,c){var d=$(c);return d.hasClass("coral-toolbar-html")?!0:void(d.attr("component-role")&&(a?d[d.attr("component-role")]("disable"):d[d.attr("component-role")]("enable")))}),this.options.disabled=!!a},disableItem:function(a){var b=this;"string"==typeof a?b._disableItemById(a):b._disableItemByIndex(a)},_disableItemById:function(a){var b=this._getSubCoral(a);if(b){var c=b.$el;if(c.hasClass("coral-toolbar-html"))return;switch(b.type){case"tieredmenu":c.tieredmenu("disableItem",a);break;default:var d=$(this._findElementsByAttr(this._getElements(0),"id",a)[0]);if(!d.length)return;d[d.attr("component-role")]("disable")}}},_disableItemByIndex:function(a){var b=parseInt(a);if(isNaN(b)||0>b||b>this.getLength()-1)return!1;var c=$(this._getElements(0)[b]);return c.hasClass("coral-toolbar-html")?!1:c.length?(c[c.attr("component-role")]("disable"),!0):!1},enableItem:function(a){var b=this;"string"==typeof a?b._enableItemById(a):b._enableItemByIndex(a)},_enableItemById:function(a){var b=this._getSubCoral(a);if(b){var c=b.$el;if(c.hasClass("coral-toolbar-html"))return;switch(b.type){case"tieredmenu":c.tieredmenu("enableItem",a);break;default:var d=$(this._findElementsByAttr(this._getElements(0),"id",a)[0]);if(!d.length)return;d[d.attr("component-role")]("enable")}}},_enableItemByIndex:function(a){var b=parseInt(a);if(isNaN(b)||0>b||b>this.getLength()-1)return!1;var c=$(this._getElements(0)[b]);if(!c.hasClass("coral-toolbar-html"))return c.length?(c[c.attr("component-role")]("enable"),!0):!1},hide:function(a){var b=this;"string"==typeof a?b._hideById(a):b._hideByIndex(a),this._refresh()},hideAll:function(){$.each(this._getElements(1),function(a,b){var c=$(b).attr("component-role");c?$(b)[c]("hide"):$(b).hide()}),this._refresh()},_hideById:function(a){var b=this._getSubCoral(a);if(b){var c=b.$el;if(c.hasClass("coral-toolbar-html"))return void c.hide();switch(b.type){case"tieredmenu":c.tieredmenu("hideItem",a);break;default:var d=$(this._findElementsByAttr(this._getElements(0),"id",a)[0]);if(!d.length)return;d[d.attr("component-role")]("hide")}}},_hideByIndex:function(a){var b=parseInt(a);if(isNaN(b)||0>b||b>this.getLength()-1)return!1;var c=$(this._getElements(0)[b]);return c.length?c.hasClass("coral-toolbar-html")?(c.hide(),!0):(c[c.attr("component-role")]("hide"),!0):!1},show:function(a){var b=this;"string"==typeof a?b._showById(a):b._showByIndex(a),this._refresh()},showAll:function(){$.each(this._getElements(1),function(a,b){var c=$(b).attr("component-role");c?$(b)[c]("show"):$(b).show()}),this._refresh()},_showById:function(a){var b=this._getSubCoral(a);if(b){var c=b.$el;if(c.hasClass("coral-toolbar-html"))return void c.show();switch(b.type){case"tieredmenu":c.tieredmenu("showItem",a);break;default:var d=$(this._findElementsByAttr(this._getElements(0),"id",a)[0]);if(!d.length)return;d[d.attr("component-role")]("show")}}},_showByIndex:function(a){var b=parseInt(a);if(isNaN(b)||0>b||b>this.getLength()-1)return!1;var c=$(this._getElements(0)[b]),d=c.attr("component-role");return c.length?(d?c[d]("show"):c.show(),!0):!1},_destroy:function(){this.uiBox.replaceWith(this.element)},_setOption:function(a,b){"id"!==a&&"name"!==a&&("disabled"===a&&this._setDisabled(b),this._super(a,b))},refresh:function(){this._refresh()},_refresh:function(){this._position(),$.coral.refreshChild(this.element)}});/*! cui 2016-11-08 */
!function(){var a,b="coral-button coral-component coral-state-default coral-corner-all",c="coral-button-text-icons coral-button-text-icon-primary coral-button-text-icon-secondary",d=function(){var a=$(this);setTimeout(function(){a.find(":coral-button").button("refresh")},1)},e=function(a){var b=a.name,c=a.form,d=$([]);return b&&(b=b.replace(/'/g,"\\'"),d=c?$(c).find("[name='"+b+"'][type=radio]"):$("[name='"+b+"'][type=radio]",a.ownerDocument).filter(function(){return!this.form})),d};$.component("coral.button",{version:"4.0.1",defaultElement:"<button>",castProperties:["dataCustom","shortCut"],options:{id:null,name:null,cls:null,title:!1,disabled:null,text:!0,label:null,icons:{primary:null,secondary:null},type:"button",width:null,countdown:!1,countdownTime:3e3,showCountdown:!0,onCreate:null,onClick:null,onDblClick:null,onMouseEnter:null,onMouseLeave:null},_create:function(){this.options.icons=this._icons(),this.element.addClass("ctrl-init ctrl-init-button"),this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,d),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title")||this.options.title;var c=this,f=this.options,g="checkbox"===this.type||"radio"===this.type,h=g?"":"coral-state-active";f.id&&this.element.attr("id",f.id),f.name&&this.element.attr("name",f.name),null===f.label&&(f.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(b).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){f.disabled||(this===a&&$(this).addClass("coral-state-active"),c._trigger("onMouseEnter",null,{id:this.id,label:c.options.label}))}).bind("mouseleave"+this.eventNamespace,function(){f.disabled||($(this).removeClass(h),c._trigger("onMouseLeave",null,{id:this.id,label:c.options.label}))}).bind("click"+this.eventNamespace,function(a){function b(){0!==$("body").find(c.element).length&&(0>=e?(c.element.button("enable"),c.element.button("option","label",d)):(setTimeout(function(){0!==$("body").find(c.element).length&&c.element.button("option","label",d+"("+e+")")},0),e--,setTimeout(function(){b()},1e3)))}if(f.disabled)a.preventDefault(),a.stopImmediatePropagation();else{if(f.once&&c.element.button("disable"),f.countdown){var d,e=f.countdownTime/1e3;0!==$("body").find(c.element).length&&(d=c.element.button("option","label")),$(document).find(c.element).length&&(c.element.button("disable"),f.showCountdown?b():c._delay(function(){c.element.button("enable"),c.element.button("option","label",d)},f.countdownTime))}c._trigger("onClick",null,{id:this.id,label:c.options.label})}}).bind("dblclick"+this.eventNamespace,function(a){f.disabled?(a.preventDefault(),a.stopImmediatePropagation()):c._trigger("onDblClick",null,{id:this.id,label:c.options.label})}),this._on({focus:function(){this.buttonElement.addClass("coral-state-focus")},blur:function(){this.buttonElement.removeClass("coral-state-focus")}}),g&&this.element.bind("change"+this.eventNamespace,function(){c.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return f.disabled?!1:void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(f.disabled)return!1;$(this).addClass("coral-state-active"),c.buttonElement.attr("aria-pressed","true");var a=c.element[0];e(a).not(a).map(function(){return $(this).button("component")[0]}).removeClass("coral-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return f.disabled?!1:($(this).addClass("coral-state-active"),a=this,void c.document.one("mouseup",function(){a=null}))}).bind("mouseup"+this.eventNamespace,function(){return f.disabled?!1:void $(this).removeClass("coral-state-active")}).bind("keydown"+this.eventNamespace,function(a){var b=$.coral.keyCode;return f.disabled?!1:(a.keyCode!==b.SPACE&&a.keyCode!==b.ENTER||$(this).addClass("coral-state-active"),f.shortCut&&$.coral.callFunction(f.shortCut,a,this),void c._trigger("onKeyDown"))}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){$(this).removeClass("coral-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(a){a.keyCode===$.coral.keyCode.SPACE&&$(this).click()})),f.width&&this.buttonElement.outerWidth(f.width),this._setOption("disabled",f.disabled),this._resetButton()},_icons:function(){function a(a,b,c){var d=b.split(" ");return $.inArray(a,d)>-1?(d=$.grep(d,function(b,c){return b!==a}),d.join(" ")):c?b:null}var b=this.options.icons,c=null,d=null,e=null,f=null;return b&&"string"==typeof b?(c=b.split(","),c.length>0&&(d=$.trim(c[0]),f=a("right",d),null===f&&(e=a("left",d,!0))),c.length>1&&(d=$.trim(c[1]),e=null===e?a("left",d):e,null===f&&(f=a("right",d,!0))),{primary:e,secondary:f}):b},_determineButtonType:function(){var a,b,c;this.element.is("[type=checkbox]")?this.type="checkbox":this.element.is("[type=radio]")?this.type="radio":this.element.is("input")?this.type="input":this.type="button","checkbox"===this.type||"radio"===this.type?(a=this.element.parents().last(),b="label[for='"+this.element.attr("id")+"']",this.buttonElement=a.find(b),this.buttonElement.length||(a=a.length?a.siblings():this.element.siblings(),this.buttonElement=a.filter(b),this.buttonElement.length||(this.buttonElement=a.find(b))),this.element.addClass("coral-helper-hidden-accessible"),c=this.element.is(":checked"),c&&this.buttonElement.addClass("coral-state-active"),this.buttonElement.prop("aria-pressed",c)):this.buttonElement=this.element},component:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("coral-helper-hidden-accessible"),this.buttonElement.removeClass(b+" ui-state-active "+c).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".coral-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(a,b){return this._super(a,b),"disabled"===a?(this.component().toggleClass("coral-state-disabled",!!b),this.element.prop("disabled",!!b),void(b&&("checkbox"===this.type||"radio"===this.type?this.buttonElement.removeClass("coral-state-focus"):this.buttonElement.removeClass("coral-state-focus coral-state-active")))):void this._resetButton()},update:function(a){"string"==typeof a&&this.element.find(".coral-button-text").html(a)},refresh:function(){var a=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("coral-button-disabled");a!==this.options.disabled&&this._setOption("disabled",a),"radio"===this.type?e(this.element[0]).each(function(){$(this).is(":checked")?$(this).button("component").addClass("coral-state-active").attr("aria-pressed","true"):$(this).button("component").removeClass("coral-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("coral-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("coral-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return void(this.options.label&&this.element.val(this.options.label));var a=this.buttonElement.removeClass(c),b=$("<span></span>",this.document[0]).addClass("coral-button-text").html(this.options.label).appendTo(a.empty()).text(),d=this.options.icons,e=d.primary&&d.secondary,f=[];d.primary||d.secondary?(this.options.text&&f.push("coral-button-text-icon"+(e?"s":d.primary?"-primary":"-secondary")),d.primary&&a.prepend("<span class='coral-button-icon-primary icon "+d.primary+"'></span>"),d.secondary&&a.append("<span class='coral-button-icon-secondary icon "+d.secondary+"'></span>"),this.options.text||(f.push(e?"coral-button-icons-only":"coral-button-icon-only"),this.hasTitle||a.attr("title",$.trim(b)))):f.push("coral-button-text-only"),this.hasTitle&&a.attr("title",$.trim(b)),a.addClass(f.join(" "))}}),$.component("coral.buttonset",{version:"4.0.1",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(coral-button)"},_create:function(){this.element.addClass("coral-buttonset")},_init:function(){this.refresh()},_setOption:function(a,b){"disabled"===a&&this.buttons.button("option",a,b),"label"===a&&this.update(b),this._super(a,b)},refresh:function(){var a="rtl"===this.element.css("direction"),b=this.element.find(this.options.items),c=b.filter(":coral-button");b.not(":coral-button").button(),c.button("refresh"),this.buttons=b.map(function(){return $(this).button("component")[0]}).removeClass("coral-corner-all coral-corner-left coral-corner-right").filter(":first").addClass(a?"coral-corner-right":"coral-corner-left").end().filter(":last").addClass(a?"coral-corner-left":"coral-corner-right").end().end()},_destroy:function(){this.element.removeClass("coral-buttonset"),this.buttons.map(function(){return $(this).button("component")[0]}).removeClass("coral-corner-left coral-corner-right").end().button("destroy")}})}();/*! cui 2016-11-08 */
$.component("coral.splitbutton",$.coral.button,{version:"4.0.2",componentName:"splitbutton",castProperties:["menuOptions","dataCustom"],options:{id:null,name:null,label:null,cls:null,icons:{primary:null,secondary:null},width:null,text:!0,disabled:!1,menuOptions:{autoDisplay:!1,popup:!0},data:null,url:null,onCreate:null,onClick:null,onDblClick:null},component:function(){return this.uiBox},uiBorder:function(){return this.uiBorder},uiDropdownButton:function(){return this.dropdownButton},menu:function(){return this.uiMenu},_create:function(){this._initElements(),this._super()},_initElements:function(){var a=this,b=this.options,c=this.options.menuOptions,d=this.options.data,e=this.options.url;this.element.addClass("ctrl-init ctrl-init-splitbutton coral-splitbutton-element"),this.dropdownButton=$("<button class='coral-splitbutton-dropdownbutton' type='button'></button>").uniqueId(),this.uiBorder=$('<span class="coral-splitbutton-border"></span>'),this.uiBox=$('<span class="coral-splitbutton"></span>'),this.uiBox.append(this.uiBorder),this.uiMenu=$('<ul class="coral-splitbutton-menu"></ul>'),this.uiBox.insertAfter(this.element),this.uiBorder.append(this.element).append(this.dropdownButton),this.uiMenu.appendTo($(document.body)),b.width&&this.uiBox.css({width:b.width}),"undefined"!=typeof this.element.attr("id")?this.options.id=this.element.attr("id"):this.options.id?this.element.attr("id",this.options.id):this.options.id=this.element.uniqueId(),"undefined"!=typeof this.element.attr("name")?this.options.name=this.element.attr("name"):this.options.name&&this.element.attr("name",this.options.name),this.triggerId=this.dropdownButton.attr("id"),this._on(this.element,{buttononclick:function(b,c){a._trigger("onClick",b,c)}}),this.dropdownButton.button({label:"下拉按钮",text:!1,icons:"cui-icon-arrow-down3",onClick:function(b,c){if(a._getToolbar().length&&0!=a._getToolbar().toolbar("option","clickToDisplay")&&a._getToolbar().length&&a._getToolbar().toolbar("option","autoDisplay")){var d=a._getToolbar(!0);d.length&&d.toggleClass("coral-toolbar-click-active")}},onMouseEnter:function(b,c){if(a._getToolbar().length&&a._getToolbar().toolbar("option","autoDisplay")){var d=a._getToolbar(!0);d.hasClass("coral-toolbar-click-active")&&($(".coral-tieredmenu:visible").length&&a._hideMenus(),a.uiMenu.tieredmenu("show"))}}});var f={};null!=d&&(f.data=d),null!=e&&(f.url=e),c=$.extend({},f,b.menuOptions,{id:this.element.attr("id")+"_tieredmenu",trigger:this.dropdownButton,of:this.element}),this.uiMenu.tieredmenu(c),a._getToolbar().length&&a._getToolbar().toolbar("option","autoDisplay")&&this.uiMenu.tieredmenu("component").bind("mouseleave",function(){a._hideMenus()}),this._on(this.uiMenu,{tieredmenuonclick:function(b,c){a._trigger("onClick",b,c)}})},_getToolbar:function(a){var b=(this.options,$());return this.element.hasClass("ctrl-toolbar-element")&&(b=a?this.element.parents(".coral-toolbar:eq(0)"):this.element.parents(".ctrl-init-toolbar:eq(0)")),b},_hideMenus:function(){$(".coral-tieredmenu").hide()},hideAllMenus:function(){$(".coral-tieredmenu").hide()},showMenu:function(){this.uiMenu.tieredmenu("show")},_setOption:function(a,b){if("id"!==a&&"name"!==a){"disabled"===a&&(this.element.toggleClass("coral-state-disabled",b),this.dropdownButton.button("option","disabled",b)),this._super(a,b)}},_destroy:function(){this.uiBox.replaceWith(this.element),this.uiMenu.parent().remove(),this.element.removeClass("ctrl-init ctrl-init-splitbutton coral-splitbutton-element")}});/*! cui 2016-11-08 */
$(document).unbind(".coral-menubutton").bind("mousedown.coral-menubutton mousewheel.coral-menubutton",function(a){$(a.target).closest("span.coral-menubutton,.coral-menubutton-buttons").length||$(".coral-menubutton-buttons").hide()}),$.component("coral.menubutton",$.coral.button,{version:"4.0.2",castProperties:["menuOptions"],options:{id:null,name:null,label:null,cls:null,icons:{primary:null,secondary:"cui-icon-arrow-down3"},width:null,text:!0,disabled:!1,renderType:"menu",menuOptions:{autoDisplay:!1,popup:!0},data:null,url:null,method:"get",position:{my:"left top",at:"left bottom"},onCreate:null,onClick:null,onDblClick:null,onLoad:null},showPanel:function(){var a=this.options,b=$.extend(a.position,{of:this.element}),c=this.uiButtons.siblings(".coral-front:visible").map(function(){return+$(this).css("z-index")}).get(),d=Math.max.apply(null,c);d>=+this.uiButtons.css("z-index")&&this.uiButtons.css("z-index",d+1),this.uiButtons.css({position:"absolute",left:"",top:"","max-height":"300px",overflow:"auto"}).position(b).show()},hidePanel:function(){this.uiButtons.hide()},_create:function(){this._initElements(),this._super()},_getToolbar:function(a){var b=(this.options,$());return this.element.hasClass("ctrl-toolbar-element")&&(b=a?this.element.parents(".coral-toolbar:eq(0)"):this.element.parents(".ctrl-init-toolbar:eq(0)")),b},_hideMenus:function(){$(".coral-tieredmenu").hide()},hideAllMenus:function(){$(".coral-tieredmenu").hide()},showMenu:function(){this.uiMenu.tieredmenu("show")},_initElements:function(){var a=this,b=this.options;this.element.addClass("ctrl-init ctrl-init-menubutton coral-menubutton-element"),this.uiBorder=$('<span class="coral-menubutton-border"></span>'),this.uiBox=$('<span class="coral-menubutton"></span>'),this.uiBox.append(this.uiBorder),this.uiBox.insertAfter(this.element),this.uiBorder.append(this.element),"undefined"!=typeof this.element.attr("id")?this.options.id=this.element.attr("id"):this.options.id?this.element.attr("id",this.options.id):this.options.id=this.element.uniqueId().attr("id"),"undefined"!=typeof this.element.attr("name")?this.options.name=this.element.attr("name"):this.options.name&&this.element.attr("name",this.options.name),this.options.onClick=function(c,d){if("button"==b.renderType&&(a.uiButtons.is(":visible")?a.hidePanel():a.showPanel()),a._getToolbar().length&&a._getToolbar().toolbar("option","autoDisplay")){var e=a._getToolbar(!0);e.length&&e.toggleClass("coral-toolbar-click-active")}},this.options.onMouseEnter=function(c,d){if(a._getToolbar().length&&a._getToolbar().toolbar("option","autoDisplay")&&"button"!=b.renderType){var e=a._getToolbar(!0);e.hasClass("coral-toolbar-click-active")&&($(".coral-tieredmenu:visible").length&&a._hideMenus(),a.uiMenu.tieredmenu("show"))}},this._on(this.element,{buttononclick:function(b,c){a._trigger("onClick",b,c)}}),"button"==b.renderType?(this.uiButtons=$("<div class='coral-menubutton-buttons coral-front'></div>").appendTo($(document.body)),this._loadData()):(this.uiMenu=$('<ul class="coral-menubutton-menu"></ul>').appendTo($(document.body)),this._renderMenu())},_renderMenu:function(){var a=this,b=this.options,c=this.options.menuOptions,d=this.options.data,e=this.options.url,f={};null!=d&&(f.data=d),null!=e&&(f.url=e),c=$.extend({},f,b.menuOptions,{id:this.element.attr("id")+"_tieredmenu",trigger:this.element,of:this.element}),this.uiMenu.tieredmenu(c),a._getToolbar().length&&a._getToolbar().toolbar("option","autoDisplay")&&this.uiMenu.tieredmenu("component").bind("mouseleave",function(){a._hideMenus()}),this._on(this.uiMenu,{tieredmenuonclick:function(b,c){a._trigger("onClick",b,c)}})},_loadData:function(){var a=this,b=this.options;b.url?$.ajax({type:b.method,url:b.url,data:{},dataType:"json",success:function(b){a._initData(b)},error:function(){$.alert("Json Format Error!")}}):b.data&&this._initData(b.data)},_initData:function(a){var b=this;"object"==typeof a&&this._addItems(null,a),b._trigger("onLoad",null,{})},_addItems:function(a,b){if("object"==typeof b){for(var c=this,d=[],e=b.length,f=0;e>f;f++){var g=b[f];$.isEmptyObject(g)||d.push(c._createButton(g))}this._appendItems(a,d),this._initItems(d)}},_createButton:function(a){return{button:$("<button type='button'></button>").addClass("coral-menubutton-button-item"),options:a}},_appendItems:function(a,b){for(var c in b)b[c].button.appendTo(this.uiButtons)},_initItems:function(a){var b=this;for(var c in a){var d=a[c].button,e=a[c].options;d.button(e);var f={};f.buttononclick=function(a,c){b._trigger("onClick",a,c)},b._on(d,f)}},add:function(a){},prepend:function(a){if(!(!a instanceof jQuery)){var b=this,c=a.length;a instanceof Array||(a=[a]);for(var d=c-1;d>-1;d--){var e=a[d];e.css({margin:"",left:"",right:""}).removeClass("coral-menubutton-button-item").addClass("coral-menubutton-button-item").prependTo(b.uiButtons)}}},append:function(a){if(!(!a instanceof jQuery)){var b=this,c=a.length;a instanceof Array||(a=[a]);for(var d=c-1;d>-1;d--){var e=a[d];e.css({margin:"",left:"",right:""}).removeClass("coral-menubutton-button-item").addClass("coral-menubutton-button-item").prependTo(b.uiButtons)}}},pop:function(){var a=this.options;if("button"!=a.renderType)return $();var b=this.uiButtons.find(".coral-menubutton-button-item:eq(0)");return b.length?b.removeClass("coral-menubutton-button-item"):$()},component:function(){return this.uiBox},border:function(){return this.uiBorder},buttons:function(){return this.uiButtons},buttonElements:function(){return this.uiButtons.children()},menu:function(){return this.uiMenu},_bindEvents:function(){},_setOption:function(a,b){"id"!==a&&"name"!==a&&("disabled"===a&&this.element.toggleClass("coral-state-disabled",b),this._super(a,b))},_destroy:function(){var a=this.options;this.uiBox.replaceWith(this.element),"buttons"==a.renderType?this.uiButtons.remove():this.uiMenu.parent().remove(),this.element.children().remove(),this.element.removeClass("ctrl-init ctrl-init-menubutton coral-menubutton-element")}});/*! cui 2016-11-08 */
$.component("coral.treebutton",$.coral.button,{version:$.coral.version,castProperties:["treeOptions"],options:{id:null,name:null,label:null,cls:null,position:{my:"left top",at:"left bottom",collision:"none"},width:null,text:!0,disabled:!1,multiple:!1,treeOptions:{id:null,name:null,data:null,showLine:!1,showIcon:!1,checkable:!0},onCreate:null,onClick:null,onCheck:null,onSelect:null},tree:function(){return this.uiTree},_create:function(){this._super(),this._initElements()},_initElements:function(){var a=this,b=this.options,c=this.options.treeOptions;this.element.addClass("coral-treebutton-element").uniqueId(),this.uiTree=$("<ul>").attr("id",$(this.element).attr("id")+"_tree").addClass("coral-treebutton-panel coral-front").appendTo("body"),this.element.on("click",function(b,c){a._showtree()}),this._on(this.document,{mousedown:function(b){b.isDefaultPrevented()||a._hidetree()}}),this.uiTree.unbind().bind("mousedown",function(a){a.preventDefault()});var d={checkable:this.options.multiple};c=$.extend({},d,b.treeOptions,{id:$(this.element).attr("id")+"_tree"}),this.uiTree.tree(c)},_bindEvents:function(){},_setOption:function(a,b){this._super(a,b)},_showtree:function(a){var b=this.uiTree;b.show();var c=b.siblings(".coral-front:visible").map(function(){return+$(this).css("z-index")}).get(),d=Math.max.apply(null,c);d>=+b.css("z-index")&&b.css("z-index",d+1),b.position($.extend({of:this.element},this.options.position))},_hidetree:function(){this.uiTree.hide()},disabledNode:function(a){for(var b=this.uiTree.tree("getNodesByParam","id",a),c=0,d=b.length;d>c;c++)this.uiTree.tree("setChkDisabled",b[0],!0)},undisabledNode:function(a){for(var b=this.uiTree.tree("getNodesByParam","id",a),c=0,d=b.length;d>c;c++)this.uiTree.tree("setChkDisabled",b[0],!1)},_destroy:function(){this.uiTree.remove(),this.element.removeClass("ctrl-init ctrl-init-treebutton coral-treebutton-element")}});/*! cui 2016-11-08 */
var _timer=!1,_resizable=!0;$(window).unbind(".coral-panel").bind("resize.coral-panel",function(){_resizable&&(_timer!==!1&&clearTimeout(_timer),_timer=setTimeout(function(){_resizable=!1,$.coral.refreshAllComponent("body"),_timer=!1,_resizable=!0},200))}),$.component("coral.panel",{version:"4.0.2",options:{id:null,title:null,iconCls:null,width:"auto",height:"auto",left:null,top:null,cls:null,headerCls:null,bodyCls:null,style:{},href:null,cache:!0,fit:!1,border:!0,doSize:!0,showHeader:!0,showTitle:!0,content:null,collapsible:!1,showNavButton:!1,minimizable:!1,maximizable:!1,closable:!1,collapsed:!1,minimized:!1,maximized:!1,closed:!1,tools:null,url:null,loadtext:"加载中，请耐心等候...",loadingMessage:"Loading...",extractor:function(a){var b=/<body[^>]*>((.|[\n\r])*)<\/body>/im,c=b.exec(a);return c?c[1]:a},beforeOpen:$.noop,beforeClose:$.noop,beforeDestroy:$.noop,beforeCollapse:$.noop,beforeExpand:$.noop,onLoad:$.noop,onOpen:$.noop,onClose:$.noop,onDestroy:$.noop,onResize:$.noop,onMove:$.noop,onMaximize:$.noop,onRestore:$.noop,onMinimize:$.noop,onCollapse:$.noop,onExpand:$.noop},_create:function(){this.originalTitle=this.element.attr("title"),this.element.removeAttr("title").addClass("ctrl-init ctrl-init-panel"),this._createWrapper(),this.isLoaded=!1,this.element.appendTo(this.uiPanel),this._addHeader(),this._setBorder(),1==this.options.doSize&&(this.uiPanel.css("display","block"),this.resizePanel()),1==this.options.closed||1==this.options.minimized?this.close():this.open()},_createWrapper:function(){this.element.addClass("coral-panel-body"),this.uiPanel=$('<div class="coral-panel"></div>').insertBefore(this.element)},_fit:function(a){return $.coral.panel.fit(this.uiPanel,a)},resizePanel:function(a){var b=this.options,c=this.uiPanel,d=c.children("div.coral-panel-header"),e=c.children("div.coral-panel-body");a&&$.extend(b,{width:a.width,height:a.height,left:a.left,top:a.top}),b.fit?$.extend(b,this._fit()):this._fit(!1),c.css({left:b.left,top:b.top}),isNaN(b.width)?c.width("auto"):c.outerWidth(b.width),d.add(e).outerWidth(c.width()),isNaN(b.height)?(e.height("auto"),c.css("height","")):(c.outerHeight(b.height),e.outerHeight(c.height()-d.outerHeight())),this._doResize(),this.toolbarEl&&this.toolbarEl.toolbar("refresh"),this._trigger("onResize",null,{width:b.width,height:b.height})},_setBorder:function(){var a=this.options,b=this.uiPanel,c=this.header(),d=this.body();$.isEmptyObject(a.style)||b.css(a.style),a.border?(c.removeClass("coral-panel-header-noborder"),d.removeClass("coral-panel-body-noborder")):(c.addClass("coral-panel-header-noborder"),d.addClass("coral-panel-body-noborder")),c.addClass(a.headerCls),d.addClass(a.bodyCls)},_addHeader:function(){var a=this.options,b=this.uiPanel,c=this;if(a.tools&&"string"==typeof a.tools&&b.find(">div.coral-panel-header>div.coral-panel-tool .coral-panel-tool-a").appendTo(a.tools),b.children("div.coral-panel-header").remove(),a.title&&a.showHeader){var d=$('<div class="coral-panel-header"></div>').prependTo(b);this.toolbarEl=$("<div></div>"),this.toolbarEl.appendTo(d);var e=[],f={type:"html",content:a.title},g={type:"button",icons:"cui-icon-arrow-up3 coral-panel-tool-collapse",label:"collapse",text:!1,onClick:function(){a.collapsed===!0?c.expand(!0):c.collapse(!0)}},h={type:"button",icons:"cui-icon-minus3 coral-panel-tool-min",label:"minimize",text:!1,onClick:function(){c.minimize()}},i={type:"button",icons:"cui-icon-enlarge7 coral-panel-tool-max",label:"maximize",text:!1,onClick:function(){a.maximized===!0?c.restore():c.maximize()}},j={type:"button",icons:"cui-icon-cross2 coral-panel-tool-close",label:"close",text:!1,onClick:function(){c.close()}},k={data:e};a.toolbarOptions?($.each(a.toolbarOptions.data,function(b,c){"title"===c&&(a.toolbarOptions.data[b]=f),"collapse"===c&&(a.toolbarOptions.data[b]=g),"minimize"===c&&(a.toolbarOptions.data[b]=h),"maximize"===c&&(a.toolbarOptions.data[b]=i),"close"===c&&(a.toolbarOptions.data[b]=j)}),$.extend(!0,k,a.toolbarOptions)):(a.showTitle&&e.push(f),e.push("->"),a.collapsible&&e.push(g),a.minimizable&&e.push(h),a.maximizable&&e.push(i),a.closable&&e.push(j)),this.toolbarEl.toolbar(k),b.children("div.coral-panel-body").removeClass("coral-panel-body-noheader")}else b.children("div.coral-panel-body").addClass("coral-panel-body-noheader")},toolbar:function(){return this.toolbarEl},_loadData:function(){var a=this.options,b=this;a.url?b.isLoaded&&a.cache||(b.isLoaded=!1,b.element.html(""),$(this.element).loading({position:"inside",text:this.options.loadtext}),this.xhr&&this.xhr.abort(),this.xhr=$.ajax(this._ajaxSettings()),this.xhr.success(function(c){b.setContent(a.extractor.call(b.element,c)),b._trigger("onLoad",null,arguments),b.isLoaded=!0}).complete(function(a,c){a===b.xhr&&(b.xhr=null)})):a.content&&(b.isLoaded||(b.setContent(a.content),b.isLoaded=!0))},_ajaxSettings:function(){var a=this.options;return{url:a.url,cache:!1,dataType:"html"}},_doResize:function(){$.coral.refreshChild(this.element)},_destroy:function(a){1!=a&&0==this._trigger("beforeDestroy")||(this.originalTitle&&this.element.attr("title",this.originalTitle),this.element.removeClass("coral-panel-body").detach(),this.element.insertAfter(this.component()),this.component().remove(),this._trigger("onDestroy"))},component:function(){return this.uiPanel},panel:function(){return this.uiPanel},getOptions:function(){return this.options},header:function(){return this.uiPanel.find(">div.coral-panel-header")},body:function(){return this.uiPanel.find(">div.coral-panel-body")},setTitle:function(a){this.options.title=a,this.header().find("div.coral-panel-title").html(a)},setContent:function(a){this.element.children().remove(),this.element.html(a),$.parser&&$.parser.parse(this.element)},open:function(a){var b=this.options,c=null;1!=a&&this._trigger("beforeOpen",null)===!1||(this.uiPanel.show(),b.closed=!1,b.minimized=!1,c=this.uiPanel.children(".coral-panel-header").find("a.coral-panel-tool-restore"),c.length&&(b.maximized=!0),this._trigger("onOpen"),b.maximized===!0&&(b.maximized=!1,this.maximize()),b.collapsed===!0&&(b.collapsed=!1,this.collapse()),b.collapsed||(this._loadData(),this._doResize()))},close:function(a){var b=this.options,c=this.uiPanel;1!=a&&0==this._trigger("beforeClose",null)||(this._fit(!1),c.hide(),b.closed=!0,this._trigger("onClose"))},refresh:function(a){this.isLoaded=!1,a&&(this.options.url=a),this._loadData()},reload:function(a){this.refresh(a)},resize:function(a){this.resizePanel(a)},move:function(a){var b=this.options;a&&(null!=a.left&&(b.left=a.left),null!=a.top&&(b.top=a.top)),this.uiPanel.css({left:b.left,top:b.top}),this._trigger("onMove",null,{left:b.left,top:b.top})},maximize:function(){var a=this.options;a.maximized!==!0&&(this.uiPanel.children("div.coral-panel-header").find("a.coral-panel-tool-max").addClass("coral-panel-tool-restore").addClass("cui-icon-shrink7").removeClass("cui-icon-enlarge7"),this.original||(this.original={width:a.width,height:a.height,left:a.left,top:a.top,fit:a.fit}),a.left=0,a.top=0,a.fit=!0,this.resizePanel(),a.minimized=!1,a.maximized=!0,this._trigger("onMaximize"))},minimize:function(){this._fit(!1),this.uiPanel.hide(),this.options.minimized=!0,this.options.maximized=!1,this._trigger("onMinimize")},restore:function(){this.options.maximized!==!1&&(this.uiPanel.show(),this.uiPanel.children("div.coral-panel-header").find("a.coral-panel-tool-max").removeClass("coral-panel-tool-restore").addClass("cui-icon-enlarge7").removeClass("cui-icon-shrink7"),$.extend(this.options,this.original),this.resizePanel(),this.options.minimized=!1,this.options.maximized=!1,this.original=null,this._trigger("onRestore"))},collapse:function(a){var b=this.options,c=this.body(),d=this;b.collapsed!==!0&&(c.stop(!0,!0),d._trigger("beforeCollapse")!==!1&&(this.header().find("a.coral-panel-tool-collapse").addClass("coral-panel-tool-expand"),a===!0?c.slideUp("normal",function(){b.collapsed=!0,d._trigger("onCollapse")}):(c.hide(),b.collapsed=!0,d._trigger("onCollapse"))))},expand:function(a){var b=this.options,c=this.body(),d=this;b.collapsed!==!1&&(c.stop(!0,!0),d._trigger("beforeExpand")!==!1&&(this.header().find("a.coral-panel-tool-collapse").removeClass("coral-panel-tool-expand"),a===!0?c.slideDown("normal",function(){b.collapsed=!1,d._trigger("onExpand"),d._loadData(),d._doResize()}):(c.show(),b.collapsed=!1,d._trigger("onExpand"),d._loadData(),d._doResize())))}}),$.coral.panel.fit=function(a,b){b=void 0==b?!0:b;var c=a.parent()[0];return c=$(c),b?c.hasClass("coral-noscroll")||(c.addClass("coral-noscroll"),"BODY"==c.attr("tagName")&&$("html").addClass("coral-panel-fit")):c.hasClass("coral-noscroll")&&(c.removeClass("coral-noscroll"),"BODY"==c.attr("tagName")&&$("html").removeClass("coral-panel-fit")),{width:c.width(),height:c.height()}};/*! cui 2016-11-08 */
$.component("coral.colorpicker",$.coral.inputbase,{version:$.coral.version,ids:{},charMin:65,tp1:'<div class="colorpicker"><div class="colorpicker_color"><div><div></div></div></div><div class="colorpicker_hue"><div></div></div><div class="colorpicker_new_color"></div><div class="colorpicker_current_color"></div><div class="colorpicker_hex"><input type="text" maxlength="6" size="6" /></div><div class="colorpicker_rgb_r colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_g colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_h colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_s colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_submit"></div><div class="custom_color_area"></div></div>',castProperties:["customColorArray"],options:{readonlyInput:!1,readonly:!1,isLabel:!1,disable:!1,isShow:!1,showBgcolor:!0,showClose:!1,onShow:null,onBeforeShow:null,onHide:null,customColorArray:["dddddd","eeeeee","cccccc","eb1139","FF0000","700000","585858","33FF00","330000","009900","990000","FFFF66","FF3366","6666FF","0000CC","00FFFF","FF66CC","FF0099","999999","ffffff","33FFFF","ffffff","ffffff","ffffff","ffffff","ffffff"],onChange:null,onSubmit:null,color:"ff0000",livePreview:!0,flat:!1},fillRGBFields:function(a,b){var c=this.HSBToRGB(a);$(b).data("colorpicker").fields.eq(1).val(c.r).end().eq(2).val(c.g).end().eq(3).val(c.b).end()},fillHSBFields:function(a,b){$(b).data("colorpicker").fields.eq(4).val(a.h).end().eq(5).val(a.s).end().eq(6).val(a.b).end()},fillHexFields:function(a,b){$(b).data("colorpicker").fields.eq(0).val(this.HSBToHex(a)).end()},component:function(){return this.textboxWrapper},_create:function(){var a=this,b=this.options;if("string"==typeof b.color)b.color=a.HexToHSB(b.color);else if(void 0!=b.color.r&&void 0!=b.color.g&&void 0!=b.color.b)b.color=a.RGBToHSB(b.color);else{if(void 0==b.color.h||void 0==b.color.s||void 0==b.color.b)return this;b.color=a.fixHSB(b.color)}var c=$.extend({},b);c.origColor=b.color;var d="collorpicker_"+parseInt(1e3*Math.random());$(this.element).data("colorpickerId",d),this.cal=$(this.tp1).attr("id",d),c.flat?this.cal.appendTo(this.element).show():this.cal.appendTo(document.body),this._initElement(),c.fields=this.cal.find("input"),c.selector=this.cal.find("div.colorpicker_color"),c.selectorIndic=c.selector.find("div div"),c.el=this.element,c.hue=this.cal.find("div.colorpicker_hue div"),c.newColor=this.cal.find("div.colorpicker_new_color"),c.currentColor=this.cal.find("div.colorpicker_current_color"),this.cal.data("colorpicker",c),this._bindEvents(),this.fillRGBFields(c.color,this.cal.get(0)),this.fillHSBFields(c.color,this.cal.get(0)),this.fillHexFields(c.color,this.cal.get(0)),this.setHue(c.color,this.cal.get(0)),this.setSelector(c.color,this.cal.get(0)),this.setCurrentColor(c.color,this.cal.get(0)),this.setNewColor(c.color,this.cal.get(0)),c.flat&&this.cal.css({position:"relative",display:"block"}),a._trigger("onCreate",null,[])},_bindEvents:function(){this.options;this._on(this.cal.find("input"),{keyup:function(a){var b=a.charCode||a.keyCode||-1,c=$(a.target).closest("input")[0];return b>this.charMin&&90>=b||32==b?!1:void(this.cal.data("colorpicker").livePreview===!0&&this._change(c))},change:function(a){var b=$(a.target).closest("input")[0];this._change(b)},blur:function(a){this.cal.data("colorpicker").fields.parent().removeClass("colorpicker_focus")},focus:function(a){var b=$(a.target).closest("input")[0];charMin=b.parentNode.className.indexOf("_hex")>0?70:65,$(b).parent().parent().data("colorpicker").fields.parent().removeClass("colorpicker_focus"),$(b).parent().addClass("colorpicker_focus")}}),this._on(this.cal.find("span"),{mousedown:function(a){var b=$(e.target).closest("span")[0],c=$(b).parent().find("input").focus(),d={el:$(b).parent().addClass("colorpicker_slider"),max:b.parentNode.className.indexOf("_hsb_h")>0?360:b.parentNode.className.indexOf("_hsb")>0?100:255,y:a.pageY,field:c,that:this,val:parseInt(c.val(),10),preview:$(this).parent().parent().data("colorpicker").livePreview};$(document).bind("mouseup",d,this._upIncrement),$(document).bind("mousemove",d,this._moveIncrement)}}),this._on(this.cal.find(">div.colorpicker_current_color"),{click:function(a){var b=this.cal,c=this.cal.data("colorpicker").origColor;b.data("colorpicker").color=c,this.fillRGBFields(c,b.get(0)),this.fillHexFields(c,b.get(0)),this.fillHSBFields(c,b.get(0)),this.setSelector(c,b.get(0)),this.setHue(c,b.get(0)),this.setNewColor(c,b.get(0))}}),this._on(this.cal.find("div.colorpicker_color"),{mousedown:function(a){var b=$(a.target).closest("div.colorpicker_color"),c={that:this,cal:b.parent(),pos:b.offset()};c.preview=c.cal.data("colorpicker").livePreview,$(document).bind("mouseup",c,this._upSelector),$(document).bind("mousemove",c,this._moveSelector)},dblclick:function(a){var b=$(a.target).closest("div.colorpicker_color"),c={that:this,cal:b.parent(),pos:b.offset()};c.preview=c.cal.data("colorpicker").livePreview,a.data=c,this._moveSelector(a);var d=this.cal,e=d.data("colorpicker").color;d.data("colorpicker").origColor=e,this.setCurrentColor(e,d.get(0)),this.setValue(this.HSBToHex(e)),this.options.showBgcolor&&this.element.css({"background-color":"#"+this.HSBToHex(e)}),this._trigger("onSubmit",this.HSBToHex(e),this.HSBToRGB(e),d.data("colorpicker").el),this.cal.hide(),this.options.isShow=!1}}),this._on(this.cal.find("div.colorpicker_hue"),{mousedown:function(a){var b=this,c=$(a.target).closest("div.colorpicker_hue"),d={that:b,cal:c.parent(),y:c.offset().top};d.preview=d.cal.data("colorpicker").livePreview,$(document).bind("mouseup",d,b._upHue),$(document).bind("mousemove",d,b._moveHue)}}),this._on(this.cal.find("div.colorpicker_submit"),{mouseenter:function(a){var b=$(a.target).closest("div.colorpicker_submit");b.addClass("colorpicker_focus")},mouseleave:function(a){var b=$(a.target).closest("div.colorpicker_submit");b.removeClass("colorpicker_focus")},click:function(a){var b=this.cal,c=b.data("colorpicker").color;b.data("colorpicker").origColor=c,this.setCurrentColor(c,b.get(0)),this.setValue(this.HSBToHex(c)),this.options.showBgcolor&&this.element.css({"background-color":"#"+this.HSBToHex(c)}),this._trigger("onSubmit",this.HSBToHex(c),this.HSBToRGB(c),b.data("colorpicker").el),this.cal.hide(),this.options.isShow=!1}}),this._on({click:function(a){this.component().addClass("coral-state-focus"),this._show(a)},blur:function(a){this.component().removeClass("coral-state-focus"),this.setValue(this.element.val())},keyup:function(a){var b=this.element.val();this.cal.find(".colorpicker_new_color").css({"background-color":"#"+b})}}),this._on(this.cal.find(".color-div"),{click:function(a){var b=$(a.target).closest(".color-div"),c=b.attr("title");this.cal.find(".custom_show_area").css({"background-color":c}).attr("title",c)}}),this._on(this.cal.find(".custom_show_area"),{click:function(a){var b=this.cal.find(".custom_show_area").attr("title").slice(1);this.setValue(b),this.options.showBgcolor&&this.element.css({"background-color":"#"+b}),this.cal.hide(),this.options.isShow=!1}})},_initElement:function(){var a=this,b=a.options;this.className="coral-textbox-default coral-validation-colorpicker tabbable "+this.element[0].className,this.compClass="coral-colorpicker coral-textbox",this.hiddenClass="",this.classBorder="","hidden"==this.element.attr("type")&&(this.compClass=this.compClass+" hide"),this.createInput(),this.textboxWrapper=$(this.textboxWrapper),this.elementBorder=$(this.elementBorder),this.textboxHidden=$(this.textboxWrapper[0].lastChild),this.element=$(this.textboxInput);var c=$("<div class='custom_show_area' title='#ffffff'></div>");return c.appendTo(".custom_color_area"),b.customColorArray.forEach(function(a,b){var c="#"+a.toLowerCase(),d=$("<div class='color-div' title='"+c+"'></div>");d.appendTo(".custom_color_area").css({"background-color":c,position:"absolute",width:"16px",height:"16px"}),12>=b?d.css({left:18+19*b+"px",top:"10px"}):d.css({left:18+19*(b-13)+"px",top:"36px"})}),""!==$.trim(this.element.val())?this.options.value=this.element.val():this.options.value&&this.element.val(this.options.value),b.width&&this.textboxWrapper.css("width",b.width),b.height&&this._setOption("height",b.height),b.readonlyInput&&this._setReadonlyInput(),b.readonly&&this._setReadonly(),"boolean"==typeof b.isLabel&&b.isLabel?(this._setReadonly(),this.options.readonly=!0,void this.component().addClass("coral-isLabel")):("boolean"==typeof b.disabled&&b.disabled&&this._setOption("disabled",b.disabled),this.options.showClose&&this.clearIcon.css("right",this.rightPos?this.rightPos:0),this.element.attr("placeholder",b.placeholder),void(b.placeholder&&""===this.element.val()&&this._showPlaceholder()))},setValue:function(a){a=null===a||"undefined"==typeof a?"":a,this.textboxHidden.val(a),this.element.val(a),this.options.value=a,this.previous=a,""!==a&&this._hidePlaceholder()},getValue:function(){return this.textboxHidden.val()},_hidePlaceholder:function(){if(!$.support.placeholder){var a=this;a.textboxWrapper.find(".coral-textbox-placeholder-label").remove()}},_showPlaceholder:function(){if(!$.support.placeholder){var a=this,b=$("<span class='coral-textbox-placeholder-label'>"+a.options.placeholder+"</span>");$(a.element).after(b)}},_setReadonlyInput:function(){"undefined"!=typeof this.element.attr("readonly")?this.options.readonlyInput=this.element.prop("readonly"):this.options.readonlyInput&&this.element.prop("readonly",this.options.readonlyInput),this.element.prop("readonly")&&this.component().addClass("coral-readonlyInput")},_setReadonly:function(){this.options.readonlyInput=!0,this._setReadonlyInput(),this.component().removeClass("coral-readonlyInput").addClass("coral-readonly"),this.element.removeClass("tabbable")},_change:function(a,b){var c,d=$(a).parent().parent();a.parentNode.className.indexOf("_hex")>0?d.data("colorpicker").color=c=this.HexToHSB(this.fixHex($(a).val())):a.parentNode.className.indexOf("_hsb")>0?d.data("colorpicker").color=c=this.fixHSB({h:parseInt(d.data("colorpicker").fields.eq(4).val(),10),s:parseInt(d.data("colorpicker").fields.eq(5).val(),10),b:parseInt(d.data("colorpicker").fields.eq(6).val(),10)}):d.data("colorpicker").color=c=this.RGBToHSB(this.fixRGB({r:parseInt(d.data("colorpicker").fields.eq(1).val(),10),g:parseInt(d.data("colorpicker").fields.eq(2).val(),10),b:parseInt(d.data("colorpicker").fields.eq(3).val(),10)})),b&&(this.fillRGBFields(c,d.get(0)),this.fillHexFields(c,d.get(0)),this.fillHSBFields(c,d.get(0))),this.setSelector(c,d.get(0)),this.setHue(c,d.get(0)),this.setNewColor(c,d.get(0)),this._trigger("onChange",c,this.HSBToHex(c),this.HSBToRGB(c))},_upIncrement:function(a){var b=a.data.that;return b._change(a.data.field.get(0),!0),a.data.el.removeClass("colorpicker_slider").find("input").focus(),$(document).unbind("mouseup",b._upIncrement),$(document).unbind("mousemove",b._moveIncrement),!1},_moveIncrement:function(a){var b=a.data.that;return a.data.field.val(Math.max(0,Math.min(a.data.max,parseInt(a.data.val+a.pageY-a.data.y,10)))),a.data.preview&&b._change(a.data.field.get(0),!0),!1},setSelector:function(a,b){$(b).data("colorpicker").selector.css("backgroundColor","#"+this.HSBToHex({h:a.h,s:100,b:100})),$(b).data("colorpicker").selectorIndic.css({left:parseInt(150*a.s/100,10),top:parseInt(150*(100-a.b)/100,10)})},setHue:function(a,b){$(b).data("colorpicker").hue.css("top",parseInt(150-150*a.h/360,10))},setCurrentColor:function(a,b){$(b).data("colorpicker").currentColor.css("backgroundColor","#"+this.HSBToHex(a))},setNewColor:function(a,b){$(b).data("colorpicker").newColor.css("backgroundColor","#"+this.HSBToHex(a))},_moveHue:function(a){var b=a.data.that;return b._change(a.data.cal.data("colorpicker").fields.eq(4).val(parseInt(360*(150-Math.max(0,Math.min(150,a.pageY-a.data.y)))/150,10)).get(0),a.data.preview),!1},_upHue:function(a){var b=a.data.that;return b.fillRGBFields(a.data.cal.data("colorpicker").color,a.data.cal.get(0)),b.fillHexFields(a.data.cal.data("colorpicker").color,a.data.cal.get(0)),$(document).unbind("mouseup",b._upHue),$(document).unbind("mousemove",b._moveHue),!1},_moveSelector:function(a){var b=a.data.that;return b._change(a.data.cal.data("colorpicker").fields.eq(6).val(parseInt(100*(150-Math.max(0,Math.min(150,a.pageY-a.data.pos.top)))/150,10)).end().eq(5).val(parseInt(100*Math.max(0,Math.min(150,a.pageX-a.data.pos.left))/150,10)).get(0),a.data.preview),!1},_upSelector:function(a){var b=a.data.that;return b.fillRGBFields(a.data.cal.data("colorpicker").color,a.data.cal.get(0)),b.fillHexFields(a.data.cal.data("colorpicker").color,a.data.cal.get(0)),$(document).unbind("mouseup",b._upSelector),$(document).unbind("mousemove",b._moveSelector),!1},enterSubmit:function(a){$(this).addClass("colorpicker_focus")},leaveSubmit:function(a){$(this).removeClass("colorpicker_focus")},_hide:function(a){var b=this.cal?this:a.data.that;b.isChildOf(b.cal.get(0),a.target,b.cal.get(0))||(0!=b._trigger("onHide",b.cal.get[0])&&(b.cal.hide(),b.options.isShow=!1),$(document).unbind("mousedown",b._hide))},_show:function(a){if(!this.options.flat){var b=this.cal,c=this,d=this.element.parent();this.setColor(this.getValue()),this._trigger("onBeforeShow",a,b.get(0));var e=$(this.element).offset(),f=this.getViewport(),g=e.top+this.element.offsetHeight,h=e.left;return g+176>f.t+f.h&&(g-=this.element.offsetHeight+176),h+356>f.l+f.w&&(h-=356),c.options.isShow||(0!=this._trigger("onShow",a,b.get(0))&&(b.show(),this.options.isShow=!0),function i(){var a=c;a.options.isShow&&(b.css({left:$.coral.getLeft(b,d),top:$.coral.getTop(b,d)}),a.scrollTimer=setTimeout(i,200))}()),$(document).bind("mousedown",{cal:b,that:c},this._hide),!1}},isChildOf:function(a,b,c){if(a==b)return!0;if(a.contains)return a.contains(b);if(a.compareDocumentPosition)return!!(16&a.compareDocumentPosition(b));for(var d=b.parentNode;d&&d!=c;){if(d==a)return!0;d=d.parentNode}return!1},getViewport:function(){var a="CSS1Compat"==document.compatMode;return{l:window.pageXOffset||(a?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(a?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(a?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(a?document.documentElement.clientHeight:document.body.clientHeight)}},fixHSB:function(a){return{h:Math.min(360,Math.max(0,a.h)),s:Math.min(100,Math.max(0,a.s)),b:Math.min(100,Math.max(0,a.b))}},fixRGB:function(a){return{r:Math.min(255,Math.max(0,a.r)),g:Math.min(255,Math.max(0,a.g)),b:Math.min(255,Math.max(0,a.b))}},fixHex:function(a){var b=6-a.length;if(b>0){for(var c=[],d=0;b>d;d++)c.push("0");c.push(a),a=c.join("")}return a},HexToRGB:function(a){var a=parseInt(a.indexOf("#")>-1?a.substring(1):a,16);return{r:a>>16,g:(65280&a)>>8,b:255&a}},HexToHSB:function(a){return this.RGBToHSB(this.HexToRGB(a))},RGBToHSB:function(a){var b={h:0,s:0,b:0},c=Math.min(a.r,a.g,a.b),d=Math.max(a.r,a.g,a.b),e=d-c;return b.b=d,b.s=0!=d?255*e/d:0,0!=b.s?a.r==d?b.h=(a.g-a.b)/e:a.g==d?b.h=2+(a.b-a.r)/e:b.h=4+(a.r-a.g)/e:b.h=-1,b.h*=60,b.h<0&&(b.h+=360),b.s*=100/255,b.b*=100/255,b},HSBToRGB:function(a){var b={},c=Math.round(a.h),d=Math.round(255*a.s/100),e=Math.round(255*a.b/100);if(0==d)b.r=b.g=b.b=e;else{var f=e,g=(255-d)*e/255,h=(f-g)*(c%60)/60;360==c&&(c=0),60>c?(b.r=f,b.b=g,b.g=g+h):120>c?(b.g=f,b.b=g,b.r=f-h):180>c?(b.g=f,b.r=g,b.b=g+h):240>c?(b.b=f,b.r=g,b.g=f-h):300>c?(b.b=f,b.g=g,b.r=g+h):360>c?(b.r=f,b.g=g,b.b=f-h):(b.r=0,b.g=0,b.b=0)}return{r:Math.round(b.r),g:Math.round(b.g),b:Math.round(b.b)}},RGBToHex:function(a){var b=[a.r.toString(16),a.g.toString(16),a.b.toString(16)];return $.each(b,function(a,c){1==c.length&&(b[a]="0"+c)}),b.join("")},HSBToHex:function(a){return this.RGBToHex(this.HSBToRGB(a))},showPicker:function(){$(this.element).data("colorpickerId")&&this._show()},hidePicker:function(){$(this).data("colorpickerId")&&this._hide()},setColor:function(a){if("string"==typeof a)a=this.HexToHSB(a);else if(void 0!=a.r&&void 0!=a.g&&void 0!=a.b)a=this.RGBToHSB(a);else{if(void 0==a.h||void 0==a.s||void 0==a.b)return this;a=this.fixHSB(a)}if($(this.element).data("colorpickerId")){var b=this.cal;b.data("colorpicker").color=a,b.data("colorpicker").origColor=a,this.fillRGBFields(a,b.get(0)),this.fillHSBFields(a,b.get(0)),this.fillHexFields(a,b.get(0)),this.setHue(a,b.get(0)),this.setSelector(a,b.get(0)),this.setCurrentColor(a,b.get(0)),this.setNewColor(a,b.get(0))}}});/*! cui 2016-11-08 */
!function(){"use strict";function a(a,b){$(".coral-combo-wrapper").not(a).hide(),$(".coral-combo-iframePanel:visible").not(b).hide()}$(document).unbind(".coral-combobox").bind("mousedown.coral-combobox mousewheel.coral-combobox",function(b){var c=$(b.target).closest(".coral-combo-panel").length,d=$(b.target).closest(".coral-combo").length,e=$(b.target).closest(".coral-button").length;c||d&&!e||a()}),$.component("coral.combo",$.coral.inputbase,{castProperties:["triggers","showRequiredMark","hideRequiredMark","shortCut","onBlur"],version:"4.0.2",options:{panelRenderOnShow:!1,popupDialog:!1,showStar:!0,showDirection:"down",labelField:null,starBefore:!1,isInited:!1,id:null,name:null,showOnFocus:!0,iframePanel:!1,buttons:[],forceSelection:!0,width:"auto",height:22,placeholder:"",cls:"",required:!1,errMsg:null,errMsgPosition:"leftBottom",isLabel:!1,panelWidth:null,panelHeight:"auto",panelComponentCls:"",position:{my:"left top",at:"left bottom",collision:"none"},maxPanelHeight:200,multiple:!1,separator:",",valueTextSeparator:"-",postMode:"value",editable:!1,readonly:!1,readonlyInput:!0,disabled:!1,clearOnLoad:!0,hasArrow:!0,value:"",text:"",delay:300,zIndex:1e4,enableHighlight:!1,enablePinyin:!1,showClose:!1,enableFilter:!1,enterFilter:!0,query:null,filter:function(a,b){var c=$(this).attr("component-role"),d=$(this)[c]("option"),e=d.textField,f=d.valueField,g=b[e].toLowerCase(),h=b[f].toString().toLowerCase();return a=a.toLowerCase(),g.indexOf(a)>-1?"text":d.enablePinyin===!0&&pinyinEngine.toPinyin(g,!1,"").indexOf(a)>-1?!0:h.indexOf(a)>-1},onKeyUp:null,onKeyDown:null,onEnter:null,onBlur:null,onClick:null,onValidError:null,onValidSuccess:null,onShowPanel:$.noop,onHidePanel:$.noop,onChange:$.noop,triggers:null,excluded:!1},_addCacheItem:function(a){"object"==typeof a&&("undefined"==typeof this.cache&&(this.cache={}),this.cache=$.extend({},this.cache,a))},_getCacheItem:function(a){return"string"==typeof a?this.cache&&this.cache[a]?this.cache[a]:null:void 0},_removeCacheItem:function(a){this.cache&&this.cache[a]&&delete this.cache[a]},_create:function(){this._prepareInit(),this._initCombo(),this._setDefaultValue(),this._initState(),this._initData(),this._bindEvent()},_prepareInit:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.panelRendered=!1,this.dataLoaded=!1,this.search=!1,this.isInit=!1,this.isLoaded=!1,this.isInited=!1,this.currentValues=[],this.cache={},this.options.enableSearch===!0&&(this.options.readonlyInput=!1),(this.options.popupDialog||this.options.enableFilter)&&(this.options.readonlyInput=!0),this.element.hide(),this.element.attr("id")?this.element.attr("id")!=this.options.id&&(this.options.id=this.element.attr("id")):this.options.id&&this.element.attr("id",this.options.id),this.element.attr("id")||(this.options.id=this.element.uniqueId().attr("id")),this.element.attr("name")&&this.options.name?this.element.attr("name")!=this.options.name&&(this.options.name=this.element.attr("name")):!this.options.name&&this.element.attr("name")&&(this.options.name=this.element.attr("name")),this.element.attr("value")&&this.options.value?this.element.attr("value")!=this.options.value&&(this.options.value=this.element.attr("value")):!this.options.value&&this.element.attr("value")&&(this.options.value=this.element.attr("value")),"SELECT"==$(this.element)[0].tagName&&(this.transformData=this._transformData())},_initCombo:function(){this.className="coral-combo-text coral-combo-default coral-textbox-default tabbable "+this.element[0].className,this.classBorder="coral-combo-border",this.compClass="coral-combo coral-textbox",this.hiddenClass="coral-combo-value",this.uiCombo={combo:null,panel:null},this.previousValue=null,this.createInput(),this.uiCombo.combo=$(this.textboxWrapper),this.elementBorder=$(this.elementBorder),this.uiCombo.textbox=$(this.textboxInput),this.element=$(this.textboxInput),this.options.labelField&&this._createLabel(),this.options.name&&(this.element.removeAttr("name").attr("orgname",this.options.name),name=" name='"+this.options.name+"'"),this.uiCombo.panel=$("<div class='coral-combo-panel "+this.options.panelComponentCls+"'></div>").appendTo("body"),this.options.iframePanel&&(this.uiCombo.iframePanel=$("<iframe class='coral-combo-iframePanel' style='position:absolute;display:none;'></iframe>").appendTo("body")),this.uiCombo.pContent=$("<div class='coral-combo-content'></div>").appendTo(this.uiCombo.panel),this.options.enableFilter&&$("<div class='coral-combo-filter'><span class='coral-combo-filter-border'><input type='text' class='coral-combo-filterbox'></span><span class='coral-combo-search cui-icon-search2'></span></div>").appendTo(this.uiCombo.panel);var a="absolute";this.options.popupDialog&&(a="",this.uiCombo.popupDialog=$("<div class='coral-combo-popup-dialog'></div>").appendTo("body"),this.uiCombo.popupInputbox=$("<input type='text' />").appendTo(this.uiCombo.popupDialog)),0==this.options.hasArrow&&(this.elementBorder.css({"padding-right":0}),this.uiCombo.textbox.css({"padding-right":0}),this.uiClose().css({right:0})),this.uiCombo.panel.css({position:a}).addClass("coral-combo-wrapper "+this.options.cls+"-panel coral-front").hide(),this.uiCombo.textbox.attr("placeholder",this.options.placeholder),this._showPlaceholder(),this.options.buttons.length>0&&this._createButtonPanel()},_initState:function(){this.options.isLabel===!0?this._setIsLabel(this.options.isLabel):this._setReadonly(this.options.readonly),this.options.readonly||this.uiCombo.textbox.prop("readonly",this.options.readonlyInput),this.resize()},_initData:$.noop,_setDefaultValue:function(){return this.options.value?(this.setValue(this.options.value),void(this.originalValue=this.getValue())):void(this.originalValue="")},_showPlaceholder:function(a){if(!$.support.placeholder&&!this.component().find(".coral-textbox-placeholder-label").length){a=a?a:this.options.placeholder;var b=$("<span class='coral-textbox-placeholder-label'>"+a+"</span>");$(this.uiCombo.textbox).after(b)}},_hidePlaceholder:function(){$.support.placeholder||this.component().find(".coral-textbox-placeholder-label").remove()},_setIsLabel:function(a){!0===a?(this.component().removeClass("coral-readonly"),this.component().addClass("coral-isLabel"),this.uiCombo.textbox.prop("readonly",!0),this.options.emptyText&&""===this.getValue()&&this.uiCombo.textbox.val(""),this.hidePanel(),this.uiCombo.textbox.removeClass("tabbable"),this.uiCombo.textbox.removeAttr("placeholder")):(this.component().removeClass("coral-isLabel coral-readonly"),this.uiCombo.textbox.prop("readonly",this.options.readonlyInput),this.options.readonly=!1,this.uiCombo.textbox.addClass("tabbable"),this.uiCombo.textbox.attr("placeholder",this.options.placeholder)),this.options.isLabel=!!a},_setReadonlyInput:function(a){a?this.uiCombo.textbox.prop("readonly",!0):this.uiCombo.textbox.prop("readonly",!1)},_setReadonly:function(a){a?(this.element.prop("readonly",!0),this.uiCombo.textbox.prop("readonly",!0),this.uiCombo.textbox.removeClass("tabbable"),this.uiCombo.combo.find(".coral-combo-value").prop("readonly",!0)):($(this.element).prop("readonly",!1),this.uiCombo.textbox.prop("readonly",!1),this.uiCombo.textbox.addClass("tabbable"),this.uiCombo.combo.find(".coral-combo-value").prop("readonly",!1)),this.options.readonly=!!a,this.uiCombo.combo.removeClass("coral-isLabel"),this.uiCombo.combo.toggleClass("coral-readonly",this.options.readonly)},_setDisabled:function(a){a?(this.element.prop("disabled",!0),this.uiCombo.combo.find(".coral-combo-value").prop("disabled",!0),this.uiCombo.combo.find(".coral-combo-text").prop("disabled",!0),this.uiCombo.textbox.removeClass("tabbable")):($(this.element).prop("disabled",!1),this.uiCombo.combo.find(".coral-combo-value").prop("disabled",!1),this.uiCombo.combo.find(".coral-combo-text").prop("disabled",!1),this.uiCombo.textbox.addClass("tabbable")),this.options.disabled=!!a,this.uiCombo.combo.toggleClass(this.componentFullName+"-disabled coral-state-disabled",this.options.disabled)},_selectPrev:$.noop,_selectNext:$.noop,_doEnter:$.noop,_doQuery:$.noop,_addHighlight:function(a,b){if(""!==b&&a.length&&this.options.enableHighlight){a=$(a);var c,d=b.replace(/[\s]+/g," ").split(" ");a.each(function(a,e){var f=$(e),g=$(e).parent(),h=$(e).html();if(h!=b){if(f.hasClass(".coral-combobox-item-selected"))return void g.html(that._getTextFromHTML(h));if(!f.children("input").length){for(var i=0;i<d.length;i++)c=new RegExp(""+d[i],"gmi"),h=h.replace(c,'<span class="coral-keyword-highlight">'+d[i]+"</span>");f.html(h)}}})}},_getTextFromHTML:function(a){return"undefined"!=typeof a?(a=a.replace(/<\/?[^>]*>/g,""),a=a.replace(/[ | ]*\n/g,"\n"),a=a.replace(/&nbsp;/gi,"")):void 0},_clearValues:function(a){var b,c,d=this.options.valueField,e=this.currentValues,f=e.length,g=0;for(b=0;f>b;b++)for(c=0;c<a.length;c++)if(e[b]==a[c][d]){g+=1;break}return g!=f},_removeHighlight:function(a){if(a.length&&this.options.enableHighlight){a=$(a);var b=this;a.each(function(a,c){var d=$(c).parent(),e=d.html();d.html(b._getTextFromHTML(e))})}},focus:function(){if(this.options.disabled||this.options.readonly||this.options.isLabel)return!1;if(this.uiCombo.textbox.focus(),!this.dataLoaded){var a={focus:{param:null}};return this._addCacheItem(a),!0}return!0},_bindEvent:function(){var b=this,c=(this.options,this.uiCombo.combo,this.uiCombo.panel),d=this.uiCombo.iframePanel;this.options.disabled&&this.element.addClass("coral-state-disabled"),this._off(b.component());var e,f;this._on(this.uiCombo.panel.find(".coral-combo-filterbox"),{focusin:function(a){f=!0}}),this._on({"mouseenter.coral-combo-border":function(a){b.component().hasClass("coral-isLabel")||b.component().hasClass("coral-readonly")||(b.uiCombo.combo.addClass("coral-textbox-hover"),this._updateTitle())},"mouseleave.coral-combo-border":function(a){b.component().hasClass("coral-isLabel")||b.component().hasClass("coral-readonly")||b.uiCombo.combo.removeClass("coral-textbox-hover")},"keydown.coral-combo-text":function(a){this._doKeyDown(a,!1);var b=this.options;b.shortCut&&$.coral.callFunction(b.shortCut,event,this)},"keyup.coral-combo-text":function(a){this.options.readonly||this.options.isLabel||this._trigger("onKeyUp",a,{})},"blur.coral-combo-text":function(a){this._setHv(a,"blur")},"focusin.coral-combo-text":function(a){this.options.readonly||this.options.isLabel||(this.component().addClass("coral-state-focus"),e||this._trigger("onFocus",a))},"focusout.coral-combo-text":function(a){return this.cancelBlur?void delete this.cancelBlur:void(this.options.readonly||this.options.isLabel||this._delay(function(){return e?void(e=!1):(this.component().removeClass("coral-state-focus"),f?void(f=!1):(this.hidePanel(),void this._trigger("onBlur",a)))},100))},"click.coral-combo-text":function(a){(!b.component().hasClass("coral-isLabel")&&!b.component().hasClass("coral-readonly")||1!=this.options.hasArrow||this.options.readOnlyInput)&&(b.component().hasClass("coral-state-focus")&&(this.options.popupDialog&&this.options.showOnFocus===!0?this.uiCombo.popupDialog.dialog("open"):c.is(":visible")?this.hidePanel():this.showPanel()),this.options.enableFilter&&(f=!0),b._trigger("onClick",a))},"mousedown.coral-combo-arrow":function(a){this.component().hasClass("coral-isLabel")||this.component().hasClass("coral-readonly")||this.component().hasClass("coral-state-focus")&&(e=!0)},"click.coral-combo-arrow":function(g){a(c,d),b.component().hasClass("coral-isLabel")||b.component().hasClass("coral-readonly")||(b.component().hasClass("coral-state-focus")&&(e=!0),this.options.enableFilter&&(f=!0),this.focus(),b.options.popupDialog?b.uiCombo.popupDialog.dialog("open"):c.is(":visible")?b.hidePanel():b.showPanel())},"click.coral-input-clearIcon":function(a){this.component().hasClass("coral-state-focus")&&(e=!0),this.clear(),this.options.placeholder&&this._showPlaceholder()},combogridonshowpanel:function(a){b._removeGridHighlights(),b._scrollTo(b.getValue()),b.grid().grid("refresh")}}),this._on(this.uiCombo.panel.find(".coral-combo-filterbox"),{keydown:function(a){this._doKeyDown(a,!0)}}),this._on(this.uiCombo.panel.find(".coral-combo-search"),{click:function(a){return a.preventDefault(),this._filter(a,!0),!1}}),this._on(this.uiCombo.panel.find(".coral-combo-filterbox"),{focusout:function(a){return this.cancelBlur?void(this.cancelBlur=!1):void this._delay(function(){this.hidePanel()},100)}})},_updateTitle:function(){var a=$("<span style = 'visibility: hidden'>"+this.getText()+"</span>").appendTo("body");this.component().outerWidth()<a.width()&&this.component().attr("title",this.getText()),a.remove()},_doKeyDown:function(a,b){var c=this.options,d=this.panel();if(this.previousValue=$(a.target).val(),!c.readonly&&!c.isLabel){var e=$.coral.keyCode;switch(a.keyCode){case e.TAB:break;case e.ENTER:a.preventDefault(),this._doEnter(a),this._setHv(a),this._trigger("onEnter",a,{});break;case e.ESCAPE:this.hidePanel();break;case e.UP:a.preventDefault(),c.readonly===!1&&(d.is(":visible")?c.onSelectPrev?this._trigger("onSelectPrev",a):this._selectPrev(a):this.showPanel());break;case e.DOWN:a.preventDefault(),c.readonly===!1&&(d.is(":visible")?c.onSelectNext?this._trigger("onSelectNext",a):this._selectNext(a):this.showPanel());break;default:0==this.options.readonlyInput&&this._filter(a,b)}this._hidePlaceholder(),this._trigger("onKeyDown",a)}},_setHv:function(a,b){var c=$(a.target),d=c.val();d=this.options.multiple?d.split(this.options.separator):[d],this._showItems();var e=!0;if("blur"==b&&(e=d.toString()!=this.previousValue),e){var f=(this.options.textField,this.options.valueField,this._checkMathch(d,!0));f?this.setValues(f.valarr):(c.val(""),this.setValues([""]))}},_searchFilter:$.noop,_filter:function(a,b){var c=this,d=this.options,e=this.panel();return c.timer&&clearTimeout(c.timer),e.is(":visible")||c.showPanel(),c.timer=setTimeout(function(){var f=$(a.target).val();if(b&&(f=e.find(".coral-combo-filterbox").val()),f=c.options.multiple?f.split(d.separator):[f],f!=c.previousValue){d.query?d.query.call(c.element,f):(c.search=!0,c._doQuery(f));c.options.textField,c.options.valueField;if(!b){var g=c._checkMathch(f,!1);c.setValues(g.valarr,!0,!0)}c.resizeIframePanel()}},d.delay),!1},_formatValue:function(a){return a},_setOption:function(a,b){return"id"!==a&&"name"!==a?("readonly"===a&&this._setReadonly(b),"readonlyInput"===a&&this._setReadonlyInput(b),"disabled"===a&&this._setDisabled(b),"data"===a&&(this.data=b),this._super(a,b),"isLabel"===a?void this._setIsLabel(b):void("labelField"===a&&this.labelPanel.html(b))):void 0},_destroy:function(){this.panel().remove(),this.options.iframePanel&&this.uiCombo.iframePanel.remove(),this.component().replaceWith(this.element),this.options.name&&this.element.removeAttr("orgname").attr("name",this.options.name),this.element.show(),this.element.css(this.originalCss)},component:function(){return this.uiCombo.combo},panel:function(){return this.uiCombo.panel},uiArrow:function(){return this.uiCombo.combo.find("span.coral-combo-arrow")},uiClose:function(){return this.uiCombo.combo.find("span.coral-input-clearIcon")},uiBorder:function(){return this.component().find("span.coral-combo-border")},resize:function(a){var b=this.options,c=this.uiCombo.combo;this.uiCombo.panel,this.elementBorder;if(a&&(b.width=a),"auto"!=b.width&&"item"!=b.width){if(isNaN(b.width)){var d=this.element.parent(":first"),e=null;a=this.element.outerWidth(),d&&"BODY"!==d.get(0).tagName&&(e=d.outerWidth(),a>e&&(a=e)),b.width=a}c.outerWidth(b.width)}},resizeIframePanel:function(){var a,b=(this.options,this.uiCombo.combo,this.uiCombo.panel),c=this.uiCombo.iframePanel||$();a=b.height(),c.css("height",a)},_initPanel:function(){var a=this.options,b=(this.uiCombo.combo,this.elementBorder),c=this.uiCombo.panel,d=a.panelHeight;this._renderItems(this.options.data),this.panelRendered=!0,this.lazyPanelHtml="",c.css("width",a.panelWidth?a.panelWidth:b.outerWidth()),c.css("height",d),isNaN(d)&&(this.uiCombo.pContent.css({"max-height":a.maxPanelHeight+"px"}),this.uiCombo.popupDialogTree&&this.uiCombo.popupDialogTree.css({"max-height":a.maxPanelHeight+"px"})),this.options.enableFilter&&!isNaN(d)?this.uiCombo.pContent.height(a.panelHeight-30):"auto"==d?this.uiCombo.pContent.height(""):this.uiCombo.pContent.height(d-2),this.options.iframePanel&&this.uiCombo.iframePanel.css("height",c.outerHeight())},showPanel:function(){var a=this,b=this.options,c=this.uiCombo.combo,d=this.elementBorder,e=this.options.showDirection,f=this.uiCombo.panel,g=this.uiCombo.iframePanel||$();if(f.is(":hidden")){var h=$(".coral-front:visible").map(function(){return+$(this).css("z-index")}).get(),i=Math.max.apply(null,h);i>=+f.css("z-index")&&(f.css("z-index",i+1),this.options.iframePanel&&g.css("z-index",i)),this._initPanel(),this._PanelInited=!0,f.show(0,function(){a.resizeIframePanel(),g.show(),function h(){f.is(":visible")&&(f.css({left:$.coral.getLeft(f,d),top:$.coral.getTop(f,d,e),width:b.panelWidth?b.panelWidth:d.outerWidth()}),a.options.iframePanel&&g.css({left:$.coral.getLeft(g,d),top:$.coral.getTop(g,c,e),width:b.panelWidth?b.panelWidth:d.outerWidth()}),setTimeout(h,200))}(),a.uiCombo.panel.find(".coral-combo-filterbox").focus(),a._trigger("onShowPanel",null,{}),a._scrollTo(a.getValue())})}b.enableFilter&&this.setValues(this.getValues())},hidePanel:function(){this.uiCombo.panel.hide(),this.uiCombo.iframePanel&&this.uiCombo.iframePanel.hide(),this._trigger("onHidePanel",null,{})},disable:function(){this._setDisabled(!0)},enable:function(){this._setDisabled(!1)},show:function(){this._super()},hide:function(){this._super(),this.hidePanel()},hideErrors:function(){$.validate.hideErrors(this.uiBorder()),this.component().removeClass("coral-combo-error")},clear:function(){this.setValues([],!0,!1)},getOldText:function(){return this.oldText},reset:function(){this.setValue(this.originalValue)},getText:function(){return this.uiCombo.combo.find("input.coral-combo-text").val()},_setText:function(a){var b=this.uiCombo.combo.find("input.coral-combo-text");b.val(a),this.previousValue=a},setText:function(a){this._setText(a)},getValues:function(){var a=[];return this.dataLoaded?(this.uiCombo.combo.find("input.coral-combo-value").each(function(){a.push($(this).val())}),a):this.currentValues},setValues:function(a,b,c){var d=this.getValues(),e=this.options,f=0,g=[],h=[];a=a||[],this.oldValues=d;var i=[],j="",k="";if(this.uiCombo.combo.find("input.coral-combo-value").remove(),a.length>1||""!=a[0]){for(f=0;f<a.length;f++)j="",k="",this.options.name&&(j=" name='"+this.options.name+"' "),i.push("<input type='hidden' "+j+" value='"+this._formatValue(a[f])+"' class='coral-combo-value' />");this.uiCombo.combo.append(i.join(""))}for(f=0;f<d.length;f++)g[f]=d[f];for(f=0;f<a.length;f++)for(var l=0;l<g.length;l++)if(a[f]==g[l]){h.push(a[f]),g.splice(l,1);break}if(a.length&&this.options.placeholder&&this._hidePlaceholder(),"item"==e.width){var m=$("<div style = 'visibility:hidden;'><span>"+this.getText()+"</span></div>").appendTo("body"),n=this.component().find(".coral-textbox-default"),o=parseInt(n.css("padding-left"))+parseInt(n.css("padding-right")),p=this.uiArrow().outerWidth()+2*parseInt(this.uiArrow().css("right")),q=m.find("span").outerWidth()+o+p;this.resize(q),m.remove(),e.width="item"}h.length==a.length&&a.length==d.length||!b||(this.options.multiple?this._trigger("onChange",null,{value:a,newValue:a,newText:this.getText(),text:this.getText(),oldValue:d,oldText:this.getOldText()}):this._trigger("onChange",null,{value:a[0],newValue:a[0],newText:this.getText(),text:this.getText(),oldValue:d[0],oldText:this.getOldText()}))},getValue:function(){return this.getValues().join(this.options.separator)},setValue:function(a,b,c){a=a||"",a=a.split(this.options.separator),this.setValues(a,b)},getSelectedItems:function(){for(var a=this.getValues(),b=[],c=this.options.data,d=0;d<a.length;d++)for(var e=0;e<c.length;e++){var f=c[e];if(a[d]==f.id)for(var g in f)b.push(g+"="+f[g]+"\n")}return b},refresh:function(){this.destroy(),this.component().remove(),this._create()}})}();/*! cui 2016-11-08 */
!function(){"use strict";var a=0;$.component("coral.combobox",$.coral.combo,{version:"4.0.3",castProperties:["data","buttons","formatter","shortCut","onShowPanel","onBlur"],options:{cls:"",valueField:"value",textField:"text",panelRenderOnShow:!1,mode:"local",method:"post",url:null,data:[],selectedIndex:null,buttons:[],width:"auto",showText:!0,emptyText:null,postMode:"value",formatter:function(a){var b=$(this).combobox("option","textField");return a[b]},loader:function(a,b,c){var d=$(this),e=d.combobox("option","url");return e?($.ajax({type:d.combobox("option","method"),url:e,data:a,dataType:"json",success:function(a){b(a)},error:function(){c.apply(this,arguments)}}),!1):!1},beforeLoad:$.noop,onLoad:$.noop,onError:$.noop,onShowPanel:$.noop,beforeSelect:$.noop,onSelect:$.noop,unSelect:$.noop},_create:function(){var b=this,c=null;new Date;this.data=this.data||[],a++,b.options.itemIdPrefix="combobox_i"+a,this.element.addClass("coral-form-element-combobox coral-validation-combobox ctrl-form-element");var d=$.coral.toFunction(this.options.onShowPanel);c=function(a){d&&d.apply(b.element,[a])},this.options.onShowPanel=c,this._super(),this._on(this.uiCombo.panel,{mouseover:function(a){$(a.target).closest(".coral-combobox-item").addClass("coral-combobox-item-hover")},mouseout:function(a){$(a.target).closest(".coral-combobox-item").removeClass("coral-combobox-item-hover")},mousedown:function(a){this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var b=$(a.target).closest(".coral-combobox-item"),c=b.attr("value");if(!$(a.target).closest(".coral-combo-filterbox").length){if(!b.length||b.hasClass("coral-combobox-item-disabled"))return!1;var d=this.getRowIndex(c);return!1===this._trigger("beforeSelect",null,[{item:this.options.data[d]},{data:this.options.data[d]}])?!1:(this.options.multiple?(this.oldText=this.uiCombo.textbox.val(),""===c?(this.clear(),this.hidePanel(),this.select(c)):(this.options.emptyText&&this.unselect(""),b.hasClass("coral-combobox-item-selected")?(this.unselect(c),b.removeClass("coral-combobox-item-selected")):this.select(c))):(this.oldText=this.uiCombo.textbox.val(),this.hidePanel(),this.select(c)),!1)}}}),this.options.isLabel&&this.options.emptyText&&""===this.getValue()&&this.uiCombo.textbox.val("")},_initData:function(){return this.options.url?this._request(this.options.url):this.options.data.length?this.loadData(this.options.data):this.loadData(this.transformData)},_renderItems:function(a){var b,c=this.options,d=(this.panel(),[]),e=[],f="",g=$.coral.toFunction(this.options.formatter),h=$.coral.toFunction(this.options.itemattr);for(b=0;b<a.length;b++){var i=a[b],j=i[c.valueField],k=i[c.textField],l=1==!!i.hidden?"hidden":"",m="",n=k;if(g&&(n=g.call(this.element,a[b])),$.isFunction(h)){var o=h.apply(this.element[0],[{item:a[b]}]);if(!$.isEmptyObject(o)){o.hasOwnProperty("style")&&(m+=o.style,delete o.style),o.hasOwnProperty("class")&&(l+=" "+o["class"],delete o["class"]);try{delete o.role}catch(p){}for(attrName in o)o.hasOwnProperty(attrName)&&(f+=" "+attrName+"="+o[attrName])}e.push("<div class='coral-combobox-item "+l+f+"' style='"+m+"' id='"+this.options.itemIdPrefix+"_"+b+"' value='"+j+"'>"+n+"</div>")}else e.push("<div class='coral-combobox-item "+l+" ' id='"+this.options.itemIdPrefix+"_"+b+"' value='"+j+"'>"+n+"</div>");i.selected&&-1===$.inArray(j,d)&&d.push(this.getModeValue(j,k))}return this.lazyPanelHtml=e.join(""),this.uiCombo.pContent.html(this.lazyPanelHtml),d},loadData:function(a,b,c){var d=this.options,e=(this.panel(),this),f=c||"onLoad",g=($.coral.toFunction(this.options.formatter),{}),h=[],i=!1;a instanceof Array||(a=[]),this.data=a||[],this.options.data=a||[],d.clearOnLoad&&(i=e._clearValues(this.data)),this.uiCombo.pContent.empty(),this.options.emptyText&&(a.length>0&&""===a[0][this.options.valueField]||(g[this.options.valueField]="",g[this.options.textField]=this.options.emptyText,a.unshift(g)));h=this._renderItems(this.data),0==h.length&&!this.currentValues.length&&this.options.selectedIndex&&a[this.options.selectedIndex]&&(h=[a[this.options.selectedIndex].value]),this.options.panelRenderOnShow||(this.uiCombo.pContent.html(this.lazyPanelHtml),this.panelRendered=!0),this.currentValues.length&&!i&&(h=this.currentValues),this.isInit||(this.isInit=!0,this.originalValue=h.join(",")),this.dataLoaded=!0,d.multiple?this.setValues(h,!1,b):(h=h.length?[h[0]]:[],this.setValues(h,!1,b)),this._trigger(f,null,[a])},localFilter:function(a){for(var b=this.getData(),c=this.panel().find(".coral-combobox-item"),d=0;d<b.length;d++)if($(c[d]).hide(),a.apply(this.element,[b[d]])){b[d][this.options.valueField],b[d][this.options.textField];$(c[d]).show()}},_scrollTo:function(a){var b,c=this.panel().find(".coral-combo-content"),d=this.getEl(a);d.length&&(d.position().top<=0?(b=c.scrollTop()+d.position().top,c.scrollTop(b)):d.position().top+d.outerHeight()>c.height()&&(b=c.scrollTop()+d.position().top+d.outerHeight()-c.height(),c.scrollTop(b)))},_transformData:function(){var a=this.options,b=[];return $(">option",this.element).each(function(){var c={};c[a.valueField]=void 0!==$(this).attr("value")?$(this).attr("value"):$(this).html(),c[a.textField]=$(this).html(),c.selected=$(this).attr("selected"),b.push(c)}),b},_showItems:function(){this.uiCombo.panel.find(".coral-combobox-item").show()},_doQuery:function(a){var b=this.options,c=this.options.filter;if("remote"==b.mode)this._request(null,{q:a},!0);else{var d=this.panel(),e=this.getData(),f=d.find(".coral-combobox-item");f.hide(),this._removeHighlight(this.uiCombo.pContent.find("span.coral-keyword-highlight")),this.uiCombo.pContent.find(".coral-combobox-item-selected").removeClass("coral-combobox-item-selected"),this.uiCombo.pContent.find(".coral-item-focus").removeClass("coral-item-focus");for(var g=0;g<e.length;g++)for(var h=pinyinEngine.toPinyin(e[g][b.textField],!1,""),i=0;i<a.length;i++){var j=c.apply(this.element,[a[i],e[g]]);if(j){var k=e[g][b.valueField].toString(),l=e[g][b.textField];(l.indexOf(a[i])>-1||k.indexOf(a[i])>-1||h.indexOf(a[i])>-1)&&(-1!=$.inArray($(f[g]).attr("value"),this.hideValueArr)?$(f[g]).hide():($(f[g]).show(),l==a[i]?($(f[g]).addClass("coral-combobox-item-selected"),this._removeHighlight($(f[g]).find("span.coral-keyword-highlight"))):"text"==j&&this._addHighlight($(f[g]),a[i])))}}}},_checkMathch:function(a,b){var c=[],d=[],e=this.options,f=e.textField,g=e.valueField;b&&this._showItems();var h,i,j=!1,k=this.data,l="",m={};if(e.multiple)for(h=0;h<a.length;h++){for(i=0;i<k.length;i++)if(k[i][f]!=a[h]&&k[i][g]!=a[h]&&(m[h.toString()]=!0),k[i][f]==a[h]){l=this.getModeValue(k[i][g],k[i][f]),c.push(l),j=!0;break}j||e.forceSelection||(!m[h.toString()]&&!b||b)&&(c.push(a[h]),d.push(a[h])),j=!1}else{var n=-1;for(h=0;h<k.length;h++)k[h][f]==a[0]&&(n=-1===n?h:n,j=!0),k[h][f]!=a[0]&&k[h][g]!=a[0]&&(m[0]=!0);j&&(l=this.getModeValue(k[n][g],k[n][f]),c.push(l)),j||e.forceSelection||(!m[0]&&!b||b)&&(c.push(a[0]),d.push(a[0]))}return{valarr:c,textarr:d}},_request:function(a,b,c){var d=this,e={},f=[],g=this.options.loader,h=!1;if(a||d.options.url?!a&&d.options.url&&(a=d.options.url):a=[],"string"!=typeof a?(e=a,e.data?f=e.data:e.url?(a=e.url,d.options.url=e.url,h=!0):e instanceof Array?f=a:e.url||e.data||d.options.url?e.url||e.data||!d.options.url||(a=d.options.url,h=!0):f=[]):(d.options.url=a,h=!0),h){if(b=b||{},0==this._trigger("beforeLoad",null,[b]))return;g.apply(this.element,[b,function(a){var b=e.onLoad;d.loadData(a,c,b),d._loadedHandler()},function(){d._trigger("onError",null,arguments)}])}else{var i=e.onLoad;d.loadData(f,c,i)}},_loadedHandler:function(){var a=this._getCacheItem("setValues");a&&(this.setValues(a.values,a.triggerOnChange,a.remainText),this._removeCacheItem("setValues"));var b=this._getCacheItem("focus");b&&this._removeCacheItem("focus")},_selectItems:function(a,b){var c=this.panel(),d=null,e=null,f=c.find(".coral-item-focus:visible"),g=":last";return a&&(g=":first"),f.removeClass("coral-item-focus"),f.length?e=f.attr("value"):(f=d=c.find(".coral-combobox-item-selected:visible"+g),d.length&&(e=d.attr("value"))),"prev"==b?0===f.prevAll(":visible").length?(f=c.find(".coral-combobox-item:visible:last"),f.addClass("coral-item-focus")):f.prevAll(":visible:eq(0)").addClass("coral-item-focus"):0===f.nextAll(":visible").length?(f=c.find(".coral-combobox-item:visible:first"),f.addClass("coral-item-focus")):f.nextAll(":visible:eq(0)").addClass("coral-item-focus"),e},_selectPrev:function(){var a=this.panel(),b=this._selectItems(!0,"prev"),c=a.find('.coral-combobox-item[value="'+b+'"]'),d=null,e=null;c.length?d=c.prevAll(":visible:eq(0)"):c=a.find(".coral-combobox-item:visible:last"),null!==d&&0===d.length&&(d=a.find(".coral-combobox-item:visible:last")),e=d?d.attr("value"):c.attr("value"),this.select(e),this._scrollTo(e)},_selectNext:function(){var a=this.panel(),b=this._selectItems(!0,"next"),c=a.find('.coral-combobox-item[value="'+b+'"]'),d=null,e=null;c.length?d=c.nextAll(":visible:eq(0)"):c=a.find(".coral-combobox-item:visible:first"),d&&0==d.length&&(d=a.find(".coral-combobox-item:visible:first")),e=d?d.attr("value"):c.attr("value"),this.select(e),this._scrollTo(e)},_doEnter:function(a){var b,c=this.panel(),d=this.getValues(),e=c.find(".coral-item-focus:visible"),f=this.getData(),g=this.options,h=e.attr("value");if(h){var i="",j=0;for(b=0;b<f.length;b++)h==f[b][g.valueField]&&(j=b);i=this.getModeValue(h,f[j][g.textField]),this.options.multiple?-1==$.inArray(i,d)?this.select(h):this.unselect(h):this.hidePanel()}},_formatValue:function(a){var b=this.getData(),c=this.options,d=c.valueField,e=c.textField,f=0,g=null;if("text"===c.postMode||"value-text"===c.postMode)for(f=0;f<b.length;f++)if(g=b[f],""!=a&&a==g[d]){if("text"===c.postMode)return g[e];if("value-text"===c.postMode)return a+c.valueTextSeparator+g[e]}return a},_destroy:function(){this.element.removeClass("coral-validation-combobox"),this.element.removeClass("coral-form-element-combobox"),this._super()},_getOnlyValues:function(){var a=this.getData(),b=this.options,c=[],d=0;if(!this.currentValues||!this.currentValues[0]&&1===this.currentValues.length)return c;for(;d<this.currentValues.length;d++){var e=this.currentValues[d],f=0,g=b.valueField,h=b.textField,i=null;if("value-text"===b.postMode&&(e=e.split(b.valueTextSeparator)[0],c.push(e)),"value"===b.postMode&&c.push(e),"text"===b.postMode)for(;a&&f<a.length;f++)if(i=a[f],i[h]==e){c.push(i[g]);break}}return c},_getCurrentValues:function(){var a=(this.getData(),this.options,[]);return!this.currentValues||!this.currentValues[0]&&1===this.currentValues.length?a:this.currentValues},getData:function(){return this.data||[]},setValues:function(a,b,c){var d=this.options,e=this.getData(),f=this.panel(),g=c,h=0,i=(this.getValues()||[],[]),j=[],k=null,l=null,m=null;if("object"==typeof g&&(c=g.remainText,b=g.triggerOnChange),this.currentValues=a,this.dataLoaded){for(f.find(".coral-combobox-item-selected").removeClass("coral-combobox-item-selected"),h=0;h<a.length;h++){l=a[h],m=l;var n=this.getRowIndex(l);if(n>-1){m=e[n][d.textField],k=e[n][d.valueField];this._getItemByIndex(n).addClass("coral-combobox-item-selected");d.emptyText&&""==l?(this.uiCombo.textbox.attr("placeholder",d.emptyText),this._showPlaceholder(d.emptyText),m=""):this._hidePlaceholder(),j.push(m),i.push(l)}else 0>n&&!d.forceSelection&&(j.push(m),i.push(l))}c||this._setText(j.join(d.separator));var o=this._getMinus(i,a);(o.length&&i.length||!i.length)&&(j=j.concat(o),c||this._setText(j.join(d.separator)),i=a),this._super(i,b,c)}},_getMinus:function(a,b){var c=[];return $.each(b,function(b,d){-1==$.inArray(d,a)&&c.push(d)}),c},getEl:function(a){var b=this.getRowIndex(a),c=b;return $("#"+this.options.itemIdPrefix+"_"+c)},_getItemByIndex:function(a){var b=a;return $("#"+this.options.itemIdPrefix+"_"+b)},getRowIndex:function(a){for(var b=this.options,c=this.getData(),d=b.postMode,e=0;e<c.length;e++){if("value"==d&&c[e][b.valueField]==a)return e;if("text"==d&&c[e][b.textField]==a)return e;if("value-text"==d&&c[e][b.valueField]==a.split(b.valueTextSeparator)[0])return e}return-1},clear:function(){var a=this.panel();this._super(),a.find(".coral-combobox-item-selected").removeClass("coral-combobox-item-selected"),a.find(".coral-item-focus").removeClass("coral-item-focus")},reload:function(a){this._request(a)},select:function(a){var b,c,d=this.options,e=this.getData();a=$.trim(a),c=d.multiple?this.getValues():[];var f="",g=0;for(b=0;b<e.length;b++)a==e[b][d.valueField]&&(g=b);for(f=this.getModeValue(a,e[g][d.textField]),b=0;b<c.length;b++)if(c[b]==f)return;c.push(f),this.setValues(c,!0,!1),this._trigger("onSelect",null,[{item:e[g],value:a,text:e[g][d.textField]}])},getModeValue:function(a,b){var c;return"value"==this.options.postMode&&(c=a),"text"==this.options.postMode&&(c=b),"value-text"==this.options.postMode&&(c=a+"-"+b),c},unselect:function(a){var b,c=this.options,d=this.getData(),e=this.getValues(),f=0;for(b=0;b<d.length;b++)a==d[b][c.valueField]&&(f=b);for("value"==this.options.postMode&&(a=a),"text"==this.options.postMode&&(a=d[f][c.textField]),"value-text"==this.options.postMode&&(a=a+"-"+d[f][c.textField]),b=0;b<e.length;b++)if(e[b]==a){e.splice(b,1),this.setValues(e,!0,!1),this._trigger("onSelect",null,[{item:d[f],value:a,text:d[f][c.textField]}]);break}},showPanel:function(){this._removeHighlight(this.uiCombo.pContent.find("span.coral-keyword-highlight"));var a,b=0;if(this._super(),this.hideValueArr)for(;b<this.hideValueArr.length;b++)a=this.hideValueArr[b],this.uiCombo.pContent.find('.coral-combobox-item[value="'+a+'"]').addClass("hidden")},addOption:function(a){var b=0,c=null,d=this.options.valueField,e=this.options.textField,f=a[d],g=a[e];if(!(d in a&&e in a))return $.message&&$.message("JSON格式不正确!"),!1;for(b=0;b<this.data.length;b++)if(a[d]==this.data[b][d]||a[e]==this.data[b][e])return $.message&&$.message("当前选项已存在!"),!1;return c=$('<div class="coral-combobox-item"></div>'),c.attr("value",f),this.options.formatter?c.html(this.options.formatter.call(this.element,a)):c.html(g),this.data.length>0&&""==this.data[0][d]?(this.data.splice(1,0,a),c.insertAfter(this.uiCombo.pContent.find(":first-child"))):(this.data.unshift(a),c.prependTo(this.uiCombo.pContent)),!0},removeOption:function(a){var b=null,c=null,d=0,e=this.options.valueField,f=null;if("number"==typeof a){if(a>this.data.length)return;b=this.data[d],f=a}if("string"==typeof a&&(c=a),"object"==typeof a){if(!(e in a))return;c=a[e]}if(null!==c)for(;d<this.data.length;d++)if(c==this.data[d][e]){b=this.data[d],f=d;break}null!==f&&(this.data.splice(f,1),this.uiCombo.pContent.find('.coral-combobox-item[value="'+c+'"]').remove())},clearOptinons:function(){this.uiCombo.pContent.empty(),this.clear()},showOption:function(a){var b;if("number"==typeof a)b=this.uiCombo.pContent.find(".coral-combobox-item:eq("+a+")");else if("string"==typeof a)b=this.uiCombo.pContent.find('.coral-combobox-item[value="'+a+'"]');else if("object"==typeof a){if(!(this.options.valueField in a))return;b=this.uiCombo.pContent.find('.coral-combobox-item[value="'+a[this.options.valueField]+'"]')}else this.uiCombo.pContent.find(".coral-combobox-item").removeClass("hidden"),this.hideValueArr=null;b&&b.length>0&&(b.removeClass("hidden"),this.hideValueArr&&$.inArray(b.attr("value"),this.hideValueArr)>-1&&this.hideValueArr.splice($.inArray(b.attr("value"),this.hideValueArr),1))},hideOption:function(a){this.hideValueArr||(this.hideValueArr=[]);var b;if("number"==typeof a)b=this.uiCombo.pContent.find(".coral-combobox-item:eq("+a+")");else if("string"==typeof a)b=this.uiCombo.pContent.find('.coral-combobox-item[value="'+a+'"]');else{if(!(this.options.valueField in a))return;b=this.uiCombo.pContent.find('.coral-combobox-item[value="'+a[this.options.valueField]+'"]')}b&&b.length>0&&(b.addClass("hidden"),-1==$.inArray(b.attr("value"),this.hideValueArr)&&this.hideValueArr.push(b.attr("value")))}})}();/*! cui 2016-11-08 */
$.component("coral.combotree",$.coral.combo,{version:"4.0.3",castProperties:["data","rootNode","buttons","shortCut"],options:{valueField:"id",textField:"name",panelRenderOnShow:!1,mode:"local",method:"post",url:null,dialogMaxHeight:500,data:null,buttons:[],postMode:"value",multiple:null,simpleDataEnable:!1,simpleDataIdKey:"id",simpleDataPIdKey:"pId",simpleDataRootPId:null,rootNode:!1,radioType:"level",showRootNode:!0,allowPushParent:!0,traversal:!1,cascadeCheck:!1,formatter:function(a){var b=$(this).combotree("option","textField");return a[b]},loader:function(a,b,c){var d=$(this),e=d.combotree("option","url");return e?void $.ajax({type:d.combotree("option","method"),url:e,data:a,dataType:"json",success:function(a){b(a)},error:function(a){c.apply(this,arguments)}}):!1},beforeClick:null,beforeLoad:$.noop,onLoad:$.noop,onError:$.noop,onSelect:$.noop,unSelect:$.noop,onExpand:null,onClick:null},tree:function(){return $("#"+$(this.element).attr("id")+"_tree")},_filterLocalTree:function(a){var b=$("#"+$(this.element).attr("id")+"_tree");b.tree("filterNodesByParam",a)},_create:function(){var a=this,b=null;this.element.addClass("coral-form-element-combotree coral-validation-combotree coral-combobox-f ctrl-form-element"),b=function(){},this.options.onShowPanel=b,this._super(),this.options.popupDialog&&(this.uiCombo.popupInputbox=this.uiCombo.popupInputbox.textbox({componentCls:"coral-combo-popup-input",icons:[{icon:"cui-icon-search2",click:function(b,c){a._filterLocalTree({name:c.value})}}],onKeyUp:function(b,c){a._filterLocalTree({name:c.value}),b.stopPropagation()}}),this.uiCombo.popupDialog.dialog({autoOpen:!1,title:"下拉树",maxHeight:"string"==typeof this.options.dialogMaxHeight?parseInt(this.options.dialogMaxHeight):this.options.dialogMaxHeight,height:"auto",width:"auto",modal:!0,resizable:!1,buttons:{"确定":function(b){var c=$.data(a.uiCombo.popupInputbox,"value"),d=$.data(a.uiCombo.popupInputbox,"text");c&&a.setValues(c,!0,d),$(this).dialog("close")},"关闭":function(a){$(this).dialog("close")}}})),this.uiCombo.panel.unbind().bind("mouseover",function(a){$(a.target).closest(".coral-combobox-item").addClass("coral-combobox-item-hover")}).bind("mouseout",function(a){$(a.target).closest(".coral-combobox-item").removeClass("coral-combobox-item-hover")}).bind("mousedown",function(b){return a.cancelBlur=!0,a._delay(function(){delete a.cancelBlur},100),!1})},_getSetting:function(){var a=this,b={simpleDataEnable:this.options.simpleDataEnable,simpleDataIdKey:this.options.simpleDataIdKey,simpleDataPIdKey:this.options.simpleDataPIdKey,simpleDataRootPId:this.options.simpleDataRootPId,checkable:null==this.options.multiple?this.options.checkable:this.options.multiple,chkStyle:this.options.chkStyle,radioType:this.options.radioType,showRootNode:this.options.showRootNode,rootNode:this.options.rootNode,chkboxType:this.options.cascadeCheck?{Y:"",N:""}:{Y:"ps",N:"ps"},beforeClick:function(b,c){if(!a.options.allowPushParent&&c.isParent)return!1;var d=$.coral.toFunction(a.options.beforeClick);return a.options.multiple?!1:a.options.checkable?!1:$.isFunction(d)?d(b,c):!0},onClick:function(b,c,d,e){var f=[],g=[];if(f.push(d.name),g.push(d.id),a.options.traversal)for(var h=d.getParentNode();h;)f.push(h.name),h=h.getParentNode();return a.options.popupDialog?($.data(a.uiCombo.popupInputbox,"value",g.reverse()),$.data(a.uiCombo.popupInputbox,"text",f.reverse())):a.setValues(g.reverse(),!0,f.reverse()),(!a.options.multiple&&!d.isParent||!a.options.multiple&&a.options.allowPushParent)&&a.hidePanel(),a._trigger("onNodeClick",b,{treeId:c,node:d,treeNode:d,clickFlag:e}),!1},beforeCheck:function(b,c){var d=a._trigger("beforeNodeCheck",null,{treeId:b,node:c});return d?void 0:!1},onCheck:function(b,c,d){for(var e=[],f=[],g=$("#"+c).tree("getCheckedNodes",!0),h=0,i=g.length;i>h;h++)if(a.options.cascadeCheck||!g[h].getCheckStatus().half){if(!a.options.allowPushParent&&g[h].isParent)continue;e.push(g[h].name),f.push(g[h].id)}a.options.popupDialog?($.data(a.uiCombo.popupInputbox,"value",f),$.data(a.uiCombo.popupInputbox,"text",e)):a.setValues(f,!0,e),a._trigger("onNodeCheck",b,{treeId:c,node:d})},onLoad:function(b,c,d,e){var f,g=[],h=[],i=[],j=!1,k=$("#"+c),m=k.tree("getNodes"),n=k.tree("transformToArray",m);if(a.options.clearOnLoad&&(j=a._clearValues(n)),1==k.tree("option","checkable")){for(i=k.tree("getCheckedNodes",!0),f=0,l=i.length;f<l;f++)if(a.options.cascadeCheck||!i[f].getCheckStatus().half){if(!a.options.allowPushParent&&i[f].isParent)continue;g.push(i[f].name),h.push(i[f].id)}}else g=!1;a.currentValues.length&&!j&&(h=a.currentValues),a.isInit||(a.isInit=!0,a.originalValue=h.join(",")),a.isLoaded=!0,a.dataLoaded=!0,a.setValues(h,!1,g),a._trigger("onLoad",b,{treeId:c,treeNode:d,msg:e})},onExpand:function(b,c,d){a._trigger("onExpand",b,[{treeId:c,node:d}])}};return b},setPopupInput:function(a){this.uiCombo.popupInputbox.textbox("setValue",a.join(this.options.separator))},_initData:function(){var a=$('<ul id="'+$(this.element).attr("id")+'_tree"></ul>');this.options.popupDialog?(a.appendTo(this.uiCombo.popupDialog),this.uiCombo.popupDialogTree=a):a.appendTo(this.uiCombo.pContent),this.uiCombo.panel.unbind().bind("mousedown",function(a){a.preventDefault()});var b=this._getSetting();"string"==typeof this.options.url&&""!==this.options.url&&$.extend(b,{asyncEnable:!0,asyncUrl:this.options.url,asyncAutoParam:"id,name"}),a.tree(b,this.options.data)},_renderItems:function(a){},_scrollTo:function(a){var b=this.panel(),c=b.find('div.coral-combobox-item[value="'+a+'"]');if(c.length)if(c.position().top<=0){var d=b.scrollTop()+c.position().top;b.scrollTop(d)}else if(c.position().top+c.outerHeight()>b.height()){var d=b.scrollTop()+c.position().top+c.outerHeight()-b.height();b.scrollTop(d)}},_request:function(a,b,c){var d=this,e={},f=[],g=this.options.loader,h=!1;if(a||d.options.url?!a&&d.options.url&&(a=d.options.url):a=[],"string"!=typeof a?(e=a,e.data?f=e.data:e.url?(a=e.url,d.options.url=e.url,h=!0):e instanceof Array?f=a:e.url||e.data||d.options.url?e.url||e.data||!d.options.url||(a=d.options.url,h=!0):f=[]):(d.options.url=a,h=!0),h){if(b=b||{},0==this._trigger("beforeLoad",null,[b]))return;g.apply(this.element,[b,function(a){d.loadData(a,c),d._trigger($.isFunction(e.onLoad)?e.onLoad:"onLoad",null,[a])},function(){d._trigger("onError",null,arguments)}])}else d.loadData(f,c),d._trigger($.isFunction(e.onLoad)?e.onLoad:"onLoad",null,[f])},getTree:function(){return $("#"+$(this.element).attr("id")+"_tree")},loadData:function(a,b){var c=this.getTree();c.tree("reload",a);var d=c.tree("getNodes");$.each(d,function(a,b){c.tree("expandNode",b,!0)}),this.dataLoaded=!0,this.setValues(this.currentValues)},getData:function(){return this.getTree().tree("getNodes")||[]},setComboValues:function(a,b){this.setValues(a,!1,b)},_setTreeNodeState:function(a,b){var c=this.options,d=[],e=$("#"+$(this.element).attr("id")+"_tree");if(e.tree("cancelSelectedNode"),1==e.tree("option","checkable")){e.tree("checkAllNodes",!1);for(i in a){var f=e.tree("getNodeByParam","id",a[i]);f&&e.tree("checkNode",f,!0,!c.cascadeCheck),b||(f?d.push(f.name):d.push(a[i]))}}else for(i in a){var f=e.tree("getNodeByParam","id",a[i]);e.tree("selectNode",f),b||(f?d.push(f.name):d.push(a[i]))}return b||(b=d),b},setValues:function(a,b,c){var d;this.currentValues=a,d=this._setTreeNodeState(a,c).join(this.options.separator),c="boolean"==typeof c?c:!1,c||this._setText(d),this._super(a,b,c)},setValue:function(a,b,c){a=a.split(this.options.separator),this.setValues(a,!1,c)},_getOnlyValues:function(){var a=(this.getData(),this.options),b=[],c=0;if(!this.currentValues||!this.currentValues[0]&&1===this.currentValues.length)return b;for(;c<this.currentValues.length;c++){var d=this.currentValues[c];"value"===a.postMode&&b.push(d)}return b},_showItems:function(){var a=this.tree().tree("getNodes"),b=this.tree().tree("transformToArray",a);this.tree().tree("showNodes",b,{showParents:!0})},_doQuery:function(a){if(""!=a){var b=this.options,c=[],d=b.textField,e=b.valueField,f=this.options.filter;if("remote"==b.mode)this._request(null,{q:a},!0);else{var g=this.tree().tree("getNodes"),h=this.tree().tree("transformToArray",g);this.tree().tree("hideNodes",h);for(var i=0;i<h.length;i++)for(var j=pinyinEngine.toPinyin(h[i][d],!1,""),k=0;k<a.length;k++){var l=f.apply(this.element,[a[k],h[i]]);if(l){var m=(h[i][e],h[i][d]);(m.indexOf(a[k])>-1||j.indexOf(a[k])>-1)&&(c.push(h[i]),this.tree().tree("showNodes",c,{showParents:!0}),this.tree().tree("expandNode",c[0].getParentNode(),!0,!1,!1))}}}}},_checkMathch:function(a,b){var c,d,e,f,g=[],h=[],i=[],j=this.options,k=j.textField,m=j.valueField;b&&this._showItems();var n=!1,o={};if(j.multiple){for(this.tree().tree("checkAllNodes",!1),c=0;c<a.length;c++)if(!b||!this.options.forceSelection||""!==$.trim(a[c])){var i=this.tree().tree("getNodesByParam",k,a[c],null);for(i.length||(o[c.toString()]=!0),d=0;d<i.length;d++)if(j.cascadeCheck||!i[d].isParent){g.push(i[d][m]),h.push(i[d][k]),n=!0;break}n||this.options.forceSelection||(!o[c.toString()]&&!b||b)&&(g.push(a[c]),h.push(a[c])),n=!1}for(f=0;f<g.length;f++){var i=this.tree().tree("getNodesByParam",m,g[f],null);i.length&&this.tree().tree("checkNode",i[0],!0,!j.cascadeCheck)}var i=this.tree().tree("getCheckedNodes",!0);for(e=0,l=i.length;e<l;e++)if(j.cascadeCheck||!i[e].getCheckStatus().half){if(!j.allowPushParent&&i[e].isParent)continue;-1==$.inArray(i[e][m],g)&&(h.push(i[e][k]),g.push(i[e][m]))}}else{var i=this.tree().tree("getNodesByParam",k,a[0],null),p=-1;for(c=0;c<i.length;c++)p=-1===p?c:p,n=!0;n&&(g.push(i[p][m]),h.push(i[p][k])),n||this.options.forceSelection||(g.push(a[0]),h.push(a[0]))}return{valarr:g,textarr:h}},clear:function(){this._super(),this.options.multiple&&$("#"+$(this.element).attr("id")+"_tree").tree("checkAllNodes",!1)},_formatValue:function(a){var b;b=this.options.multiple?this.getTree().tree("getCheckedNodes",!0):this.getTree().tree("getSelectedNodes");var c=this.options,d=c.valueField,e=c.textField,f=0,g=null;if("text"===c.postMode||"value-text"===c.postMode)for(f=0;f<b.length;f++)if(g=b[f],""!=a&&a==g[d]){if("text"===c.postMode)return g[e];if("value-text"===c.postMode)return a+c.valueTextSeparator+g[e]}return a},reload:function(a){this._request(a)},_destroy:function(){this.element.removeClass("coral-validation-combotree"),this.element.removeClass("coral-form-element-combotree"),this.options.popupDialog&&this.uiCombo.popupDialog.dialog("forceDestroy"),this._super()}});/*! cui 2016-11-08 */
$.component("coral.combogrid",$.coral.combo,{version:"4.0.3",castProperties:["colNames","colModel","data","buttonOptions","gridOptions","buttons","shortCut","searchColumns"],options:{colNames:[],colModel:[],valueField:"id",textField:"name",panelRenderOnShow:!1,multiple:!1,selarrrow:[],buttons:[],searchColumns:[],url:null,panelWidth:500,panelHeight:220,sortable:!1,data:[],onSelectAll:null,onSortableColums:null,onLoad:$.noop,onComplete:null,pager:!1,buttonOptions:null,gridOptions:{loadonce:"false"}},grid:function(){return $("#combo_grid_"+$(this.element).attr("id"))},button:function(){return null!==this.options.buttonOptions?this.$button:void 0},_destroy:function(){this.element.removeClass("coral-validation-combogrid"),this.element.removeClass("coral-form-element-combogrid"),this.grid().grid("destroy"),this._super()},_showItems:function(){var a=(this.options.textField,this.options.valueField,{}),b=this.grid();a.filters="{}",b.grid("option","localonce",!0),$.extend(b.grid("option","postData"),a),b.grid("reload",{page:1})},_doQuery:function(a){var b=this.options,c=this.grid(),d=b.textField,e=c.grid("option","colModel"),f=[],g=[];for(var h in e){var i=e[h];"cb"!=i.name&&"rn"!=i.name}for(var j=0;j<a.length;j++)if(a[j]=pinyinEngine.toPinyin(a[j],!1,""),b.searchColumns.length>0)for(var h=0;h<b.searchColumns.length;h++)g.push('{"field":"'+b.searchColumns[h]+'","op":"cn","data":"'+a[j]+'"}');else g.push('{"field":"'+d+'","op":"cn","data":"'+a[j]+'"}');f.filters='{"groupOp":"OR","rules":['+g.join(",")+"]}",c.grid("option","localonce",!0),$.extend(c.grid("option","postData"),f),c.grid("reload",{page:1})},_checkMathch:function(a,b){var c,d,e=[],f=[],g=this.options.textField,h=this.options.valueField;this.grid();b&&this._showItems();var i=this.grid().grid("option","data"),j=!1,k={};if(this.options.multiple){for(c=0;c<a.length;c++){for(d=0;d<i.length;d++)if(i[d][g]!=a[c]&&i[d][h]!=a[c]&&(k[c.toString()]=!0),i[d][g]==a[c]){e.push(i[d][h]),f.push(i[d][g]),j=!0;break}j||this.options.forceSelection||(!k[c.toString()]&&!b||b)&&(e.push(a[c]),f.push(a[c])),j=!1}var l=this._getOnlyValues(),m=this._getOnlyTexts();for(c=0;c<a.length;c++)for(d=0;d<m.length;d++)m[d]==a[c]&&-1===$.inArray(m[d],f)&&(e.push(l[d]),f.push(m[d]))}else{var n=-1;for(c=0;c<i.length;c++)i[c][g]==a[0]&&(n=-1===n?c:n,j=!0);j&&(e.push(i[n][h]),f.push(i[n][g])),j||this.options.forceSelection||(!k[0]&&!b||b)&&(e.push(a[0]),f.push(a[0]))}return{valarr:e,textarr:f}},reload:function(a){this.cache.isReload=!0;var b=this.grid(),c={},d=!1,e=[];a||this.options.url?!a&&this.options.url&&(a=this.options.url):a=[],"string"!=typeof a?(c=a,c.data?e=c.data:c.url?(a=c.url,d=!0):a instanceof Array?e=a:c.url||c.data||this.options.url?c.url||c.data||!this.options.url||(a=this.options.url,d=!0):e=[]):(this.options.url=a,d=!0),$.isFunction(c.onLoad)&&(this.cache.onLoad=c.onLoad),c.postData,b.grid("reload",a)},_removeGridHighlights:function(){this._removeHighlight(this.grid().find(".coral-grid-btable tr td > span.coral-keyword-highlight"))},_renderItems:function(a){},_addGridHighlights:function(){this._addHighlight(this.grid().find(".coral-grid-btable .jqgrow").children("td"),this.uiCombo.textbox.val())},_updateGridData:function(a){var b=this.grid().grid("getRowData",a.rowId),c=this._getTextFromHTML(b[this.options.valueField]),d=this._getTextFromHTML(b[this.options.textField]),e=$.inArray(c,this.gridValueArr);return this.options.multiple?void(a.status?-1==e&&(this.gridValueArr.push(c),this.gridTextArr.push(d),this.gridRowIdArr.push(a.rowId)):-1!=e&&(this.gridValueArr.splice(e,1),this.gridTextArr.splice(e,1),this.gridRowIdArr.splice(e,1))):(this.gridValueArr=[c],this.gridTextArr=[d],void(this.gridRowIdArr=[a.rowId]))},_create:function(){var a=this;this.element.addClass("coral-form-element-combogrid coral-validation-combogrid"),this._super(),this.panelRendered=!0,null!==this.options.buttonOptions&&(this.$button=this._getButtonEl(),this.component().append(this.$button).addClass("coral-combogrid-hasButton"),this.$button.button(this.options.buttonOptions)),this.uiCombo.panel.unbind().bind("mousedown",function(b){a.cancelBlur=!0,a._delay(function(){delete a.cancelBlur});var c=$(b.target).closest(".coral-grid-pager").length;return 1==c})},_initCombo:function(){this._super();$();this.options.pager?grid=$('<div id="combo_grid_'+$(this.element).attr("id")+'"><div class="combo_grid_'+$(this.element).attr("id")+'"></div></div>').appendTo(this.uiCombo.pContent):grid=$('<div id="combo_grid_'+$(this.element).attr("id")+'"></div>').appendTo(this.uiCombo.pContent),this.gridValueArr=[],this.gridTextArr=[],this.gridRowIdArr=[],goptions={fitStyle:"fill",keyName:this.options.valueField,sortable:this.options.sortable,colModel:this.options.colModel,colNames:this.options.colNames,multiselect:this.options.multiple,sortname:this.options.sortname,width:"auto"},goptions=$.extend({},goptions,this.options.gridOptions),null!=this.options.url?(goptions.url=this.options.url,goptions.datatype="json"):(goptions.data=this.options.data,goptions.datatype="local"),this._on(grid,{gridonselectrow:function(a,b){var c=this._getOnlyValues();this.options.multiple?-1==$.inArray(b.rowId,c)?c.push(b.rowId):c.splice($.inArray(b.rowId,c),1):c=[b.rowId],this.setValues(c,!0,!1),!this.options.multiple&&a.originalEvent&&"click"==a.originalEvent.type&&this.hidePanel(),this._trigger("onSelectRow",a,[{rowId:b.rowId,status:b.status}])},gridonselectall:function(a,b){var c=b.status?b.aRowIds.concat():[];this.setValues(c,!0,!1)},gridonload:function(a,b){var c=this,d=!1,e=b.data;c.options.clearOnLoad&&(d=c._clearValues(e)),this._addGridHighlights(),this.dataLoaded=!0;for(var f=this.grid().grid("option","selarrrow").concat(),g=0;g<f.length;g++)this.grid().grid("setSelection",f[g],!1);var h=this._getOnlyValues();$.each(h,function(a,b){c.grid().grid("setSelection",b,!1,null)}),1==d&&(this.currentValues=[]),this.search||(this.setValues(this.currentValues),this.search=!1),this.cache.isReload&&(this.cache.isReload=!1,this._trigger(this.cache.onLoad||"onLoad",null,[b]),delete this.cache.onLoad)}}),grid.grid(goptions),grid.grid("refresh")},_getButtonEl:function(){return $("<button type='button'></button>").addClass("coral-combogrid-button")},_getRowDataByColName:function(a){var b=(this.options,this.grid()),c=b.grid("option","data"),d=[];return"string"==typeof a&&(a=[a]),$.each(c,function(b,c){var e={};for(var f in a){var g=a[f];e[g]=c[g]}d.push(e)}),d},_getTextArrByValueArr:function(a){var b=(this.options,this.options.valueField),c=this.options.textField,d=this._getRowDataByColName([b,c]),e=[];for(var f in a){var g=a[f],h=!1;$.each(d,function(a,d){g==d[b]&&(e.push(d[c]),h=!0)}),h||e.push(a[f])}return e},setValues:function(a,b,c){for(var d=this.grid(),e=d.grid("option","selarrrow").concat(),f=0;f<e.length;f++)d.grid("setSelection",e[f],!1);if(!this.dataLoaded){var g={setValues:{values:a,text:c,triggerOnChange:b}};this._addCacheItem(g)}var h=this.options,i=[];i=this._getTextArrByValueArr(a),c="boolean"==typeof c?c:!1,c||this._setText(i.join(h.separator)),this.currentValues=a,this.currentTexts=i;var j=a.concat();j.sort();for(var f=0;f<j.length;f++)(j[f]!==j[f+1]&&f!=j.length||f==j.length)&&d.grid("setSelection",j[f],!1);if("item"==h.width){var k=$("<div style = 'visibility:hidden;'><span>"+this.getText()+"</span></div>").appendTo("body"),l=this.component().find(".coral-textbox-default"),m=parseInt(l.css("padding-left"))+parseInt(l.css("padding-right")),n=this.uiArrow().outerWidth()+2*parseInt(this.uiArrow().css("right")),o=k.find("span").outerWidth()+m+n;this.resize(o),k.remove(),h.width="item"}this._super(a,b,!1)},_getOnlyValues:function(){var a=this.getData(),b=this.options,c=[],d=0;if(!this.currentValues||!this.currentValues[0]&&1===this.currentValues.length)return c;for(;d<this.currentValues.length;d++){var e=this.currentValues[d],f=0,g=b.valueField,h=b.textField,i=null;if("value-text"===b.postMode&&c.push(e.split(b.valueTextSeparator)[0]),"value"===b.postMode&&c.push(e),"text"===b.postMode)for(;a&&f<a.length;f++)if(i=a[f],i[h]==e){c.push(i[g]);break}}return c},_getOnlyTexts:function(){return this.currentTexts||[]},getData:function(){return this.grid().grid("option","data")||[]},_selectPrev:function(){var a=this,b=null,c=0,d=a.grid().grid("getDataIDs");if(selarrrow=a.grid().grid("option","selarrrow").concat(),valueFirst=a.getValues()[0],a.selectedRow=a.selectedRow||valueFirst,a.options.multiple){if(a.selectedRow){for(var e=d.length;e>=0;e--)if(a.selectedRow==d[e]){c=0==e?d.length-1:e-1,a.selectedRow=d[c];break}-1==$.inArray(a.selectedRow,selarrrow)&&a.grid().grid("setSelection",a.selectedRow)}else a.selectedRow=d.length,a.grid().grid("setSelection",d.length);a._scrollTo(a.selectedRow)}else b=a.grid().grid("option","selrow"),b?(c=a.grid().grid("getInd",b),c>=0&&a.grid().grid("setSelection",d[c-2])):a.grid().grid("setSelection",d.length);a._scrollTo(b)},_selectNext:function(){var a=this,b=null,c=0,d=a.grid().grid("getDataIDs");if(selarrrow=a.grid().grid("option","selarrrow").concat(),valueFirst=a.getValues()[0],a.selectedRow=a.selectedRow||valueFirst,a.options.multiple){if(a.selectedRow){for(var e=0;e<d.length;e++)if(a.selectedRow==d[e]){c=e==d.length-1?0:e+1,a.selectedRow=d[c];break}-1==$.inArray(a.selectedRow,selarrrow)&&a.grid().grid("setSelection",a.selectedRow)}else a.selectedRow=d[0],a.grid().grid("setSelection",d[0]);a._scrollTo(a.selectedRow)}else b=a.grid().grid("option","selrow"),b?(c=a.grid().grid("getInd",b),c<d.length&&a.grid().grid("setSelection",d[c])):a.grid().grid("setSelection",d[0]),a._scrollTo(b)},_doEnter:function(){this.uiCombo.panel.is(":visible")&&(this.options.multiple?this.grid().grid("setSelection",this.selectedRow):this.hidePanel())},_scrollTo:function(a){var b=this.panel(),c=b.find('.coral-row-ltr[id="'+a+'"]');if(c.length)if(c.position().top<=0){var d=b.find(".coral-grid-rows-view").scrollTop()+c.position().top-c.outerHeight();b.find(".coral-grid-rows-view").scrollTop(d)}else if(c.position().top+c.outerHeight()>b.find(".coral-grid-rows-view").height()){var d=b.find(".coral-grid-rows-view").scrollTop()+c.position().top+c.outerHeight()-b.find(".coral-grid-rows-view").height();b.find(".coral-grid-rows-view").scrollTop(d)}}});/*! cui 2016-11-08 */
var datepicker_instActive,formatOptions={ymdFormat:["dd","MMdd","yyyyMM","yyyyMMdd"],ymFormat:["yyyy","yyyyMM"],yFormat:["yyyy"]};$.coral.trim=function(a){return a.replace(/(^\s*)|(\s*$)/g,"")},$.coral.parseDate=function(a,b,c){var d,e=c;if(null==a||null==b)throw"Invalid arguments";if(c=c||{},b="object"==typeof b?b.toString():b+"",""===b)return null;if("timepicker"==e.model){var f=new Date,g=[];a="yyyy-MM-dd "+e.timeFormat,g.push(f.getFullYear()),g.push(f.getMonth()+1),g.push(f.getDate()),b=g.join("-")+" "+b}d=configDateFormat(a,b,c),a=d.format,b=d.value;var h,i,f,j=_hasTime(a),k=0,l=(c?c.shortYearCutoff:null)||c.shortYearCutoff,m="string"!=typeof l?l:(new Date).getFullYear()%100+parseInt(l,10),e=((c?c.dayNamesShort:null)||c.dayNamesShort,(c?c.dayNames:null)||c.dayNames,(c?c.monthNamesShort:null)||c.monthNamesShort,(c?c.monthNames:null)||c.monthNames,c.opts),n=-1,o=-1,p=-1,q=-1,r=-1,s=-1,t=-1,u=!1,v=function(b){var c=h+1<a.length&&a.charAt(h+1)===b;return c&&h++,c},w=function(b){for(var c=1;h+1<a.length&&a.charAt(h+1)==b;)c++,h++;return c},x=function(a,c){if(k>b.length||k==b.length)return-1;var d=new RegExp("^\\d{1,"+c+"}"),e=b.substring(k).match(d);if(!e)throw"Missing number at position "+k;return k+=e[0].length,parseInt(e[0],10)},y=function(){""!==b.charAt(k)&&b.charAt(k)!==a.charAt(h)||k++};for(h=0;h<a.length;h++)if(u)"'"!==a.charAt(h)||v("'")?y():u=!1;else switch(a.charAt(h)){case"d":var z=w("d");p=x("d",z);break;case"M":z=w("M"),o=x("M",z);break;case"y":z=w("y"),n=x("y",z);break;case"H":z=w("H"),r=x("H",z);break;case"m":z=w("m"),s=x("m",z);break;case"s":z=w("s"),t=x("s",z);break;default:y()}if(-1==p&&(p=1,-1==o&&(o=1)),-1!=p&&-1==o&&(o=(new Date).getMonth()+1),-1===n?n=(new Date).getFullYear():100>n&&(n+=(new Date).getFullYear()-(new Date).getFullYear()%100+(m>=n?0:-100)),q>-1)for(o=1,p=q;;){if(i=_getDaysInMonth(n,o-1),i>=p)break;o++,p-=i}if(n=-1==n?1:n,r=-1==r?0:r,s=-1==s?0:s,t=-1==t?0:t,f=_daylightSavingAdjustWidthTime(new Date(n,o-1,p),[r,s,t]),f.getFullYear()!==n||f.getMonth()+1!==o||f.getDate()!==p||j&&(f.getHours()!==r||f.getMinutes()!==s||f.getSeconds()!==t))throw"Invalid date";return f},$.coral.longToStringDate=function(a,b){var c;if(!$.trim(a)||1==a&&b.restrictConvert)return"";c=void 0==b?"yyyy-MM-dd":b.dateFormat;var d=new Date(parseInt(a)),e=$.coral.formatDate(c,d,b);return e},$.coral.stringToLongDate=function(a,b){if(!$.trim(a))return b.restrictConvert?1:"";var c=new Date(a),a=c.getTime();return a},$.coral.formatDate=function(a,b,c){if(!b)return"";var d,e=c,f=e?e.dayNamesShort:null,g=e?e.dayNames:null,h=(e?e.monthNamesShort:null,e?e.monthNames:null),i=function(b){var c=d+1<a.length&&a.charAt(d+1)===b;return c&&d++,c},j=function(b){for(var c=1;d+1<a.length&&a.charAt(d+1)==b;)c++,d++;return c},k=function(a,b,c){var d=""+b;if(i(a))for(;d.length<c;)d="0"+d;return d},l=function(a,b,c,d){return i(a)?d[b]:c[b]},m="",n=!1;if(e&&"timepicker"==e.model&&(a="yyyy-MM-dd "+e.timeFormat),b)for(d=0;d<a.length;d++)if(n)"'"!==a.charAt(d)||i("'")?m+=a.charAt(d):n=!1;else switch(a.charAt(d)){case"d":m+=k("d",b.getDate(),2);break;case"D":m+=l("D",b.getDay(),f,g);break;case"M":var o=j("M");4==o?m+=h[b.getMonth()]:3==o?m+=h[b.getMonth()]:2==o?m+=b.getMonth()+1>9?b.getMonth()+1:"0"+(b.getMonth()+1):1==o&&(m+=b.getMonth()+1);break;case"y":o=j("y"),4==o?m+=b.getFullYear():3==o?m+=(b.getFullYear()+"").substring(1,4):2==o?m+=(b.getYear()%100<10?"0":"")+b.getYear()%100:1==o&&(m+=b.getYear()%100);break;case"H":o=j("H"),2==o?m+=b.getHours()>9?b.getHours():"0"+b.getHours():1==o&&(m+=b.getHours());break;case"m":o=j("m"),2==o?m+=b.getMinutes()>9?b.getMinutes():"0"+b.getMinutes():1==o&&(m+=b.getMinutes());break;case"s":o=j("s"),2==o?m+=b.getSeconds()>9?b.getSeconds():"0"+b.getSeconds():1==o&&(m+=b.getSeconds());break;case"W":o=j("W"),2==o?m+=c.calculateWeek(b)>9?c.calculateWeek(b):"0"+c.calculateWeek(b):1==o&&(m+=c.calculateWeek(b));break;case"w":m+=b.getDay();break;default:m+=a.charAt(d)}return e&&"timepicker"==e.model&&(m=m.substring(m.indexOf(" ")+1,m.length)),m},_hasTime=function(a){var b=a+"";return-1!=b.indexOf("H")||-1!=b.indexOf("m")||-1!=b.indexOf("s")},getFormatter=function(a,b,c){var d=null,e=null,f=c;b.indexOf("y")>-1&&b.indexOf("M")>-1&&b.indexOf("d")>-1&&(d="ymdFormat"),b.indexOf("y")>-1&&b.indexOf("M")>-1&&-1==b.indexOf("d")&&(d="ymFormat"),b.indexOf("y")>-1&&-1==b.indexOf("M")&&-1==b.indexOf("d")&&(d="yFormat");var g=f.formatOptions||formatOptions,a="object"==typeof a?a.toString():a+"";if(""===a)return null;var h=a.split(" ");if(h[0].indexOf("/")>-1||h[0].indexOf("-")>-1)for(var i=h[0].indexOf("/")>-1?h[0].split("/"):h[0].split("-"),j=0;j<i.length;j++)i[j].length%2!=0&&(i[j]="0"+i[j]),h[0]=i.join("-");for(var k=h[0].indexOf("/")>-1?h[0].replace(/\//g,""):h[0].replace(/-/g,""),j=(h[0].split("/").length-1,h[0].split("-").length-1,0);j<g[d].length;j++)g[d][j].length==k.length&&(e=g[d][j]);return(e?e:b)||null},configDateFormat=function(a,b,c){var d=a,e=a.split(" "),f=(e[1]||"",b.split(" "));if(f[0].indexOf("/")>-1||f[0].indexOf("-")>-1)for(var g=f[0].indexOf("/")>-1?f[0].split("/"):f[0].split("-"),h=0;h<g.length;h++)g[h].length%2!=0&&(g[h]="0"+g[h]),f[0]=g.join("-");return a=getFormatter(f[0],e[0],c),a+=d.substr(e[0].length,d.length),f[0]=f[0].indexOf("/")>-1?f[0].replace(/\//g,""):f[0].replace(/-/g,""),b=f.join(" "),{format:a,value:b}},_daylightSavingAdjust=function(a){return a?(a.setHours(a.getHours()>12?a.getHours()+2:0),a):null},_getFormatConfig=function(a){var b=a.shortYearCutoff;return b="string"!=typeof b?b:(new Date).getFullYear()%100+parseInt(b,10),{shortYearCutoff:b,dayNamesShort:a.dayNamesShort,dayNames:a.dayNames,monthNamesShort:a.monthNamesShort,monthNames:a.monthNames,calculateWeek:a.calculateWeek,opts:a}},_daylightSavingAdjustWidthTime=function(a,b){var c=_daylightSavingAdjust(a);return c&&(c.setHours(b[0]),c.setMinutes(b[1]),c.setSeconds(b[2]),c.setMilliseconds(0)),a},$.component("coral.datepicker",$.coral.inputbase,{castProperties:["showRequiredMark","hideRequiredMark","shortCut"],version:"4.0.2",componentName:"datepicker",componentFullName:"coral-datepicker",initialized:!1,_curInst:null,_keyEvent:!1,_disabledInputs:[],_datepickerShowing:!1,_inDialog:!1,_mainDivId:"coral-datepicker-divId",_inlineClass:"coral-datepicker-inline",_appendClass:"coral-datepicker-append",_triggerClass:"coral-datepicker-trigger",_dialogClass:"coral-datepicker-dialog",_disableClass:"coral-datepicker-disabled",_unselectableClass:"coral-datepicker-unselectable",_currentClass:"coral-datepicker-current-day",_dayOverClass:"coral-datepicker-days-cell-over",regional:[],options:{showOn:"button",showAnim:"fadeIn",showOptions:{},closeOnClick:!0,iframePanel:!1,dateFormat:"yyyy-MM-dd",timeFormat:"HH:mm:ss",formatOptions:formatOptions,firstDay:1,isRTL:!1,showMonthAfterYear:!0,defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!0,changeYear:!0,complete:!0,yearRange:"c-30:c+30",showOtherMonths:!0,selectOtherMonths:!0,showWeek:!1,calculateWeek:function(a){var b,c=new Date(a.getTime());return c.setDate(c.getDate()+4-(c.getDay()||7)),b=c.getTime(),c.setMonth(0),c.setDate(1),Math.floor(Math.round((b-c)/864e5)/7)+1},shortYearCutoff:"+10",validDate:!0,model:"datepicker",minDate:null,maxDate:null,minTime:null,maxTime:null,duration:"fast",beforeShowDay:null,beforeShow:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!0,autoSize:!1,disabled:!1,isLabel:!1,readonly:!1,readonlyInput:!1,showClose:!1,value:null,required:!1,showStar:!0,starBefore:!1,errMsg:null,errMsgPosition:"leftBottom",startDateId:null,endDateId:null,onSelect:null,onChange:null,onFormatError:null,onFormatWarn:null,srcDateFormat:null,zIndex:null,name:null,triggers:null,excluded:!1,valueType:"string",restrictConvert:!0},markerClassName:"hasDatepicker",maxRows:4,extendRemove:function(a,b){$.extend(a,b);for(var c in b)null==b[c]&&(a[c]=b[c]);return a},bindHover:function(a){var b=this,c="button, .coral-datepicker-prev, .coral-datepicker-next, .coral-datepicker-calendar td a, .menuTimeSel";return a.delegate(c,"mouseout",function(){$(this).removeClass("coral-state-hover"),-1!==this.className.indexOf("coral-datepicker-prev")&&$(this).removeClass("coral-datepicker-prev-hover"),-1!==this.className.indexOf("coral-datepicker-next")&&$(this).removeClass("coral-datepicker-next-hover")}).delegate(c,"mouseover",{element:b},b.datepicker_handleMouseover)},datepicker_handleMouseover:function(a){var b=a.data?a.data.element:a;b.isDisabled()||($(this).parents(".coral-datepicker-calendar").find("a").removeClass("coral-state-hover"),$(this).addClass("coral-state-hover"),-1!==this.className.indexOf("coral-datepicker-prev")&&$(this).addClass("coral-datepicker-prev-hover"),-1!==this.className.indexOf("coral-datepicker-next")&&$(this).addClass("coral-datepicker-next-hover"))},widget:function(){return this.dpDiv},_create:function(){var a,b;a=this.element[0].nodeName.toLowerCase(),b="div"===a||"span"===a,this.regional[""]={closeText:"关闭",prevText:"上月",nextText:"下月&#x3E;",currentText:"今天",monthNames:["1","2","3","4","5","6","7","8","9","10","11","12"],monthNamesShort:["1","2","3","4","5","6","7","8","9","10","11","12"],dayNames:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],dayNamesShort:["周日","周一","周二","周三","周四","周五","周六"],dayNamesMin:["日","一","二","三","四","五","六"],weekHeader:"周",yearSuffix:"年",monthSuffix:"月"},$.extend(this.options,this.regional[""]);var c=this.options;null!=c.dateFormat&&null==c.srcDateFormat&&(c.srcDateFormat=c.dateFormat),"long"==c.valueType&&c.value&&(c.value=$.coral.longToStringDate(c.value,c)),this.regional.en=$.extend(!0,{},this.regional[""]),this.regional["en-US"]=$.extend(!0,{},this.regional.en);$("body").find("#coral-datepicker-divId");if(this.dpDiv=$("#coral-datepicker-divId").length?$("#coral-datepicker-divId"):this.bindHover($("<div id='"+this._mainDivId+"' class='coral-datepicker coral-component coral-component-content coral-helper-clearfix coral-corner-all'></div>")),this.iframePanel=$("<iframe class='coral-datepicker-iframePanel' style='position:absolute;height:auto;'></iframe>"),this.initialized||($(document).mousedown({that:this},this._checkExternalClick),this.initialized=!0),0===$("#"+this._mainDivId).length&&$("body").append(this.dpDiv),this.prepareInit(this.options),this._initElement(),c.startDateId){$("#"+c.startDateId).datepicker("option","endDateId",this.element[0].id);var d=$("#"+c.startDateId).datepicker("getValue");$("#"+this.element[0].id).datepicker("option","minDate",d)}"input"===a?this.connect():b&&this.inline(),$(document).off(".coral-datepicker").on("mousedown.coral-datepicker","#"+this._mainDivId,function(a){return $(a.target).hasClass("menuTimeSel")?void a.stopPropagation():void a.stopPropagation()})},component:function(){return this.element.parent().parent()},_initElement:function(){var a=this.options,b=a.id,c=this.element.attr("name")||a.name||"",d=$.coral.trim(a.value),e=a.width,f=a.height,g=a.cls,h=a.labelField,i=a.showClose,j="",k=a.componentCls;this.originalValue=d,c&&this.element.removeAttr("name"),i&&(j="<span class='coral-input-clearIcon cui-icon-cross2'></span>");var l=$("<input id='"+b+"_srcval' name='"+c+"' type='hidden' value='"+(null==d?"":d)+"'>"),m=$("<span id='"+b+"_eleBorder' class='coral-textbox-border coral-corner-all'>"+j+"</span>"),n=$("<span id='"+b+"_eleComp' class='coral-textbox'></span>");if(this.element.addClass("coral-textbox-default coral-validation-datepicker tabbable "),this.element.addClass("coral-form-element-datepicker ctrl-init ctrl-form-element ctrl-init-datepicker"),null!=f&&(n.outerHeight(f),this.element.outerHeight("100%")),null!=e&&n.outerWidth(e),n.insertAfter(this.element).addClass(k),l.appendTo(m),this.element.appendTo(m).addClass(g),m.appendTo(n),a.iframePanel&&this.iframePanel.appendTo("body").hide(),null!=h){var o=$('<label class="coral-label">'+h+"</label>");m.before(o),n.addClass("coral-hasLabel")}this.options.readonly||this.element.prop("readonly",this.options.readonlyInput)},prepareInit:function(a){var b=this.element[0];a=a||{},b.id?a.id?b.id=a.id:a.id=$(b).uniqueId().attr("id"):(a.id&&(b.id=a.id),a.id=$(b).uniqueId().attr("id")),b.name?a.name?b.name=a.name:a.name=$(b).attr("name"):(a.name&&(b.name=a.name),a.name=$(b).attr("name")),a.value=$(b).val()||a.value||"";var c="div"===b.nodeName.toLowerCase()||"span"===b.nodeName.toLowerCase();this._newInst($(b),c)},_newInst:function(a,b){var c=a[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");this.dpDiv.css({display:"none"}),a.attr("component-role",this.componentName),this.inst={id:c,input:a,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:b,isShow:!1,dpDiv:b?this.bindHover($("<div class='"+this._inlineClass+" coral-datepicker coral-datepicker-panel coral-component coral-component-content coral-helper-clearfix coral-corner-all'></div>")):this.dpDiv},$.extend(this.options,this.inst)},connect:function(){var a=this.options,b=this.element[0],c=$(b),d=this;a.append=$([]),a.trigger=$([]),c.hasClass(this.markerClassName)||(this._attachments(c),c.addClass(this.markerClassName).keydown({that:d},this._doKeyDown).keypress({that:d},this._doKeyPress).keyup({that:d},this._doKeyUp),this._autoSize(),a.disabled&&this.disable(),a.readonlyInput&&this.readonlyInput(a.readonlyInput),a.readonly&&this.readonly(a.readonly),a.isLabel&&this.isLabel(a.isLabel))},_processDefaultDate:function(a,b){var c=this.options;if(""==b)return c.selectedDay=c.currentDay=null,c.selectedMonth=c.currentMonth=null,c.selectedYear=c.currentYear=null,c.currentHur=null,c.currentMiu=null,c.currentSed=null,c.input.val(""),null;var d=c.dateFormat,e=null;try{e=$.coral.parseDate(d,b,c)}catch(f){return null}c.selectedDay=c.currentDay=e.getDate(),c.selectedMonth=c.currentMonth=e.getMonth(),c.selectedYear=c.currentYear=e.getFullYear(),c.currentHur=e.getHours(),c.currentMiu=e.getMinutes(),c.currentSed=e.getSeconds();var g=_daylightSavingAdjustWidthTime(new Date(c.currentYear,c.currentMonth,c.currentDay),[c.currentHur,c.currentMiu,c.currentSed]),h="";if(!c.value&&b&&(c.value=b),""!=c.value){var i=getFormatter(c.value,c.dateFormat,c);h=this.completeFormate(i,d),h=$.coral.formatDate(h,g,c)}return c.input.val(h),g},_attachments:function(a){var b,c,d=this,e=this.options,f=e.appendText,g=e.isRTL;e.append&&e.append.remove(),f&&(e.append=$("<span class='"+this._appendClass+"'>"+f+"</span>"),a[g?"before":"after"](e.append)),a.unbind("focus",this.show),a.unbind("blur"),a.parent().unbind("mouseleave"),a.parent().unbind("mouseenter"),a.unbind(".attachments"),e.trigger&&e.trigger.remove();var h=$.coral.trim(e.value);if(""==a.parent().find("input[type='hidden']").val()&&"string"==typeof h&&""!=h)d._processDefaultDate(d,h),d._setHiddenInputValue();else{var i=d._getHiddenInputValue();d._processDefaultDate(d,i)}a.parent().find(".coral-input-clearIcon").unbind("click").bind("click",function(a){d.setValue("",!0)}),b=e.showOn,a.focus(function(a){"focus"!==b&&"both"!==b||d.show(a),d.options.readonly||d.options.isLabel||d.component().addClass("coral-state-focus")}),"button"!==b&&"both"!==b||(c=e.buttonText,e.trigger=$("<span/>").addClass("coral-icon-calendar cui-icon-calendar4"),a[g?"before":"after"](e.trigger),1==e.isLabel&&a.parent().addClass("coral-datepicker-no-close"),e.trigger.click(function(b){return d._datepickerShowing&&d._lastInput===a[0]?d.hide():d._datepickerShowing&&d._lastInput!==a[0]&&d.hide(),d.show(),!1})),a.blur(function(a){d._inputBlur(e,a)}),a.parent().mouseleave(function(){e.readonly||e.isLabel||e.disabled||e.readonlyInput||a.parent().parent().removeClass("coral-textbox-hover")}),a.parent().mouseenter(function(){e.readonly||e.isLabel||e.disabled||e.readonlyInput||a.parent().parent().addClass("coral-textbox-hover")}),a.bind("keyup.attachments",function(a){switch(a.keyCode){case 9:d.show(a)}})},_autoSize:function(){var a=this.options;if(a.autoSize&&!a.inline){var b,c,d,e,f=new Date(2009,11,20),g=a.dateFormat;if(g.match(/[DM]/)){b=function(a){for(c=0,d=0,e=0;e<a.length;e++)a[e].length>c&&(c=a[e].length,d=e);return d};g.match(/MM/)?"monthNames":"monthNamesShort",g.match(/DD/)?"dayNames":"dayNamesShort";f.setMonth(b(a.matchMM)),f.setDate(b(a.amtchDD)+20-f.getDay())}a.input.attr("size",this._formatDate(f).length)}},inline:function(){var a=this.element[0],b=this.options,c=$(a);c.hasClass(this.markerClassName)||(c.addClass(this.markerClassName).append(b.dpDiv),this._setDate(this._getDefaultDate(),!0),this.update(),this._updateAlternate(),b.disabled&&this.disable(a),b.dpDiv.css("display","block"))},dialog:function(a,b,c,d){var e,f,g,h,i,j=(this.element[0],this),k=this._dialogInst;return k||(this.uuid+=1,e="dp"+this.uuid,this._dialogInput=$("<input type='text' id='"+e+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown({that:j},this._doKeyDown),$("body").append(this._dialogInput),this._newInst(this._dialogInput,!1),this._dialogInst=k,inst.options={}),j.extendRemove(inst.options,c||{}),a=a&&a.constructor===Date?this._formatDate(inst,a):a,this._dialogInput.val(a),this._pos=d?d.length?d:[d.pageX,d.pageY]:null,this._pos||(f=document.documentElement.clientWidth,g=document.documentElement.clientHeight,h=document.documentElement.scrollLeft||document.body.scrollLeft,i=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[f/2-100+h,g/2-150+i]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),inst.options.onSelect=b,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this.show(),$.blockUI&&$.blockUI(this.dpDiv),this},_destroy:function(){var a,b=this.options,c=this.element[0],d=$(c);$(c).parent().parent().replaceWith(d),d.hasClass(this.markerClassName)&&(a=c.nodeName.toLowerCase(),$.removeData(c,"inited"),b.isShow=!1,"input"===a?(b.append.remove(),b.trigger.remove(),d.removeClass(this.markerClassName).unbind(".field").unbind(".restrictInput").unbind("blur").unbind("focus").unbind("keydown").unbind("keypress").unbind("keyup").unbind("datepickeronblur").unbind("datepickeronchange").unbind("datepickeronkeydown").unbind("datepickeronkeyup").unbind("datepickeronstatus").unbind("onOptionChange")):"div"!==a&&"span"!==a||d.removeClass(this.markerClassName).empty(),$(c).val(""),$(c).removeAttr("value"),d.removeAttr("component-role").removeClass("coral-textbox-default coral-validation-datepicker coral-form-element-datepicker ctrl-init ctrl-form-element ctrl-init-datepicker").removeAttr("data-options"))},enable:function(){var a,b,c=this.element[0],d=this.options,e=$(c);e.hasClass(this.markerClassName)&&(a=c.nodeName.toLowerCase(),"input"===a?(c.disabled=!1,d.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""}),e.parent().parent().removeClass("coral-state-disabled")):"div"!==a&&"span"!==a||(b=e.children("."+this._inlineClass),b.children().removeClass("coral-state-disabled"),b.find("select.coral-datepicker-month, select.coral-datepicker-year").prop("disabled",!1)),this._disabledInputs=$.map(this._disabledInputs,function(a){return a===c?null:a}))},disable:function(){var a,b,c=this.element[0],d=this.options,e=$(c);e.hasClass(this.markerClassName)&&(a=c.nodeName.toLowerCase(),"input"===a?(c.disabled=!0,d.trigger.css({opacity:"0.5",cursor:"default"}),e.parent().parent().addClass("coral-state-disabled")):"div"!==a&&"span"!==a||(b=e.children("."+this._inlineClass),b.children().addClass("coral-state-disabled"),b.find("select.coral-datepicker-month, select.coral-datepicker-year").prop("disabled",!0)),this._disabledInputs=$.map(this._disabledInputs,function(a){return a===c?null:a}),this._disabledInputs[this._disabledInputs.length]=c)},readonly:function(a){var b=this.element[0],c=$(b);c.hasClass(this.markerClassName)&&($(b).parent().parent().removeClass("coral-isLabel"),$(b).parent().parent().toggleClass("coral-readonly",a),$(b).toggleClass("tabbable",!a),this._readonly(b,a))},_readonly:function(a,b){var c=a.nodeName.toLowerCase(),d=this.options;if("input"===c&&b&&(a.readOnly=!0,d.trigger.filter("button").each(function(){this.readOnly=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})),"input"===c&&!b){if(this.isIsLabel())return;a.readOnly=!1,d.trigger.filter("button").each(function(){this.readOnly=!1}).end().filter("img").css({opacity:"1.0",cursor:""})}},readonlyInput:function(a){this.options.readonly||this.element.prop("readonly",a)},isReadonly:function(){return this.options.readonly?this.options.readonly:!1},isReadonlyInput:function(){return this.options.readonlyInput?this.options.readonlyInput:!1},isIsLabel:function(){return this.options.isLabel?this.options.isLabel:!1},isLabel:function(a){var b=this.element[0],c=$(b),d=this.options;if(c.hasClass(this.markerClassName)){d.id;a?(c.parent().removeClass("coral-datepicker-no-close"),c.parent().parent().removeClass("coral-readonly"),c.parent().parent().addClass("coral-isLabel"),c.removeClass("tabbable")):(c.parent().parent().removeClass("coral-isLabel coral-readonly"),c.parent().addClass("coral-datepicker-no-close"),c.addClass("tabbable")),this.options.readonly=a,this.options.isLabel=a,this._readonly(b,a)}},isDisabled:function(){var a=this.element[0];if(!a)return!1;for(var b=0;b<this._disabledInputs.length;b++)if(this._disabledInputs[b]===a)return!0;return!1},_doOption:function(a,b){var c,d,e,f=this,g=this.options;c=this.getDate(!0),d=this._getMinMaxDate("min"),e=this._getMinMaxDate("max");var h=this._getHiddenInputValue();if("value"==a){if(b){var i=getFormatter(b,g.dateFormat,g),j=$.coral.parseDate(i,b,g),k=g.srcDateFormat;2===this._checkDateRange(j)&&(b=$.coral.formatDate(k,d,g)),1===this._checkDateRange(j)&&(b=$.coral.formatDate(k,e,g))}c=f._processDefaultDate(f,b)}(null!==d&&"dateFormat"==a||null!==d&&"minDate"==a)&&(g.minDate=this._formatDate(d)),(null!==e&&"dateFormat"==a||null!==e&&"maxDate"==a)&&(g.maxDate=this._formatDate(e)),"disabled"==a&&(b?this.disable():this.enable()),"readonlyInput"==a&&this.readonlyInput(b),"readonly"==a&&this.readonly(b),"isLabel"==a&&this.isLabel(b),"showAnim"!=a&&("startDateId"===a&&$("#"+b).datepicker("option","endDateId",g.id),this._attachments(this.element),this._autoSize(),this._setDate(c),g.isShow&&this.update(),this._updateAlternate(),this._setHiddenInputValue(),"value"==a&&this._setStartEnd(h,b))},_setOption:function(a,b){"value"==a&&"long"==this.options.valueType&&(b=$.coral.longToStringDate(b,this.options)),this._super(a,b),this._doOption(a,b)},valid:function(){var a=this.element[0],b={hasTips:!1,element:$(a)};return!($.validate.validateField(null,b).length>0)},change:function(a,b){this.element[0];this.option(a,b)},refresh:function(){var a=(this.element[0],this.options);a&&this.update()},reset:function(){var a=this.element[0];$(a).datepicker("option","value",this.originalValue)},setValue:function(a,b){var c=this.options;"long"==c.valueType&&(a=$.coral.longToStringDate(a,c));var d=(this.element[0],this._getHiddenInputValue()),a=$.coral.trim(a);this._doOption("value",a),b&&this._change(d,a)},getValue:function(a){var b=(this.element[0],this.options),c=this.getDateValue();return"long"==b.valueType&&(c=$.coral.stringToLongDate(c,b)),c},getText:function(){return this.options.input.val()},getValidateValue:function(){return this.options.restrictConvert&&"long"==this.options.valueType?this.getText():this.getValue()},setDate:function(a){var b=this.options,c=b.dateFormat,d=$.coral.formatDate(c,a,b);this.setValue(d)},getDate:function(a){var b=(this.element[0],this.options);return b&&!b.inline&&this._setDateFromField(b,a),b?this._getDate():null},getDateValue:function(){this.element[0],this.options;return this._getHiddenInputValue()},_doKeyDown:function(a){var b,c,d,e=a.data.that,f=e.options,g=!0,h=f.dpDiv.is(".coral-datepicker-rtl"),i=e._getHiddenInputValue();if(f._keyEvent=!0,e._datepickerShowing)switch(a.keyCode){case 9:e.hide(),g=!1;break;case 13:d=$("td."+e._dayOverClass+":not(."+e._currentClass+")",f.dpDiv),d[0]&&e._selectDay(a.target,f.selectedMonth,f.selectedYear,d[0]),b=f.onSelect,b?c=e._formatDate():e.hide();case 27:e.hide();break;case 33:e._adjustDate(a.target,a.ctrlKey?-f.stepBigMonths:-f.stepMonths,"M");break;case 34:e._adjustDate(a.target,a.ctrlKey?+f.stepBigMonths:+f.stepMonths,"M");break;case 35:(a.ctrlKey||a.metaKey)&&e._clearDate(),g=a.ctrlKey||a.metaKey;break;case 36:(a.ctrlKey||a.metaKey)&&e._gotoToday(a.target),g=a.ctrlKey||a.metaKey;break;case 37:(a.ctrlKey||a.metaKey)&&e._adjustDate(a.target,h?1:-1,"D"),g=a.ctrlKey||a.metaKey,a.originalEvent.altKey&&e._adjustDate(a.target,a.ctrlKey?-f.stepBigMonths:-f.stepMonths,"M");break;case 38:(a.ctrlKey||a.metaKey)&&e._adjustDate(a.target,-7,"D"),g=a.ctrlKey||a.metaKey;break;case 39:(a.ctrlKey||a.metaKey)&&e._adjustDate(a.target,h?-1:1,"D"),g=a.ctrlKey||a.metaKey,a.originalEvent.altKey&&e._adjustDate(a.target,a.ctrlKey?+f.stepBigMonths:+f.stepMonths,"M");break;case 40:(a.ctrlKey||a.metaKey)&&e._adjustDate(a.target,7,"D"),g=a.ctrlKey||a.metaKey;break;default:g=!1}else if(36===a.keyCode&&a.ctrlKey)e.show();else switch(g=!1,a.keyCode){case 9:case 13:e._setHiddenInputValue(),c=e._getHiddenInputValue(),e._setStartEnd(i,c),e._change(i,c)}f.shortCut&&$.coral.callFunction(f.shortCut,a,this),e._trigger("onKeyDown",a,[{oldValue:i,value:f.input.val()}]),g&&(a.preventDefault(),a.stopPropagation())},_setStartEnd:function(a,b){var c=this.options;if(a!=b){var d=c.startDateId,e=c.endDateId;d&&$("#"+d).datepicker("option","maxDate",b),e&&$("#"+e).datepicker("option","minDate",b)}},_change:function(a,b,c){a!=b&&(this.options.value=b,this._trigger("onChange",c,[{oldValue:a,newValue:b,value:b}]))},_doKeyPress:function(a){},_doKeyUp:function(a){var b,c=a.data.that,d=c.options,e=c._getHiddenInputValue(),f=c._getMinMaxDate("min"),g=c._getMinMaxDate("max");if(d.input.val()!==d.lastVal){try{""==d.input.val()&&(d.selectedDay=null,d.drawMonth=d.selectedMonth=null,d.drawYear=d.selectedYear=null,d.currentDay=null,d.currentMonth=null,d.currentYear=null,d.currentHur=null,d.currentMiu=null,d.currentSed=null),b=$.coral.parseDate(d.dateFormat,d.input?d.input.val():null,d),d.input.addClass("isEdit"),b&&0===c._checkDateRange(b)?(c._setDateFromField(),c._updateAlternate()):1===c._checkDateRange(b)?(d.currentDay=g.getDate(),d.currentMonth=g.getMonth(),d.currentYear=g.getFullYear()):2===c._checkDateRange(b)&&(d.currentDay=f.getDate(),d.currentMonth=f.getMonth(),d.currentYear=f.getFullYear());d.input.val()}catch(h){d.input.val()}c._trigger("onKeyUp",a,[{oldValue:e,value:d.input.val()}])}return!0},_checkDateRange:function(a){var b,c,b=(this.options,this._getMinMaxDate("min"));return c=this._getMinMaxDate("max"),null!=c&&a>c?1:null!=b&&b>a?2:0},_srcDateFormatSeparator:function(a){var b="/";return a.indexOf("/")>-1?b:a.indexOf("-")>-1?b="-":void 0},_setHiddenInputValue:function(){var a=this.options;if(""==a.input.val())return void a.input.parent().find("input[type='hidden']").val("");var b=a.dateFormat,c=c||a.srcDateFormat,d=this._srcDateFormatSeparator(c);if(null==a.currentYear||null==a.currentMonth)return void a.input.parent().find("input[type='hidden']").val("");var e=_daylightSavingAdjustWidthTime(new Date(a.currentYear,a.currentMonth,a.currentDay),[a.currentHur,a.currentMiu,a.currentSed]),f=getFormatter(a.input.val(),a.dateFormat,a),g=this.completeFormate(f,b);if(a.complete)h=$.coral.formatDate(c,e,a);else if(c.indexOf("-")>-1||c.indexOf("/")>-1){g=g.indexOf("y")>-1&&g.indexOf("M")>-1&&g.indexOf("d")>-1?c:g;var h=$.coral.formatDate(g,e,_getFormatConfig(a));if(h.indexOf("-")>-1)var h=-1==h.indexOf(d)?h.replace(/-/gm,d):h;else if(h.indexOf("/")>-1)var h=-1==h.indexOf(d)?h.replace(/\//gm,d):h}else g=g.indexOf("-")>-1?g.replace(/-/gm,""):g.replace(/\//gm,""),g.indexOf("y")>-1&&(-1==g.indexOf("d")&&g.indexOf("y")>-1&&g.indexOf("M")>-1&&(c=c.split(" ")[0],g=c.replace(/d/gm,"")),g=g.indexOf("y")>-1&&g.indexOf("M")>-1&&g.indexOf("d")>-1?c:g),h=$.coral.formatDate(g,e,a);a.input.parent().find("input[type='hidden']").val(h)},_getHiddenInputValue:function(){var a=this.options;a.id;return a.input.parent().find("input[type='hidden']").val()},_createEditFormat:function(a){var b="";return null!=a&&(b+=this._isYearMonthMode(a)?"yyyy-MM":this._isYearMode(a)?"yyyy":"yyyy-MM-dd",_hasTime(a)&&(b+=" HH:mm:ss")),b},completeFormate:function(a,b){var c,d=this.options,e=b.indexOf("H")>-1?b.split(" ")[0]:b;if(d.complete)return b;if(-1==e.indexOf("d"))return-1==e.indexOf("d")&&-1==a.indexOf("M")?a:e;if(e.indexOf("d")>-1){var f=e.indexOf("y"),g=e.indexOf("d"),h=e.substr(g+2,e.length),i=e.substr(0,g-1);e.substr(0,g+2);if(2==a.length)return a;if(a.indexOf("y")>-1&&a.indexOf("d")>-1&&a.indexOf("M")>-1)return b;if(-1==a.indexOf("d")){if(-1==a.indexOf("M"))return a;0==g&&(c=h),8==g&&(c=i),3==g&&(c=i+h)}else-1==a.indexOf("y")&&(0==f&&(c=e.substr(f+5,5)),6==f&&(c=e.substr(0,f-1)))}return c},compMaxMin:function(){var a=this.options,b=this._getMinMaxDate("min"),c=this._getMinMaxDate("max");b&&a.currentYear==b.getFullYear()&&a.currentMonth==b.getMonth()&&a.currentDay==b.getDate().toString()?a.currentHur<b.getHours()?(a.currentHur=b.getHours(),a.currentMiu=b.getMinutes(),a.currentSed=b.getSeconds()):a.currentHur==b.getHours()&&(a.currentHur=b.getHours(),a.currentMiu<b.getMinutes()?(a.currentMiu=b.getMinutes(),a.currentSed=b.getSeconds()):a.currentMiu==b.getMinutes()&&(a.currentMiu=b.getMinutes(),a.currentSed<=b.getSeconds()&&(a.currentSed=b.getSeconds()))):c&&a.currentYear==c.getFullYear()&&a.currentMonth==c.getMonth()&&a.currentDay==c.getDate().toString()&&(a.currentHur>c.getHours()?(a.currentHur=c.getHours(),a.currentMiu=c.getMinutes(),a.currentSed=c.getSeconds()):a.currentHur==c.getHours()&&(a.currentHur=c.getHours(),a.currentMiu>c.getMinutes()?(a.currentMiu=c.getMinutes(),a.currentSed=c.getSeconds()):a.currentMiu==c.getMinutes()&&(a.currentMiu=c.getMinutes(),a.currentSed>=c.getSeconds()&&(a.currentSed=c.getSeconds()))))},_inputBlur:function(a){this.component().removeClass("coral-state-focus");var b=this.options,c=b.dateFormat;if(!this.isReadonly()&&!this.isIsLabel()){var d=this._getHiddenInputValue(),e="";this._getMinMaxDate("min"),this._getMinMaxDate("max");this.compMaxMin();var f=_daylightSavingAdjustWidthTime(new Date(b.currentYear,b.currentMonth,b.currentDay),[b.currentHur,b.currentMiu,b.currentSed]);if(("undefined"!=typeof b.currentYear||null!=b.currentYear)&&!b.isShow){var g=getFormatter(b.input.val(),b.dateFormat,b),h=/[\u4E00-\u9FA5]|[\uFE30-\uFFA0]|[a-zA-Z]|[`~!@#\$%\^\&\*\(\)_\+<>\?"\{\},\.\\\;'\[\]]|^[-\/:]|[-\/:]$/gi;h.exec(b.input.val())&&b.input.val(""),""!=b.input.val()&&(e=this.completeFormate(g,c),e=$.coral.formatDate(e,f,b)),b.input.val(e),this._setHiddenInputValue(),this._setStartEnd(d,e),this._change(d,e,null),this._trigger("onBlur",a,[{value:e}])}}},focus:function(a){return a?input=a.target:input=this.element[0],"input"!==input.nodeName.toLowerCase()&&(input=$("input",input.parentNode)[0]),this.isDisabled()||this._lastInput===input||this.isReadonly()||this.isIsLabel()||this.isReadonlyInput()?!1:(input.focus(),!0)},show:function(a){var b,c=this,d=this.options;if(b=a?a.target:this.element[0],"input"!==b.nodeName.toLowerCase()&&(b=$("input",b.parentNode)[0]),!(c.isDisabled()||c._lastInput===b||c.isReadonly()||c.isIsLabel())){var e,f,g,h,i,j;if($.coral._curInst&&$.coral._curInst!==d&&($.coral._curInst.dpDiv.stop(!0,!0),d&&c._datepickerShowing&&c.hide()),e=d.beforeShow,f=e?e.apply(b,[b,d]):{},f!==!1){c.extendRemove(d,f),d.lastVal=null,c._lastInput=b,c._setDateFromField(),c._inDialog&&(b.value=""),c._pos||(c._pos=c._findPos(b),c._pos[1]+=b.offsetHeight),g=!1,$(b).parents().each(function(){return g|="fixed"===$(this).css("position"),!g}),h={left:c._pos[0],top:c._pos[1]},c._pos=null,d.dpDiv.empty(),d.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),c.iframePanel.css({position:"absolute",display:"block",top:"-1000px"}),c.update();var k=$(d.dpDiv),l=c.iframePanel,m=k.width(),n=k.height();h=c._checkOffset(h,g),d.dpDiv.css({position:c._inDialog&&$.blockUI?"static":g?"fixed":"absolute",
display:"none",left:h.left+"px",top:h.top+"px"}),c.iframePanel.css({position:c._inDialog&&$.blockUI?"static":g?"fixed":"absolute",display:"none",left:h.left+"px",top:h.top+"px",width:m,height:n}),d.isShow||(d.isShow=!0,d.inline||(i=d.showAnim,j=d.duration,null!=d.zIndex&&(d.dpDiv.zIndex(d.zIndex+1),c.iframePanel.zIndex(d.zIndex)),c._datepickerShowing=!0,$.effects&&$.effects.effect[i]?d.dpDiv.show(i,d.showOptions,j):d.dpDiv[i||"show"](i?j:null),c.iframePanel.show(i),c._shouldFocusInput()&&d.input.focus(),c._curInst=d,$.coral._curInst=c._curInst),function o(){var a=$(b).parent().parent();d.isShow&&(k.css({left:$.coral.getLeft(k,a),top:$.coral.getTop(k,a)}),l.css({left:$.coral.getLeft(k,a),top:$.coral.getTop(k,a)}),setTimeout(o,200))}()),d.dpDiv.find("#dpTimeSpinner").spinner("setValue",d.dpDiv.find("#dpTimeHour").val()),d.dpDiv.find("#dpTimeSpinner").spinner("setValue",d.dpDiv.find("#dpTimeMinute").val()),d.dpDiv.find("#dpTimeSpinner").spinner("setValue",d.dpDiv.find("#dpTimeSecond").val())}}},_updateDateTime:function(){var a,b,c,d,e,f,g=this,h=[],i=this.options;if("timepicker"==i.model){var j=new Date;h.push(j.getFullYear(),j.getMonth(),j.getDate());var k=i.minTime?h.join("-")+" "+i.minTime:null,l=i.maxTime?h.join("-")+" "+i.maxTime:null,m=new Date(k),n=new Date(l);d=new Date(j.getFullYear(),j.getMonth(),j.getDate()),e=f=d}else{var k=this._getMinMaxDate("min"),l=this._getMinMaxDate("max"),m=new Date(k),n=new Date(l);d=new Date(i.selectedYear,i.selectedMonth,i.selectedDay),e=new Date(m.getFullYear(),m.getMonth(),m.getDate()),f=new Date(n.getFullYear(),n.getMonth(),n.getDate())}i.dpDiv.find("#coral-timePanel").find("#dpTimeHour").spinner({max:24,min:0,step:1,vertical:!0,onSpin:function(b,c){var h=$(this).spinner("getValue");return a=c.value,new Date(d).getTime()==new Date(e).getTime()&&k&&a<m.getHours()||l&&new Date(d).getTime()==new Date(f).getTime()&&a>n.getHours()?($(this).find("#dpTimeHour").val(h),!1):void g._selectTime(a)}}),i.dpDiv.find("#coral-timePanel").find("#dpTimeMinute").spinner({max:60,min:0,step:1,vertical:!0,onSpin:function(a,c){var h=$(this).spinner("getValue");b=c.value;var j=i.dpDiv.find("#dpTimeHour").val();return new Date(d).getTime()==new Date(e).getTime()&&k&&b<m.getMinutes()&&j<=m.getHours()||l&&new Date(d).getTime()==new Date(f).getTime()&&b>n.getMinutes()&&j>=n.getHours()?($(this).find("#dpTimeMinute").val(h),!1):void g._selectTime(null,c.value)}}),i.dpDiv.find("#coral-timePanel").find("#dpTimeSecond").spinner({max:60,min:0,step:1,vertical:!0,onSpin:function(a,b){var h=$(this).spinner("getValue");c=b.value;var j=i.dpDiv.find("#dpTimeHour").val(),o=i.dpDiv.find("#dpTimeMinute").val();return new Date(d).getTime()==new Date(e).getTime()&&k&&c<m.getSeconds()&&j<=m.getHours()&&o<=m.getMinutes()||l&&new Date(d).getTime()==new Date(f).getTime()&&c>n.getSeconds()&&j>=n.getHours()&&o>=n.getMinutes()?($(this).find("#dpTimeSecond").val(h),!1):void g._selectTime(null,null,b.value)}})},update:function(){var a=this.options,b=this;this.maxRows=4,datepicker_instActive=a,"datepicker"==a.model?(a.dpDiv.empty().append(this._generateHTML()).append(this._generateTimePanel()),a.dpDiv.find("#timepicker").find(".icon-checkmark").hide()):a.dpDiv.empty().append(this._generateTimePanel()),this._updateDateTime(),this._attachHandlers(),this._attachTimeHandlers();var c,d=this._getNumberOfMonths(),e=d[1],f=17,g=a.dpDiv.find("."+this._dayOverClass+" a");g.length>0&&this.datepicker_handleMouseover.apply(g.get(0),[b]),a.dpDiv.removeClass("coral-datepicker-multi-2 coral-datepicker-multi-3 coral-datepicker-multi-4").width(""),e>1&&a.dpDiv.addClass("coral-datepicker-multi-"+e).css("width",f*e+"em"),a.dpDiv[(1!==d[0]||1!==d[1]?"add":"remove")+"Class"]("coral-datepicker-multi"),a.dpDiv[(a.isRTL?"add":"remove")+"Class"]("coral-datepicker-rtl"),a===this._curInst&&this._datepickerShowing&&this._shouldFocusInput(),a.yearshtml&&(c=a.yearshtml,setTimeout(function(){c===a.yearshtml&&a.yearshtml&&a.dpDiv.find("select.coral-datepicker-year:first").replaceWith(a.yearshtml),c=a.yearshtml=null},0))},_shouldFocusInput:function(){var a=this.options;return a.input&&a.input.is(":visible")&&!a.input.is(":disabled")&&!a.input.is(":focus")},_checkOffset:function(a,b){var c=this.options,d=c.dpDiv.outerWidth(),e=c.dpDiv.outerHeight(),f=c.input?c.input.outerWidth():0,g=c.input?c.input.outerHeight():0,h=document.documentElement.clientWidth+(b?0:$(document).scrollLeft()),i=document.documentElement.clientHeight+(b?0:$(document).scrollTop());return a.left-=c.isRTL?d-f:0,a.left-=b&&a.left===c.input.offset().left?$(document).scrollLeft():0,a.top-=b&&a.top===c.input.offset().top+g?$(document).scrollTop():0,a.left-=Math.min(a.left,a.left+d>h&&h>d?Math.abs(a.left+d-h):0),a.top-=Math.min(a.top,a.top+e>i&&i>e?Math.abs(e+g):0),a},_findPos:function(a){for(var b,c=this.options,d=c.isRTL;a&&("hidden"===a.type||1!==a.nodeType||$.expr.filters.hidden(a));)a=a[d?"previousSibling":"nextSibling"];return b=$(a).offset(),[b.left,b.top]},hide:function(a){var b,c,d,e,a=this.element[0],f=this,g=this._curInst;!g||a&&g!==this.options||(g.isShow=!1,this._datepickerShowing&&(b=g.showAnim,c=g.duration,d=function(){f._tidyDialog(g)},$.effects&&($.effects.effect[b]||$.effects[b])?g.dpDiv.hide(b,g.showOptions,c,d):g.dpDiv["slideDown"===b?"slideUp":"fadeIn"===b?"fadeOut":"hide"](b?c:null,d),this.iframePanel.hide(),b||d(),this._datepickerShowing=!1,e=g.onClose,e&&e.apply(g.input?g.input[0]:null,[g.input?g.input.val():"",g]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),$.blockUI&&($.unblockUI(),$("body").append(this.dpDiv))),this._inDialog=!1))},_tidyDialog:function(a){a.dpDiv.removeClass(this._dialogClass).unbind(".coral-datepicker-calendar")},_checkExternalClick:function(a){var b=a.data.that;if(b._curInst){var c=$(a.target),d=b.options;a.isDefaultPrevented()||(c[0].id===b._mainDivId||0!==c.parents("#"+b._mainDivId).length||c.hasClass(b.markerClassName)||c.closest("."+b._triggerClass).length||!b._datepickerShowing||b._inDialog&&$.blockUI)&&(!c.hasClass(b.markerClassName)||b._curInst===d)||b.hide()}},_adjustDate:function(a,b,c){var d=$(a),e=this.options;this.isDisabled(d[0])||this.isReadonly()||this.isIsLabel()||(this._adjustInstDate(b+("M"===c?e.showCurrentAtPos:0),c),this.update())},_gotoToday:function(a){var b,c=this,d=($(a),this.options),e=_hasTime(d.dateFormat);if(d.gotoCurrent&&d.currentDay)d.selectedDay=d.currentDay,d.drawMonth=d.selectedMonth=d.currentMonth,d.drawYear=d.selectedYear=d.currentYear;else{if(b=new Date,e||b.setHours(0,0,0,0),1===c._checkDateRange(b))return;if(2===c._checkDateRange(b))return;d.selectedDay=b.getDate(),d.drawMonth=d.selectedMonth=b.getMonth(),d.drawYear=d.selectedYear=b.getFullYear(),d.currentHur=b.getHours(),d.currentMiu=b.getMinutes(),d.currentSed=b.getSeconds()}if(this._notifyChange(),e)this._selectDateTime();else{var f=d.dpDiv.children("table").find(".coral-datepicker-today");this._selectDay(a,+f.attr("data-month"),+f.attr("data-year"),f[0])}this._updateDateTime()},_selectMonthYear:function(a,b,c,d){var e=$(a),f=this,g=this.options,h=this._isYearMonthMode(g.dateFormat),i=this._isYearMode(g.dateFormat);h===!0?g["draw"+("M"===c?"Month":"Year")]=parseInt("M"===c?$(b).attr("data-month"):b.options[b.selectedIndex].value,10):i===!0?g.drawYear=parseInt("Y"===c?$(b).attr("data-year"):b.options[b.selectedIndex].value,10):g["draw"+("M"===c?"Month":"Year")]=parseInt(b.options[b.selectedIndex].value,10),g["selected"+("M"===c?"Month":"Year")]=g["draw"+("M"===c?"Month":"Year")];var j=this._getHiddenInputValue();h===!0&&"M"===c&&this._setMonthYearValue(this),i===!0&&this._setMonthYearValue(this);var k=this._getHiddenInputValue();this._notifyChange(),d&&(f._setStartEnd(j,k),f._change(j,k,null)),this._adjustDate(e)},_setMonthYearValue:function(a){var b=this.options,c=b.dateFormat;a._isYearMonthMode(c)&&(b.currentYear=b.selectedYear,b.currentMonth=b.selectedMonth,b.currentDay=b.selectedDay=1),a._isYearMode(c)&&(b.currentYear=b.selectedYear,b.currentMonth=b.selectedMonth=1,b.currentDay=b.selectedDay=1);var d=a._formatDate();b.input&&b.input.val(d),a._setHiddenInputValue()},_selectDay:function(a,b,c,d){var e=this.options;$(a);if(!($(d).hasClass(this._unselectableClass)||this.isDisabled()||this.isReadonly()||this.isIsLabel())){e.selectedDay=e.currentDay=$("a",d).html(),e.selectedMonth=e.currentMonth=b,e.selectedYear=e.currentYear=c;e.dateFormat,this._getMinMaxDate("min"),this._getMinMaxDate("max");this.compMaxMin(),this._autoFixInput(this);e.dpDiv.find("#dpTimeHour").val(),e.dpDiv.find("#dpTimeMinute").val(),e.dpDiv.find("#dpTimeSecond").val();this._selectDate(a,this._formatDate(e.currentDay,e.currentMonth,e.currentYear)),$(d).parent().parent().find("a").removeClass("coral-state-active"),$(d).children("a").addClass("coral-state-active"),this.update(),this.options.closeOnClick&&-1==e.dateFormat.indexOf("H")&&this.hide()}},_clearDate:function(){this._setDate("")},clearError:function(){var a=this.element[0];$(".coral-validate-state-error").remove(),$(".coral-errorIcon").remove(),$(".coral-validate-error").removeClass("coral-validate-error"),$(a).prop("isError",!1)},_selectDate:function(a,b){var c=($(a),this.options);c.dateFormat;if(b=null!=b?b:this._formatDate(),c.input&&c.input.val(b),this._updateAlternate(),c.inline)this.update();else{this._lastInput=c.input[0],"object"!=typeof c.input[0]&&c.input.focus(),this._lastInput=null;var d=this._getHiddenInputValue();this._setHiddenInputValue();var e=this._getHiddenInputValue();e!==d&&(this._setStartEnd(d,e),this._change(d,e,null))}this._trigger("onSelect",null,[{oldValue:d,newValue:e}])},_attachTimeHandlers:function(){function a(a,b){var c=b?function(){var b=0;return a.children(":visible").each(function(a){b+=$(this).outerHeight(!0)}),b}():0;a.height(c)}var b=this.options;this._getHiddenInputValue();this._setHiddenInputValue();this._getHiddenInputValue();b.dpDiv.find("#timePanel").bind("mousedown",function(c){var d=b.dpDiv.find("#datepicker"),e=b.dpDiv.find("#timepicker");d.hasClass("in")?(a(d,!0),a(d,!1),a(e,!0),setTimeout(function(){e.css("height","auto")},350)):(a(e,!0),a(d,!0),a(e,!1),setTimeout(function(){d.css("height","auto")},350)),d.toggleClass("in"),c.preventDefault()}),this._verifyInput(b.dpDiv.find("#dpTimeHour"),"H"),this._verifyInput(b.dpDiv.find("#dpTimeMinute"),"m"),this._verifyInput(b.dpDiv.find("#dpTimeSecond"),"s")},_autoFixInput:function(a){var b=this.options,c=a._getMinMaxDate("min"),d=a._getMinMaxDate("max"),e=b.dpDiv.find("#dpTimeHour").val(),f=b.dpDiv.find("#dpTimeMinute").val(),g=b.dpDiv.find("#dpTimeSecond").val();e=e.replace(/[^0-9]/g,""),""==e&&(e=b.currentHur),f=f.replace(/[^0-9]/g,""),""==f&&(f=b.currentMiu),g=g.replace(/[^0-9]/g,""),""==g&&(g=b.currentSed);var h=new Date(b.currentYear,b.currentMonth,b.currentDay,e,f,g),i=h;1===a._checkDateRange(h)?i=d:2===a._checkDateRange(h)&&(i=c),b.dpDiv.find("#dpTimeHour").spinner("setValue",i.getHours()||"00"),b.dpDiv.find("#dpTimeMinute").spinner("setValue",i.getMinutes()||"00"),b.dpDiv.find("#dpTimeSecond").spinner("setValue",i.getSeconds()||"00")},_verifyInput:function(a,b){var c=this,d=59;d="H"==b?23:d,a.change(function(){c._autoFixInput(c)}).bind("paste",function(){c._autoFixInput(c)})},_selectTime:function(a,b,c){var d=this.options,e=this._getHiddenInputValue(),f=a||d.dpDiv.find("#dpTimeHour").val(),g=b||d.dpDiv.find("#dpTimeMinute").val(),c=c||d.dpDiv.find("#dpTimeSecond").val();d.currentHur=f,d.currentMiu=g,d.currentSed=c,d.input.val(this._formatDate()),this._setHiddenInputValue();var h=this._getHiddenInputValue();this._change(e,h,null)},_selectDateTime:function(){var a=this._getHiddenInputValue(),b=this.options,c=this._getMinMaxDate("min"),d=this._getMinMaxDate("max"),e=new Date;if(!b.selectedYear){b.currentDay=b.selectedDay=e.getDate(),b.currentMonth=b.selectedMonth=e.getMonth(),b.currentYear=b.selectedYear=e.getFullYear();var f=new Date(b.currentYear,b.currentMonth,b.currentDay,hur,miu,sed);c||d?1===this._checkDateRange(f)?(b.selectedDay=d.getDate(),b.selectedMonth=d.getMonth(),b.selectedYear=d.getFullYear()):2===this._checkDateRange(f)&&(b.selectedDay=c.getDate(),b.selectedMonth=c.getMonth(),b.selectedYear=c.getFullYear()):b.input.val(f)}b.input.val(this._formatDate()),this._setHiddenInputValue(),this._updateAlternate();var g=this._getHiddenInputValue();this._setStartEnd(a,g),this._change(a,g,null);$(b.input[0]);this.hide()},_hasHur:function(a){var b=a+"";return-1!=b.indexOf("H")},_hasMin:function(a){var b=a+"";return-1!=b.indexOf("m")},_hasSec:function(a){var b=a+"";return-1!=b.indexOf("s")},_isYearMonthMode:function(a){return _hasTime(a)?!1:-1!=a.indexOf("M")&&-1!=a.indexOf("y")&&-1==a.indexOf("d")},_isYearMode:function(a){return _hasTime(a)?!1:-1!=a.indexOf("y")&&-1==a.indexOf("M")&&-1==a.indexOf("d")},_updateAlternate:function(){var a,b,c,d=this.options,e=d.altField;e&&(a=d.altFormat||d.dateFormat,b=this._getDate(),c=$.coral.formatDate(a,b,d),$(e).each(function(){$(this).val(c)}))},noWeekends:function(a){var b=a.getDay();return[b>0&&6>b,""]},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,_possibleChars:function(a){var b,c="",d=!1,e=function(c){var d=b+1<a.length&&a.charAt(b+1)===c;return d&&b++,d};for(b=0;b<a.length;b++)if(d)"'"!==a.charAt(b)||e("'")?c+=a.charAt(b):d=!1;else switch(a.charAt(b)){case"d":case"m":case"y":case"@":case"H":case"M":case"s":c+="0123456789";break;case"D":case"W":return null;case"'":e("'")?c+="'":d=!0;break;default:c+=a.charAt(b)}return c},_setDateFromField:function(a){var b=this.options,c=b.dateFormat,d=(b.lastVal=b.input?b.input.val():null,this._getDefaultDate()),e=d,f=b.input.val();_getFormatConfig(b);try{e=$.coral.parseDate(c,f,b)||d}catch(g){e=d}b.selectedDay=e.getDate(),b.drawMonth=b.selectedMonth=e.getMonth(),b.drawYear=b.selectedYear=e.getFullYear(),b.currentDay=e.getDate(),b.currentMonth=e.getMonth(),b.currentYear=e.getFullYear(),b.currentHur=e.getHours(),b.currentMiu=e.getMinutes(),b.currentSed=e.getSeconds(),this._adjustInstDate()},_getDefaultDate:function(){var a=this.options;return this._restrictMinMax(this._determineDate(a.defaultDate,new Date))},_determineDate:function(a,b){var c=this,d=this.options,e=function(a){var b=new Date;return b.setDate(b.getDate()+a),b},f=function(a){try{var b="yyyy-MM-dd",e=d.srcDateFormat;return c._isYearMonthMode(e)&&(b="yyyy-MM"),c._isYearMode(e)&&(b="yyyy"),(a+"").length>10&&_hasTime(e)&&(b+=" HH:mm:ss"),b=d.dateFormat,$.coral.parseDate(b,a,d)}catch(f){}for(var g=(a.toLowerCase().match(/^c/)?c._getDate():null)||new Date,h=g.getFullYear(),i=g.getMonth(),j=g.getDate(),k=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=k.exec(a);l;){switch(l[2]||"d"){case"d":case"D":j+=parseInt(l[1],10);break;case"w":case"W":j+=7*parseInt(l[1],10);break;case"m":case"M":i+=parseInt(l[1],10),j=Math.min(j,c._getDaysInMonth(h,i,d));break;case"y":case"Y":h+=parseInt(l[1],10),j=Math.min(j,c._getDaysInMonth(h,i,d))}l=k.exec(a)}return new Date(h,i,j)},g=null==a||""===a?b:"string"==typeof a?f(a):"number"==typeof a?isNaN(a)?b:e(a):new Date(a.getTime());g=g&&"Invalid Date"===g.toString()?b:g;var h=0,i=0,j=0,k=0;return g&&(h=g.getHours(),i=g.getMinutes(),j=g.getSeconds(),k=g.getMilliseconds(),g.setHours(0),g.setMinutes(0),g.setSeconds(0),g.setMilliseconds(0)),_daylightSavingAdjustWidthTime(g,[h,i,j])},_setDate:function(a,b){var c=!a,d=this.options,e=d.selectedMonth,f=d.selectedYear,g=this._restrictMinMax(this._determineDate(a,new Date)),h=d.dateFormat,i=this._getHiddenInputValue();if(d.selectedDay=d.currentDay=g.getDate(),d.drawMonth=d.selectedMonth=d.currentMonth=g.getMonth(),d.drawYear=d.selectedYear=d.currentYear=g.getFullYear(),d.currentHur=g.getHours(),d.currentMiu=g.getMinutes(),d.currentSed=g.getSeconds(),e===d.selectedMonth&&f===d.selectedYear||b||this._notifyChange(),this._adjustInstDate(),d.input)if(c)this._processDefaultDate(this,""),this._setHiddenInputValue();else if(d.complete){var j=this._formatDate();d.input.val(j),this._setStartEnd(i,j)}else{var k=getFormatter(d.value,d.dateFormat,d),l=this.completeFormate(k,h);l=$.coral.formatDate(l,a,d),d.input.val(l)}},_getDate:function(){var a=this.options,b=!a.currentYear||a.input&&""===a.input.val()?null:_daylightSavingAdjustWidthTime(new Date(a.currentYear,a.currentMonth,a.currentDay),[a.currentHur,a.currentMiu,a.currentSed]);return b},_attachHandlers:function(){var a=this,b=this.options,c=b.stepMonths,d="#"+b.id.replace(/\\\\/g,"\\"),e=this._isYearMonthMode(b.dateFormat),f=this._isYearMode(b.dateFormat);b.dpDiv.find("[data-handler]").map(function(){var g={prev:function(){return e===!0?a._adjustDate(d,-1,"Y"):f===!0?a._adjustDate(d,-12,"Y"):a._adjustDate(d,-c,"M"),!1},next:function(){return e===!0?a._adjustDate(d,1,"Y"):f===!0?a._adjustDate(d,12,"Y"):a._adjustDate(d,+c,"M"),!1},hide:function(){a.hide()},today:function(){return a._gotoToday(d),!1},selectDay:function(){return a._selectDay(d,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonthAndHide:function(){return a._selectMonthYear(d,this,"M",!0),a.hide(),!1},selectYearAndHide:function(){return a._selectMonthYear(d,this,"Y",!0),a.hide(),!1},selectMonth:function(){return a._selectMonthYear(d,this,"M"),!1},selectYear:function(){return a._selectMonthYear(d,this,"Y"),!1},focusTime:function(){if($(this).prop("readonly"))return!1;if(a.focusInput=this.id,"dpTimeHour"==this.id&&(b.dpDiv.find(".coral-datepicer-timePanel").hide(),b.dpDiv.find(".hourMenu").show()),"dpTimeMinute"==this.id){var c=$("#dpTimeHour").val();b.dpDiv.find(".coral-datepicer-timePanel").hide(),b.dpDiv.find(".minuteMenu").replaceWith(a._modifiedMin(c)),b.dpDiv.find(".minuteMenu").show()}if("dpTimeSecond"==this.id){var c=$("#dpTimeHour").val(),d=$("#dpTimeMinute").val();b.dpDiv.find(".secondMenu").replaceWith(a._modifiedSed(c,d)),b.dpDiv.find(".coral-datepicer-timePanel").hide(),b.dpDiv.find(".secondMenu").show()}return!1}};$(this).bind(this.getAttribute("data-event"),g[this.getAttribute("data-handler")]),$(b.dpDiv).off(".hourMenu").on("mousedown.hourMenu",".hourMenu",function(c){return $(c.target).hasClass("menuTimeSel")?(b.dpDiv.find("#dpTimeHour").spinner("setValue",$(c.target).html()),b.dpDiv.find(".menuSel").hide(),a._autoFixInput(a),a._selectTime(),b.dpDiv.find("#coral-timePanel").show(),!1):!1}),$(b.dpDiv).off(".minuteMenu").on("mousedown.minuteMenu",".minuteMenu",function(c){return $(c.target).hasClass("menuTimeSel")?(b.dpDiv.find("#dpTimeMinute").spinner("setValue",$(c.target).html()),b.dpDiv.find(".menuSel").hide(),a._autoFixInput(a),a._selectTime(),b.dpDiv.find("#coral-timePanel").show(),!1):!1}),$(b.dpDiv).off(".secondMenu").on("mousedown.secondMenu",".secondMenu",function(c){return $(c.target).hasClass("menuTimeSel")?(b.dpDiv.find("#dpTimeSecond").spinner("setValue",$(c.target).html()),b.dpDiv.find(".menuSel").hide(),a._autoFixInput(a),a._selectTime(),b.dpDiv.find("#coral-timePanel").show(),!1):!1})})},_generateHTML:function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O=this.options,P=new Date,Q=_daylightSavingAdjustWidthTime(new Date(P.getFullYear(),P.getMonth(),P.getDate()),[0,0,0]),R=O.isRTL,S=this._isYearMonthMode(O.dateFormat),T=this._isYearMode(O.dateFormat),U=1==S||1==T?!1:O.showButtonPanel,V=O.hideIfNoPrevNext,W=O.navigationAsDateFormat,X=this._getNumberOfMonths(),Y=O.showCurrentAtPos,Z=O.stepMonths,_=1!==X[0]||1!==X[1],aa=_daylightSavingAdjustWidthTime(O.currentDay?new Date(O.currentYear,O.currentMonth,O.currentDay):new Date(9999,9,9),[0,0,0]),ba=this._getMinMaxDate("min"),ca=this._getMinMaxDate("max"),da=O.drawMonth-Y,ea=O.drawYear,fa=(O.dateFormat,""),ga=_hasTime(O.dateFormat);if(0>da&&(da+=12,ea--),ca)for(a=_daylightSavingAdjustWidthTime(new Date(ca.getFullYear(),ca.getMonth()-X[0]*X[1]+1,ca.getDate()),[O.currentHur,O.currentMiu,O.currentSed]),a=ba&&ba>a?ba:a;_daylightSavingAdjustWidthTime(new Date(ea,da,1),[O.currentHur,O.currentMiu,O.currentSed])>a;)da--,0>da&&(da=11,ea--);O.drawMonth=da,O.drawYear=ea,b=O.prevText,b=W?$.coral.formatDate(b,_daylightSavingAdjustWidthTime(new Date(ea,da-Z,1),[O.currentHur,O.currentMiu,O.currentSed]),O):b,c=this._canAdjustMonth(-1,ea,da)?"<a class='coral-datepicker-prev coral-state-default coral-corner-all' data-handler='prev' data-event='mousedown' title='"+b+"'><span class='icon  cui-icon-arrow-"+(R?"right3":"left3")+"'></span></a>":V?"":"<a class='coral-datepicker-prev coral-state-default coral-corner-all coral-state-disabled' title='"+b+"'><span class='coral-icon coral-icon-circle-triangle-"+(R?"e":"w")+"'>"+b+"</span></a>",d=O.nextText,d=W?$.coral.formatDate(d,_daylightSavingAdjustWidthTime(new Date(ea,da+Z,1),[O.currentHur,O.currentMiu,O.currentSed]),O):d,e=this._canAdjustMonth(1,ea,da)?"<a class='coral-datepicker-next coral-state-default coral-corner-all' data-handler='next' data-event='mousedown' title='"+d+"'><span class='cui-icon-arrow-"+(R?"left3":"right3")+"'></span></a>":V?"":"<a class='coral-datepicker-next coral-state-default coral-corner-all coral-state-disabled' title='"+d+"'><span class='coral-icon coral-icon-circle-triangle-"+(R?"w":"e")+"'>"+d+"</span></a>",f=O.currentText,g=O.gotoCurrent&&O.currentDay?aa:Q,f=W?$.coral.formatDate(f,g,O):f,h="",i=U?"<div class='coral-datepicker-buttonpane coral-component-content' "+(S||T?"style='display:none'":"")+">"+(R?h:"")+(this._isInRange(g)?"<button type='button' class='coral-datepicker-current coral-state-default coral-priority-primary coral-corner-all' data-handler='today' data-event='mousedown'>"+f+"</button>":"")+(R?"":h)+"</div>":"";var ha="";for(!ga||(ha+='<button class="coral-datepicker-close coral-state-default coral-priority-secondary coral-corner-all" id="dpTimeEnsure">确定</button>'),ha+=U?"<button type='button' class='coral-datepicker-current coral-state-default coral-priority-primary coral-corner-all' data-handler='today' data-event='mousedown'>"+f+"</button>":"",j=parseInt(O.firstDay,10),j=isNaN(j)?0:j,k=O.showWeek,l=O.dayNames,m=O.dayNamesMin,n=O.monthNames,o=O.monthNamesShort,p=O.beforeShowDay,q=O.showOtherMonths,r=O.selectOtherMonths,t=this._getDefaultDate(),s=new Date(t.getFullYear(),t.getMonth(),t.getDate()),u="","datepicker"==O.model&&(fa="collapse in"),w=0;w<X[0];w++){for(x="",this.maxRows=4,y=0;y<X[1];y++){if(z=_daylightSavingAdjustWidthTime(new Date(ea,da,O.selectedDay),[O.currentHur,O.currentMiu,O.currentSed]),A=" coral-corner-all",B="",_){if(B+="<div class='coral-datepicker-group",X[1]>1)switch(y){case 0:B+=" coral-datepicker-group-first",A=" coral-corner-"+(R?"right":"left");break;case X[1]-1:B+=" coral-datepicker-group-last",A=" coral-corner-"+(R?"left":"right");break;default:B+=" coral-datepicker-group-middle",A=""}B+="'>"}for(B+="<div id='datepicker' class='coral-datepickerPanel "+fa+"'><div class='coral-datepicker-header coral-helper-clearfix"+A+"'>"+(/all|left/.test(A)&&0===w?R?e:c:"")+(/all|right/.test(A)&&0===w?R?c:e:"")+this._generateMonthYearHeader(da,ea,ba,ca,w>0||y>0,n,o,S)+"</div>",S===!0&&(B+=this._generateMonthHTML(da,ea,ba,ca,w>0||y>0,n,o,aa,Q)),1==T&&(B+=this._generateYearHTML(ea,ba,ca,w>0||y>0,aa,Q)),B+="<table class='coral-datepicker-calendar' "+(S||T?"style='display:none'":"")+"><thead><tr>",C=k?"<th class='coral-datepicker-week-col'>"+O.weekHeader+"</th>":"",v=0;7>v;v++)D=(v+j)%7,C+="<th scope='col'"+((v+j+6)%7>=5?" class='coral-datepicker-week-end'":"")+"><span title='"+l[D]+"'>"+m[D]+"</span></th>";for(B+=C+"</tr></thead><tbody>",E=this._getDaysInMonth(ea,da,O),ea===O.selectedYear&&da===O.selectedMonth&&(O.selectedDay=Math.min(O.selectedDay,E)),F=(this._getFirstDayOfMonth(ea,da)-j+7)%7,G=Math.ceil((F+E)/7),H=_&&this.maxRows>G?this.maxRows:G,this.maxRows=H,I=_daylightSavingAdjustWidthTime(new Date(ea,da,1-F),[0,0,0]),J=0;H>J;J++){for(B+="<tr>",K=k?"<td class='coral-datepicker-week-col'>"+O.calculateWeek(I)+"</td>":"",v=0;7>v;v++)L=p?p.apply(O.input?O.input[0]:null,[I]):[!0,""],M=I.getMonth()!==da,N=M&&!r||!L[0]||ba&&I<=new Date(ba.getFullYear(),ba.getMonth(),ba.getDate()-1)||ca&&I>ca,K+="<td class='"+((v+j+6)%7>=5?" coral-datepicker-week-end":"")+(M?" coral-datepicker-other-month":"")+(I.getTime()===z.getTime()&&da===O.selectedMonth&&O._keyEvent||s.getTime()===I.getTime()&&s.getTime()===z.getTime()?" "+this._dayOverClass:"")+(N?" "+this._unselectableClass+" coral-state-disabled":"")+(M&&!q?"":" "+L[1]+(I.getTime()===aa.getTime()?" "+this._currentClass:"")+(I.getTime()===Q.getTime()?" coral-datepicker-today":""))+"'"+(M&&!q||!L[2]?"":" title='"+L[2].replace(/'/g,"&#39;")+"'")+(N?"":" data-handler='selectDay' data-event='mousedown' data-month='"+I.getMonth()+"' data-year='"+I.getFullYear()+"'")+">"+(M&&!q?"&#xa0;":N?"<span class='coral-state-default'>"+I.getDate()+"</span>":"<a class='coral-state-default"+(I.getTime()===Q.getTime()?" coral-state-highlight":"")+(I.getTime()===aa.getTime()?" coral-state-active":"")+(M?" coral-priority-secondary":"")+"' href='javascript:void(0);'>"+I.getDate()+"</a>")+"</td>",I.setDate(I.getDate()+1),I=_daylightSavingAdjustWidthTime(I,[0,0,0]);B+=K+"</tr>"}da++,da>11&&(da=0,ea++),ga&&(B+="</tbody></table></div><div class='picker-switch accordion-toggle'><a class='coral-datepicker-today time-btn' data-handler='today' data-event='mousedown'>今天</a>",B+="<a id='timePanel' class='date-time-icon time-btn'><span class='cui-icon-clock'/></a><a class='datepicker-close time-btn' data-handler='hide' data-event='click'>关闭</a></div>"),x+=B}u+=x}return O._keyEvent=!1,u},_generateMonthHTML:function(a,b,c,d,e,f,g,h,i){for(var j="<table class='coral-datepicker-calendar' ><tbody>",k=(this.options,0),l="",m="",n=c&&c.getFullYear()===b,o=d&&d.getFullYear()===b,p=0;3>p;p++){j+="<tr>";for(var q=0;4>q;q++)l=k===i.getMonth()&&b===i.getFullYear()?"coral-state-highlight":"",m=k===a?"coral-state-active":"",j+=(!n||k>=c.getMonth())&&(!o||k<=d.getMonth())?"<td data-handler='selectMonthAndHide' data-event='mousedown' data-month='"+k+"'><a class='coral-state-default date-month "+l+" "+m+"' href='javascript:void(0);'>"+f[k++]+"</a></td>":"<td class='"+this._unselectableClass+" coral-state-disabled'><span class='date-month' >"+f[k++]+"</span></td>";j+="</tr>"}return j+"</tbody></table>"},isExist:function(a){return"undefined"!=typeof a},_timeDateInitValue:function(){var a,b,c,d,e,f,g,h,i,j=this.options,k=[],l=new Date;if("timepicker"==j.model){a=j.currentHur?j.currentHur:l.getHours(),b=j.currentMiu?j.currentMiu:l.getMinutes(),c=j.currentSed?j.currentSed:l.getSeconds(),k.push(l.getFullYear(),l.getMonth(),l.getDate());var m=j.minTime?k.join("-")+" "+j.minTime:null,n=j.maxTime?k.join("-")+" "+j.maxTime:null;d=new Date(l.getFullYear(),l.getMonth(),l.getDate(),a,b,c),i=new Date(l.getFullYear(),l.getMonth(),l.getDate()),g=h=i}else{var o=(_hasTime(j.dateFormat),this._hasHur(j.dateFormat)),p=this._hasMin(j.dateFormat),q=this._hasSec(j.dateFormat),m=j.minDate;n=j.maxDate,a=o?this.isExist(j.currentHur)?j.currentHur:l.getHours():"00",b=p?this.isExist(j.currentMiu)?j.currentMiu:l.getMinutes():"00",c=q?this.isExist(j.currentSed)?j.currentSed:l.getSeconds():"00",d=new Date(j.selectedYear,j.selectedMonth,j.selectedDay,a,b,c),i=new Date(j.selectedYear,j.selectedMonth,j.selectedDay),m&&""!=m&&(e=new Date(m.replace(/-/g,"/")),g=new Date(e.getFullYear(),e.getMonth(),e.getDate())),n&&""!=n&&(f=new Date(n.replace(/-/g,"/")),h=new Date(f.getFullYear(),f.getMonth(),f.getDate()))}return 1===this._checkDateRange(d)?(d=new Date(n.replace(/-/g,"/")),a=d.getHours(),b=d.getMinutes(),c=d.getSeconds()):2===this._checkDateRange(d)&&(d=new Date(m.replace(/-/g,"/")),a=d.getHours(),b=d.getMinutes(),c=d.getSeconds()),{hur:a,min:b,sed:c,minDate:m,maxDate:n,minDay:e,maxDay:f,compMin:g,compMax:h,compDate:i}},_generateTimePanel:function(){var a,b,c,d,e=this.options,f=(e.dateFormat,[]),g="";"datepicker"==this.options.model&&(g="collapse"),b=this._timeDateInitValue();var h=b.minDate,i=b.maxDate,j=b.compDate,c=b.compMin,d=b.compMax;return f.push("<div id='timepicker' class='coral-timepickerPanel "+g+"'>"),f.push("<table id='coral-timePanel' class='coral-datepicer-timePanel'><tr><td><input data-handler='focusTime' data-event='click' id='dpTimeHour' name='timeHourVal' value='"+b.hur+"' maxlength='2'/></td>"),f.push("<td class='separator'>:</td><td><input id='dpTimeMinute' name='timeMinVal' data-handler='focusTime' data-event='click' value='"+b.min+"' maxlength='2'/></td>"),a="datepicker"==e.model&&e.dateFormat.indexOf("s")>-1||"timepicker"==e.model&&e.timeFormat.indexOf("s")>-1?"":"display:none",f.push("<td class='separator' style="+a+">:</td><td id='secondTd' style="+a+"><input id='dpTimeSecond' name='timeSecVal' data-handler='focusTime' data-event='click' value='"+b.sed+"' maxlength='2'/></td>"),f.push("</tr></table>"),f.push(this._timeHourPanel(h,i,j,c,d,!1)),f.push(this._timeMinPanel(h,i,j,c,d,!1)),f.push(this._timeSedPanel(h,i,j,c,d,!1)),f.push("</div>"),f.join("")},_generateYearHTML:function(a,b,c,d,e,f){for(var g=this.options,h="<table class='coral-datepicker-calendar' ><tbody>",i="",j="",k=a-a%12,l=b&&b.getFullYear()===a,m=c&&c.getFullYear()===a,n=0;3>n;n++){h+="<tr>";for(var o=0;4>o;o++)i="",j=k==g.currentYear?"coral-state-active":"",h+=(!l||k>=b.getFullYear())&&(!m||k<=c.getFullYear())?"<td data-handler='selectYearAndHide' data-event='mousedown' data-year='"+k+"'><a class='coral-state-default date-year  "+j+"' href='javascript:void(0);'>"+k++ +"</a></td>":"<td class='"+this._unselectableClass+" coral-state-disabled'><span class='date-year' >"+k++ +"</span></td>";h+="</tr>"}return h+"</tbody></table>"},_timeHourPanel:function(a,b,c,d,e,f){var g=[],h="";f&&(h="hourPanel"),g.push("<div class='menuSel hourMenu '"+h+" style='display: none;'>"),g.push("<table cellspacing='0' cellpadding='3' border='0' nowrap='nowrap'><tbody>");for(var i=0,j=0;6>j;j++){g.push("<tr nowrap='nowrap'></tr>");for(var k=0;4>k;k++)a&&i<new Date(a).getHours()&&new Date(c).getTime()==new Date(d).getTime()||b&&i>new Date(b).getHours()&&new Date(c).getTime()==new Date(e).getTime()?g.push("<td nowrap='' class='menuTimeSel coral-state-disabled' data-handler='clickHour' data-event='click' >"+(i++/Math.pow(10,2)).toFixed(2).substr(2)+"</td>"):g.push("<td nowrap='' class='menuTimeSel' data-handler='clickHour' data-event='click' >"+(i++/Math.pow(10,2)).toFixed(2).substr(2)+"</td>");g.push("</tr>")}return g.push("</tbody></table></div>"),g.join("")},_timeMinPanel:function(a,b,c,d,e,f){var g=[],h="";f&&(h="minPanel"),g.push("<div class='menuSel minuteMenu '"+h+" style='display: none;'>"),g.push("<table cellspacing='0' cellpadding='3' border='0' nowrap='nowrap'><tbody>");for(var i=0,j=0;3>j;j++){g.push("<tr nowrap='nowrap'></tr>");for(var k=0;4>k;k++)a&&i<new Date(a).getMinutes()&&new Date(c).getTime()==new Date(d).getTime()||b&&i>new Date(b).getMinutes()&&new Date(c).getTime()==new Date(e).getTime()?g.push("<td nowrap='' class='menuTimeSel coral-state-disabled' data-handler='clickMinute' data-event='click'>"+i+"</td>"):g.push("<td nowrap='' class='menuTimeSel' data-handler='clickMinute' data-event='click' >"+i+"</td>"),i+=5;g.push("</tr>")}return g.push("</tbody></table></div>"),g.join("")},_timeSedPanel:function(a,b,c,d,e,f){var g,h=[],i="";f&&(i="sedPanel"),h.push("<div class='menuSel secondMenu '"+i+" style='display: none;'>"),h.push("<table cellspacing='0' cellpadding='3' border='0' nowrap='nowrap'><tbody>"),g=0;for(var j=0;4>j;j++){h.push("<tr nowrap='nowrap'></tr>");for(var k=0;3>k;k++)a&&g<new Date(a).getSeconds()&&new Date(c).getTime()==new Date(d).getTime()||b&&g>new Date(b).getSeconds()&&new Date(c).getTime()==new Date(e).getTime()?h.push("<td nowrap='' class='menuTimeSel coral-state-disabled' data-handler='clickSecond' data-event='click'>"+(g/Math.pow(10,2)).toFixed(2).substr(2)+"</td>"):h.push("<td nowrap='' class='menuTimeSel' data-handler='clickSecond' data-event='click' >"+(g/Math.pow(10,2)).toFixed(2).substr(2)+"</td>"),g+=5;h.push("</tr>");
}return h.push("</tbody></table></div>"),h.join("")},_modifiedMin:function(a){var b,c,d,e,f,g=this.options,h=[],i=g.minDate,j=g.maxDate;if("timepicker"==g.model){var k=new Date;h.push(k.getFullYear(),k.getMonth(),k.getDate()),i=g.minTime?h.join("-")+" "+g.minTime:null,j=g.maxTime?h.join("-")+" "+g.maxTime:null,d=new Date(k.getFullYear(),k.getMonth(),k.getDate()),e=f=d}else d=new Date(g.selectedYear,g.selectedMonth,g.selectedDay),b=new Date(i),c=new Date(j),e=new Date(b.getFullYear(),b.getMonth(),b.getDate()),f=new Date(c.getFullYear(),c.getMonth(),c.getDate());var l=[];l.push("<div class='menuSel minuteMenu' style='display: none;'>"),l.push("<table cellspacing='0' cellpadding='3' border='0<tr' nowrap='nowrap'><tbody>");for(var m=0,n=0;3>n;n++){l.push("<tr nowrap='nowrap'></tr>");for(var o=0;4>o;o++)i&&m<new Date(i).getMinutes()&&new Date(d).getTime()==new Date(e).getTime()&&a==new Date(i).getHours()||j&&m>new Date(j).getMinutes()&&new Date(d).getTime()==new Date(f).getTime()&&a==new Date(j).getHours()?l.push("<td nowrap='' class='menuTimeSel coral-state-disabled' data-handler='clickMinute' data-event='click'>"+(m/Math.pow(10,2)).toFixed(2).substr(2)+"</td>"):l.push("<td nowrap='' class='menuTimeSel' data-handler='clickMinute' data-event='click' >"+(m/Math.pow(10,2)).toFixed(2).substr(2)+"</td>"),m+=5;l.push("</tr>")}return l.push("</tbody></table></div>"),l.join("")},_modifiedSed:function(a,b){var c=this.options,d=c.minDate,e=c.maxDate,f=new Date(c.selectedYear,c.selectedMonth,c.selectedDay),g=new Date(d),h=new Date(e),i=new Date(g.getFullYear(),g.getMonth(),g.getDate()),j=new Date(h.getFullYear(),h.getMonth(),h.getDate()),k=[];k.push("<div class='menuSel secondMenu' style='display: none;'>"),k.push("<table cellspacing='0' cellpadding='3' border='0<tr' nowrap='nowrap'><tbody>");for(var l=0,m=0;3>m;m++){k.push("<tr nowrap='nowrap'></tr>");for(var n=0;4>n;n++)d&&l<new Date(d).getSeconds()&&new Date(f).getTime()==new Date(i).getTime()&&a==new Date(d).getHours()&&b==new Date(d).getMinutes()||e&&l>new Date(e).getSeconds()&&new Date(f).getTime()==new Date(j).getTime()&&a==new Date(e).getHours()&&b==new Date(e).getMinutes()?k.push("<td nowrap='' class='menuTimeSel coral-state-disabled' data-handler='clickSecond' data-event='click'>"+(l/Math.pow(10,2)).toFixed(2).substr(2)+"</td>"):k.push("<td nowrap='' class='menuTimeSel' data-handler='clickSecond' data-event='click' >"+(l/Math.pow(10,2)).toFixed(2).substr(2)+"</td>"),l+=5;k.push("</tr>")}return k.push("</tbody></table></div>"),k.join("")},_generateMonthYearHeader:function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q=this.options,r=q.changeMonth,s=q.changeYear,t=q.showMonthAfterYear,u="<div class='coral-datepicker-title'>",v="",w=q.monthSuffix,x=q.dateFormat;if(!this._isYearMonthMode(x)&&!this._isYearMode(x)){if(e||!r)v+="<span class='coral-datepicker-month'>"+f[a]+"</span>";else{for(i=c&&c.getFullYear()===b,j=d&&d.getFullYear()===b,v+="<select class='coral-datepicker-month' data-handler='selectMonth' data-event='change'>",k=0;12>k;k++)(!i||k>=c.getMonth())&&(!j||k<=d.getMonth())&&(v+="<option value='"+k+"'"+(k===a?" selected='selected'":"")+">"+g[k]+"</option>");v+="</select>",v+=w}t||(u+=v+(!e&&r&&s?"":"&#xa0;"))}if(!q.yearshtml)if(q.yearshtml="",e||!s)u+="<span class='coral-datepicker-year'>"+b+"</span>";else{if(l=q.yearRange.split(":"),m=(new Date).getFullYear(),n=function(a){var c=a.match(/c[+\-].*/)?b+parseInt(a.substring(1),10):a.match(/[+\-].*/)?m+parseInt(a,10):parseInt(a,10);return isNaN(c)?m:c},o=n(l[0]),p=Math.max(o,n(l[1]||"")),o=c?Math.max(o,c.getFullYear()):o,p=d?Math.min(p,d.getFullYear()):p,this._isYearMode(x)){var o=b-b%12;q.yearshtml+="<span class = 'coral-datepicker-year'>"+o+"-"+(o+11)+"</span>"}else{for(q.yearshtml+="<select class='coral-datepicker-year' data-handler='selectYear' data-event='change'>";p>=o;o++)q.yearshtml+="<option value='"+o+"'"+(o===b?" selected='selected'":"")+">"+o+"</option>";q.yearshtml+="</select>"}u+=q.yearshtml,q.yearshtml=null}return u+=q.yearSuffix,t&&(u+=(!e&&r&&s?"":"&#xa0;")+(h===!1?v:"")),u+="</div>"},_adjustInstDate:function(a,b){var c=this.options,d=c.drawYear+("Y"===b?a:0),e=c.drawMonth+("M"===b?a:0),f=Math.min(c.selectedDay,this._getDaysInMonth(d,e,c))+("D"===b?a:0),g=this._restrictMinMax(_daylightSavingAdjustWidthTime(new Date(d,e,f),[c.currentHur,c.currentMiu,c.currentSed]));c.selectedDay=g.getDate(),c.drawMonth=c.selectedMonth=g.getMonth(),c.drawYear=c.selectedYear=g.getFullYear(),"M"!==b&&"Y"!==b||this._notifyChange()},_restrictMinMax:function(a){var b=(this.options,this._getMinMaxDate("min")),c=this._getMinMaxDate("max"),d=b&&b>a?b:a;return c&&d>c?c:d},_notifyChange:function(){var a=this.options,b=a.onChangeMonthYear;b&&b.apply(a.input?a.input[0]:null,[a.selectedYear,a.selectedMonth+1,a])},_getNumberOfMonths:function(){var a=this.options,b=a.numberOfMonths;return null==b?[1,1]:"number"==typeof b?[1,b]:b},_getMinMaxDate:function(a){var b,c=this.options;return b="timepicker"==c.model?a+"Time":a+"Date",this._determineDate(c[b],null)},_getDaysInMonth:function(a,b,c){var d=c;return d?32-_daylightSavingAdjustWidthTime(new Date(a,b,32),[d.currentHur,d.currentMiu,d.currentSed]).getDate():32-_daylightSavingAdjustWidthTime(new Date(a,b,32),[0,0,0]).getDate()},_getFirstDayOfMonth:function(a,b){return new Date(a,b,1).getDay()},_canAdjustMonth:function(a,b,c){var d=this.options,e=this._getNumberOfMonths(),f=_daylightSavingAdjustWidthTime(new Date(b,c+(0>a?a:e[0]*e[1]),1),[d.currentHur,d.currentMiu,d.currentSed]);return 0>a&&f.setDate(this._getDaysInMonth(f.getFullYear(),f.getMonth(),d)),this._isInRange(f)},_isInRange:function(a){var b,c,d=this.options,e=this._getMinMaxDate("min"),f=this._getMinMaxDate("max"),g=null,h=null,i=d.yearRange;return i&&(b=i.split(":"),c=(new Date).getFullYear(),g=parseInt(b[0],10),h=parseInt(b[1],10),b[0].match(/[+\-].*/)&&(g+=c),b[1].match(/[+\-].*/)&&(h+=c)),(!e||a.getTime()>=e.getTime())&&(!f||a.getTime()<=f.getTime())&&(!g||a.getFullYear()>=g)&&(!h||a.getFullYear()<=h)},_formatDate:function(a,b,c){var d=this.options;a||(d.currentDay=d.selectedDay,d.currentMonth=d.selectedMonth,d.currentYear=d.selectedYear);var e=(this._getMinMaxDate("min"),this._getMinMaxDate("max"),a?"object"==typeof a?a:_daylightSavingAdjustWidthTime(new Date(c,b,a),[d.currentHur,d.currentMiu,d.currentSed]):_daylightSavingAdjustWidthTime(new Date(d.currentYear,d.currentMonth,d.currentDay),[d.currentHur,d.currentMiu,d.currentSed]));return $.coral.formatDate(d.dateFormat,e,d)},_apply:function(a,b,c){var d=this.options,e=d.type;if(e){if("string"==typeof e)return window[e].apply(d.input?d.input[0]:null,[c].concat(b));if($.isFunction(e))return e.apply(d.input?d.input[0]:null,[c].concat(b))}}});/*! cui 2016-11-08 */
$.component("coral.checkbox",$.coral.formelement,{version:"4.0.1",castProperties:["triggers","showRequiredMark","hideRequiredMark","shortCut"],options:{showStar:!0,id:null,name:null,value:"",label:"",maxLabelWidth:"auto",labelField:null,starBefore:!1,title:"",width:"auto",height:null,disabled:!1,required:!1,readonly:!1,isLabel:!1,checked:!1,errMsg:null,errMsgPosition:"leftBottom",onValidError:null,onKeyDown:null,onValidSuccess:null,onChange:$.noop,triggers:null,excluded:!1},_create:function(){var a=this,b=this.options,c=b.maxLabelWidth,d=b.label;a.originalValue="",a.element.jquery||(a.element=$(a.element)),a.element.addClass("coral-form-element-checkbox tabbable"),a.element.addClass("coral-validation-checkbox"),"undefined"==typeof a.element.attr("id")&&!!a.options.id&&a.element.attr("id",a.options.id),a.options.id=a.element.uniqueId().attr("id");var e=a.element.attr("name");"undefined"!=typeof e?a.options.name=e:a.element.attr("name",a.options.name),""!=$.trim(a.element.val())&&"on"!=$.trim(a.element.val())?a.options.value=a.element.val():a.options.value&&a.element.val(a.options.value),a.options.name&&(a.nameMark="coral-checkbox-element-"+a._hashCode(a.options.name),a.element.addClass(a.nameMark)),a.uiCheckbox=$('<span class="coral-checkbox"></span>'),a.uiLabel=$('<label class="coral-checkbox-label" for=\''+a.options.id+"'></label>"),a.uiIcon=$('<span class="coral-checkbox-icon"></span>'),"auto"==c?a.uiText=$('<span class="coral-checkbox-text"></span>'):a.uiText=$("<span class='coral-checkbox-text'  title='"+d+"' style='max-width:"+c+"px;'></span>"),a.uiLabel.append(a.uiIcon),a.uiLabel.append(this.uiText),a.options.label&&a.uiText.append(a.options.label),a.options.title&&a.uiLabel.attr("title",a.options.title),a.options.checked?(a.uiIcon.addClass("cui-icon-checkbox-checked coral-checkbox-hightlight"),a.element.prop("checked",!0)):(a.uiIcon.addClass("cui-icon-checkbox-unchecked"),a.element.prop("checked",!1)),a.element.after(a.uiCheckbox),a.uiCheckbox.append(a.element).append(a.uiLabel),b.labelField&&(this.uiLabelField=$('<label class="coral-label">'+b.labelField+"</label>"),this.uiCheckbox.prepend(this.uiLabelField),this.uiCheckbox.addClass("coral-hasLabel")),a.element[0].checked===!0&&(a.originalValue=a.options.value),a._bindEvent(),a._trigger("onCreate",null,[])},reset:function(){""===this.originalValue?this.uncheck():this.check()},_getCheckboxs:function(){var a=this,b=a.element.closest("form");return a.nameMark?b.length>0?b.find($("."+a.nameMark)):$("."+a.nameMark):a.element},_setDisabled:function(a){a?(this.element.prop("disabled",!0),this.element.removeClass("tabbable"),this.uiCheckbox.addClass("coral-state-disabled")):(this.element.prop("disabled",!1),this.uiCheckbox.removeClass("coral-state-disabled"),this.element.addClass("tabbable")),this.options.disabled=!!a},_setReadonly:function(a){a?(this.element.prop("readonly",!0),this.uiCheckbox.addClass("coral-readonly"),this.element.removeClass("tabbable")):(this.element.prop("readonly",!1),this.uiCheckbox.removeClass("coral-readonly"),this.element.addClass("tabbable")),this.options.readonly=!!a},_setIsLabel:function(a){a?(this.element.prop("isLabel",!0),this.uiCheckbox.addClass("coral-isLabel"),this.element.removeClass("tabbable")):(this.element.prop("isLabel",!1),this.uiCheckbox.removeClass("coral-isLabel"),this.element.addClass("tabbable")),this.options.isLabel=!!a},focus:function(){return this.options.disabled||this.options.readonly||this.options.isLabel?!1:(this.element.focus(),!0)},_bindEvent:function(){var a=this,b=a.options;this.options.disabled&&this._setDisabled(this.options.disabled),this.element.bind("change",function(b){$(this).prop("checked")?a.uiIcon.removeClass("cui-icon-checkbox-unchecked ").addClass("cui-icon-checkbox-checked coral-checkbox-hightlight"):a.uiIcon.removeClass("cui-icon-checkbox-checked coral-checkbox-hightlight").addClass("cui-icon-checkbox-unchecked"),a._trigger("onChange",b,[{checked:!!a.element.prop("checked")}])}).bind("focus",function(b){a.uiCheckbox.addClass("coral-checkbox-highlight")}).bind("blur",function(){a.uiCheckbox.removeClass("coral-checkbox-highlight")}).bind("keydown"+this.eventNamespace,function(c){b.shortCut&&$.coral.callFunction(b.shortCut,event,this),a._trigger("onKeyDown",c,{})}),this.uiCheckbox.bind("mouseenter"+this.eventNamespace,function(){a.options.disabled||a.uiCheckbox.hasClass("coral-checkbox-highlight")||a.uiCheckbox.hasClass("coral-checkbox-highlight")||$(this).addClass("coral-checkbox-hover")}).bind("mouseleave"+this.eventNamespace,function(){a.options.disabled||$(this).removeClass("coral-checkbox-hover")}),this.uiLabel.bind("click",function(b){return a.options.readonly||a.options.isLabel||a.options.disabled?!1:void a._trigger("onClick",b,{})})},_setOption:function(a,b){if("id"!==a&&"name"!==a){if("readonly"===a&&this._setReadonly(b),"disabled"===a&&this._setDisabled(b),"isLabel"===a&&this._setIsLabel(b),"label"===a&&this.uiText.html(b),"maxLabelWidth"===a){var c=b;"auto"!=b?(c+="px",this.uiText.attr("title",this.options.label)):(c="",this.uiText.attr("title","")),this.uiText.css("max-width",c)}this._super(a,b)}},_destroy:function(){this.uiCheckbox.replaceWith(this.element),this.uncheck(),this.element.removeAttr("value"),this.element.removeClass("coral-form-element-checkbox"),this.element.removeClass("coral-validation-checkbox"),this.element.removeClass(this.nameMark)},_hashCode:function(a){if(!a)return 0;a=""+a;for(var b=0,c=0,d=a.length,e=0;d>e;e++)b=31*b+a.charCodeAt(c++),(b>2147483647||2147483648>b)&&(b=4294967295&b);return b},component:function(){return this.uiCheckbox},disable:function(){this._setDisabled(!0)},readonly:function(){this._setReadonly(!0)},enable:function(){this._setDisabled(!1)},show:function(){this.component().show()},hide:function(){this.component().hide()},check:function(){this.uiIcon.hasClass("coral-checkbox-hightlight")||(this.uiIcon.removeClass("cui-icon-checkbox-unchecked").addClass("cui-icon-checkbox-checked coral-checkbox-hightlight"),this.element.prop("checked",!0))},uncheck:function(){this.uiIcon.hasClass("coral-checkbox-hightlight")&&(this.uiIcon.removeClass("cui-icon-checkbox-checked coral-checkbox-hightlight").addClass("cui-icon-checkbox-unchecked"),this.element.prop("checked",!1))},isChecked:function(){return this.element.prop("checked")},getValue:function(){return this.getValues().join(",")},getValues:function(){var a=this,b=[];return a._getCheckboxs().each(function(){var a=$(this);a.checkbox("isChecked")&&b.push(a.val())}),b},refresh:function(){this._destroy(),this._create()}});/*! cui 2016-11-08 */
$.component("coral.checkboxlist",$.coral.formelement,{version:"4.0.1",castProperties:["data","triggers","showRequiredMark","hideRequiredMark","shortCut"],options:{id:null,name:null,valueField:"value",textField:"text",required:!1,showStar:!0,maxLabelWidth:"auto",labelField:null,starBefore:!1,column:null,disabled:!1,readonly:!1,isLabel:!1,value:"",data:null,url:null,termSplit:";",itemSplit:":",errMsg:null,errMsgPosition:"leftBottom",repeatLayout:"table",itemWidth:"auto",onValidError:null,onKeyDown:null,onValidSuccess:null,triggers:null,excluded:!1,onChange:$.noop},_create:function(){var a=this,b=this.options;this.element.jquery||(this.element=$(this.element)),this.element.addClass("coral-form-element-checkboxlist  ctrl-init ctrl-form-element ctrl-init-checkboxlist coral-validation-checkboxlist"),"undefined"==typeof a.element.attr("id")&&!!a.options.id&&a.element.attr("id",a.options.id),a.options.id=a.element.uniqueId().attr("id");var c=a.element.attr("name");"undefined"!=typeof c?a.options.name=c:a.element.attr("name",a.options.name),this.uiBoxlist=$('<span class="coral-checkboxlist"></span>'),this.uiInput=$('<input type="hidden">'),this.options.name&&this.uiInput.attr("name",this.options.name),this.options.value&&this.uiInput.val(this.options.value),this._initData(),this._bindEvent(),this.uiInput.appendTo(this.uiBoxlist),b.labelField&&(this.uiLabel=$('<label class="coral-label">'+b.labelField+"</label>"),this.uiBoxlist.prepend(this.uiLabel),this.uiBoxlist.addClass("coral-hasLabel")),this.uiBoxlist.insertAfter(this.element),this.element.hide()},reload:function(a){var b=this,c={},d=[],e=!1;a||b.options.url?!a&&b.options.url&&(a=b.options.url):a=[],"string"!=typeof a?(c=a,c.data?d=c.data:c.url?(a=c.url,b.options.url=c.url,e=!0):c instanceof Array?d=a:c.url||c.data||b.options.url?c.url||c.data||!b.options.url||(a=b.options.url,e=!0):d=[]):(b.options.url=a,e=!0),this.uiBoxlist.empty(),e?(this.xhr&&this.xhr.abort(),this.xhr=$.ajax(this._ajaxSettings()),this.xhr.success(function(a){b._loadData(a)}).complete(function(a,c){a===b.xhr&&(b.xhr=null)}).error(function(){$.alert("Json Format Error!")})):b._loadData(d),this._bindEvent()},_initData:function(){var a=this;this.options;this.options.url?(this.xhr&&this.xhr.abort(),this.xhr=$.ajax(this._ajaxSettings()),this.xhr.success(function(b){a._loadData(b)}).complete(function(b,c){b===a.xhr&&(a.xhr=null)}).error(function(){$.alert("Json Format Error!")})):this.options.data&&this._loadData(this.options.data)},_ajaxSettings:function(){var a=this.options;return{type:"get",url:a.url,data:{},async:!1,dataType:"json"}},_loadData:function(a){var b,c=null,d=[],e=[],f=[],g=0,h=null,i=null,j=null;if("string"==typeof a)for(c=a.split(this.options.termSplit),a=[];g<c.length;g++)i=c[g],j=i.split(this.options.itemSplit),h={},h[this.options.valueField]=j[0],h[this.options.textField]=j[1],a.push(h);for(this.data=a,g;g<a.length;g++)b=a[g],b.checked&&d.push(b[this.options.valueField]),f.push(b[this.options.valueField]);if(this.options.value&&(d=this.options.value.split(",")),this.options.clearOnLoad){for(var k=0;k<d.length;k++)$.inArray(d[k],f)>-1&&e.push(d[k]);d=e}this.isInit||(this.isInit=!0,this.originalValue=d.join(",")),this._renderChkItem(),this.setValue(d)},_renderChkItem:function(){"table"==this.options.repeatLayout?(null==this.options.column&&(this.options.column=3),this._renderTableItem(),this.uiTable.appendTo(this.uiBoxlist)):"flow"==this.options.repeatLayout&&(null==this.options.column&&(this.options.column=this.data.length),this._renderBorderItem(),this.uiBorder.appendTo(this.uiBoxlist))},reset:function(){this.setValue(this.originalValue)},_renderBorderItem:function(){var a=this,b=this.options,c=this.options.column,d=this.data;a.uiBorder=$('<span class="coral-checkboxlist-border"></span>');for(var e in d)e>c-1&&e%c==0&&$("<br/>").appendTo(a.uiBorder),a._renderItem(d[e]).css("width",b.itemWidth).appendTo(a.uiBorder)},_renderTableItem:function(){this.uiTable=$("<table></table>");var a=0,b=0,c=this.data,d=c.length||0,e=this.options.column,f=0,g=null,h=null;if(c&&!(c.length<1))for(f=Math.ceil(d/e);f>a;a++){for(g=$("<tr></tr>"),b=0;e>b;b++)h=$("<td></td>"),d>a*e+b&&this._renderItem(c[a*e+b]).appendTo(h),h.appendTo(g);g.appendTo(this.uiTable)}},_renderItem:function(a){var b=1==a.hidden?"hidden":"",c=$("<span class='coral-checkbox tabbable "+b+"'tabindex=0></span>"),d=$("<span class='coral-checkbox-label'></span>"),e=$("<span class='coral-checkbox-icon'></span>"),f=this.options.maxLabelWidth,g=$(),h=a[this.options.valueField],i=a[this.options.textField];return g="auto"==f?$('<span class="coral-checkbox-text"></span>'):$("<span class='coral-checkbox-text'  title='"+i+"' style='max-width:"+f+"px;'></span>"),c.attr("data-value",h),d.append(e).append(g),d.appendTo(c),e.addClass("cui-icon-checkbox-unchecked"),g.append(i),c},_bindEvent:function(){var a=this;this.options.disabled&&this._setDisabled(this.options.disabled),this.options.readonly&&this._setReadonly(this.options.readonly),this.options.isLabel&&this._setIsLabel(this.options.isLabel),this.uiBoxlist.find(".coral-checkbox").each(function(){$(this).bind("click"+a.eventNamespace,function(b){a._selectItems(b),b.stopPropagation()})}),this._on({"keydown .coral-checkbox":function(b){var c=$.coral.keyCode,d=a.options;switch(b.keyCode){case c.SPACE:b.preventDefault(),a._selectItems(b)}d.shortCut&&$.coral.callFunction(d.shortCut,event,this),a._trigger("onKeyDown",b,{})},"focus .coral-checkbox":function(a){var b=$(a.target).closest(".coral-checkbox");b.addClass("coral-checkbox-highlight")},"blur .coral-checkbox":function(a){var b=$(a.target).closest(".coral-checkbox");b.removeClass("coral-checkbox-highlight")},"mouseenter .coral-checkbox":function(a){var b=$(a.target).closest(".coral-checkbox");b.hasClass("coral-state-disabled")||b.addClass("coral-checkbox-hover")},"mouseleave .coral-checkbox":function(a){var b=$(a.target).closest(".coral-checkbox");b.hasClass("coral-state-disabled")||b.removeClass("coral-checkbox-hover")}}),this.uiBoxlist.find(".coral-checkbox-label").each(function(){$(this).bind("click"+a.eventNamespace,function(b){return a.options.readonly||a.options.isLabel?!1:void 0})})},_selectItems:function(a){var b=this;if(!b.options.disabled&&!b.options.readonly&&!b.options.isLabel){var c=$(a.target).closest(".coral-checkbox"),d=c.find(".coral-checkbox-icon");if(c.hasClass("coral-state-disabled")||c.hasClass("coral-readonly")||c.hasClass("coral-isLabel"))return void event.stopPropagation();d.hasClass("coral-checkboxlist-item-highlight")?(d.removeClass("cui-icon-checkbox-checked coral-checkboxlist-item-highlight").addClass("cui-icon-checkbox-unchecked"),c.removeClass("coral-checkbox-highlight")):(d.removeClass("cui-icon-checkbox-unchecked").addClass("coral-checkboxlist-item-highlight cui-icon-checkbox-checked"),c.addClass("coral-checkbox-highlight"));var e=b.getValue();b._changeValue(),b._trigger("onChange",null,{value:b.uiInput.val(),oldValue:e,checked:d.hasClass("coral-checkboxlist-item-highlight")})}},_changeValue:function(){var a=[];this.uiBoxlist.find(".coral-checkbox").each(function(){$(this).find(".coral-checkbox-icon").hasClass("coral-checkboxlist-item-highlight")&&a.push($(this).attr("data-value"))}),this.uiInput.val(a.toString())},_setDisabled:function(a){a=!!a,this.uiBoxlist.find(".coral-checkbox").each(function(){$(this).toggleClass("coral-state-disabled",a),$(this).toggleClass("tabbable",!a)}),this.options.disabled=a},_setReadonly:function(a){a=!!a,this.uiBoxlist.find(".coral-checkbox").each(function(){$(this).toggleClass("coral-readonly",a),$(this).toggleClass("tabbable",!a)}),this.options.readonly=a},_setIsLabel:function(a){a=!!a,this.uiBoxlist.find(".coral-checkbox").each(function(){$(this).toggleClass("coral-isLabel",a),$(this).toggleClass("tabbable",!a)}),this.options.isLabel=a},_setOption:function(a,b){if("id"!==a&&"name"!==a){if("readonly"===a&&this._setReadonly(b),"isLabel"===a&&this._setIsLabel(b),"disabled"===a)return void this._setDisabled(b);if("maxLabelWidth"===a){var c=b;if("auto"!=b){c+="px";for(var d=this.component().find(".coral-checkbox-text"),e=0;e<d.length;e++){var f=$(d[e]).html();$(d[e]).attr("title",f)}}else c="",this.component().find(".coral-checkbox-text").attr("title","");this.component().find(".coral-checkbox-text").css("max-width",c)}this._super(a,b)}},_destroy:function(){this.component().remove(),this.options.name&&this.element.removeAttr("orgname").attr("name",this.options.name),this.element.removeClass("coral-form-element-checkboxlist"),this.element.removeClass("coral-validation-checkboxlist"),this.element.show()},focus:function(){},component:function(){return this.uiBoxlist},disable:function(){this._setOption("disabled",!0),this._setDisabled(!0)},readonly:function(){this._setReadonly("readonly",!0)},enable:function(){this._setOption("disabled",!1),this._setDisabled(!1)},disableItem:function(a){this.uiBoxlist.find('.coral-checkbox[data-value="'+a+'"]').toggleClass("coral-state-disabled",!0)},enableItem:function(a){this.options.disabled=!1;this.uiBoxlist.find('.coral-checkbox[data-value="'+a+'"]').toggleClass("coral-state-disabled",!1)},show:function(){this.component().show()},hide:function(){this.component().hide()},getValue:function(){return this.uiInput.val()},setValue:function(a,b){this.getValue()||[];this.uiBoxlist.find(".coral-checkboxlist-item-highlight").each(function(){$(this).removeClass("cui-icon-checkbox-checked coral-checkboxlist-item-highlight").addClass("cui-icon-checkbox-unchecked")}),a=a||"";for(var c=0,d=$.isArray(a)?a:a&&"string"==typeof a&&""!==$.trim(a)?a.split(","):[];c<d.length;c++)this.uiBoxlist.find('.coral-checkbox[data-value="'+d[c]+'"]').find(".coral-checkbox-icon").removeClass("cui-icon-checkbox-unchecked").addClass("cui-icon-checkbox-checked coral-checkboxlist-item-highlight");this.uiInput.val(d.toString())},invertCheck:function(a){var b=[];this.uiBoxlist.find(".coral-checkboxlist-item-highlight").each(function(){$(this).removeClass("cui-icon-checkbox-checked coral-checkboxlist-item-highlight").addClass("coral-checkbox-temp")}),this.uiBoxlist.find(".cui-icon-checkbox-unchecked").each(function(){$(this).removeClass("cui-icon-checkbox-unchecked").addClass("cui-icon-checkbox-checked coral-checkboxlist-item-highlight")}),this.uiBoxlist.find(".coral-checkbox-temp").each(function(){$(this).removeClass("coral-checkbox-temp").addClass("cui-icon-checkbox-unchecked")}),this.uiBoxlist.find(".coral-checkbox").each(function(){$(this).find(".coral-checkbox-icon").hasClass("coral-checkboxlist-item-highlight")&&b.push($(this).attr("data-value"))}),this.setValue(b,a)},checkAll:function(){for(var a=[],b=0,c=null,d=this.data;b<d.length;b++)c=d[b],a.push(c[this.options.valueField]);this.setValue(a)},getText:function(a){var b=0,c=this.data,d=null,e=[];for(a=a?a.split(","):this.getValue().split(",");b<c.length;b++)d=c[b][this.options.valueField],$.inArray(d,a)>-1&&e.push(c[b][this.options.textField]);return e.toString()}});/*! cui 2016-11-08 */
$.component("coral.radio",$.coral.formelement,{version:"4.0.1",castProperties:["triggers","showRequiredMark","hideRequiredMark","shortCut"],options:{showStar:!0,id:null,name:null,width:"auto",height:24,label:"",starBefore:!1,labelField:null,disabled:!1,readonly:!1,isLabel:!1,allowCancel:!1,checked:!1,required:!1,isCheck:!1,value:"",errMsg:null,errMsgPosition:"leftBottom",onValidError:null,onValidSuccess:null,onClick:null,onKeyDown:null,onChange:$.noop,triggers:null,excluded:!1},_create:function(){var a=this,b=this.options;a.element.jquery||(a.element=$(a.element)),a.element.addClass("coral-form-element-radio tabbable"),a.element.addClass("coral-validation-radio"),"undefined"==typeof a.element.attr("id")&&!!a.options.id&&a.element.attr("id",a.options.id),a.options.id=a.element.uniqueId().attr("id");var c=a.element.attr("name");"undefined"!=typeof c?a.options.name=c:a.element.attr("name",a.options.name),""!=$.trim(a.element.val())&&"on"!=$.trim(a.element.val())?a.options.value=a.element.val():a.options.value&&a.element.val(a.options.value),a.nameMark="coral-radio-element-"+a._hashCode(a.options.name),a.element.addClass(a.nameMark),a.uiRadio=$('<span class="coral-radio"></span>'),a.uiLabel=$('<label class="coral-radio-label" for='+a.options.id+"></label>"),a.uiIcon=$('<span class="coral-radio-icon"></span>'),a.uiLabel.append(a.uiIcon),a.options.label&&a.uiLabel.append(a.options.label),a.options.checked?(a._getRadios().not(a.element).radio("uncheck"),a.uiIcon.addClass("cui-icon-radio-checked coral-radio-hightlight"),a.element.prop("checked",!0)):(a.uiIcon.addClass("cui-icon-radio-unchecked"),a.element.prop("checked",!1)),a.element.after(a.uiRadio),a.uiRadio.append(a.element).append(a.uiLabel),b.labelField&&(this.uiLabelField=$('<label class="coral-label">'+b.labelField+"</label>"),this.uiRadio.prepend(this.uiLabelField),this.uiRadio.addClass("coral-hasLabel")),a.element[0].checked===!0&&(a.originalValue=this.getValue()),a._bindEvent()},reset:function(){"off"===this.originalValue||""===this.originalValue?this.uncheck():this.check()},_getRadios:function(){var a=this,b=a.element.closest("form");return b.length>0?b.find($("."+a.nameMark)):$("."+a.nameMark)},_setDisabled:function(a){a?(this.element.prop("disabled",!0),this.element.removeClass("tabbable"),this.uiRadio.addClass("coral-state-disabled")):(this.element.prop("disabled",!1),this.element.addClass("tabbable"),this.uiRadio.removeClass("coral-state-disabled")),this.options.disabled=!!a},_setIsLabel:function(a){a?(this.element.prop("isLabel",!0),this.uiRadio.addClass("coral-isLabel"),this.element.removeClass("tabbable")):(this.element.prop("isLabel",!1),this.uiRadio.removeClass("coral-isLabel"),this.element.addClass("tabbable")),this.options.isLabel=!!a},_setReadonly:function(a){a?(this.element.prop("reaonly",!0),this.uiRadio.addClass("coral-readonly"),this.element.removeClass("tabbable")):(this.element.prop("readonly",!1),this.uiRadio.removeClass("coral-readonly"),this.element.addClass("tabbable")),this.options.readonly=!!a},focus:function(){return this.options.disabled||this.options.readonly||this.options.isLabel?!1:(this.element.focus(),!0)},_bindEvent:function(){var a=this,b=a.options;this.options.disabled&&this._setDisabled(this.options.disabled),this.options.readonly&&this._setReadonly(this.options.readonly),this.options.isLabel&&this._setIsLabel(this.options.isLabel);var c;this.element.bind("focus",function(){a.uiRadio.addClass("coral-radio-highlight")}).bind("blur",function(){a.uiRadio.removeClass("coral-radio-highlight")}).bind("click",function(b){if(!(a.options.disabled||a.options.readonly||a.options.isLabel)){if(c)return void(c=!1);a._clearCheckedState(),a.uiIcon.removeClass("cui-icon-radio-unchecked"),a.uiIcon.addClass("cui-icon-radio-checked coral-radio-hightlight"),a._trigger("onChange",null,[{checked:!!a.element.prop("checked")}]),a._trigger("onClick",null,{checked:!!a.element.prop("checked")})}}).bind("keydown"+this.eventNamespace,function(c){if(a.options.allowCancel){var d=$.coral.keyCode;switch(c.keyCode){case d.SPACE:c.preventDefault(),a._selectItem(c)}}b.shortCut&&$.coral.callFunction(b.shortCut,event,this),a._trigger("onKeyDown",c,{})}),this.uiRadio.bind("mouseenter"+this.eventNamespace,function(){a.options.disabled||$(this).addClass("coral-radio-hover")}).bind("mouseleave"+this.eventNamespace,function(){a.options.disabled||$(this).removeClass("coral-radio-hover")}),this.uiLabel.bind("click",function(b){a._selectItem(b)})},_selectItem:function(a){var b=this;if(b.options.readonly||b.options.disabled||b.options.isLabel)return!1;if(suppressClick=!0,b.options.isCheck=$(b.element).prop("checked"),b.options.isCheck){if(!b.options.allowCancel)return;b._clearCheckedState(),b.uiIcon.addClass("cui-icon-radio-unchecked"),b.element.prop("checked",!1),b._trigger("onChange",null,[{checked:!!b.element.prop("checked")}])}else b._clearCheckedState(),b.uiIcon.removeClass("cui-icon-radio-unchecked"),b.uiIcon.addClass("cui-icon-radio-checked"),b.element.prop("checked",!0),b._trigger("onChange",null,[{checked:!!b.element.prop("checked")}])},clear:function(){},_clearCheckedState:function(){this._getRadios().each(function(){$(this).radio("component").find(".coral-radio-icon").removeClass("cui-icon-radio-checked coral-radio-hightlight").addClass(" cui-icon-radio-unchecked")})},_hashCode:function(a){if(!a)return 0;a=""+a;for(var b=0,c=0,d=a.length,e=0;d>e;e++)b=31*b+a.charCodeAt(c++),(b>2147483647||2147483648>b)&&(b=4294967295&b);return b},_setOption:function(a,b){"id"!==a&&"name"!==a&&("readonly"===a&&this._setReadonly(b),"isLabel"===a&&this._setIsLabel(b),"disabled"===a&&this._setDisabled(b),this._super(a,b))},_destroy:function(){this.uiRadio.replaceWith(this.element),this.uncheck(),this.element.removeClass("coral-form-element-radio"),this.element.removeClass("coral-validation-radio"),this.element.removeClass(this.nameMark)},component:function(){return this.uiRadio},disable:function(){this._setDisabled(!0)},enable:function(){this._setDisabled(!1)},show:function(){this.component().show()},hide:function(){this.component().hide()},check:function(){var a=this;this.uiIcon.hasClass("cui-icon-radio-unchecked")&&(a._getRadios().each(function(){$(this).radio("component").find(".coral-radio-icon").removeClass("cui-icon-radio-checked coral-radio-hightlight").addClass(" cui-icon-radio-unchecked")}),this.uiIcon.removeClass("cui-icon-radio-unchecked").addClass("cui-icon-radio-checked coral-radio-hightlight"),this.element.prop("checked",!0))},uncheck:function(){this.uiIcon.hasClass("coral-radio-hightlight")&&(this.uiIcon.removeClass("cui-icon-radio-checked coral-radio-hightlight").addClass("cui-icon-radio-unchecked"),this.element.prop("checked",!1))},isChecked:function(){return this.element.prop("checked")},setValue:function(a){"on"===a?this.check():this.uncheck()},getValue:function(){return this.getValues().join(",")},getValues:function(){var a=this,b=[];return a._getRadios().each(function(){var a=$(this);a.radio("isChecked")&&b.push(a.val())}),b},refresh:function(){this._destroy(),this._create()}});/*! cui 2016-11-08 */
$.component("coral.radiolist",$.coral.formelement,{version:"4.0.1",castProperties:["data","triggers","showRequiredMark","hideRequiredMark","shortCut"],options:{id:null,name:null,valueField:"value",textField:"text",required:!1,labelField:null,starBefore:!1,showStar:!0,column:null,disabled:!1,readonly:!1,isLabel:!1,isCheck:!1,allowCancel:!1,value:"",valueIndex:null,data:[],url:null,termSplit:";",itemSplit:":",repeatLayout:"table",itemWidth:"auto",errMsg:null,errMsgPosition:"leftBottom",onLoad:null,onValidError:null,onKeyDown:null,onValidSuccess:null,triggers:null,excluded:!1,onChange:$.noop},_create:function(){this.options;this._prepareInit(),this._initComponent(),this._setDefaultValue(),this._initData(),this._bindEvent(),(this.options.url||this.options.data)&&this._trigger("onLoad",null,[{data:this.getData()}])},_prepareInit:function(){this.isInit=!1},_initComponent:function(){this.element.addClass("coral-form-element-radiolist coral-validation-radiolist ctrl-init ctrl-form-element ctrl-init-radiolist"),"undefined"==typeof this.element.attr("id")&&!!this.options.id&&that.element.attr("id",this.options.id),this.options.id=this.element.uniqueId().attr("id");var a=this.element.attr("value");a&&(this.options.value=a);var b=this.element.attr("name");"undefined"!=typeof b?this.options.name=b:this.element.attr("name",this.options.name),this.uiBoxlist=$('<span class="coral-radiolist"></span>'),this.uiInput=$('<input type="hidden">'),this.options.name&&(this.uiInput.attr("name",this.options.name),this.element.removeAttr("name").attr("orgname",this.options.name)),this.uiInput.appendTo(this.uiBoxlist),this.options.labelField&&(this.uiLabel=$('<label class="coral-label">'+this.options.labelField+"</label>"),this.uiBoxlist.prepend(this.uiLabel),this.uiBoxlist.addClass("coral-hasLabel")),this.uiBoxlist.insertAfter(this.element),this.element.hide()},_setDefaultValue:function(){},reload:function(a){var b=this,c={},d=[],e=!1;a||b.options.url?!a&&b.options.url&&(a=b.options.url):a=[],"string"!=typeof a?(c=a,c.data?d=c.data:c.url?(a=c.url,b.options.url=c.url,e=!0):c instanceof Array?d=a:c.url||c.data||b.options.url?c.url||c.data||!b.options.url||(a=b.options.url,e=!0):d=[]):(b.options.url=a,e=!0),this.uiBoxlist.empty(),e?(this.xhr&&this.xhr.abort(),this.xhr=$.ajax(this._ajaxSettings()),this.xhr.success(function(a){b._loadData(a)}).complete(function(a,c){a===b.xhr&&(b.xhr=null)}).error(function(){$.alert("Json Format Error!")})):b._loadData(d)},_initData:function(){var a=this,b=this.options;b.url?(this.xhr&&this.xhr.abort(),this.xhr=$.ajax(this._ajaxSettings()),this.xhr.success(function(b){a._loadData(b)}).complete(function(b,c){b===a.xhr&&(a.xhr=null)}).error(function(){$.alert("Json Format Error!")})):b.data&&this._loadData(b.data)},_ajaxSettings:function(){var a=this.options;return{type:"get",url:a.url,data:{},async:!1,dataType:"json"}},_loadData:function(a){var b,c,d=null,e=0,f=null,g=null,h=null;if("string"==typeof a)for(d=a.split(this.options.termSplit),a=[];e<d.length;e++)g=d[e],h=g.split(this.options.itemSplit),f={},f[this.options.valueField]=h[0],f[this.options.textField]=h[1],a.push(f);for(this.data=a,e;e<a.length;e++)b=a[e],b.checked&&(c=b[this.options.valueField]);this.options.value&&(c=this.options.value),this.isInit||(this.isInit=!0,this.originalValue=c),this._renderRadioItem(),this.setValue(c)},_renderRadioItem:function(){"table"==this.options.repeatLayout?(null==this.options.column&&(this.options.column=3),this._renderTableItem(),this.uiTable.appendTo(this.uiBoxlist)):"flow"==this.options.repeatLayout&&(null==this.options.column&&(this.options.column=this.data.length),this._renderFlowItem(),this.uiBorder.appendTo(this.uiBoxlist))},reset:function(){this.setValue(this.originalValue)},getData:function(){return this.data},_renderFlowItem:function(){var a=this,b=this.options,c=this.options.column,d=this.data;a.uiBorder=$('<span class="coral-radiolist-border"></span>');for(var e in d)e>c-1&&e%c===0&&$("<br/>").appendTo(a.uiBorder),a._renderItem(d[e]).css("width",b.itemWidth).appendTo(a.uiBorder)},_renderTableItem:function(){this.uiTable=$("<table></table>");var a=0,b=0,c=this.data,d=c.length||0,e=this.options.column,f=0,g=null,h=null;if(c&&!(c.length<1))for(f=Math.ceil(d/e);f>a;a++){for(g=$("<tr></tr>"),b=0;e>b;b++)h=$("<td></td>"),d>a*e+b&&this._renderItem(c[a*e+b]).appendTo(h),h.appendTo(g);g.appendTo(this.uiTable)}},_renderItem:function(a){for(var b,c,d,e,f=this.data,g=!1,h=0;h<f.length;h++)1==f[h].checked&&(g=!0);return g?this.tabIndex=h:this.tabIndex=0,c=a.hidden===!0?"hidden":"",d=a.checked===!0?"tabindex = 0":"",e=a.checked===!0?"tabbable":"",g||a[this.options.valueField]!=f[0].value?b=$("<span class='coral-radio "+c+e+"'"+d+"></span>"):(d="tabindex = 0",b=$("<span class='coral-radio "+c+"tabbable '"+d+"></span>")),uiLabel=$("<label class='coral-radio-label'></label>"),uiIcon=$("<span class='coral-radio-icon'></span>"),value=a[this.options.valueField],text=a[this.options.textField],b.attr("value",value),uiLabel.append(uiIcon).append(text),uiLabel.appendTo(b),uiIcon.addClass("cui-icon-radio-unchecked"),b},_bindEvent:function(){var a=this;this.options.disabled&&this._setDisabled(this.options.disabled),this.options.readonly&&this._setReadonly(this.options.readonly),this.options.isLabel&&this._setIsLabel(this.options.isLabel),this._on({"mouseenter .coral-radio":function(b){if(a.options.readonly||a.options.isLabel)return!1;var c=$(b.target).closest(".coral-radio");$(c).hasClass("coral-state-disabled")||$(c).addClass("coral-radio-hover")},"mouseleave .coral-radio":function(b){if(a.options.readonly||a.options.isLabel)return!1;var c=$(b.target).closest(".coral-radio");$(c).hasClass("coral-state-disabled")||$(c).removeClass("coral-radio-hover")},"focus .coral-radio":function(a){var b=$(a.target).closest(".coral-radio");$(b).addClass("coral-radio-highlight")},"blur .coral-radio":function(a){var b=$(a.target).closest(".coral-radio");$(b).removeClass("coral-radio-highlight")},"keydown .coral-radio":function(b){var c=$.coral.keyCode,d=this.options,e=$(b.target).closest(".coral-radiolist"),f=e.find(".coral-radio");switch(record=0,isChecked=!0,$.each(f,function(a){f[a]==document.activeElement&&(record=a),isChecked=$(f[a]).attr("checked")===!0}),b.keyCode){case c.SPACE:b.preventDefault(),a._selectItem(b);break;case c.LEFT:if(b.preventDefault(),a.options.readonly||a.options.isLabels)return!1;0==record&&(record=f.length);var g=$(f[record-1]),h=g.find(".coral-radio-icon"),i=g.attr("value");g.attr("tabindex","0"),$(f[record]).removeAttr("tabindex"),g.addClass("tabbable"),$(f[record]).removeClass("tabbable"),a.setValue(i),setTimeout(function(){g.focus()}),a._trigger("onChange",null,{value:i,checked:h.hasClass("coral-radiolist-item-hightlight")});break;case c.RIGHT:if(b.preventDefault(),a.options.readonly||a.options.isLabel)return!1;record==f.length-1&&(record=-1);var g=$(f[record+1]),h=g.find(".coral-radio-icon"),i=g.attr("value");g.attr("tabindex","0"),$(f[record]).removeAttr("tabindex"),g.addClass("tabbable"),$(f[record]).removeClass("tabbable coral-radio-highlight"),a.setValue(i),setTimeout(function(){g.focus()}),a._trigger("onChange",null,{value:i,checked:h.hasClass("coral-radiolist-item-hightlight")})}d.shortCut&&$.coral.callFunction(d.shortCut,event,this),a._trigger("onKeyDown",b,{})},"click .coral-radio":function(b){a.options.disabled||a.options.readonly||(a._selectItem(b),b.stopPropagation())}})},_selectItem:function(a){var b=this,c=$(".coral-radiolist").find(".coral-radio"),d=$(a.target).closest(".coral-radio");if(b.options.readonly||b.options.isLabel)return!1;var e=d,f=e.find(".coral-radio-icon"),g=e.attr("value"),h=b.getValue();if($.each(c,function(a){$(c[a]).hasClass("tabbable")&&($(c[a]).removeClass("tabbable"),$(c[a]).removeAttr("tabindex"))}),e.addClass("tabbable"),e.attr("tabindex","0"),e.focus(),g==h){if(!this.options.allowCancel)return!1;f.removeClass("cui-icon-radio-checked coral-radiolist-item-hightlight ").addClass("cui-icon-radio-unchecked"),c.removeClass("coral-radio-highlight"),b.uiInput.val("")}else b.setValue(g),b._trigger("onChange",null,{value:g,checked:f.hasClass("coral-radiolist-item-hightlight")})},_setDisabled:function(a){a=!!a,this.uiBoxlist.find(".coral-radio").each(function(){$(this).toggleClass("coral-state-disabled",a),$(this).toggleClass("tabbable",!a)}),this.options.disabled=a},_setReadonly:function(a){a=!!a,this.uiBoxlist.find(".coral-radio").each(function(){$(this).toggleClass("coral-readonly",a),$(this).toggleClass("tabbable",!a)}),this.options.readonly=a},_setIsLabel:function(a){a=!!a,this.uiBoxlist.find(".coral-radio").each(function(){$(this).toggleClass("coral-isLabel",a),$(this).toggleClass("tabbable",!a)}),this.options.isLabel=a},_setOption:function(a,b){"id"!==a&&"name"!==a&&("disabled"===a&&this._setDisabled(b),"readonly"===a&&this._setReadonly(b),"isLabel"===a&&this._setIsLabel(b),this._super(a,b))},_destroy:function(){this.component().remove(),this.options.name&&this.element.removeAttr("orgname").attr("name",this.options.name),this.element.removeClass("coral-form-element-radiolist"),this.element.removeClass("coral-validation-radiolist"),this.element.show()},focus:function(){},component:function(){return this.uiBoxlist},disable:function(){this._setDisabled(!0)},readonly:function(){this._setReadonly(!0)},enable:function(){this._setDisabled(!1)},disableItem:function(a){this.uiBoxlist.find('.coral-radio[value="'+a+'"]').toggleClass("coral-state-disabled",!0)},enableItem:function(a){this.options.disabled=!1,this.uiBoxlist.find('.coral-radio[value="'+a+'"]').toggleClass("coral-state-disabled",!1)},show:function(){this.component().show()},hide:function(){this.component().hide()},getValue:function(){return this.uiInput.val()},setValue:function(a){a=a||"",this.uiBoxlist.find(".coral-radiolist-item-hightlight").each(function(){$(this).removeClass("cui-icon-radio-checked coral-radiolist-item-hightlight").addClass("cui-icon-radio-unchecked")});this.uiBoxlist.find('.coral-radio[value="'+a+'"]').find(".coral-radio-icon").removeClass("cui-icon-radio-unchecked").addClass("cui-icon-radio-checked coral-radiolist-item-hightlight");this.uiInput.val(a)},getText:function(a){var b=0,c=this.data,d=null;for(a||(a=this.getValue());b<c.length;b++)if(d=c[b][this.options.valueField],d==a)return c[b][this.options.textField];return""}});/*! cui 2016-11-08 */
$.component("coral.progressbar",{version:"4.0.1",options:{id:null,name:null,max:100,value:0,text:"{value}%",onChange:null,onComplete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("coral-progressbar coral-component coral-corner-all"),this.valueDiv=$('<div class="coral-progressbar-value coral-corner-left"></div>').appendTo(this.element),this.textDiv=$('<div class="coral-progressbar-text"></div>').appendTo(this.valueDiv),this.valueWidth=this.element.width()-(this.valueDiv.outerWidth(!0)-this.valueDiv.outerWidth()),this._refreshValue()},_destroy:function(){this.element.removeClass("coral-progressbar coral-component coral-component-content coral-corner-all"),this.valueDiv.remove()},value:function(a){return void 0===a?this.options.value:(this.options.value=this._constrainedValue(a),void this._refreshValue())},_constrainedValue:function(a){return void 0===a&&(a=this.options.value),this.indeterminate=a===!1,"number"!=typeof a&&(a=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,a))},_setOptions:function(a){var b=a.value;delete a.value,this._super(a),this.options.value=this._constrainedValue(b),this._refreshValue()},_setOption:function(a,b){"max"===a&&(b=Math.max(this.min,b)),"disabled"===a&&this.element.toggleClass("coral-state-disabled",!!b).attr("aria-disabled",b),this._super(a,b)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var a=this.options.value,b=this._percentage().toFixed(0),c=this.options.text.replace(/{value}/,b),d=0,e=0;this.valueDiv.toggle(this.indeterminate||a>this.min).toggleClass("coral-corner-right",a===this.options.max).width(this.valueWidth*b/100),100==b&&this.valueDiv.width("auto"),this.textDiv.html(c),d=this.element.position().left+(this.element.outerWidth()-this.textDiv.outerWidth())/2,e=this.element.position().top+(this.element.outerHeight()-this.textDiv.outerHeight())/2,this.textDiv.position({of:this.element,my:d+" "+e,at:d+" "+e}),this.element.toggleClass("coral-progressbar-indeterminate",this.indeterminate),this.indeterminate?this.overlayDiv||(this.overlayDiv=$("<div class='coral-progressbar-overlay'></div>").appendTo(this.valueDiv)):this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null),this.oldValue!==a&&(this.oldValue=a,this._trigger("onChange",null,{value:a,oldValue:this.oldValue})),a===this.options.max&&this._trigger("onComplete")}});/*! cui 2016-11-08 */
$.component("coral.accordion",{version:"4.0.1",options:{active:0,a:[],animate:{params:{},duration:300,easing:"swing"},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"cui-icon-arrow-down3",header:"cui-icon-arrow-up3"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var a=this.options;a.icons=$.coral.toFunction(a.icons),this.options.a.push("ddd"),this.prevShow=this.prevHide=$(),this.element.addClass("coral-accordion ctrl-init ctrl-init-accordion coral-component coral-helper-reset").attr("role","tablist"),a.collapsible||a.active!==!1&&null!=a.active||(a.active=0),this._processPanels(),a.active<0&&(a.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():$()}},_createIcons:function(){var a=this.options.icons;a&&($("<span>").addClass("coral-accordion-header-icon icon "+a.header).prependTo(this.headers),this.active.children(".coral-accordion-header-icon").removeClass(a.header).addClass(a.activeHeader),this.headers.each(function(){var a=$.parser.parseOptions(this);0==a.collapsible?$(this).children(".coral-accordion-header-icon").remove():$(this).addClass("coral-accordion-icons")}))},_destroyIcons:function(){this.headers.removeClass("coral-accordion-icons").children(".coral-accordion-header-icon").remove()},_destroy:function(){var a;this.element.removeClass("coral-accordion coral-component coral-helper-reset").removeAttr("role"),this.headers.removeClass("coral-accordion-header coral-accordion-header-active coral-state-default coral-corner-all coral-state-active coral-state-disabled coral-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").removeUniqueId(),this._destroyIcons(),a=this.headers.next().removeClass("coral-helper-reset coral-widget-content coral-corner-bottom coral-accordion-content coral-accordion-content-active coral-state-disabled").css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&a.css("height","")},_setOption:function(a,b){return"active"===a?void this._activate(b):("event"===a&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(b)),this._super(a,b),"collapsible"!==a||b||this.options.active!==!1||this._activate(0),"icons"===a&&(this._destroyIcons(),b&&this._createIcons()),void("disabled"===a&&(this.element.toggleClass("coral-state-disabled",!!b).attr("aria-disabled",b),this.headers.add(this.headers.next()).toggleClass("coral-state-disabled",!!b))))},_keydown:function(a){if(!a.altKey&&!a.ctrlKey){var b=$.coral.keyCode,c=this.headers.length,d=this.headers.index(a.target),e=!1;switch(a.keyCode){case b.RIGHT:case b.DOWN:e=this.headers[(d+1)%c];break;case b.LEFT:case b.UP:e=this.headers[(d-1+c)%c];break;case b.SPACE:case b.ENTER:this._eventHandler(a);break;case b.HOME:e=this.headers[0];break;case b.END:e=this.headers[c-1]}e&&($(a.target).attr("tabIndex",-1),$(e).attr("tabIndex",0),e.focus(),a.preventDefault())}},_panelKeyDown:function(a){a.keyCode===$.coral.keyCode.UP&&a.ctrlKey&&$(a.currentTarget).prev().focus()},refresh:function(){var a=this.options;this._processPanels(),a.active===!1&&a.collapsible===!0||!this.headers.length?(a.active=!1,this.active=$()):a.active===!1?this._activate(0):this.active.length&&!$.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".coral-state-disabled").length?(a.active=!1,this.active=$()):this._activate(Math.max(0,a.active-1)):a.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("coral-accordion-header coral-state-default coral-corner-all"),this.headers.next().addClass("coral-accordion-content coral-helper-reset coral-component-content coral-corner-bottom").filter(":not(.coral-accordion-content-active)").hide()},_refresh:function(){var a,b=this.options,c=b.heightStyle,d=this.element.parent();this.active=this._findActive(b.active).addClass("coral-accordion-header-active coral-state-active coral-corner-top").removeClass("coral-corner-all"),this.active.next().addClass("coral-accordion-content-active").show(),this.headers.attr("role","tab").each(function(){var a=$(this),b=a.uniqueId().attr("id"),c=a.next(),d=c.uniqueId().attr("id");a.attr("aria-controls",d),c.attr("aria-labelledby",b)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(b.event),"fill"===c?($.coral.fitParent(this.component(),!0),a=d.height(),this.element.siblings(":visible").each(function(){var b=$(this),c=b.css("position");"absolute"!==c&&"fixed"!==c&&(a-=b.outerHeight(!0))}),this.headers.each(function(){a-=$(this).outerHeight(!0)}),this.headers.next().each(function(){$(this).height(Math.max(0,a-$(this).innerHeight()+$(this).height()))}).addClass("coral-scroll")):"auto"===c&&($.coral.fitParent(this.component(),!1),a=0,this.headers.next().each(function(){a=Math.max(a,$(this).css("height","").height())}).height(a)),this.headers.each(function(){var a=$.parser.parseOptions(this);0==a.collapsible&&$(this).next().addClass("hidden")})},_activate:function(a){var b=this._findActive(a)[0];b!==this.active[0]&&(b=b||this.active[0],this._eventHandler({target:b,currentTarget:b,preventDefault:$.noop}))},_findActive:function(a){return"number"==typeof a?this.headers.eq(a):$()},_setupEvents:function(a){var b={keydown:"_keydown"};a&&$.each(a.split(" "),function(a,c){b[c]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,b),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(a){var b=this.options,c=this.active,d=$(a.currentTarget),e=d[0]===c[0],f=e&&b.collapsible,g=f?$():d.next(),h=c.next(),i={oldHeader:c,oldPanel:h,newHeader:f?$():d,newPanel:g,headerOptions:$.parser.parseOptions(f?$():d)};a.preventDefault(),e&&!b.collapsible||this._trigger("beforeActivate",a,i)===!1||(b.active=f?!1:this.headers.index(d),this.active=e?$():d,this._toggle(i),c.removeClass("coral-accordion-header-active coral-state-active"),b.icons&&c.children(".coral-accordion-header-icon").removeClass(b.icons.activeHeader).addClass(b.icons.header),e||(d.removeClass("coral-corner-all").addClass("coral-accordion-header-active coral-state-active coral-corner-top"),b.icons&&d.children(".coral-accordion-header-icon").removeClass(b.icons.header).addClass(b.icons.activeHeader),d.next().addClass("coral-accordion-content-active")))},_toggle:function(a){var b=a.newPanel,c=this.prevShow.length?this.prevShow:a.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=b,this.prevHide=c,this.options.animate?this._animate(b,c,a):(c.hide(),b.show(),this._toggleComplete(a)),c.attr({"aria-hidden":"true"}),c.prev().attr("aria-selected","false"),b.length&&c.length?c.prev().attr({tabIndex:-1,"aria-expanded":"false"}):b.length&&this.headers.filter(function(){return 0===$(this).attr("tabIndex")}).attr("tabIndex",-1),b.attr("aria-hidden","false").prev().attr({"aria-selected":"true",tabIndex:0,"aria-expanded":"true"})},_animate:function(a,b,c){var d,e,f,g=this,h=0,i=a.length&&(!b.length||a.index()<b.index()),j=this.options.animate||{},k=i&&j.down||j,l=function(){g._toggleComplete(c)};return"number"==typeof k&&(f=k),"string"==typeof k&&(e=k),e=e||k.easing||j.easing,f=f||k.duration||j.duration,b.length?a.length?(d=a.show().outerHeight(),b.animate(this.hideProps,{duration:f,easing:e,step:function(a,b){b.now=Math.round(a)}}),void a.hide().animate(this.showProps,{duration:f,easing:e,complete:l,step:function(a,b){b.now=Math.round(a),"height"!==b.prop?h+=b.now:"content"!==g.options.heightStyle&&(h=0)}})):b.animate(this.hideProps,f,e,l):a.animate(this.showProps,f,e,l)},_toggleComplete:function(a){var b=a.oldPanel;b.removeClass("coral-accordion-content-active").prev().removeClass("coral-corner-top").addClass("coral-corner-all"),b.length&&(b.parent()[0].className=b.parent()[0].className),this._trigger("onActivate",null,a)}});/*! cui 2016-11-08 */
!function(){var a={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},b={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},c=null;$.component("coral.dialog",{version:"@version",castProperties:["buttons","position"],options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"关闭",closeButtonClass:"cui-icon-cross2",closable:!0,loadtext:"加载中，请耐心等候 ...",maximumText:"最大化",maximizable:!1,maximized:!1,minimizable:!1,minimized:!1,minimizText:"最小化",restoreWidth:200,restoreHeight:200,dialogClass:"",iframePanel:!1,draggable:!0,animateType:null,hide:null,delay:"800",height:"auto",percent:!1,manualResize:!1,maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,zIndex:null,timeOut:0,position:{my:"center",at:"center",of:window,collision:"fit",using:function(a){var b=$(this).css(a).offset().top;0>b&&$(this).css("top",a.top-b)}},resizable:!0,show:null,title:null,subTitle:null,type:null,wtype:"dialog",message:null,width:300,url:"",contentType:"",reLoadOnOpen:!1,postData:[],asyncType:"post",beforeClose:null,onCreate:null,onClose:null,onDrag:null,onDragStart:null,onDragStop:null,onFocus:null,onLoad:null,onLoadError:null,onOpen:null,onResize:null,onResizeStart:null,onResizeStop:null,onConfirm:null,onCancel:null,focusInput:!1},_compatible:function(){this.options.reloadOnOpen=this.options.reLoadOnOpen},_create:function(){this._compatible();var a=[],b=/^(\d|[1-9]\d|100)%$/;b.test(this.options.height)&&(this.options.percent=this.options.height,this.options.height=this._percentToPx()),$.inArray(this.options.wtype,["dialog","message","alert","confirm"])<0&&(this.options.wtype="dialog"),"dialog"!==this.options.wtype&&(this.options.minHeight=null),this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this.originalsubTitle=this.element.attr("subTitle"),this.options.subTitle=this.options.subTitle||this.originalsubTitle,a=["slideTop","slideBottom","slideLeft","slideRight"],$.inArray(this.options.animateType,a)>-1&&(this.animate=!0),this._createWrapper();var c=this.options.isMessage?"alert-box":"coral-dialog-content";switch(this.element.show().removeAttr("title").addClass(c+" coral-component-content").appendTo(this.uiDialog),"dialog"!==this.options.wtype&&this.uiDialog.addClass("coral-messager"),this.options.wtype){case"alert":this._createTitlebar(),this._createButtonPanel();break;case"message":break;case"confirm":this._createTitlebar(),this._createButtonPanel();break;case"dialog":this._createTitlebar(),this._createButtonPanel()}this.options.draggable&&$.fn.draggable&&this._makeDraggable(),this.options.resizable&&$.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var a=this.options.appendTo;return"string"==typeof a&&"parent"==a?this.originalPosition.parent:a&&(a.jquery||a.nodeType)?$(a):this.document.find(a||"body").eq(0)},forceDestroy:function(){this._destroy(!0)},_destroy:function(a){var b,c=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("coral-dialog-content coral-component-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.options.iframePanel&&this.iframePanel.stop(!0,!0).remove(),a||(this.originalTitle&&this.element.attr("title",this.originalTitle),b=c.parent.children().eq(c.index),b.length&&b[0]!==this.element[0]?b.before(this.element):c.parent.append(this.element))},component:function(){return this.uiDialog},disable:$.noop,enable:$.noop,minimize:function(){var a,b,c=this,d=this.originalPosition;this._hide(this.uiDialog,this.options.hide,function(){if(b=d.parent.children().eq(d.index),b.length&&b[0]!==c.element[0]?b.before(c.uiDialog):d.parent.append(c.uiDialog),c._isOpen=!1,c._focusedElement=null,c._destroyOverlay(),c._untrackInstance(),$.inArray(c.options.wtype,["dialog","alert","confirm"])>-1&&c.opener.length&&"object"!=c.opener[0].tagName.toLowerCase()&&!c.opener.filter(":focusable").focus().length)try{a=c.document[0].activeElement,a&&"body"!==a.nodeName.toLowerCase()&&$(a).blur()}catch(e){}"dialog"!==c.options.wtype&&c.element.remove(),c._trigger("onMinimize",event)}),this.options.iframePanel&&this.iframePanel.hide()},close:function(a){var b,c,d=this,e=this.options.hide,f=this.originalPosition;this.animate&&(d.uiDialog.hasClass("in")&&d.uiDialog.removeClass("in"),e=this.options),this.options.reLoadOnOpen&&(this.loaded=!1),this._isOpen&&this._trigger("beforeClose",a)!==!1&&(d.options.destroyOnClose&&d.element.html(""),""!=d.options.url&&d.options.reLoadOnOpen&&d.options.autoDestroy&&d.element.html(""),this._hide(this.uiDialog,e,function(){if(c=f.parent.children().eq(f.index),c.length&&c[0]!==d.element[0]?c.before(d.uiDialog):f.parent.append(d.uiDialog),d._isOpen=!1,d._focusedElement=null,d._destroyOverlay(),d._untrackInstance(),$.inArray(d.options.wtype,["dialog","alert","confirm"])>-1&&d.opener.length&&"object"!=d.opener[0].tagName.toLowerCase()&&!d.opener.filter(":focusable").focus().length)try{b=d.document[0].activeElement,b&&"body"!==b.nodeName.toLowerCase()&&$(b).blur()}catch(e){}"dialog"!==d.options.wtype&&d.element.remove(),d._trigger("onClose",a)}),this.options.iframePanel&&this.iframePanel.hide())},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(a,b){var c=!1,d=this.uiDialog.siblings(".coral-front:visible").map(function(){return+$(this).css("z-index")}).get(),e=Math.max.apply(null,d);return e>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",e+1),this.options.iframePanel&&this.iframePanel.css("z-index",e+1),c=!0),c&&!b&&this._trigger("onFocus",a),c},reload:function(){var a=this,b={panel:a.element},c=this.options.url;c&&($(a.element).loading({position:"overlay",text:"加载中，请耐心等候！"}),a.loaded=!0,$.ajax({url:this.options.url,type:this.options.asyncType,dataType:"html",data:this.options.postData,success:function(c,d,e){$(a.element).loading("hide"),a.element.html(c),$(a.element).loading({text:"渲染中，请耐心等候！",position:"overlay"}),$.parser.parse(a.element),$(a.element).loading("hide"),a._trigger("onLoad",null,b)},error:function(b,c,d){a._trigger("onLoadError",null,[{xhr:b,st:c,err:d}])},beforeSend:function(a,b){}}))},open:function(){function a(){b.close()}var b=this,d={panel:b.element};this.uiDialog.appendTo(this._appendTo());var e=this.options.url&&!b.loaded;return e&&($(b.element).loading({position:"overlay",text:"加载中，请耐心等候！"}),b.loaded=!0,$.ajax({contentType:this.options.contentType,url:this.options.url,type:this.options.asyncType,dataType:"html",data:this.options.postData,success:function(a,c,e){$(b.element).loading("hide"),b.element.html(a),$(b.element).loading({text:"渲染中，请耐心等候！",position:"overlay"}),$.parser.parse(b.element),$(b.element).loading("hide"),b._trigger("onLoad",null,d)},error:function(a,c,d){b._trigger("onLoadError",null,[{xhr:a,st:c,err:d}])},beforeSend:function(a,b){}})),c=null,this._isOpen?void(this._moveToTop()&&$.inArray(b.options.wtype,["dialog","alert","confirm"])>-1&&this._focusTabbable()):(this._isOpen=!0,this.opener=$(this.document[0].activeElement),this._size(),this.animate?setTimeout(function(){b.uiDialog.addClass("in")},0):this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&(this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this.options.iframePanel&&this.overlay.css("z-index",this.iframePanel.css("z-index")-1)),this._show(this.uiDialog,this.options.show,function(){$.inArray(b.options.wtype,["dialog","alert","confirm"])>-1&&b._focusTabbable(),e?$(b.element).loading("refresh"):$.coral.refreshAllComponent(b.element),b.options.iframePanel&&(b.iframePanel.show(),b.iframePanel.css("width",b.uiDialog.outerWidth())),b._trigger("onFocus")}),this._makeFocusTarget(),this._trigger("onOpen"),void(!isNaN(this.options.timeOut)&&this.options.timeOut>0&&(c=setTimeout(a,b.options.timeOut),this.uiDialog.hover(function(){c&&clearTimeout(c)},function(){c=setTimeout(a,b.options.timeOut)}))))},_focusTabbable:function(){var a=this._focusedElement;return this.options.focusInput===!0?void this._focusFirst():(a||(a=this.element.find("[autofocus]")),a.length||(a=this.element.find(":tabbable")),!a.length&&this.uiDialogButtonPane&&(a=this.uiDialogButtonPane.find(":tabbable")),!a.length&&this.uiDialogTitlebarClose&&(a=this.uiDialogTitlebarClose.filter(":tabbable")),a.length||(a=this.uiDialog),void a.eq(0).focus())},_findFields:function(){return $.coral.findComponent(".ctrl-form-element",this.element)},_focusFirst:function(){var a=this._findFields();for(var b in a){var c=a[b];if(c.focus&&1==c.focus())return}},_keepFocus:function(a){function b(){var a=this.document[0].activeElement,b=this.uiDialog[0]===a||$.contains(this.uiDialog[0],a);b||this._focusTabbable()}a.preventDefault(),b.call(this),this._delay(b)},_createWrapper:function(){this.uiDialog=$("<div>").addClass("coral-dialog coral-component coral-component-content coral-corner-all coral-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this.element.parent()),this.animate&&this.uiDialog.addClass(this.options.animateType),this.options.iframePanel&&(this.iframePanel=$("<iframe class='coral-dialog-iframePanel' style='position:absolute;'></iframe>").hide().appendTo(this._appendTo())),this.options.zIndex&&(this.uiDialog.css("z-index",this.options.zIndex),this.options.iframePanel&&this.iframePanel.css("z-index",this.options.zIndex)),this._on(this.uiDialog,{keydown:function(a){if(this.options.closeOnEscape&&!a.isDefaultPrevented()&&a.keyCode&&a.keyCode===$.coral.keyCode.ESCAPE)return a.preventDefault(),void this.close(a);if(a.keyCode===$.coral.keyCode.TAB&&!a.isDefaultPrevented()){var b=this.uiDialog.find(":tabbable"),c=b.filter(":first"),d=b.filter(":last");a.target!==d[0]&&a.target!==this.uiDialog[0]||a.shiftKey?a.target!==c[0]&&a.target!==this.uiDialog[0]||!a.shiftKey||(this._delay(function(){d.focus()}),a.preventDefault()):(this._delay(function(){c.focus()}),a.preventDefault())}},mousedown:function(a){this._moveToTop(a)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var a;this.options;this.uiDialogTitlebar=$("<div>").addClass("coral-dialog-titlebar coral-component-header coral-corner-all coral-helper-clearfix").prependTo(this.uiDialog),this.uiDialogToolbar=$("<div>").addClass("coral-dialog-toolbar coral-corner-all coral-helper-clearfix").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebar,{mousedown:function(a){$(a.target).closest(".coral-dialog-toolbar-close")||$(a.target).closest(".coral-dialog-toolbar-maximum")||this.uiDialog.focus()}}),this.options.minimizable&&(this.uiDialogTitlebarMaximum=$("<button type='button'></button>").button({label:"&nbsp;",icons:{primary:"cui-icon-minus3"},text:!1}).addClass("coral-dialog-toolbar-minimize").appendTo(this.uiDialogToolbar)),this.options.maximizable&&(this.uiDialogTitlebarMaximum=$("<button type='button'></button>").button({label:this.options.maximumText,icons:{primary:"cui-icon-enlarge7"},text:!1}).addClass("coral-dialog-toolbar-maximum").appendTo(this.uiDialogToolbar)),this.options.closable&&(this.uiDialogTitlebarClose=$("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:this.options.closeButtonClass},text:!1}).addClass("coral-dialog-toolbar-close").appendTo(this.uiDialogToolbar)),this._on(this.uiDialogTitlebar,{click:function(a){if($(a.target).closest(".coral-dialog-toolbar-minimize").length&&this.minimize(),$(a.target).closest(".coral-dialog-toolbar-close").length){var b=$(a.target);b.removeClass("coral-state-hover"),a.preventDefault(),this.close(a)}$(a.target).closest(".coral-dialog-toolbar-maximum").length&&(this.uiDialog.hasClass("coral-dialog-maximum")?this.restore():this.maximize(),$.coral.refreshAllComponent(this.element))}}),a=$("<span>").uniqueId().addClass("coral-dialog-title").prependTo(this.uiDialogTitlebar),this._title(a),uiDialogsubTitle=$("<span>").uniqueId().addClass("coral-dialog-subTitle").prependTo(this.uiDialogTitlebar),this._subTitle(uiDialogsubTitle),this.uiDialog.attr({"aria-labelledby":a.attr("id")}),this.options.maximizable&&this.options.maximized&&(this.maximize(),$.coral.refreshAllComponent(this.element))},maximize:function(a){var b=this.options;b.restoreHeight=b.height,b.restoreWidth=b.width,$(this.element).dialog("option","width",$(window).width()),$(this.element).dialog("option","height",$(window).height()),this.uiDialog.addClass("coral-dialog-maximum"),this.uiDialogTitlebarMaximum.find(".cui-icon-enlarge7").removeClass("cui-icon-enlarge7").addClass("cui-icon-shrink7"),this.options.iframePanel&&this.iframePanel.css({width:$(window).width(),height:$(window).height()}),this._trigger("onMaximize",null,{width:$(window).outerWidth(),height:$(window).outerHeight()})},restore:function(){var a=this,b=this.options;$(a.element).dialog("option","width",b.restoreWidth),$(a.element).dialog("option","height",b.restoreHeight),a.uiDialog.removeClass("coral-dialog-maximum"),this.options.iframePanel&&(this.iframePanel.css({width:b.restoreWidth,height:b.restoreHeight}),this.iframePanel.position(b.position)),this._resetMaximizeIcon(),this._trigger("onRestore",null,{width:$(window).outerWidth(),height:$(window).outerHeight()})},_resetMaximizeIcon:function(){this.uiDialogTitlebarMaximum&&this.uiDialogTitlebarMaximum.find(".cui-icon-shrink7").removeClass("cui-icon-shrink7").addClass("cui-icon-enlarge7")},_title:function(a){var b=$.coral.toFunction(this.options.titleFormat);this.options.title||a.html("&#160;"),b?a.html(b.call(this.element,this.options.title)):a.text(this.options.title)},_subTitle:function(a){this.options.subTitle||a.html("&#160;"),a.text(this.options.subTitle)},_createButtonPanel:function(){this.uiDialogButtonPane=$("<div>").addClass("coral-dialog-buttonpane coral-component-content coral-helper-clearfix"),this.uiButtonSet=$("<div>").addClass("coral-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var a=this,b=this.options.buttons;$.noop,$.noop;if(this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),$.isEmptyObject(b)&&(b={}),$.isArray(b)&&!b.length)return void this.uiDialog.removeClass("coral-dialog-buttons");var c=!0;$.each(b,function(b,d){var e,f,g="coral-btn-primary";d=$.isFunction(d)?{click:d,text:b}:d,d=$.extend({type:"button"},d),e=d.click,d.click=function(){e.apply(a.element[0],arguments)},f={icons:d.icons,icons:d.cls,countdown:d.countdown,text:d.showText},d.id&&(f.id=d.id),f=c?$.extend({},f,{cls:g+" "+d.cls}):$.extend({},f,{cls:d.cls}),delete d.icons,delete d.cls,delete d.showText,$("<button></button>",d).button(f).appendTo(a.uiButtonSet),c=!1}),this.uiDialog.addClass("coral-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog)},_makeDraggable:function(){function a(a){return{position:a.position,offset:a.offset}}var b=this,c=this.options;this.uiDialog.draggable({cancel:".coral-dialog-content, .coral-dialog-toolbar-close",handle:".coral-dialog-titlebar",containment:"document",start:function(c,d){$(this).addClass("coral-dialog-dragging"),b._blockFrames(),b.options.iframePanel&&b.iframePanel.css(d.position),b._trigger("onDragStart",c,a(d))},drag:function(c,d){b.options.iframePanel&&b.iframePanel.css(d.position),b._trigger("onDrag",c,a(d))},stop:function(d,e){var f=e.offset.left-b.document.scrollLeft(),g=e.offset.top-b.document.scrollTop();c.position={my:"left top",at:"left"+(f>=0?"+":"")+f+" top"+(g>=0?"+":"")+g,of:b.window},$(this).removeClass("coral-dialog-dragging"),b.options.iframePanel&&b.iframePanel.position(c.position),b._unblockFrames(),b._trigger("onDragStop",d,a(e))}})},_makeResizable:function(){function a(a){return{originalPosition:a.originalPosition,originalSize:a.originalSize,position:a.position,size:a.size}}var b=this,c=this.options,d=c.resizable,e=this.uiDialog.css("position"),f="string"==typeof d?d:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".coral-dialog-content",containment:"document",alsoResize:this.element,maxWidth:c.maxWidth,maxHeight:c.maxHeight,minWidth:c.minWidth,minHeight:this._minHeight(),handles:f,start:function(c,d){$(this).addClass("coral-dialog-resizing"),b.manualResize=!0,b.options.iframePanel&&(b.iframePanel.css(d.position),b.iframePanel.css(d.size)),b._blockFrames(),b._trigger("onResizeStart",c,a(d))},resize:function(c,d){b.options.iframePanel&&(b.iframePanel.css(d.position),b.iframePanel.css(d.size)),$.coral.refreshAllComponent(b.element),b._trigger("onResize",c,a(d))},stop:function(d,e){var f=b.uiDialog.offset(),g=f.left-b.document.scrollLeft(),h=f.top-b.document.scrollTop();c.height=b.uiDialog.height(),c.width=b.uiDialog.width(),c.position={my:"left top",at:"left"+(g>=0?"+":"")+g+" top"+(h>=0?"+":"")+h,of:b.window},$(this).removeClass("coral-dialog-resizing"),b.options.iframePanel&&(b.iframePanel.position(c.position),b.iframePanel.position(e.size)),b._unblockFrames(),b._trigger("onResizeStop",d,a(e))}}).css("position",e)},_trackFocus:function(){this._on(this.component(),{focusin:function(a){this._makeFocusTarget(),this._focusedElement=$(a.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var a=this._trackingInstances(),b=$.inArray(this,a);-1!==b&&a.splice(b,1)},_trackingInstances:function(){var a=this.document.data("coral-dialog-instances");return a||(a=[],this.document.data("coral-dialog-instances",a)),a},_minHeight:function(){var a=this.options;return"auto"===a.height?a.minHeight:Math.min(a.minHeight,a.height)},_position:function(){var a,b,c=this.options.position,d=[0,0],e=[];c?(("string"==typeof c||"object"==typeof c&&"0"in c)&&(e=c.split?c.split(" "):[c[0],c[1]],1===e.length&&(e[1]=e[0]),$.each(["left","top"],function(a,b){+e[a]===e[a]&&(d[a]=e[a],e[a]=b)}),c={my:e[0]+(d[0]<0?d[0]:"+"+d[0])+" "+e[1]+(d[1]<0?d[1]:"+"+d[1]),at:e.join(" ")}),c=$.extend({},$.coral.dialog.prototype.options.position,c)):c=$.coral.dialog.prototype.options.position,b=this.uiDialog.is(":visible"),b||this.uiDialog.show(),this.options.iframePanel&&(a=this.iframePanel.is(":visible"),a||this.iframePanel.show()),this.options.queue?$("#coral-msgBox").position(c):(this.uiDialog.position(c),this.options.iframePanel&&this.iframePanel.position(c)),b||this.uiDialog.hide(),this.options.iframePanel&&(a||this.iframePanel.hide())},_setOptions:function(c){var d=this,e=!1,f={};$.each(c,function(c,g){d._setOption(c,g),c in a&&(e=!0),c in b&&(f[c]=g)}),e&&!$(d.element).is(":hidden")&&(this._size(),d.animate||this._position()),this.uiDialog.is(":data(coral-resizable)")&&this.uiDialog.resizable("option",f)},_setOption:function(a,b){var c,d,e=this.uiDialog;"dialogClass"===a&&e.removeClass(this.options.dialogClass).addClass(b),"disabled"!==a&&(this._super(a,b),"appendTo"===a&&this.uiDialog.appendTo(this._appendTo()),"buttons"===a&&this._createButtons(),"maximumText"===a&&this.uiDialogTitlebarMaximum.button({label:""+b}),"closeText"===a&&this.uiDialogTitlebarClose.button({label:""+b}),"draggable"===a&&(c=e.is(":data(coral-draggable)"),c&&!b&&(e.draggable("destroy"),this.options.iframePanel&&this.iframePanel.draggable("destroy")),!c&&b&&this._makeDraggable()),"position"===a&&this._position(),"resizable"===a&&(d=e.is(":data(coral-resizable)"),d&&!b&&(e.resizable("destroy"),this.options.iframePanel&&this.iframePanel.resizable("destroy")),d&&"string"==typeof b&&e.resizable("option","handles",b),d||b===!1||this._makeResizable()),"title"===a&&this._title(this.uiDialogTitlebar.find(".coral-dialog-title")),"subTitle"===a&&this._subTitle(this.uiDialogTitlebar.find(".coral-dialog-subTitle")),"width"!==a&&"height"!==a||(this._resetMaximizeIcon(),this.uiDialog.removeClass("coral-dialog-maximum")))},_size:function(){var a,b,c,d=this.options;if(this.element.hide().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),d.minWidth>d.width&&(d.width=d.minWidth),a=this.uiDialog.css({height:"auto",width:d.width}).outerHeight(),this.element.show(),b=Math.max(0,d.minHeight-a),c="number"==typeof d.maxHeight?Math.max(0,d.maxHeight-a):"none","auto"===d.height)this.element.css({minHeight:b,maxHeight:c,height:"auto"});else{var e=/^(\d|[1-9]\d|100)%$/;e.test(this.options.height)?(this.options.percent=this.options.height,this.element.height(Math.max(0,this._percentToPx()-a))):this.element.height(Math.max(0,this.options.height-a))}this.uiDialog.is(":data(coral-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight()),this.options.iframePanel&&this.iframePanel.css({width:this.uiDialog.outerWidth(),height:this.uiDialog.outerHeight()})},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var a=$(this);return $("<div>").css({position:"absolute",width:a.outerWidth(),height:a.outerHeight()}).appendTo(a.parent()).offset(a.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(a){return $(a.target).closest(".coral-dialog").length?!0:!!$(a.target).closest(".coral-datepicker").length},_createOverlay:function(){if(this.options.modal){var a=!0;this._delay(function(){a=!1}),this.document.data("coral-dialog-overlays")||this._on(this.document,{focusin:function(b){if(!a&&!this._allowInteraction(b)){b.preventDefault();var c=this.document.find(".coral-dialog:visible:last .coral-dialog-content").data(this.componentFullName);c&&c._focusTabbable}}}),this.overlay=$("<div>").addClass("coral-component-overlay coral-front").appendTo(this._appendTo()),"parent"==this.options.appendTo?this.overlay.css({position:"relative"}):"body"!=$(this.options.appendTo)[0].tagName.toLowerCase()&&this.overlay.css({position:"relative"}),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("coral-dialog-overlays",(this.document.data("coral-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var a=this.document.data("coral-dialog-overlays")-1;a?this.document.data("coral-dialog-overlays",a):this.document.unbind("focusin").removeData("coral-dialog-overlays"),this.overlay.remove(),this.overlay=null}},buttonPanel:function(){return this.uiButtonSet},hide:function(){this._isOpen=!1,this.component().hide()},_percentToPx:function(){var a=this.options,b=a.percent,c=$(window);return maxHeight=c.height()*parseInt(b.substring(0,b.length-1))/100,maxHeight},refresh:function(){var a=this,b=this.options,c=b.percent,d=/^(\d|[1-9]\d|100)%$/;d.test(c)&&!b.manualResize&&(maxHeight=a._percentToPx(),b.height=maxHeight,setTimeout(function(){$(a.element).dialog("option","height",maxHeight)},0))}})}();/*! cui 2016-11-08 */
$.messager={loading:{show:function(a){!a instanceof jQuery&&(a=$(a));var b=a.attr("data-loading-id");b||(b=(new Date).getTime(),a.attr("data-loading-id","loading_"+b));var c=$("<div id='loading_"+b+"' class='coral-loading'><div class='coral-loading-zone'></div><span class='coral-loading-text'>加载中，请稍后...</span></div>"),d=c.find(".coral-loading-zone"),e=c.find(".coral-loading-text");c.outerWidth(a.outerWidth()),c.outerHeight(a.outerHeight()),d.outerWidth(a.outerWidth()),d.outerHeight(a.outerHeight()),c.position({my:"left top",at:"left top",of:a}),$(document.body).append(c);var f=(c.outerWidth()-e.outerWidth())/2;e.css({left:f})},hide:function(a){!a instanceof jQuery&&(a=$(a));var b=a.attr("data-loading-id");b&&($("#"+b).remove(),a.removeAttr("data-loading-id"))}},_isType:function(a){var b,c="",d="",e=a.iconCls,f=$.inArray(a.cls,["info","success","warning","error","question","danger","alert"]);a.cls&&f>-1&&(a.type=a.cls),a.type||(a.type="info");var g={warning:"cui-icon-warning2",danger:"cui-icon-cancel-circle2",error:"cui-icon-cancel-circle2",success:"cui-icon-checkmark4",alert:"cui-icon-notification2",info:"cui-icon-notification2",confirm:"cui-icon-question4"};return"alert"==a.type?(d="coral-control-info ",b=g.alert):"success"==a.type?(d="coral-control-success ",b=g.success):"danger"==a.type?(d="coral-control-danger ",b=g.danger):"info"==a.type?(d="coral-control-info ",b=g.info):"confirm"==a.type?(d="coral-control-question ",b=g.confirm):"warning"==a.type&&(d="coral-control-warning ",b=g.warning),"boolean"==typeof e&&(c=e===!0?c="<span class='icon-control "+d+b+"'></span>":""),"string"==typeof e&&(c="<span class='icon-control "+d+a.iconCls+"'></span>"),c},_init:function(a,b){b.maximizable=!1,b.queue===!0&&($("#coral-msgBox").length||$("<div id='coral-msgBox' class='queueMessage'style='z-index:9999999999'></div>").appendTo("body"),b.appendTo="#coral-msgBox");var c="",d=b.iconCls;if("messageBox"==b.wtype)a=$("<div class='coral-messagerBox'>"+(b.iconCls||"")+"<span class='coral-messagerBox-content'>"+b.message+"</span></div>").appendTo("body");else if("message"==b.wtype){c=this._isType(b);var e=d===!1?"":"hasIcon ";a=$("<div class='"+e+b.type+"' role='alert'>"+c+"<span class='coral-alert-content'>"+b.message+"</span></div>").appendTo("body")}else"progress"==b.wtype?(c=this._isType(b),a=$("<div class='coral-messager-body coral-messager-progress'>"+c+"<span class='coral-messager-content'>"+b.message+"</span><div class='coralui-progressbar'></div></div>").appendTo("body")):"undefined"!=typeof b.message&&"message"!=b.wtype&&(c=this._isType(b),a=$("<div class='coral-messager-body'><span class='coral-messager-box'><span class='hasIcon coral-messager-box-content'>"+c+"<span class='coral-messager-content'>"+b.message+"</span></span></span></div>").appendTo("body"));return a},message:function(a,b,c){"string"!=typeof a&&"boolean"!=typeof a&&"number"!=typeof a||(a={message:a.toString(),wtype:"message"}),c||"function"!=typeof b||(c=b,b="info"),(!b||$.inArray(b,["info","success","warning","error","question","danger","alert"])<0)&&(b="info"),"error"==b&&(b="danger"),a=a||{},a=$.extend(!0,{autoOpen:!0,title:"消息提示",isMessage:!0,show:"slideDown",hide:"slideUp",modal:!1,queue:!1,onClose:c,draggable:!1,resizable:!1,width:"auto",maxWidth:600,maxHeight:600,wtype:"message",type:b,iconCls:!0,timeOut:2999},$.message.defaults,$.messageQueue.defaults,a);var d=$.messager._init(d,a);d.css("max-width",a.maxWidth+"px"),d.dialog(a),"message"===a.wtype&&($.messager.messageInstances++,$.messager.messageHeights.push(d.outerHeight()))},messageBox:function(a,b){"string"!=typeof a&&"boolean"!=typeof a&&"number"!=typeof a||(a={message:a.toString(),wtype:"messageBox"}),a=a||{},a=$.extend(!0,{autoOpen:!0,title:"消息提示",show:"slideDown",hide:"slideUp",isMessage:!0,modal:!1,draggable:!1,resizable:!1,width:200,wtype:"messageBox",timeOut:2999},$.messageBox.defaults,a);var c=$.messager._init(c,a);return c.dialog(a),c},messageQueue:function(a,b,c){var d="信息提示",e={};"string"!=typeof a&&(e=a||"",e.queue=!0,c=e.callback,b=e.title||d),"function"==typeof b&&(c=b,b=d),void 0===b&&(b=d),e=$.extend(!0,{iconCls:!0,queue:!0,message:a.toString(),title:b.toString()},$.messageQueue.defaults,e),$.messager.message(e),e.wtype="message"},messageToast:function(a,b,c){var d="信息提示",e={};"string"!=typeof a&&(e=a||"",c=e.callback,b=e.title||d),"function"==typeof b&&(c=b,b=d),void 0===b&&(b=d),e=$.extend(!0,{autoOpen:!0,modal:!1,show:"slideDown",hide:"slideUp",message:a.toString(),title:b.toString(),isMessage:!0,draggable:!1,resizable:!1,iconCls:!0,width:"auto",wtype:"message",timeOut:2999},$.messageToast.defaults,e),e.wtype="message";var f=$.messager._init(f,e);return f.dialog(e),f},alert:function(a,b,c){var d="信息提示",e={};"string"!=typeof a&&(e=a||"",c=e.callback,b=e.title||d),"function"==typeof b&&(c=b,b=d),void 0===b&&(b=d),e=$.extend(!0,{modal:!0,message:a.toString(),timeOut:0,title:b.toString(),isMessage:!0,width:400,maxHeight:600,icons:"cui-icon-warning2",iconCls:!0,wtype:"alert"},$.alert.defaults,e),(e.timeOut<=0||isNaN(e.timeOut))&&!e.buttons&&(e.buttons={"确定":function(){return $(this).dialog("close"),"function"==typeof c&&c(!0),!0}}),e.wtype="alert",e.type="alert";var f=$.messager._init(f,e);return f.dialog(e),f},danger:function(a,b,c){var d="错误提示",e={};"string"!=typeof a&&(e=a||"",c=e.callback,b=e.title||d),"function"==typeof b&&(c=b,b=d),void 0===b&&(b=d),e=$.extend(!0,{modal:!0,message:a.toString(),timeOut:0,title:b.toString(),isMessage:!0,width:400,maxHeight:600,iconCls:!0,icons:"cui-icon-cancel-circle2",wtype:"danger"},$.danger.defaults,e),(e.timeOut<=0||isNaN(e.timeOut))&&!e.buttons&&(e.buttons={"确定":function(){return $(this).dialog("close"),"function"==typeof c&&c(!0),!0}}),e.wtype="danger",e.type="danger";var f=$.messager._init(f,e);return f.dialog(e),f},success:function(a,b,c){var d="Success",e={};"string"!=typeof a&&(e=a||"",c=e.callback,b=e.title||d),"function"==typeof b&&(c=b,b=d),void 0===b&&(b=d),e=$.extend(!0,{modal:!0,message:a.toString(),timeOut:0,title:b.toString(),isMessage:!0,width:400,maxHeight:600,iconCls:!0,icons:"cui-icon-checkmark4",wtype:"success"},$.success.defaults,e),(e.timeOut<=0||isNaN(e.timeOut))&&!e.buttons&&(e.buttons={"确定":function(){return $(this).dialog("close"),"function"==typeof c&&c(!0),!0}}),e.wtype="success",e.type="success";var f=$.messager._init(f,e);return f.dialog(e),f},confirm:function(a,b,c){var d="确定",e="取消",f={},g={},h="信息提示";"string"!=typeof a&&(g=a||"",c=g.callback,b=g.title||h,d=g.okText?g.okText:d,e=g.cancelText?g.cancelText:e),"function"==typeof b&&(c=b,b=h),void 0===b&&(b=h),g=$.extend(!0,{autoOpen:!0,title:"确认提示",message:a.toString(),title:b.toString(),iconCls:!0,isMessage:!0,width:400,maxHeight:600,show:"slideDown",modal:!0,icons:"cui-icon-question4",buttons:f},$.confirm.defaults,g),f[d]=function(){return $(this).dialog("close"),"function"==typeof c&&c(!0),!1},f[e]=function(){return $(this).dialog("close"),"function"==typeof c&&c(!1),!1},g.type="confirm",g.wtype="confirm";var i=$.messager._init(i,g);return i.dialog(g),i},progress:function(a,b,c){if("close"===a){$(".coral-messager-progress").dialog("close");var d=$(".coral-messager-progress").dialog("destroy");return void d.remove()}if("progressbar"===a)return $(".coral-messager-progress .ctrl-init-progressbar");var e="确定",f="取消",g={},h={},i="进度提示";"string"!=typeof a&&(h=a||"",c=h.callback,b=h.title||i,e=h.okText?h.okText:e,f=h.cancelText?h.cancelText:f),"function"==typeof b&&(c=b,b=i),void 0===b&&(b=i),h=$.extend(!0,{autoOpen:!0,message:a.toString(),title:b.toString(),iconCls:!0,isMessage:!1,width:400,maxHeight:600,show:"slideDown",modal:!0,icons:"cui-icon-question4"},$.confirm.defaults,h),g[e]=function(){return $(this).dialog("close"),"function"==typeof c&&c(!0),!1},g[f]=function(){return $(this).dialog("close"),"function"==typeof c&&c(!1),!1},h.type="progress",h.wtype="progress";var j=$.messager._init(j,h);return j.dialog(h),$.parser.parse(j),j}},$.messager.messageInstances=0,$.messager.messageHeights=[],$.message=$.messager.message,$.messageQueue=$.messager.messageQueue,$.messageBox=$.messager.messageBox,$.messageToast=$.messager.messageToast,$.alert=$.messager.alert,$.danger=$.messager.danger,$.success=$.messager.success,$.confirm=$.messager.confirm,$.progress=$.messager.progress,$.message.defaults={position:{my:"top",at:"top top+50",of:window}},$.messageQueue.defaults={position:{my:"top",at:"top top+50",of:window}},$.messageBox.defaults={position:{my:"right bottom",at:"right bottom",of:window}},$.messageToast.defaults={position:{my:"top",at:"top top+50",of:window}},$.alert.defaults={position:{my:"center",at:"center top+200",of:window}},$.danger.defaults={position:{my:"center",at:"center top+200",of:window}},$.success.defaults={position:{my:"center",at:"center top+200",of:window}},$.confirm.defaults={position:{my:"center",at:"center top+200",of:window}};/*! cui 2016-11-08 */
$.component("coral.form",{version:"4.0.2",options:{disabled:null,ajaxSubmit:!0,novalidate:!1,context:"",separator:",",container:"tooltip",requires:null,excluded:[":disabled",":hidden",":not(:visible)"],errTipsType:"first",onCreate:null,url:"",postData:{},target:"",focusFirst:!1,showRequiredMark:null,hideRequiredMark:null,onChange:null,triggers:{},exclude:!1},_create:function(){this._initElement(),this._bindEvents(),$.data(this.element,"modifiedData",{}),$.data(this.element,"originalData",this._getForm()),this.element.validate({excluded:this.options.excluded,errorMode:this.options.errorMode,showRequiredMark:this.options.showRequiredMark,hideRequiredMark:this.options.hideRequiredMark}),this.options.focusFirst&&this._focusFirst(),this.element.append($("<input type='text' style='display:none;'></input>"))},_getFields:function(){return this.element.find(".ctrl-form-element")},_getFieldType:function(a){var b=$(a)[0].className.split(" "),c="";for(var d in b)if(b[d].indexOf("coral-validation-")>=0)return c=b[d].substr(b[d].indexOf("coral-validation-")+17);return null},_bindEvents:function(){var a=this,b=(this.options,this._getFields());b.each(function(b,c){var d=$(c),e=a._getFieldType(d);d.off(".formonchange").on(e+"onchange.formonchange",function(b,c){if(-1!=b.type.indexOf("onchange")){var d=$(this)[e]("option","name"),f=$(this)[e]("getValue"),g={};g[d]=f,a.updateCoralData(g),a._trigger("onChange",null,{field:this,type:e})}})})},_initElement:function(){var a=this.options;this.element.addClass(a.cls),this.element.appendTo(this.uiBorder),this.element.addClass("coral-form-default"),""!==a.id&&this.element.attr("id",a.id),""!==a.name&&this.element.attr("name",a.name),""!==a.action&&this.element.attr("action",a.action),""!==a.method&&this.element.attr("method",a.method),""!==a.target&&this.element.attr("target",a.target),""!=a.context?this.element.attr("context",a.context):this.element.attr("context","body")},initRequires:function(){this._initRequires()},_initRequires:function(){var a=this.element.find($("[class*='coral-validation-']")).parent(":visible").find($("[class*='coral-validation-']"));a.each(function(){var a=this.className,b="",c=a.split(" ");for(var d in c)if(c[d].indexOf("coral-validation-")>=0){b=c[d].substr(c[d].indexOf("coral-validation-")+17);break}var e=$(this)[b]("option","required");"boolean"==typeof e&&e&&("datepicker"==b?$(this)[b]("component",$(this)).parent("td").prev().addClass("require"):$(this)[b]("component").parent("td").prev().addClass("require"))})},_getCoralType:function(a){var b=$(a)[0].className.split(" "),c="";for(var d in b)if(b[d].indexOf("coral-validation-")>=0)return c=b[d].substr(b[d].indexOf("coral-validation-")+17)},showRequire:function(a){var b=$(a),c=this._getCoralType(a);b[c]("component").parent("td").prev().addClass("require")},hideRequire:function(a){var b=$(a),c=this._getCoralType(a);b[c]("component").parent("td").prev().removeClass("require")},_setOption:function(a,b){"id"!=a&&"name"!=a&&this._super(a,b)},saveOriginalCoralData:function(a){var b=this;$.each(a,function(a,c){b._updateCoralData("original",a,c)})},updateCoralData:function(a){var b=this;$.each(a,function(a,c){b._updateCoralData("modified",a,c)})},_updateCoralData:function(a,b,c){var d=$.data(this.element,a+"Data");d[b]=c,$.data(this.element,a+"Data",d)},serialize:function(){return $(this.element).serialize()},serializeArray:function(){return $(this.element).serializeArray()},modifiedData:function(a){return"boolean"==typeof a&&a?this._getSerialize("modified"):$.data(this.element,"modifiedData")},originalData:function(a){return"boolean"==typeof a&&a?this._getSerialize("original"):$.data(this.element,"originalData")},formData:function(){return this._getForm()},getData:function(){return this.formData()},_getSerialize:function(a){var b=$.data(this.element,a+"Data"),c="";return $.each(b,function(a,b){if("Object"!=typeof b)c+=a+"="+b+"&";else for(var d in b)c+=a+"="+b[d]+"&"}),c.substr(0,c.length-1)},_getForm:function(){var a=this,b={},c={},d=$(this.element).serializeArray();return $(this.element).find(".ctrl-form-element").each(function(){var c=$(this).attr("component-role"),d=$(this)[c]("option","name");d&&("checkbox"!==c&&"radio"!==c&&b[d]?b[d]=b[d]+a.options.separator+$(this)[c]("getValue"):b[d]=$(this)[c]("getValue"))}),$(d).each(function(d,e){e.name&&"undefined"==typeof b[e.name]&&(c[e.name]?c[e.name]=c[e.name]+a.options.separator+e.value:c[e.name]=e.value)}),$.extend(b,c),b},_loadData:function(a){var b=this;this._updateData(a,"modified"),this._updateData(a,"original"),"object"==typeof a&&$.each(a,function(a,c){b._loadCoralData(a,c)||b._loadNormalData(a,c)})},_loadCoralData:function(a,b){var c=this;b=null==b?"":b;var d=c._getCoralFormData(),e=!1;for(var f in d){var g=d[f],h=g.coralType;switch(h){case"radio":a==g.name&&(e=!0,g.el[h]("option","value")==b&&null!=b?g.el[h]("check"):g.el[h]("uncheck"));break;case"radiolist":a==g.name&&(e=!0,null==b&&(b=""),g.el[h]("setValue",b));break;case"checkbox":if(a==g.name){e=!0,null==b&&(b=[""]),"object"!=typeof b&&(b="string"==typeof b?b.split(c.options.separator):[b]);for(var i in b){if(g.el[h]("option","value")==b[i]){g.el[h]("check");break}g.el[h]("uncheck")}}break;case"checkboxlist":a==g.name&&(e=!0,a==g.name&&(null==b&&(b=""),g.el[h]("setValue",b)));break;case"combobox":case"combotree":case"combogrid":a==g.name&&(e=!0,"object"!=typeof b&&(b="string"==typeof b?b.split(c.options.separator):[b]),null!=b&&g.el[h]("setValues",b));break;case"datepicker":a==g.name&&(e=!0,null!=b&&g.el[h]("option","value",b));break;case"autocomplete":case"autocompletetree":a==g.name&&(e=!0,null!=b&&g.el[h]("option","value",b));break;default:a==g.name&&(e=!0,null!=b&&g.el[h]("option","value",b))}}return e},_loadNormalData:function(a,b){var c=this,d=c._getNomalFormElements();for(var e in d)if(a==d[e].attr("name"))if(void 0!=d[e].attr("type")&&"radio"==d[e].attr("type")){if(b!=d[e].attr("value"))continue;d[e][0].checked=!0}else"string"==typeof b&&-1!=b.indexOf(c.options.separator)&&(b=b.split(c.options.separator)),$(c.element.find("[name="+a+"]")).val(b)},_getAllFromElements:function(){return this.element.find("[name]")},_getCoralFormData:function(){var a=[];return this.element.find(".ctrl-form-element").each(function(){var b=$(this),c=null,d=b.attr("component-role");c=b[d]("option","name"),null!=c&&a.push({el:b,name:c,coralType:d})}),a},_getCoralFormElements:function(){return this.element.find(".coral-form-element")},_getCoralNameJson:function(){var a=this,b={};return a._getCoralFormElements().each(function(){var a=$(this).attr("component-role");$(this)[a]("option","name")&&(b[name]=a)}),b},_getNomalFormElements:function(){var a=this,b=[],c=a._getCoralNameJson();return a._getAllFromElements().each(function(){c[$(this).attr("name")]||b.push($(this))}),b},_updateData:function(a,b){var c=$.data(this.element,b+"Data");"object"==typeof a&&$.each(a,function(a,d){"original"==b&&"undefined"!=typeof c[a]?c[a]=d:"modified"==b&&"undefined"!=typeof c[a]&&delete c[a]})},resetData:function(){this.reset()},getErrors:function(){var a=this.component().find(".coral-validate-error"),b=[];return a.each(function(){var a=$(this).find(".ctrl-form-element"),c=$(a).attr("component-role"),d={};d.errorText=$(this).find(".coral-errorIcon").attr("data-errors"),d.required=$(a)[c]("option","required"),d.id=$(a)[c]("option","id"),d.validType=$(a)[c]("option","validType"),d.value=$(a)[c]("getValue"),d.element=a[0],d.requiredMsg=$(a)[c]("option","requiredMsg")||$.validate.options.requiredMsg,d.name=$(a)[c]("option","name"),b.push(d)}),b},reset:function(){$(this.element).find(".ctrl-form-element").each(function(a){var b=$(this).attr("component-role");$(this)[b]("reset")}),$.data(this.element,"modifiedData",{})},_isExclud:function(a,b){if(!b)return!1;for(var c=b.length,d=0;c>d;d++)if("string"==typeof b[d]&&a.is(b[d]))return!0;return!1},clear:function(a){var b={};if(a&&a.excluded&&a.excluded instanceof Array)for(var c in a.excluded){var d=a.excluded[c];b[d]=d}$(this.element).find(".ctrl-form-element").each(function(a){var c=$(this).attr("component-role");if(!($(this)[c]("option","readonly")&&b.readonly||$(this)[c]("option","isLabel")&&b.isLabel||$(this)[c]("option","disabled")&&b.disabled))switch(c){case"radio":case"checkbox":$(this)[c]("uncheck");break;default:$(this)[c]("setValue","")}}),$.validate.clearErrors(this.element),$.data(this.element,"modifiedData",{})},load:function(a){var b=this,c={},d=[],e=!1;"undefined"!=typeof a&&("string"!=typeof a?(c=a,c.data?d=c.data:c.url?(a=c.url,e=!0):d=a):e=!0,e?$.ajax({url:a,type:"POST",data:$.extend(!0,{},this.options.postData,c.postData),async:!1,dataType:"json",success:function(a){b._loadData(a),b._trigger($.isFunction(c.onLoad)?c.onLoad:"onLoad",null,[a])},error:function(){b._trigger("onLoadError",null,[])}}):(this._loadData(d),this._trigger($.isFunction(c.onLoad)?c.onLoad:"onLoad",null,[{content:d}])))},loadData:function(a){this.load(a)},submit:function(a){if(a=a||{},0==this._trigger($.isFunction(a.onSubmit)?a.onSubmit:"onSubmit",null,[]))return!1;if(this.options.ajaxSubmit)$.ajax({type:"post",url:$.extend(!0,{},this.options.url,a.url),data:$.extend(!0,{},this.options.postData,a.postData,this.formData),dataType:"json",success:function(b){this._trigger($.isFunction(a.onSuccess)?a.onSuccess:"onSuccess",null,[{content:b}])},error:function(){}});else{if(!this.valid())return!1;this.element.submit()}},valid:function(){return this.options.novalidate?!0:this.element.validate("valid")},hideErrorTips:function(){$("div.coral-validate-state-error").remove()},_focusFirst:function(){},findFields:function(){return $.coral.findComponent(".ctrl-form-element",this.element)},setIsLabel:function(a){$.coral.setIsLabel(a,this.element)},setReadOnly:function(a){$.coral.setReadOnly(a,this.element)},refresh:function(a){var b,c=this.options,d=c.heightStyle,e=this.component().parent();"fill"===d?($.coral.fitParent(this.component(),!0),b=e.height(),this.component().siblings(":visible").each(function(){var a=$(this),c=a.css("position");"absolute"!==c&&"fixed"!==c&&(b-=a.outerHeight(!0))}),this.element.height(Math.max(0,b-this.element.innerHeight()+this.element.height())).addClass("coral-scroll")):"auto"===d&&this.element.height(""),$.coral.refreshChild(this.element)}});/*! cui 2016-11-08 */
$.component("coral.tabs",{version:"4.0.1",delay:300,options:{active:0,collapsible:!1,event:"click",loadonce:!0,renderPanelOnActivate:!1,destroyAllonActive:!1,heightStyle:"content",hide:null,show:null,loadtext:"加载中，请耐心等候...",method:"GET",newbtn:!1,name:null,onTabNew:null,onActivate:null,onLoad:null,beforeActivate:null,beforeLoad:null,beforeTabClose:null,onTabClose:null},_create:function(){var a=this,b=this.options;null!=b.method&&""!=b.method?b.method=(b.method+"").toUpperCase():b.method="GET",this.running=!1,this.element.addClass("coral-tabs ctrl-init ctrl-init-tabs coral-component coral-component-content coral-corner-all").toggleClass("coral-tabs-collapsible",b.collapsible),this._processTabs(),"boolean"==typeof b.newbtn&&b.newbtn&&this.addnewbtn(),b.active=this._initialActive(),$.isArray(b.disabled)&&(b.disabled=$.unique(b.disabled.concat($.map(this.tabs.filter(".coral-state-disabled"),function(b){return a.tabs.index(b)}))).sort()),this.options.active!==!1&&this.anchors.length?this.active=this._findActive(b.active):this.active=$(),this._refresh(),this.active.length&&this.load(b.active),this.element.hasClass("coral-tabs-bottom")?$(".coral-tabs-bottom .coral-tabs-nav, .coral-tabs-bottom .coral-tabs-nav > *").removeClass("coral-corner-all coral-corner-top").addClass("coral-corner-bottom"):this.element.hasClass("coral-tabs-right")?this.element.addClass("coral-tabs-right coral-helper-clearfix").removeClass("coral-corner-top").addClass("coral-corner-left"):this.element.hasClass("coral-tabs-left")&&this.element.removeClass("coral-corner-top").addClass("coral-tabs-left coral-helper-clearfix coral-corner-left")},_isLocal:function(){return function(a){return a=a.cloneNode(!1),a.hash.length>1&&-1!=a.href.indexOf("#")}}(),_initialActive:function(){var a=this.options.active,b=this.options.collapsible,c=location.hash.substring(1);return null===a&&(c&&this.tabs.each(function(b,d){return $(d).attr("aria-controls")===c?(a=b,!1):void 0}),null===a&&(a=this.tabs.index(this.tabs.filter(".coral-state-active"))),null!==a&&-1!==a||(a=this.tabs.length?0:!1)),a!==!1&&(a=this.tabs.index(this.tabs.eq(a)),-1===a&&(a=b?!1:0)),!b&&a===!1&&this.anchors.length&&(a=0),a},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):$()}},_tabKeydown:function(a){var b=$(this.document[0].activeElement).closest("li"),c=this.tabs.index(b),d=!0;if(!this._handlePageNav(a)){switch(a.keyCode){case $.coral.keyCode.RIGHT:case $.coral.keyCode.DOWN:c++;break;case $.coral.keyCode.UP:case $.coral.keyCode.LEFT:d=!1,c--;break;case $.coral.keyCode.END:c=this.anchors.length-1;break;case $.coral.keyCode.HOME:c=0;break;case $.coral.keyCode.SPACE:return a.preventDefault(),clearTimeout(this.activating),void this._activate(c);case $.coral.keyCode.ENTER:return a.preventDefault(),clearTimeout(this.activating),void this._activate(c===this.options.active?!1:c);default:return}a.preventDefault(),clearTimeout(this.activating),c=this._focusNextTab(c,d),a.ctrlKey||(b.attr("aria-selected","false"),this.tabs.eq(c).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",c)},this.delay))}},_panelKeydown:function(a){this._handlePageNav(a)||a.ctrlKey&&a.keyCode===$.coral.keyCode.UP&&(a.preventDefault(),this.active.focus())},_handlePageNav:function(a){return a.altKey&&a.keyCode===$.coral.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):a.altKey&&a.keyCode===$.coral.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(a,b){function c(){return a>d&&(a=0),0>a&&(a=d),a}for(var d=this.tabs.length-1;-1!==$.inArray(c(),this.options.disabled);)a=b?a+1:a-1;return a},_focusNextTab:function(a,b){return a=this._findNextTab(a,b),this.tabs.eq(a).focus(),a},_setOption:function(a,b){return"active"===a?void("string"==typeof b?this._activate(this._getIndex(b)):this._activate(b)):"disabled"===a?void this._setupDisabled(b):(this._super(a,b),"collapsible"===a&&(this.element.toggleClass("coral-tabs-collapsible",b),b||this.options.active!==!1||this._activate(0)),"event"===a&&this._setupEvents(b),void("heightStyle"===a&&this._setupHeightStyle(b)))},_tabId:function(a){return a.attr("aria-controls")||"coral-tabs-"+getNextTabId()},_sanitizeSelector:function(a){return a?a.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var a=this.options,b=this.tablist.children(":has(a[href])");a.disabled=$.map(b.filter(".coral-state-disabled"),function(a){return b.index(a)}),this._processTabs(),a.active!==!1&&this.anchors.length?this.active.length&&!$.contains(this.tablist[0],this.active[0])?this.tabs.length===a.disabled.length?(a.active=!1,this.active=$()):this._activate(this._findNextTab(Math.max(0,a.active-1),!1)):a.active=this.tabs.index(this.active):(a.active=!1,this.active=$()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.addClass("coral-tabs-active coral-state-active").attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"}).attr({"data-render":""})):this.tabs.eq(0).attr("tabIndex",0),this._setupHeightStyle(this.options.heightStyle)},add:function(a){a=a||{};var b=this.options.disabled,c=null,d=a.tabId,e=null,f=a.label,g=a.ariaControls,h=!1,i=a.href,j=void 0==a.closeable?!1:a.closeable,k=j===!0?"<span class='coral-closable cui-icon-cross2'></span>":"",l=a.content;if(b!==!0){"boolean"==typeof this.options.newbtn&&this.options.newbtn&&this.tablist.find("> li:last").remove(),g?c=g:"undefined"==typeof i?c=$({}).uniqueId()[0].id:(c=i,0==c.indexOf("#")?c=c.substr(1):h=!0),d=d?"id="+d:"";var m="<li "+d+"><a href='#{href}'>"+f+"</a>{closespan}</li>";if(m=m.replace(/\{closespan\}/g,k),h)return e=$(m.replace(/#\{href\}/g,c)),this.component().find(">.coral-tabs-nav").append(e),void this.component().tabs("refresh");e=$(m.replace(/#\{href\}/g,"#"+c)),g&&e.attr("aria-controls",g),this.component().find(">.coral-tabs-nav").append(e),this.element.hasClass("coral-tabs-bottom")?this.component().find(">.coral-tabs-nav").before("<div id='"+c+"'>"+l+"</div>"):this.component().append("<div id='"+c+"'>"+l+"</div>"),"boolean"==typeof this.options.newbtn&&this.options.newbtn&&this.addnewbtn(),this.refresh()}},remove:function(a){if(!this.options.disabled){if(a instanceof Array)for(var b in a)this._remove(a[b]);else this._remove(a);this.refresh()}},_remove:function(a){var b;b="undefined"==typeof a?this.options.active:"string"==typeof a?this.getIndexById(a):a;var c=this._getList().find("> li:has(a[href])").eq(b).attr("aria-controls");this.component().find("li[aria-controls='"+c+"']").remove(),this.component().find("div#"+c).remove()},addnewbtn:function(){var a=this,b=$("<li class='coral-tabs-newbtn coral-corner-top'><a class='coral-tabs-anchor'><span class='cui-icon-plus-circle2'></span></a></li>");b.unbind("click").bind("click",function(b){!0!==a.options.disabled&&a._trigger("onTabNew",null,[])}),this.tablist.append(b),a._hoverable(b)},_processTabs:function(){var a=this;this.tablist=this._getList().addClass("coral-tabs-nav coral-helper-reset coral-helper-clearfix coral-component-header coral-corner-all").attr("role","tablist").delegate("> li","mousedown"+this.eventNamespace,function(a){$(this).is(".coral-state-disabled")&&a.preventDefault()}).delegate(".coral-tabs-anchor","focus"+this.eventNamespace,function(){$(this).closest("li").is(".coral-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").addClass("coral-state-default coral-corner-top").attr({role:"tab",tabIndex:-1}),this.tabs=this.tabs.filter(function(){if(0==$(this).data("authority")){$(this).remove();var a=$(this).find(">a").attr("href");return"#"==a.slice(0,1)&&$("body").find(a).remove(),!1}return!0}),this.anchors=this.tabs.map(function(){return $("a",this)[0]}).addClass("coral-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=$(),this.anchors.each(function(b,c){var d,e,f,g=$(c).uniqueId().attr("id"),h=$(c).closest("li"),i=h.attr("aria-controls");h.find(".coral-closable").addClass("cui-icon-cross2"),a._isLocal(c)?(d=c.hash,f=d.substring(1),e=a.element.find(a._sanitizeSelector(d)),a.options.renderPanelOnActivate&&e.attr("data-render","false")):(f=h.attr("aria-controls")||$({}).uniqueId()[0].id,d="#"+f,e=a.element.find(d),e.length||(e=a._createPanel(f),a.element.hasClass("coral-tabs-bottom")?e.insertBefore(a.panels[b-1]||a.tablist):e.insertAfter(a.panels[b-1]||a.tablist)),e.attr("aria-live","polite")),e.length&&(a.panels=a.panels.add(e)),i&&h.data("coral-tabs-aria-controls",i),h.attr({"aria-controls":f,"aria-labelledby":g}),e.attr("aria-labelledby",g)}),this.panels.addClass("coral-tabs-panel coral-component-content coral-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.tablist||this.element.find(">ol,>ul").eq(0)},_createPanel:function(a){return $("<div>").attr("id",a).addClass("coral-tabs-panel coral-component-content coral-corner-bottom").data("coral-tabs-destroy",!0)},_setupDisabled:function(a){$.isArray(a)&&(a.length?a.length===this.anchors.length&&(a=!0):a=!1);for(var b,c=0;b=this.tabs[c];c++)a===!0||-1!==$.inArray(c,a)?$(b).addClass("coral-state-disabled").attr("aria-disabled","true"):$(b).removeClass("coral-state-disabled").removeAttr("aria-disabled");this.options.disabled=a},_setupEvents:function(a){var b={};a&&$.each(a.split(" "),function(a,c){b[c]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels).add(this.tabs.children("span.cui-icon-cross2"))),this._on(!0,this.anchors,{click:function(a){a.preventDefault()}}),this._on(this.anchors,b),this._on(this.tabs.children("span.coral-closable"),{click:"_tabClose"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._on(this.tabs,{keydown:"_tabKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_tabClose:function(a){var b=this;if(b.options.disabled!==!0){var c=$(a.target),d=c.closest("li"),e=d.attr("aria-controls"),f=b._getPanelForTab(d),g={currentTab:d,currentPanel:f,panelId:e};b._trigger("beforeTabClose",a,g)!==!1&&(d.remove(),b.element.find("#"+e).remove(),b._trigger("onTabClose",a,g),b.refresh())}},_setupHeightStyle:function(a){var b,c,d=!1,e=this.element.parent();if("fill"===a){$.coral.fitParent(this.component(),!0),b=e.height(),c=e.width(),e.addClass("coral-noscroll"),b-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").not("script").each(function(){var a=$(this),c=a.css("position");"absolute"!==c&&"fixed"!==c&&(b-=a.outerHeight())}),this.element.children().not(this.panels).each(function(){if($(this).parent().hasClass("coral-tabs-right")||$(this).parent().hasClass("coral-tabs-left")){var a=$(this).css("position");if(d=!0,"absolute"===a||"fixed"===a)return;return void(c-=$(this).outerWidth(!0))}b-=$(this).outerHeight(!0)});var f,g=this.panels.filter(":visible");if(f=g.outerHeight()-g.innerHeight(),this.panels.each(function(){$(this).height(Math.max(0,b-f-$(this).innerHeight()+$(this).height()))}),d){var h=this.element.children("ul");h.height(Math.max(0,b-h.innerHeight()+h.height()))}}else"auto"===a&&(b=0,this.panels.each(function(){b=Math.max(b,$(this).height("").height()),$(this).width("")}).height(b));this.panels.each(function(){$(this).is(":visible")&&$.coral.refreshAllComponent($(this))})},_eventHandler:function(a){var b=this.options,c=this.active,d=$(a.currentTarget),e=d.closest("li"),f=e[0]===c[0],g=f&&b.collapsible,h=g?$():this._getPanelForTab(e),i=c.length?this._getPanelForTab(c):$(),j={oldTab:c,oldPanel:i,newTab:g?$():e,newPanel:h};a.preventDefault(),e.hasClass("coral-state-disabled")||e.hasClass("coral-tabs-loading")||this.running||f&&!b.collapsible||this._trigger("beforeActivate",a,j)===!1||(b.active=g?!1:this.tabs.index(e),this.active=f?$():e,this.xhr&&this.xhr.abort(),i.length||h.length||$.error("jQuery UI Tabs: Mismatching fragment identifier."),h.length&&this.load(this.tabs.index(e),a),this._toggle(a,j))},_toggle:function(a,b){function c(){e.running=!1,e._trigger("onActivate",a,b),"false"===f.attr("data-render")?coral.render(f):$.coral.refreshAllComponent(f)}function d(){b.newTab.closest("li").addClass("coral-tabs-active coral-state-active"),f.length&&e.options.show?e._show(f,e.options.show,c):(f.show(),c())}var e=this,f=b.newPanel,g=b.oldPanel;this.running=!0,g.length&&this.options.hide?this._hide(g,this.options.hide,function(){b.oldTab.closest("li").removeClass("coral-tabs-active coral-state-active"),d()}):(b.oldTab.closest("li").removeClass("coral-tabs-active coral-state-active"),g.hide(),d()),g.attr("aria-hidden","true"),b.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),f.length&&g.length?b.oldTab.attr("tabIndex",-1):f.length&&this.tabs.filter(function(){return 0===$(this).attr("tabIndex")}).attr("tabIndex",-1),f.attr("aria-hidden","false"),b.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(a){if(-1!=a){var b,c=this._findActive(a);c[0]!==this.active[0]&&(c.length||(c=this.active),b=c.find(".coral-tabs-anchor")[0],this._eventHandler({target:b,currentTarget:b,preventDefault:$.noop}))}},_findActive:function(a){return a===!1?$():this.tabs.eq(a)},_getIndex:function(a){return"string"==typeof a&&(a=this.anchors.index(this.anchors.filter("[href$='"+a+"']"))),a},getIdByIndex:function(a){var b=this.tablist.children("li").filter(function(){return $(this).hasClass("coral-state-default")});return b.eq(a).attr("aria-controls")},getIndexById:function(a){var b=this.tablist.children("li").filter(function(){return $(this).hasClass("coral-state-default")});return b.index(b.filter("[aria-controls$='"+a+"']"))},getIndexByTabId:function(a){var b=this.tablist.children("li").filter(function(){return $(this).hasClass("coral-state-default")});return b.index(b.filter("#"+a))},getAllTabId:function(){return this.getPanelIds()},getPanelIds:function(){var a=[];return this.tabs.filter("[aria-controls]").each(function(){var b=$(this).attr("aria-controls");""!=b&&a.push(b)}),a},getTabIds:function(){var a=[];this.tablist.children("li").each(function(){var b=$(this).attr("id");""!=b&&a.push(b)});return a},getTabEl:function(){var a=this.tablist.children("li.coral-state-default");return a},getPanelEl:function(){return{}},getLength:function(){return this.tabs.find("[aria-controls]").length},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("coral-tabs coral-component coral-component-content coral-corner-all coral-tabs-collapsible"),this.tablist.removeClass("coral-tabs-nav coral-helper-reset coral-helper-clearfix coral-component-header coral-corner-all").removeAttr("role"),this.anchors.removeClass("coral-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tablist.unbind(this.eventNamespace),this.tabs.add(this.panels).each(function(){$.data(this,"coral-tabs-destroy")?$(this).remove():$(this).removeClass("coral-state-default coral-state-active coral-state-disabled coral-corner-top coral-corner-bottom coral-component-content coral-state-active coral-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var a=$(this),b=a.data("coral-tabs-aria-controls");b?a.attr("aria-controls",b).removeData("coral-tabs-aria-controls"):a.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(a){var b=this.options.disabled;b!==!1&&(void 0===a?b=!1:(a=this._getIndex(a),b=$.isArray(b)?$.map(b,function(b){return b!==a?b:null}):$.map(this.tabs,function(b,c){return c!==a?c:null})),this._setupDisabled(b))},disable:function(a){var b=this.options.disabled;if(b!==!0){if(void 0===a)b=!0;else{if(a=this._getIndex(a),-1!==$.inArray(a,b))return;b=$.isArray(b)?$.merge([a],b).sort():[a]}this._setupDisabled(b)}},_destroyOtherTabs:function(a){var b=this._getList().find("> li:has(a[href])").eq(a).attr("aria-controls");this.component().children("div:not(#"+b+")").empty()},load:function(a,b){a=this._getIndex(a);var c=this,d=this.tabs.eq(a),e=d.find(".coral-tabs-anchor"),f=this._getPanelForTab(d),g={tab:d,panel:f};this.options.destroyAllonActive&&c._destroyOtherTabs(a),c._isLocal(e[0])||$.data(e[0],"cache")||(this.options.loadonce&&$.data(e[0],"cache",!0),this.xhr=$.ajax(this._ajaxSettings(e,b,g)),this.xhr&&"canceled"!==this.xhr.statusText&&(d.addClass("coral-tabs-loading"),f.attr("aria-busy","true"),f.loading({position:"inside",text:"加载中，请耐心等候..."}),this.xhr.success(function(a){setTimeout(function(){f.html(a),$.coral.openTag===!0&&$.parser.parse(f),c._trigger("onLoad",b,g)},1)}).complete(function(a,b){setTimeout(function(){"abort"===b&&c.panels.stop(!1,!0),d.removeClass("coral-tabs-loading"),f.removeAttr("aria-busy"),a===c.xhr&&delete c.xhr},1)})))},_ajaxSettings:function(a,b,c){var d=this;return{url:a.attr("href"),beforeSend:function(a,e){return d._trigger("beforeLoad",b,$.extend({jqXHR:a,ajaxSettings:e},c))},type:d.options.method}},_getPanelForTab:function(a){var b=$(a).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+b))},getPanelForTab:function(a){return this._getPanelForTab(a)}});/*! cui 2016-11-08 */
var _final={className:{BUTTON:"button",LEVEL:"level",ICO_LOADING:"ico_loading",SWITCH:"switch"},editIcon:"cui-icon-pencil7",removeIcon:"cui-icon-cross2",event:{NODECREATED:"tree_nodeCreated",CLICK:"tree_click",EXPAND:"tree_expand",COLLAPSE:"tree_collapse",ASYNC_SUCCESS:"tree_async_success",ASYNC_ERROR:"tree_async_error",REMOVE:"tree_remove",CHECK:"tree_check",DRAG:"tree_drag",DROP:"tree_drop",RENAME:"tree_rename",DRAGMOVE:"tree_dragmove"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul",CHECK:"_check",EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},line:{CENTER:"centerDottedLine",BOTTOM:"bottomDottedLine",ROOTS:"topDottedLine",NOLINE:"noline",LINE:"dottedLine"},folder:{OPEN:"folderOpen",CLOSE:"folderClose",FILE:"file",DOCU:"docu"},arrow:{RIGHT:"arrowRight1",DOWN:"arrowDown1"},node:{CURHOVER:"coral-state-hover",CURSELECTED:"curSelectedNode",CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetTree",TMPTARGET_NODE:"tmpTargetNode"},checkbox:{STYLE:"checkbox",DEFAULT:"coral-state-default",DISABLED:"coral-state-disabled",FALSE:"false",TRUE:"true",UNCHECKED:"unchecked",CHECKED:"checked",PARTIAL:"Partical",FOCUS:"coral-state-focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"}},settings={},roots={},caches={};$.component("coral.tree",{castProperties:["data","fontCss","rootNode","chkboxType","formatter","showIcon","addDiyDom","beforeDrag","onDrag","onDrop"],version:"4.0.2",componentName:"tree",componentFullName:"coral-tree",options:{treeId:"",treeObj:null,clickExpand:!1,disabledMessage:"the node is disabled",disabled:!1,addDiyDom:null,autoCancelSelected:!0,dblClickExpand:!0,expandSpeed:"fast",fontCss:{},iconUrl:!0,nameIsHTML:!1,selectedMulti:!0,showIcon:!0,showLine:!1,showTitle:!0,txtSelectedEnable:!1,rootInNode:!1,showRootNode:!0,rootNode:!1,keyChildren:"children",keyName:"name",keyTitle:"",keyUrl:"url",simpleDataEnable:!1,simpleDataIdKey:"id",simpleDataPIdKey:"pId",simpleDataRootPId:null,keepParent:!1,keepLeaf:!1,asyncEnable:!1,asyncContentType:"application/x-www-form-urlencoded",asyncType:"post",asyncDataType:"text",asyncUrl:"",asyncAutoParam:[],asyncOtherParam:[],asyncDataFilter:null,checkable:!1,autoCheckTrigger:!1,chkStyle:_final.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:_final.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"},keyChecked:"checked",editable:!1,editNameSelectAll:!1,showRemoveBtn:!0,showRenameBtn:!0,removeTitle:"remove",renameTitle:"rename",dragStyle:"line",dragAutoExpandTrigger:!1,dragIsCopy:!0,dragIsMove:!0,dragPrev:!0,dragNext:!0,dragInner:!0,dragMinMoveSize:5,dragBorderMax:10,dragBorderMin:-5,dragMaxShowNodeNum:5,dragAutoOpenTime:500,addHoverDom:null,removeHoverDom:null,beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeReName:null,onDrag:null,onDragMove:null,onDrop:null,onReName:null,beforeCheck:null,onCheck:null,beforeAsync:null,beforeClick:null,beforeDblClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,beforeRemove:null,onLoadError:null,onLoad:null,onNodeCreated:null,onClick:null,onDblClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null,onRemove:null},_create:function(){this.options,this.element;this._initTree()},_getTreeObj:function(a){var b=this._getTreeTools(a);return b?b:null},_initTree:function(){var a=this.element,b=this.options.data;a.hasClass("coral-tree")||a.addClass("coral-tree"),a.attr("component-role","tree");var c=this.options;c.treeId=a.uniqueId().attr("id"),c.treeObj=a,c.treeObj.empty(),settings[c.treeId]=c,c.cls&&a.addClass(c.cls),c.componentCls&&a.addClass(c.componentCls),"undefined"==typeof document.body.style.maxHeight&&(c.expandSpeed=""),this._initNodeBind={bind:[this._coreBindEvent,this._checkBindEvent,this._editBindEvent],unbind:[this._coreUnbindEvent,this._checkUnbindEvent,this._editUnbindEvent],caches:[this._coreInitCache,this._checkInitCache,this._editInitCache],nodes:[this._coreInitNode,this._checkInitNode,this._editInitNode],proxys:[this._checkEventProxy,this._coreEventProxy,this._editEventProxy],roots:[this._coreInitRoot,this._checkInitRoot,this._editInitRoot],beforeA:[this._beforeA],afterA:[],innerBeforeA:[],innerAfterA:[],treeTools:[this._checkTreeTools,this._editTreeTools]},this._initRoot(c);var d=this._getRoot(c),e=c.keyChildren;b=b?this._clone(this._isArray(b)?b:[b]):[],b=this._createRootNodes(c,b),c.simpleDataEnable?d[e]=this._transformToTreeFormat(c,b):d[e]=b,this._initCache(c),this._unbindTree(c),this._bindTree(c),this._unbindEvent(c),this._bindEvent(c),c.disabled?this.disable():this.enable(),c.isInit=!0,c.dataLoaded=!1,c.rootReload=!0,d[e]&&d[e].length>0?(this._createNodes(c,0,d[e]),c.treeObj.trigger(_final.event.ASYNC_SUCCESS,[c.treeId,null,d[e]])):c.asyncEnable&&c.asyncUrl&&""!==c.asyncUrl&&this._asyncNode(c)},_setOption:function(a,b){var c=this.options;this._super(a,b),"disabled"===a&&(b?$("#"+c.treeId).prepend("<div class='coral-state-disabled tree-disabled'></div>"):$("#"+c.treeId+" .tree-disabled").remove())},_pinyinEngine:function(){return new pinyinEngine},_pinyinSetCache:function(a,b,c){for(var d in c)a.setCache([c[d][b]],c[d]);return a},_pinyinSearch:function(a,b,c){var d=[];a.search(b,function(a){d.push(a)}),c(d)},filterNodesByParam:function(a){var b=this,c=b.getNodes(),d=[];b.expandAll(!0),d=b.transformToArray(c);var e=b._pinyinEngine();e=b._pinyinSetCache(e,"name",d),b.hideNodes(d),"object"==typeof a&&$.each(a,function(a,c){"name"==a&&b._pinyinSearch(e,c,function(a){b.showNodes(a,{showParents:!0})})})},disable:function(){return this._setOption("disabled",!0)},enable:function(){return this._setOption("disabled",!1)},showNodes:function(a,b){var c=this.options;this._showNodes(c,a,b)},showNode:function(a){var b=this.options;a&&this._showNodes(b,[a],b)},hideNodes:function(a){var b=this.options;this._hideNodes(b,a,b)},hideNode:function(a){var b=this.options;a&&this._hideNodes(b,[a],b)},removeNode:function(a,b){var c=this.options;a&&(b=!!b,b&&0==this._apply(c.beforeRemove,[c.treeId,a,c],!0)||(this._removeNode(c,a),b&&c.treeObj.trigger(_final.event.REMOVE,[c.treeId,a])))},selectNode:function(a,b){var c=this.options;if(a&&this._uCanDo(c)){if(b=c.selectedMulti&&b,a.parentTId)this._expandCollapseParentNode(c,a.getParentNode(),!0,!1,function(){try{this._$(a,c).focus().blur()}catch(b){}});else try{this._$(a,c).focus().blur()}catch(d){}this._selectNode(c,a,b)}},transformToTreeNodes:function(a){var b=this.options;return this._transformToTreeFormat(b,a)},transformToArray:function(a){var b=this.options;return this._transformToArrayFormat(b,a)},addNodes:function(a,b,c){function d(){f._addNodes(e,a,h,1==c)}var e=this.options,f=this,g=null!=a?"undefined"==typeof a.level?0:a.level:null;if(!b)return null;if(a||(a=null),a&&!a.isParent&&e.keepLeaf)return null;var h=f._clone(f._isArray(b)?b:[b]);return f._canAsync(e,a)?f._asyncNode(e,a,c,d):d(),this._addLine(e,a,g),h},cancelSelectedNode:function(a){var b=this.options;this._cancelPreSelectedNode(b,a)},destroy:function(){var a=this.options;this._destroy(a)},expandAll:function(a){var b=this.options;return a=!!a,this._expandCollapseSonNode(b,null,a,!0),a},expandNode:function(a,b,c,d,e){var f=this.options;if(!a||!a.isParent)return null;if(b!==!0&&b!==!1&&(b=!a.open),e=!!e,e&&b&&0==this._apply(f.beforeExpand,[f.treeId,a,f],!0))return null;if(e&&!b&&0==this._apply(f.beforeCollapse,[f.treeId,a,f],!0))return null;if(b&&a.parentTId&&this._expandCollapseParentNode(f,a.getParentNode(),b,!1),b===a.open&&!c)return null;if(this._getRoot(f).expandTriggerFlag=e,!this._canAsync(f,a)&&c)this._expandCollapseSonNode(f,a,b,!0,function(){if(d!==!1)try{this._$(a,f).focus().blur()}catch(b){}});else if(a.open=!b,this._switchNode(f,a),d!==!1)try{this._$(a,f).focus().blur()}catch(g){}return b},getNodes:function(){var a=this.options;return this._getNodes(a)},getNodeByParam:function(a,b,c){var d=this.options;return a?this._getNodeByParam(d,c?c[d.keyChildren]:this._getNodes(d),a,b):null},getNodeByTId:function(a){var b=this.options;return this._getNodeCache(b,a)},getNodesByParam:function(a,b,c){var d=this.options;return a?this._getNodesByParam(d,c?c[d.keyChildren]:this._getNodes(d),a,b):null},getNodesByParamFuzzy:function(a,b,c){var d=this.options;return a?this._getNodesByParamFuzzy(d,c?c[d.keyChildren]:this._getNodes(d),a,b):null},getNodesByFilter:function(a,b,c,d){var e=this.options;return b=!!b,a&&"function"==typeof a?this._getNodesByFilter(e,c?c[e.keyChildren]:this._getNodes(e),a,b,d):b?null:[]},getNodeIndex:function(a){var b=this.options;if(!a)return null;for(var c=b.keyChildren,d=a.parentTId?a.getParentNode():this._getRoot(b),e=0,f=d[c].length;f>e;e++)if(d[c][e]==a)return e;return-1},getSelectedNodes:function(){for(var a=this.options,b=[],c=this._getRoot(a).curSelectedList,d=0,e=c.length;e>d;d++)b.push(c[d]);return b},isSelectedNode:function(a){var b=this.options;return this._isSelectedNode(b,a)},reAsyncChildNodes:function(a,b,c,d){var e=this.options;if(this.options.asyncEnable){var f=!a;if(f&&(a=this._getRoot(e)),"refresh"==b){for(var g=this.options.keyChildren,h=0,i=a[g]?a[g].length:0;i>h;h++)this._removeNodeCache(e,a[g][h]);if(this._removeSelectedNode(e),a[g]=[],f)this.options.treeObj.empty();else{var j=this._$(a,_final.id.UL,e);j.empty()}}this._asyncNode(this.options,f?null:a,!!c,null,d)}},reLoadChildNodes:function(a,b,c,d){var e=this.options,f=!a;if(f&&(a=this._getRoot(e)),"refresh"==b){for(var g=e.keyChildren,h=0,i=a[g]?a[g].length:0;i>h;h++)this._removeNodeCache(e,a[g][h]);if(this._removeSelectedNode(e),a[g]=[],f)this.element.empty();else{var j=this._$(a,_final.id.UL,e);j.empty()}}e.isInit&&(d=this._createRootNodes(e,d)),this.addNodes(f?null:a,d,!!c)},refresh:function(){var a=this.options;a.treeObj.empty();var b=this._getRoot(a),c=b[a.keyChildren];this._initRoot(a),b[a.keyChildren]=c,this._initCache(a),this._createNodes(a,0,b[a.keyChildren])},reload:function(a){var b=this.options;if(this.options.isInit=!0,a){a=a||{};var c=[],d=!1;"string"!=typeof a?a.data?c=a.data:a instanceof Array?c=a:(a.asyncUrl&&(this.options.asyncUrl=a.asyncUrl),d=!0):(d=!0,this.options.asyncUrl=a),d&&this.options.asyncEnable?this.reAsyncChildNodes(null,"refresh",null,a):(this.reLoadChildNodes(null,"refresh",null,c),this._apply(b.onLoad,[null,this.options.treeId]),a.onLoad?this._apply(b.onLoad,[b.treeId,null,c]):b.treeObj.trigger(_final.event.ASYNC_SUCCESS,[b.treeId,null,c]))}else this.options.asyncEnable&&(a=a||{},this.reAsyncChildNodes(null,"refresh",null,a))},removeChildNodes:function(a){var b=this.options;if(!a)return null;var c=b.keyChildren,d=a[c];return this._removeChildNodes(b,a),d?d:null},_coreInitRoot:function(a){var a=this.options,b=this._getRoot(a);b||(b={},this._setRoot(a,b)),b[a.keyChildren]=[],b.expandTriggerFlag=!1,b.curSelectedList=[],b.noSelection=!0,b.createdNodes=[],b.zId=0,b._ver=(new Date).getTime()},_checkInitRoot:function(a){var a=this.options,b=this._getRoot(a);b.radioCheckedList=[]},_editInitRoot:function(a){var a=this.options,b=this._getRoot(a),c=this._getRoots();b.curEditNode=null,b.curEditInput=null,b.curHoverNode=null,b.dragFlag=0,b.dragNodeShowBefore=[],b.dragMaskList=new Array,c.showHoverDom=!0},_coreInitCache:function(a){var a=this.options,b=this._getCache(a);b||(b={},this._setCache(a,b)),b.nodes=[],b.doms=[]},_checkInitCache:function(a){},_editInitCache:function(a){},_coreBindEvent:function(a){var a=this.options,b=this,c=a.treeObj,d=_final.event;c.bind(d.NODECREATED,function(c,d,e){b._trigger("onNodeCreated",null,[d,e,a])}),c.bind(d.CLICK,function(c,d,e,f,g){return 1==f.nodeDisabled?!1:void b._trigger("onClick",null,[e,f,g,a])}),c.bind(d.EXPAND,function(c,d,e){b._trigger("onExpand",null,[d,e,a])}),c.bind(d.COLLAPSE,function(c,d,e){b._trigger("onCollapse",null,[d,e,a])}),c.bind(d.ASYNC_SUCCESS,function(c,d,e,f){b._trigger("onLoad",null,[d,e,f,a])}),c.bind(d.ASYNC_ERROR,function(c,d,e,f,g,h){b._trigger("onLoad",null,[d,e,f,g,h,a])}),c.bind(d.REMOVE,function(c,d,e){b._trigger("onRemove",null,[d,e,a])})},_checkBindEvent:function(a){var b=this.element,c=this;cache=_final.event,b.bind(cache.CHECK,function(b,d,e,f){b.srcEvent=d,c._trigger("onCheck",null,[e,f,a])})},_editBindEvent:function(a){var b=this.element,c=_final.event,d=this;b.bind(c.RENAME,function(b,c,e,f){d._trigger("onReName",null,[c,e,f,a])}),b.bind(c.DRAG,function(b,c,e,f){d._trigger("onDrag",null,[e,f,a])}),b.bind(c.DRAGMOVE,function(b,c,e,f){d._trigger("onDragMove",null,[e,f,a])}),b.bind(c.DROP,function(b,c,e,f,g,h,i){d._trigger("onDrop",null,[e,f,g,h,i,a])})},_coreUnbindEvent:function(a){var b=this.element,c=_final.event;b.unbind(c.NODECREATED).unbind(c.CLICK).unbind(c.EXPAND).unbind(c.COLLAPSE).unbind(c.ASYNC_SUCCESS).unbind(c.ASYNC_ERROR).unbind(c.REMOVE)},_checkUnbindEvent:function(a){var b=this.element,c=_final.event;b.unbind(c.CHECK)},_editUnbindEvent:function(a){var b=this.element,c=_final.event;b.unbind(c.RENAME),b.unbind(c.DRAG),b.unbind(c.DRAGMOVE),b.unbind(c.DROP)},_coreEventProxy:function(a){var b=a.target,c=this._getSetting(this.options.treeId),d="",e=null,f="",g="",h=null,i=null,j=null;if(this._eqs(a.type,"mousedown")?g="mousedown":this._eqs(a.type,"mouseup")?g="mouseup":this._eqs(a.type,"contextmenu")?g="contextmenu":this._eqs(a.type,"click")?this._eqs(b.tagName,"span")&&null!==b.getAttribute("treeNode"+_final.id.SWITCH)?(d=this._getNodeMainDom(b).id,f="switchNode"):(j=this._getMDom(c,b,[{tagName:"a",attrName:"treeNode"+_final.id.A}]),j&&(d=this._getNodeMainDom(j).id,f="clickNode")):this._eqs(a.type,"dblclick")&&(g="dblclick",j=this._getMDom(c,b,[{tagName:"a",attrName:"treeNode"+_final.id.A}]),j&&(d=this._getNodeMainDom(j).id,f="switchNode")),g.length>0&&0==d.length&&(j=this._getMDom(c,b,[{tagName:"a",attrName:"treeNode"+_final.id.A}]),j&&(d=this._getNodeMainDom(j).id)),d.length>0)switch(e=this._getNodeCache(c,d),f){case"switchNode":e.isParent&&(this._eqs(a.type,"click")||this._eqs(a.type,"dblclick")&&this._apply(c.dblClickExpand,[c.treeId,e,c],c.dblClickExpand))?h=this._onSwitchNode:f="";break;case"clickNode":h=this._onClickNode}switch(g){case"mousedown":i=this._onTreeMousedown;break;case"mouseup":i=this._onTreeMouseup;break;case"dblclick":i=this._onTreeDblclick;break;case"contextmenu":i=this._onTreeContextmenu}var k={stop:!1,node:e,nodeEventType:f,nodeEventCallback:h,treeEventType:g,treeEventCallback:i};return k},_checkEventProxy:function(a){var b=a.target,c=this._getSetting(this.options.treeId),d="",e=null,f="",g="",h=null,i=null;if(this._eqs(a.type,"mouseover")?c.checkable&&this._eqs(b.tagName,"span")&&null!==b.getAttribute("treeNode"+_final.id.CHECK)&&(d=this._getNodeMainDom(b).id,f="mouseoverCheck"):this._eqs(a.type,"mouseout")?c.checkable&&this._eqs(b.tagName,"span")&&null!==b.getAttribute("treeNode"+_final.id.CHECK)&&(d=this._getNodeMainDom(b).id,f="mouseoutCheck"):this._eqs(a.type,"click")&&c.checkable&&this._eqs(b.tagName,"span")&&null!==b.getAttribute("treeNode"+_final.id.CHECK)&&(d=this._getNodeMainDom(b).id,f="checkNode"),d.length>0)switch(e=this._getNodeCache(c,d),f){case"checkNode":h=this._onCheckNode;break;case"mouseoverCheck":h=this._onMouseoverCheck;break;case"mouseoutCheck":h=this._onMouseoutCheck}var j={stop:"checkNode"===f,node:e,nodeEventType:f,nodeEventCallback:h,treeEventType:g,treeEventCallback:i};return j},_editEventProxy:function(a){var b=a.target,c=this._getSetting(this.options.treeId),d=a.relatedTarget,e="",f=null,g="",h="",i=null,j=null,k=null;if(this._eqs(a.type,"mouseover")?(k=this._getMDom(c,b,[{tagName:"a",attrName:"treeNode"+_final.id.A}]),k&&(e=this._getNodeMainDom(k).id,g="hoverOverNode")):this._eqs(a.type,"mouseout")?(k=this._getMDom(c,d,[{tagName:"a",attrName:"treeNode"+_final.id.A}]),k||(e="remove",g="hoverOutNode")):this._eqs(a.type,"mousedown")&&(k=this._getMDom(c,b,[{tagName:"a",attrName:"treeNode"+_final.id.A}]),k&&(e=this._getNodeMainDom(k).id,g="mousedownNode")),e.length>0)switch(f=this._getNodeCache(c,e),g){case"mousedownNode":i=this._onMousedownNode;break;case"hoverOverNode":i=this._onHoverOverNode;break;case"hoverOutNode":i=this._onHoverOutNode}var l={stop:!1,node:f,nodeEventType:g,nodeEventCallback:i,treeEventType:h,treeEventCallback:j};return l},_beforeA:function(a,b,c){a.keyChecked;a.checkable&&(this._makeChkFlag(a,b),c.push("<span ID='",b.tId,_final.id.CHECK,"' class='",this._makeChkClass(a,b),"' treeNode",_final.id.CHECK,b.nocheck===!0?" style='display:none;'":"","></span>"))},_coreInitNode:function(a,b,c,d,e,f,g){if(c){var h=this._getRoot(a),i=this,j=a.keyChildren;c.level=b,c.tId=a.treeId+"_"+ ++h.zId,c.parentTId=d?d.tId:null,c.open="string"==typeof c.open?i._eqs(c.open,"true"):!!c.open,c[j]&&c[j].length>0?(c.isParent=!0,c.zAsync=!0):(c.isParent="string"==typeof c.isParent?i._eqs(c.isParent,"true"):!!c.isParent,c.open=c.isParent&&!a.asyncEnable?c.open:!1,c.zAsync=!c.isParent),c.isFirstNode=e,c.isLastNode=f,c.getParentNode=function(){return i._getNodeCache(a,c.parentTId)},c.getPreNode=function(){return i._getPreNode(a,c)},c.getNextNode=function(){return i._getNextNode(a,c)},c.isAjaxing=!1,i._fixPIdKeyValue(a,c)}},_checkInitNode:function(a,b,c,d,e,f,g){if(c){1==c.nodeDisabled&&(c.chkDisabled=!0);var h=a.keyChecked,i=this;if("string"==typeof c[h]&&(c[h]=i._eqs(c[h],"true")),c[h]=!!c[h],c.checkedOld=c[h],"string"==typeof c.nocheck&&(c.nocheck=i._eqs(c.nocheck,"true")),c.nocheck=!!c.nocheck||a.nocheckInherit&&d&&!!d.nocheck,"string"==typeof c.chkDisabled&&(c.chkDisabled=i._eqs(c.chkDisabled,"true")),c.chkDisabled=!!c.chkDisabled||a.chkDisabledInherit&&d&&!!d.chkDisabled,"string"==typeof c.halfCheck&&(c.halfCheck=i._eqs(c.halfCheck,"true")),c.halfCheck=!!c.halfCheck,c.check_Child_State=-1,c.check_Focus=!1,c.getCheckStatus=function(){return i._getCheckStatus(a,c)},a.chkStyle==_final.radio.STYLE&&a.radioType==_final.radio.TYPE_ALL&&c[h]){var j=i._getRoot(a);j.radioCheckedList.push(c)}}},_editInitNode:function(a,b,c,d,e,f,g){c&&(c.isHover=!1,c.editNameFlag=!1)},_checkTreeTools:function(a,b){},checkNode:function(a,b,c,d){var e=this.options.keyChecked,f=this,g=this.options;if(a.chkDisabled!==!0&&(b!==!0&&b!==!1&&(b=!a[e]),d=!!d,(a[e]!==b||c)&&(!d||0!=f._apply(g.beforeCheck,[g.treeId,a,g],!0))&&this._uCanDo(g)&&g.checkable&&a.nocheck!==!0)){a[e]=b;var h=this._$(a,_final.id.CHECK,g);(c||g.chkStyle===_final.radio.STYLE)&&this._checkNodeRelation(g,a),this._setChkClass(g,h,a),this._repairParentChkClassWithSelf(g,a),d&&g.treeObj.trigger(_final.event.CHECK,[null,g.treeId,a])}},_editTreeTools:function(a,b){b.cancelEditName=function(a){var b=this._getRoot(this.opts);b.curEditNode&&this._cancelCurEditNode(this.opts,a?a:null,!0)}},copyNode:function(a,b,c,d){function e(){this._addNodes(f,a,[g],d)}if(!b)return null;var f=this.options;if(a&&!a.isParent&&f.keepLeaf&&c===_final.move.TYPE_INNER)return null;var g=this._clone(b);return a||(a=null,c=_final.move.TYPE_INNER),c==_final.move.TYPE_INNER?this._canAsync(f,a)?this._asyncNode(f,a,d,e):e():(this._addNodes(f,a.parentNode,[g],d),this._moveNode(f,a,g,c,!1,d)),g},editName:function(a){var b=this.options;a&&a.tId&&a===this._getNodeCache(b,a.tId)&&(a.parentTId&&this._expandCollapseParentNode(b,a.getParentNode(),!0),this._editNode(b,a))},moveNode:function(a,b,c,d){function e(){this._moveNode(f,a,b,c,!1,d)}if(!b)return b;var f=this.options;return a&&!a.isParent&&f.keepLeaf&&c===_final.move.TYPE_INNER?null:a&&(b.parentTId==a.tId&&c==_final.move.TYPE_INNER||this._$(b,f).find("#"+a.tId).length>0)?null:(a||(a=null),this._canAsync(f,a)&&c===_final.move.TYPE_INNER?this._asyncNode(f,a,d,e):e(),b)},setEditable:function(a){var b=this.options;return b.editable=a,this.refresh()},checkAllNodes:function(a){this._repairAllChk(this.options,!!a)},getCheckedNodes:function(a){var b=this.options.keyChildren;return a=a!==!1,this._getTreeCheckedNodes(this.options,this._getRoot(this.options)[b],a)},getChangeCheckedNodes:function(){var a=this.options.keyChildren;return this._getTreeChangeCheckedNodes(this.options,this._getRoot(this.options)[a])},setChkDisabled:function(a,b,c,d){b=!!b,c=!!c,d=!!d,this._repairSonChkDisabled(this.options,a,b,d),this._repairParentChkDisabled(this.options,a.getParentNode(),b,c)},updateNode:function(a,b){var c=(this.options.updateNode,this.options);if(a){var d=this._$(a,c);if(d.get(0)&&this._uCanDo(c)&&(this._setNodeName(c,a),this._setNodeTarget(c,a),this._setNodeUrl(c,a),this._setNodeLineIcos(c,a),this._setNodeFontCss(c,a)),a&&this.options.checkable){var d=this._$(a,this.options);if(d.get(0)&&this._uCanDo(this.options)){var e=this._$(a,_final.id.CHECK,this.options);1!=b&&this.options.chkStyle!==_final.radio.STYLE||this._checkNodeRelation(this.options,a),this._setChkClass(this.options,e,a),this._repairParentChkClassWithSelf(this.options,a)}}}},_addNodeCache:function(a,b){this._getCache(a).nodes[this._getNodeCacheId(b.tId)]=b},_getNodeCacheId:function(a){return a.substring(a.lastIndexOf("_")+1)},_addNodesData:function(a,b,c){var d=a.keyChildren;b[d]||(b[d]=[]),b[d].length>0&&(b[d][b[d].length-1].isLastNode=!1,this._setNodeLineIcos(a,b[d][b[d].length-1])),b.isParent=!0,b[d]=b[d].concat(c)},_addSelectedNode:function(a,b){var c=this._getRoot(a);this._isSelectedNode(a,b)||c.curSelectedList.push(b)},_addCreatedNode:function(a,b){if(a.onNodeCreated||a.addDiyDom){var c=this._getRoot(a);c.createdNodes.push(b)}},_fixPIdKeyValue:function(a,b){a.simpleDataEnable&&(b[a.simpleDataPIdKey]=b.parentTId?b.getParentNode()[a.simpleDataIdKey]:a.simpleDataRootPId)},_getAfterA:function(a,b,c){for(var d=0,e=this._initNodeBind.afterA.length;e>d;d++)this._initNodeBind.afterA[d].apply(this,arguments)},_getBeforeA:function(a,b,c){for(var d=0,e=this._initNodeBind.beforeA.length;e>d;d++)this._initNodeBind.beforeA[d].apply(this,arguments)},_getInnerAfterA:function(a,b,c){for(var d=0,e=this._initNodeBind.innerAfterA.length;e>d;d++)this._initNodeBind.innerAfterA[d].apply(this,arguments)},_getInnerBeforeA:function(a,b,c){for(var d=0,e=this._initNodeBind.innerBeforeA.length;e>d;d++)this._initNodeBind.innerBeforeA[d].apply(this,arguments)},_getCache:function(a){return caches[a.treeId]},_getNextNode:function(a,b){if(!b)return null;for(var c=a.keyChildren,d=b.parentTId?b.getParentNode():this._getRoot(a),e=0,f=d[c].length-1;f>=e;e++)if(d[c][e]===b)return e==f?null:d[c][e+1];return null},_getNodeByParam:function(a,b,c,d){if(!b||!c)return null;for(var e=a.keyChildren,f=0,g=b.length;g>f;f++){if(b[f][c]==d)return b[f];var h=this._getNodeByParam(a,b[f][e],c,d);if(h)return h}return null},_getNodeCache:function(a,b){if(!b)return null;var c=caches[a.treeId].nodes[this._getNodeCacheId(b)];return c?c:null},_getNodeName:function(a,b){var c=a.keyName;return""+b[c]},_getNodeTitle:function(a,b){var c=""===a.keyTitle?a.keyName:a.keyTitle;return""+b[c]},_getNodes:function(a){return this._getRoot(a)[a.keyChildren]},_getNodesByParam:function(a,b,c,d){if(!b||!c)return[];for(var e=a.keyChildren,f=[],g=0,h=b.length;h>g;g++)b[g][c]==d&&f.push(b[g]),f=f.concat(this._getNodesByParam(a,b[g][e],c,d));return f},_getNodesByParamFuzzy:function(a,b,c,d){if(!b||!c)return[];var e=a.keyChildren,f=[];d=d.toLowerCase();for(var g=0,h=b.length;h>g;g++)"string"==typeof b[g][c]&&b[g][c].toLowerCase().indexOf(d)>-1&&f.push(b[g]),f=f.concat(this._getNodesByParamFuzzy(a,b[g][e],c,d));return f},_getNodesByFilter:function(a,b,c,d,e){if(!b)return d?null:[];for(var f=a.keyChildren,g=d?null:[],h=0,i=b.length;i>h;h++){if(this._apply(c,[b[h],e],!1)){if(d)return b[h];g.push(b[h])}var j=this._getNodesByFilter(a,b[h][f],c,d,e);if(d&&j)return j;g=d?j:g.concat(j)}return g},_getPreNode:function(a,b){if(!b)return null;for(var c=a.keyChildren,d=b.parentTId?b.getParentNode():this._getRoot(a),e=0,f=d[c].length;f>e;e++)if(d[c][e]===b)return 0==e?null:d[c][e-1];return null},_getRadioCheckedList:function(a){for(var b=this._getRoot(a).radioCheckedList,c=0,d=b.length;d>c;c++)this._getNodeCache(a,b[c].tId)||(b.splice(c,1),c--,d--);return b},_getCheckStatus:function(a,b){if(!a.checkable||b.nocheck||b.chkDisabled)return null;var c=a.keyChecked,d={checked:b[c],half:b.halfCheck?b.halfCheck:a.chkStyle==_final.radio.STYLE?2===b.check_Child_State:b[c]?b.check_Child_State>-1&&b.check_Child_State<2:b.check_Child_State>0};return d},_getTreeCheckedNodes:function(a,b,c,d){if(!b)return[];var e=a.keyChildren,f=a.keyChecked,g=c&&a.chkStyle==_final.radio.STYLE&&a.radioType==_final.radio.TYPE_ALL;d=d?d:[];for(var h=0,i=b.length;i>h&&(b[h].nocheck===!0||b[h].chkDisabled===!0||b[h][f]!=c||(d.push(b[h]),!g))&&(this._getTreeCheckedNodes(a,b[h][e],c,d),!(g&&d.length>0));h++);return d},_getTreeChangeCheckedNodes:function(a,b,c){if(!b)return[];var d=a.keyChildren,e=a.keyChecked;c=c?c:[];for(var f=0,g=b.length;g>f;f++)b[f].nocheck!==!0&&b[f].chkDisabled!==!0&&b[f][e]!=b[f].checkedOld&&c.push(b[f]),this._getTreeChangeCheckedNodes(a,b[f][d],c);return c},_getRoot:function(a){return a?roots[a.treeId]:null},_getRoots:function(){return roots},_getSetting:function(a){return settings[a]},_getSettings:function(){return settings},_getTreeTools:function(a){var b=this._getRoot(this._getSetting(a));return b?b.treeTools:null},_initCache:function(a){for(var b=0,c=this._initNodeBind.caches.length;c>b;b++)this._initNodeBind.caches[b].apply(this,arguments)},_initNode:function(a,b,c,d,e,f){for(var g=0,h=this._initNodeBind.nodes.length;h>g;g++)this._initNodeBind.nodes[g].apply(this,arguments)},_initRoot:function(a){for(var b=0,c=this._initNodeBind.roots.length;c>b;b++)this._initNodeBind.roots[b].apply(this,arguments)},_isSelectedNode:function(a,b){for(var c=this._getRoot(a),d=0,e=c.curSelectedList.length;e>d;d++)if(b===c.curSelectedList[d])return!0;return!1},_removeNodeCache:function(a,b){var c=a.keyChildren;if(b[c])for(var d=0,e=b[c].length;e>d;d++)this._removeNodeCache(a,b[c][d]);this._getCache(a).nodes[this._getNodeCacheId(b.tId)]=null},_removeSelectedNode:function(a,b){for(var c=this._getRoot(a),d=0,e=c.curSelectedList.length;e>d;d++)b!==c.curSelectedList[d]&&this._getNodeCache(a,c.curSelectedList[d].tId)||(c.curSelectedList.splice(d,1),d--,e--)},_setCache:function(a,b){caches[a.treeId]=b},_setRoot:function(a,b){roots[a.treeId]=b},_setTreeTools:function(a,b){for(var c=0,d=this._initNodeBind.treeTools.length;d>c;c++)this._initNodeBind.treeTools[c].apply(this,arguments)},_makeChkFlag:function(a,b){if(b){var c=a.keyChildren,d=a.keyChecked,e=-1;if(b[c])for(var f=0,g=b[c].length;g>f;f++){var h=b[c][f],i=-1;if(a.chkStyle==_final.radio.STYLE){if(i=h.nocheck===!0||h.chkDisabled===!0?h.check_Child_State:h.halfCheck===!0?2:h[d]?2:h.check_Child_State>0?2:0,2==i){e=2;break}0==i&&(e=0)}else if(a.chkStyle==_final.checkbox.STYLE){if(i=h.nocheck===!0||h.chkDisabled===!0?h.check_Child_State:h.halfCheck===!0?1:h[d]?-1===h.check_Child_State||2===h.check_Child_State?2:1:h.check_Child_State>0?1:0,1===i){e=1;break}if(2===i&&e>-1&&f>0&&i!==e){e=1;break}if(2===e&&i>-1&&2>i){e=1;break}i>-1&&(e=i)}}b.check_Child_State=e}},_setSonNodeLevel:function(a,b,c){if(c){var d=a.keyChildren;if(c.level=b?b.level+1:0,c[d])for(var e=0,f=c[d].length;f>e;e++)c[d][e]&&this._setSonNodeLevel(a,c,c[d][e])}},_transformToArrayFormat:function(a,b){if(!b)return[];var c=a.keyChildren,d=[];if(this._isArray(b))for(var e=0,f=b.length;f>e;e++)d.push(b[e]),b[e][c]&&(d=d.concat(this._transformToArrayFormat(a,b[e][c])));else d.push(b),b[c]&&(d=d.concat(this._transformToArrayFormat(a,b[c])));return d},_transformToTreeFormat:function(a,b){var c,d,e=a.simpleDataIdKey,f=a.simpleDataPIdKey,g=a.keyChildren;if(!e||""==e||!b)return[];if(this._isArray(b)){var h=[],i=[];for(c=0,d=b.length;d>c;c++)i[b[c][e]]=b[c];for(c=0,d=b.length;d>c;c++)i[b[c][f]]&&b[c][e]!=b[c][f]?(i[b[c][f]][g]||(i[b[c][f]][g]=[]),i[b[c][f]][g].push(b[c])):h.push(b[c]);return h}return[b]},_bindEvent:function(a){for(var b=0,c=this._initNodeBind.bind.length;c>b;b++)this._initNodeBind.bind[b].apply(this,arguments)},_unbindEvent:function(a){for(var b=0,c=this._initNodeBind.unbind.length;c>b;b++)this._initNodeBind.unbind[b].apply(this,arguments)},_bindTree:function(a){var b=({treeId:a.treeId},this);treeObj=this.element,a.txtSelectedEnable||treeObj.bind("selectstart",function(a){var b=a.originalEvent.srcElement.nodeName.toLowerCase();return"input"===b||"textarea"===b}).css({"-moz-user-select":"-moz-none"}),this._on(treeObj,{click:function(a){b._proxy(a)},dblclick:function(a){b._proxy(a)},mouseover:function(a){b._proxy(a)},mouseout:function(a){b._proxy(a)},mousedown:function(a){b._proxy(a)},mouseup:function(a){b._proxy(a)},contextmenu:function(a){b._proxy(a)}})},_unbindTree:function(a){var b=this.element;b.unbind("click",this._proxy),b.unbind("dblclick",this._proxy),b.unbind("mouseover",this._proxy),b.unbind("mouseout",this._proxy),b.unbind("mousedown",this._proxy),b.unbind("mouseup",this._proxy),b.unbind("contextmenu",this._proxy)},_doProxy:function(a){for(var b=[],c=0,d=this._initNodeBind.proxys.length;d>c;c++){var e=this._initNodeBind.proxys[c].apply(this,arguments);if(b.push(e),e.stop)break}return b},_proxy:function(a){var b=this._getSetting(this.options.treeId),c=this;if(!this._uCanDo(b,a))return!0;for(var d=this._doProxy(a),e=!0,f=!1,g=0,h=d.length;h>g;g++){var i=d[g];i.nodeEventCallback&&(f=!0,e=i.nodeEventCallback.apply(i,[c,i.node,a])&&e),i.treeEventCallback&&(f=!0,e=i.treeEventCallback.apply(i,[c,i.node,a])&&e)}return e},_onSwitchNode:function(a,b){var c=a.options,d=a._getSetting(c.treeId);if(b.open){if(0==a._apply(d.beforeCollapse,[d.treeId,b,d],!0))return!0;a._getRoot(d).expandTriggerFlag=!0,a._switchNode(d,b)}else{if(0==a._apply(d.beforeExpand,[d.treeId,b,d]))return!0;a._getRoot(d).expandTriggerFlag=!0,a._switchNode(d,b)}return!0},_onClickNode:function(a,b){var c=a.options;return clickFlag=c.autoCancelSelected&&(event.ctrlKey||event.metaKey)&&a._isSelectedNode(c,b)?0:c.autoCancelSelected&&(event.ctrlKey||event.metaKey)&&c.selectedMulti?2:1,0==a._apply(c.beforeClick,[c.treeId,b,clickFlag,c],!0)?!0:(0===clickFlag?a._cancelPreSelectedNode(c,b):a._selectNode(c,b,2===clickFlag),c.treeObj.trigger(_final.event.CLICK,[event,c.treeId,b,clickFlag]),c.clickExpand&&$(c.treeObj).tree("expandNode",b,null,null,null,!0),!0)},_onTreeMousedown:function(a,b){var c=a._getSetting(a.options.treeId);return a._apply(c.beforeMouseDown,[c.treeId,b,c],!0)&&a._trigger("onMouseDown",null,[c.treeId,b,c]),!0},_onTreeMouseup:function(a,b){var c=a._getSetting(a.options.treeId);return a._apply(c.beforeMouseUp,[c.treeId,b,c],!0)&&a._trigger("onMouseUp",null,[c.treeId,b,c]),!0},_onTreeDblclick:function(a,b){var c=a._getSetting(a.options.treeId);return a._apply(c.beforeDblClick,[c.treeId,b,c],!0)&&a._trigger("onDblClick",null,[c.treeId,b,c]),!0},_onTreeContextmenu:function(a,b){var c=a._getSetting(a.options.treeId);return a._apply(c.beforeRightClick,[c.treeId,b,c],!0)&&a._trigger("onRightClick",null,[c.treeId,b,c]),"function"!=typeof c.onRightClick},_onCheckNode:function(a,b){var c=a.options;if(b.chkDisabled===!0)return!1;var d=a._getSetting(c.treeId),e=d.keyChecked;if(0==a._apply(d.beforeCheck,[d.treeId,b,d],!0))return!0;b[e]=!b[e],a._checkNodeRelation(d,b);var f=a._$(b,_final.id.CHECK,d);return a._setChkClass(d,f,b),a._repairParentChkClassWithSelf(d,b),a.element.trigger(_final.event.CHECK,[event,d.treeId,b]),!0},_onMouseoverCheck:function(a,b){var c=a.options;if(b.chkDisabled===!0)return!1;var d=a._getSetting(c.treeId),e=a._$(b,_final.id.CHECK,d);return b.check_Focus=!0,a._setChkClass(d,e,b),!0},_onMouseoutCheck:function(a,b){var c=a.options;if(b.chkDisabled===!0)return!1;var d=a._getSetting(c.treeId),e=a._$(b,_final.id.CHECK,d);return b.check_Focus=!1,a._setChkClass(d,e,b),!0},_onHoverOverNode:function(a,b){var c=a.options,d=a._getSetting(c.treeId),e=a._getRoot(d);e.curHoverNode!=b&&a._onHoverOutNode(a),e.curHoverNode=b,a._addHoverDom(d,b)},_onHoverOutNode:function(a,b){var c=a.options,d=a._getSetting(c.treeId),e=a._getRoot(d);e.curHoverNode&&!a._isSelectedNode(d,e.curHoverNode)&&(a._removeTreeDom(d,e.curHoverNode),e.curHoverNode=null)},_onMousedownNode:function(a,b,c){function d(b){if(0==k.dragFlag&&Math.abs(C-b.clientX)<j.dragMinMoveSize&&Math.abs(D-b.clientY)<j.dragMinMoveSize)return!0;
var c,d,f,g,h,i=j.keyChildren;if(u.css("cursor","pointer"),0==k.dragFlag){if(0==a._apply(j.beforeDrag,[j.treeId,o,j],!0))return e(b),!0;for(c=0,d=o.length;d>c;c++)0==c&&(k.dragNodeShowBefore=[]),f=o[c],f.isParent&&f.open?(a._expandCollapseNode(j,f,!f.open),k.dragNodeShowBefore[f.tId]=!0):k.dragNodeShowBefore[f.tId]=!1;k.dragFlag=1,l.showHoverDom=!1,a._showIfameMask(j,!0);var m=!0,n=-1;if(o.length>1){var x=o[0].parentTId?o[0].getParentNode()[i]:a._getNodes(j);for(h=[],c=0,d=x.length;d>c;c++)if(void 0!==k.dragNodeShowBefore[x[c].tId]&&(m&&n>-1&&n+1!==c&&(m=!1),h.push(x[c]),n=c),o.length===h.length){o=h;break}}for(m&&(r=o[0].getPreNode(),s=o[o.length-1].getNextNode()),c=0,d=o.length;d>c;c++)f=o[c],f.editNameFlag=!1,a._selectNode(j,f,c>0),a._removeTreeDom(j,f),c>j.dragMaxShowNodeNum-1||(g=a._$("<li id='"+f.tId+"_tmp'></li>",j),g.append(a._$(f,_final.id.A,j).clone()),g.css("padding","0"),g.children("#"+f.tId+_final.id.A).removeClass(_final.node.CURSELECTED),c==j.dragMaxShowNodeNum-1&&(g=a._$("<li id='"+f.tId+"_moretmp'><a>  ...  </a></li>",j)));p=a._$("<span class='tmpTreeMove_arrow'></span>",j),p.attr("id","treeMove_arrow_tmp"),p.appendTo(u),a.element.trigger(_final.event.DRAG,[b,j.treeId,o])}if(1==k.dragFlag){if(q&&p.attr("id")==b.target.id&&A&&b.clientX+t.scrollLeft()+2>$("#"+A+_final.id.A,q).offset().left){var F=$("#"+A+_final.id.A,q);b.target=F.length>0?F.get(0):b.target}else q&&(q.removeClass(_final.node.TMPTARGET_TREE),A&&$("#"+A+_final.id.A,q).removeClass(_final.node.TMPTARGET_NODE+"_"+_final.move.TYPE_PREV).removeClass(_final.node.TMPTARGET_NODE+"_"+_final.move.TYPE_NEXT).removeClass(_final.node.TMPTARGET_NODE+"_"+_final.move.TYPE_INNER));q=null,A=null,v=!1,w=j;var G=a._getSettings();for(var H in G)G[H].treeId&&G[H].editable&&G[H].treeId!=j.treeId&&(b.target.id==G[H].treeId||$(b.target).parents("#"+G[H].treeId).length>0)&&(v=!0,w=G[H]);var I=t.scrollTop(),J=t.scrollLeft(),K=w.treeObj.offset(),L=w.treeObj.get(0).scrollHeight,M=w.treeObj.get(0).scrollWidth,N=b.clientY+I-K.top,O=w.treeObj.height()+K.top-b.clientY-I,P=b.clientX+J-K.left,Q=w.treeObj.width()+K.left-b.clientX-J,R=N<j.dragBorderMax&&N>j.dragBorderMin,S=O<j.dragBorderMax&&O>j.dragBorderMin,T=P<j.dragBorderMax&&P>j.dragBorderMin,U=Q<j.dragBorderMax&&Q>j.dragBorderMin,V=N>j.dragBorderMin&&O>j.dragBorderMin&&P>j.dragBorderMin&&Q>j.dragBorderMin,W=R&&w.treeObj.scrollTop()<=0,X=S&&w.treeObj.scrollTop()+w.treeObj.height()+10>=L,Y=T&&w.treeObj.scrollLeft()<=0,Z=U&&w.treeObj.scrollLeft()+w.treeObj.width()+10>=M;if(b.target&&a._isChildOrSelf(b.target,w.treeId)){for(var _=b.target;_&&_.tagName&&!a._eqs(_.tagName,"li")&&_.id!=w.treeId;)_=_.parentNode;var aa=!0;for(c=0,d=o.length;d>c;c++){if(f=o[c],_.id===f.tId){aa=!1;break}if(a._$(f,j).find("#"+_.id).length>0){aa=!1;break}}aa&&b.target&&a._isChildOrSelf(b.target,_.id+_final.id.A)&&(q=$(_),A=_.id)}f=o[0],V&&a._isChildOrSelf(b.target,w.treeId)&&(!q&&(b.target.id==w.treeId||W||X||Y||Z)&&(v||!v&&f.parentTId)&&(q=w.treeObj),R?w.treeObj.scrollTop(w.treeObj.scrollTop()-10):S&&w.treeObj.scrollTop(w.treeObj.scrollTop()+10),T?w.treeObj.scrollLeft(w.treeObj.scrollLeft()-10):U&&w.treeObj.scrollLeft(w.treeObj.scrollLeft()+10),q&&q!=w.treeObj&&q.offset().left<w.treeObj.offset().left&&w.treeObj.scrollLeft(w.treeObj.scrollLeft()+q.offset().left-w.treeObj.offset().left));var ba=0,ca=0;if(q&&q.attr("id")!=w.treeId){var da=null==A?null:a._getNodeCache(w,A),ea=(b.ctrlKey||b.metaKey)&&j.dragIsMove&&j.dragIsCopy||!j.dragIsMove&&j.dragIsCopy,fa=!(!r||A!==r.tId),ga=!(!s||A!==s.tId),ha=f.parentTId&&f.parentTId==A,ia=(ea||!ga)&&a._apply(w.dragPrev,[w.treeId,o,da,w],!!w.dragPrev),ja=(ea||!fa)&&a._apply(w.dragNext,[w.treeId,o,da,w],!!w.dragNext),ka=(ea||!ha)&&!(w.keepLeaf&&!da.isParent)&&a._apply(w.dragInner,[w.treeId,o,da,w],!!w.dragInner);if(ia||ja||ka){var la=$("#"+A+_final.id.A,q),ma=da.isLastNode?null:$("#"+da.getNextNode().tId+_final.id.A,q.next()),na=la.offset().top,oa=la.offset().left,pa=ia?ka?.25:ja?.5:1:-1,qa=ja?ka?.75:ia?.5:0:-1,ra=(b.clientY+I-na)/la.height();if((1==pa||pa>=ra&&ra>=-.2)&&ia?(ba=1-p.width(),ca=na-p.height()/2,B=_final.move.TYPE_PREV):(0==qa||ra>=qa&&1.2>=ra)&&ja?(ba=1-p.width(),ca=null==ma||da.isParent&&da.open?na+la.height()-p.height()/2:ma.offset().top-p.height()/2,B=_final.move.TYPE_NEXT):(ba=5-p.width(),ca=na,B=_final.move.TYPE_INNER),p.css({display:"block",top:ca+"px",left:oa+ba+"px"}),"line"==j.dragStyle&&(_final.move.TYPE_INNER==B?p.removeClass("preNext_line").addClass("inner_line"):p.removeClass("inner_line").addClass("preNext_line")),la.addClass(_final.node.TMPTARGET_NODE+"_"+B),y==A&&z==B||(E=(new Date).getTime()),da&&da.isParent&&B==_final.move.TYPE_INNER){var sa=!0;window.TreeMoveTimer&&window.TreeMoveTargetNodeTId!==da.tId?(clearTimeout(window.TreeMoveTimer),window.TreeMoveTargetNodeTId=null):window.TreeMoveTimer&&window.TreeMoveTargetNodeTId===da.tId&&(sa=!1),sa&&(window.TreeMoveTimer=setTimeout(function(){B==_final.move.TYPE_INNER&&da&&da.isParent&&!da.open&&(new Date).getTime()-E>w.dragAutoOpenTime&&a._apply(w.beforeDragOpen,[w.treeId,da,w],!0)&&(a._switchNode(w,da),w.dragAutoExpandTrigger&&w.treeObj.trigger(_final.event.EXPAND,[w.treeId,da]))},w.dragAutoOpenTime+50),window.TreeMoveTargetNodeTId=da.tId)}}else q=null,A="",B=_final.move.TYPE_INNER,window.TreeMoveTimer&&(clearTimeout(window.TreeMoveTimer),window.TreeMoveTargetNodeTId=null)}else B=_final.move.TYPE_INNER,q&&a._apply(w.dragInner,[w.treeId,o,null,w],!!w.dragInner)?q.addClass(_final.node.TMPTARGET_TREE):q=null,p.css({display:"none"}),window.TreeMoveTimer&&(clearTimeout(window.TreeMoveTimer),window.TreeMoveTargetNodeTId=null);y=A,z=B,a.element.trigger(_final.event.DRAGMOVE,[b,j.treeId,o])}return!1}function e(b){function c(){if(v){if(!n)for(var c=0,d=o.length;d>c;c++)a._removeNode(j,o[c]);if(B==_final.move.TYPE_INNER)a._addNodes(w,r,s);else if(a._addNodes(w,r.getParentNode(),s),B==_final.move.TYPE_PREV)for(c=0,d=s.length;d>c;c++)a._moveNode(w,r,s[c],B,!1);else for(c=-1,d=s.length-1;d>c;d--)a._moveNode(w,r,s[d],B,!1)}else if(n&&B==_final.move.TYPE_INNER)a._addNodes(w,r,s);else if(n&&a._addNodes(w,r.getParentNode(),s),B!=_final.move.TYPE_NEXT)for(c=0,d=s.length;d>c;c++)a._moveNode(w,r,s[c],B,!1);else for(c=-1,d=s.length-1;d>c;d--)a._moveNode(w,r,s[d],B,!1);a._selectNodes(w,s),a._$(s[0],j).focus().blur(),a.element.trigger(_final.event.DROP,[b,w.treeId,s,r,B,n])}if(window.TreeMoveTimer&&(clearTimeout(window.TreeMoveTimer),window.TreeMoveTargetNodeTId=null),y=null,z=null,t.unbind("mousemove",d),t.unbind("mouseup",e),t.unbind("selectstart",f),u.css("cursor","auto"),q&&(q.removeClass(_final.node.TMPTARGET_TREE),A&&$("#"+A+_final.id.A,q).removeClass(_final.node.TMPTARGET_NODE+"_"+_final.move.TYPE_PREV).removeClass(_final.node.TMPTARGET_NODE+"_"+_final.move.TYPE_NEXT).removeClass(_final.node.TMPTARGET_NODE+"_"+_final.move.TYPE_INNER)),a._showIfameMask(j,!1),l.showHoverDom=!0,0!=k.dragFlag){k.dragFlag=0;var h,i,m;for(h=0,i=o.length;i>h;h++)m=o[h],m.isParent&&k.dragNodeShowBefore[m.tId]&&!m.open&&(a._expandCollapseNode(j,m,!m.open),delete k.dragNodeShowBefore[m.tId]);p&&p.remove();var n=(b.ctrlKey||b.metaKey)&&j.dragIsMove&&j.dragIsCopy||!j.dragIsMove&&j.dragIsCopy;if(!n&&q&&A&&o[0].parentTId&&A==o[0].parentTId&&B==_final.move.TYPE_INNER&&(q=null),q){var r=null==A?null:a._getNodeCache(w,A);if(0==a._apply(g.beforeDrop,[w.treeId,o,r,B,n,j],!0))return void a._selectNodes(x,o);var s=n?a._clone(o):o;B==_final.move.TYPE_INNER&&a._canAsync(w,r)?a._asyncNode(w,r,!1,c):c()}else a._selectNodes(x,o),a.element.trigger(_final.event.DROP,[b,j.treeId,o,null,null,null])}}function f(){return!1}var g=a.options;event=c;var h,i,j=a._getSetting(g.treeId),k=a._getRoot(j),l=a._getRoots();if(2==event.button||!j.editable||!j.dragIsCopy&&!j.dragIsMove)return!0;var m=event.target,n=a._getRoot(j).curSelectedList,o=[];if(a._isSelectedNode(j,b))for(h=0,i=n.length;i>h;h++){if(n[h].editNameFlag&&a._eqs(m.tagName,"input")&&null!==m.getAttribute("treeNode"+_final.id.INPUT))return!0;if(o.push(n[h]),o[0].parentTId!==n[h].parentTId){o=[b];break}}else o=[b];a._editNodeBlur=!0,a._cancelCurEditNode(j);var p,q,r,s,t=$(a.element.get(0).ownerDocument),u=$(a.element.get(0).ownerDocument.body),v=!1,w=j,x=j,y=null,z=null,A=null,B=_final.move.TYPE_INNER,C=a.clientX,D=a.clientY,E=(new Date).getTime();return a._uCanDo(j)&&t.bind("mousemove",d),t.bind("mouseup",e),t.bind("selectstart",f),a.preventDefault&&a.preventDefault(),!0},_apply:function(a,b,c){if(a==c&&!$.isFunction(a))return c;if("undefined"==typeof a||null==a)return c;var d,e,f;return d=$.coral.toFunction(a),$.isFunction(d)?(e=d.apply(f||this,b?b:[]),"undefined"==typeof e?c:e):c},_canAsync:function(a,b){var c=a.keyChildren;return a.asyncEnable&&b&&b.isParent&&!(b.zAsync||b[c]&&b[c].length>0)},_clone:function(a){var b=this;if(null===a)return null;var c=b._isArray(a)?[]:{};for(var d in a)c[d]=a[d]instanceof Date?new Date(a[d].getTime()):"object"==typeof a[d]?this._clone(a[d]):a[d];return c},_eqs:function(a,b){return a.toLowerCase()===b.toLowerCase()},_isArray:function(a){return"[object Array]"===Object.prototype.toString.apply(a)},_$:function(a,b,c){return b&&"string"!=typeof b&&(c=b,b=""),"string"==typeof a?$(a,c?this.element.get(0).ownerDocument:null):$("#"+a.tId+b,c?this.element:null)},_getMDom:function(a,b,c){if(!b)return null;for(;b&&b.id!==a.treeId;){for(var d=0,e=c.length;b.tagName&&e>d;d++)if(this._eqs(b.tagName,c[d].tagName)&&null!==b.getAttribute(c[d].attrName))return b;b=b.parentNode}return null},_getNodeMainDom:function(a){return $(a).parent("li").get(0)||$(a).parentsUntil("li").parent().get(0)},_isChildOrSelf:function(a,b){return $(a).closest("#"+b).length>0},_getAbs:function(a){var b=a.getBoundingClientRect(),c=document.body.scrollTop+document.documentElement.scrollTop,d=document.body.scrollLeft+document.documentElement.scrollLeft;return[b.left+d,b.top+c]},_inputFocus:function(a){a.get(0)&&(a.focus(),this._setCursorPosition(a.get(0),a.val().length))},_inputSelect:function(a){a.get(0)&&(a.focus(),a.select())},_setCursorPosition:function(a,b){if(a.setSelectionRange)a.focus(),a.setSelectionRange(b,b);else if(a.createTextRange){var c=a.createTextRange();c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",b),c.select()}},_showIfameMask:function(a,b){for(var c=this._getRoot(a);c.dragMaskList.length>0;)c.dragMaskList[0].remove(),c.dragMaskList.shift();if(b)for(var d=this._$("iframe",a),e=0,f=d.length;f>e;e++){var g=d.get(e),h=this._getAbs(g),i=this._$("<div id='treeMask_"+e+"' class='treeMask' style='top:"+h[1]+"px; left:"+h[0]+"px; width:"+g.offsetWidth+"px; height:"+g.offsetHeight+"px;'></div>",a);i.appendTo(this._$("body",a)),c.dragMaskList.push(i)}},_addNodes:function(a,b,c,d){if(!a.keepLeaf||!b||b.isParent)if(this._isArray(c)||(c=[c]),a.simpleDataEnable&&(c=this._transformToTreeFormat(a,c)),b){var e=this._$(b,_final.id.SWITCH,a),f=this._$(b,_final.id.ICON,a),g=this._$(b,_final.id.UL,a);b.open||(this._replaceSwitchClass(b,e,_final.arrow.RIGHT),this._replaceIcoClass(b,f,_final.folder.CLOSE),b.open=!1,g.css({display:"none"})),this._addNodesData(a,b,c),this._createNodes(a,b.level+1,c,b),d||this._expandCollapseParentNode(a,b,!0)}else this._addNodesData(a,this._getRoot(a),c),this._createNodes(a,0,c,null)},_appendNodes1:function(a,b,c,d,e,f){if(!c)return[];for(var g=[],h=a.keyChildren,i=0,j=c.length;j>i;i++){var k=c[i];if(e){var l=d?d:this._getRoot(a),m=l[h],n=m.length==c.length&&0==i,o=i==c.length-1;this._initNode(a,b,k,d,n,o,f),this._addNodeCache(a,k)}var p=[];k[h]&&k[h].length>0&&(p=this._appendNodes(a,b+1,k[h],k,e,f&&k.open)),f&&(this._makeDOMNodeMainBefore(g,a,k),this._makeDOMNodeNameBefore(g,a,k),this._addDiyDom(g,a,k),this._makeDOMNodeLine(g,a,k),this._getBeforeA(a,k,g),this._getInnerBeforeA(a,k,g),this._makeDOMNodeIcon(g,a,k),this._getInnerAfterA(a,k,g),this._makeDOMNodeNameAfter(g,a,k),this._getAfterA(a,k,g),k.isParent&&k.open&&this._makeUlHtml(a,k,g,p.join("")),this._makeDOMNodeMainAfter(g,a,k),this._addCreatedNode(a,k))}return g},_appendParentULDom:function(a,b){var c=[],d=this._$(b,a);!d.get(0)&&b.parentTId&&(this._appendParentULDom(a,b.getParentNode()),d=this._$(b,a));var e=this._$(b,_final.id.UL,a);e.get(0)&&e.remove();var f=a.keyChildren,g=this._appendNodes(a,b.level+1,b[f],b,!1,!0);this._makeUlHtml(a,b,c,g.join("")),d.append(c.join(""))},_asyncNode:function(setting,node,isSilent,callback,opts){var opts=opts||{},that=this,i,l,isInit=setting.isInit;if(node&&!node.isParent)return this._apply(callback),!1;if(node&&node.isAjaxing)return!1;if(0==that._apply(setting.beforeAsync,[setting.treeId,node,setting],!0))return this._apply(callback),!1;if(node){node.isAjaxing=!0;var icoObj=that._$(node,_final.id.ICON,setting);icoObj.attr({style:"","class":_final.className.BUTTON+" "+_final.className.ICO_LOADING})}var tmpParam={},asyncOtherParam=opts.asyncOtherParam||setting.asyncOtherParam,autoParams=setting.asyncAutoParam.split(","),isInit=setting.isInit;for(i=0,l=autoParams.length;node&&l>i;i++){var pKey=autoParams[i].split("="),spKey=pKey;pKey.length>1&&(spKey=pKey[1],pKey=pKey[0]),tmpParam[spKey]=node[pKey]}if(this._isArray(asyncOtherParam))for(i=0,l=asyncOtherParam.length;l>i;i+=2)tmpParam[asyncOtherParam[i]]=asyncOtherParam[i+1];else for(var p in asyncOtherParam)tmpParam[p]=asyncOtherParam[p];var _tmpV=this._getRoot(setting)._ver,asyncUrl=this._apply(setting.asyncUrl,[setting.treeId,node,opts],setting.asyncUrl);return $.ajax({contentType:setting.asyncContentType,type:setting.asyncType,url:asyncUrl,data:tmpParam,dataType:setting.asyncDataType,success:function(msg){if(_tmpV==that._getRoot(setting)._ver){var newNodes=[];try{newNodes=msg&&0!=msg.length?"string"==typeof msg?eval("("+msg+")"):msg:[]}catch(err){newNodes=msg}node&&(node.isAjaxing=null,node.zAsync=!0),that._setNodeLineIcos(setting,node),newNodes&&""!==newNodes?(isInit&&(newNodes=that._createRootNodes(setting,newNodes)),newNodes=that._apply(setting.asyncDataFilter,[setting.treeId,node,newNodes,setting],newNodes),that._addNodes(setting,node,newNodes?that._clone(newNodes):[],!!isSilent)):(isInit&&(newNodes=that._createRootNodes(setting,newNodes)),that._addNodes(setting,node,rootNodes,!!isSilent)),opts.onLoad?that._apply(opts.onLoad,[setting.treeId,node,msg]):that.element.trigger(_final.event.ASYNC_SUCCESS,[setting.treeId,node,msg]),that._apply(callback)}},error:function(a,b,c){_tmpV==that._getRoot(setting)._ver&&(node&&(node.isAjaxing=null),that._setNodeLineIcos(setting,node),that.element.trigger(_final.event.ASYNC_ERROR,[setting.treeId,node,a,b,c]))}}),!0},_addEditBtn:function(a,b){var c=this;if(!(b.editNameFlag||this._$(b,_final.id.EDIT,a).length>0)&&this._apply(a.showRenameBtn,[a.treeId,b,a],a.showRenameBtn)){var d=this._$(b,_final.id.A,a),e="<span class='"+_final.className.BUTTON+" "+_final.editIcon+" edit' id='"+b.tId+_final.id.EDIT+"' title='"+this._apply(a.renameTitle,[a.treeId,b,a],a.renameTitle)+"' treeNode"+_final.id.EDIT+" style='display:none;'></span>";d.append(e),this._$(b,_final.id.EDIT,a).bind("click",function(){return c._uCanDo(a)&&0!=c._apply(a.beforeEditName,[a.treeId,b,a],!0)?(c._editNode(a,b),!1):!1}).show()}},_addRemoveBtn:function(a,b){var c=this;if(!(b.editNameFlag||this._$(b,_final.id.REMOVE,a).length>0)&&this._apply(a.showRemoveBtn,[a.treeId,b,a],a.showRemoveBtn)){var d=this._$(b,_final.id.A,a),e="<span class='"+_final.className.BUTTON+" "+_final.removeIcon+" remove' id='"+b.tId+_final.id.REMOVE+"' title='"+this._apply(a.removeTitle,[a.treeId,b,a],a.removeTitle)+"' treeNode"+_final.id.REMOVE+" style='display:none;'></span>";d.append(e),this._$(b,_final.id.REMOVE,a).bind("click",function(){return c._uCanDo(a)&&0!=c._apply(a.beforeRemove,[a.treeId,b,a],!0)?(c._removeNode(a,b),c.element.trigger(_final.event.REMOVE,[a.treeId,b]),!1):!1}).bind("mousedown",function(a){return!0}).show()}},_addHoverDom:function(a,b){this._getRoots().showHoverDom&&(b.isHover=!0,a.editable&&(this._addEditBtn(a,b),this._addRemoveBtn(a,b)),this._$(b,_final.id.A,a).addClass(_final.node.CURHOVER),this._apply(a.addHoverDom,[a.treeId,b,a]))},_cancelPreSelectedNode1:function(a,b){for(var c=this._getRoot(a).curSelectedList,d=0,e=c.length-1;e>=d;e--)if((!b||b===c[e])&&(this._$(c[e],_final.id.A,a).removeClass(_final.node.CURSELECTED),b)){this._removeSelectedNode(a,b);break}b||(this._getRoot(a).curSelectedList=[])},_createNodeCallback:function(a){if(a.onNodeCreated||a.addDiyDom)for(var b=this._getRoot(a);b.createdNodes.length>0;){var c=b.createdNodes.shift();this._apply(a.addDiyDom,[a.treeId,c,a]),a.onNodeCreated&&this.element.trigger(_final.event.NODECREATED,[a.treeId,c])}},_createRootNodes:function(a,b){return a.simpleDataEnable&&(b=this._transformToTreeFormat(a,b)),1==a.showRootNode?a.rootNode&&"boolean"!=typeof a.rootNode&&(a.rootNode.children=b,b=[a.rootNode]):"boolean"==typeof a.rootNode&&a.rootNode&&b.length>=1&&(b=b[0].children&&b[0].children.length>0?b[0].children:[]),b},_createNodes1:function(a,b,c,d){if(c&&0!=c.length){var e=this._getRoot(a),f=a.keyChildren,g=!d||d.open||!!this._$(d[f][0],a).get(0);e.createdNodes=[];var h=this._appendNodes(a,b,c,d,!0,g);if(d){var i=this._$(d,_final.id.UL,a);i.get(0)&&i.append(h.join(""))}else this.element.append(h.join(""));a.isInit=!1,this._createNodeCallback(a)}},_checkNodeRelation:function(a,b){var c,d,e,f=a.keyChildren,g=a.keyChecked,h=_final.radio;if(a.chkStyle==h.STYLE){var i=this._getRadioCheckedList(a);if(b[g])if(a.radioType==h.TYPE_ALL){for(d=i.length-1;d>=0;d--)c=i[d],c[g]&&c!=b&&(c[g]=!1,i.splice(d,1),this._setChkClass(a,this._$(c,_final.id.CHECK,a),c),c.parentTId!=b.parentTId&&this._repairParentChkClassWithSelf(a,c));i.push(b)}else{var j=b.parentTId?b.getParentNode():this._getRoot(a);for(d=0,e=j[f].length;e>d;d++)c=j[f][d],c[g]&&c!=b&&(c[g]=!1,this._setChkClass(a,this._$(c,_final.id.CHECK,a),c))}else if(a.radioType==h.TYPE_ALL)for(d=0,e=i.length;e>d;d++)if(b==i[d]){i.splice(d,1);break}}else b[g]&&(!b[f]||0==b[f].length||a.chkboxType.Y.indexOf("s")>-1)&&this._setSonNodeCheckBox(a,b,!0),b[g]||b[f]&&0!=b[f].length&&!(a.chkboxType.N.indexOf("s")>-1)||this._setSonNodeCheckBox(a,b,!1),b[g]&&a.chkboxType.Y.indexOf("p")>-1&&this._setParentNodeCheckBox(a,b,!0),!b[g]&&a.chkboxType.N.indexOf("p")>-1&&this._setParentNodeCheckBox(a,b,!1)},_cancelCurEditNode:function(a,b,c){var d=this._getRoot(a),e=a.keyName,f=d.curEditNode;if(f){var g=d.curEditInput,h=b?b:c?f[e]:g.val();if(this._apply(a.beforeReName,[a.treeId,f,h,c,a],!0)===!1)return!1;f[e]=h,this.element.trigger(_final.event.RENAME,[a.treeId,f,c]);var i=this._$(f,_final.id.A,a);i.removeClass(_final.node.CURSELECTED_EDIT),g.unbind(),this._setNodeName(a,f),f.editNameFlag=!1,d.curEditNode=null,d.curEditInput=null,this._selectNode(a,f,!1)}return d.noSelection=!0,!0},_editNode:function(a,b){var c=this,d=this._getRoot(a);if(this._editNodeBlur=!1,this._isSelectedNode(a,b)&&d.curEditNode==b&&b.editNameFlag)return void setTimeout(function(){this._inputFocus(d.curEditInput)},0);var e=a.keyName;b.editNameFlag=!0,this._removeTreeDom(a,b),this._cancelCurEditNode(a),this._selectNode(a,b,!1),this._$(b,_final.id.SPAN,a).html("<input type=text class='rename' id='"+b.tId+_final.id.INPUT+"' treeNode"+_final.id.INPUT+" >");var f=this._$(b,_final.id.INPUT,a);f.attr("value",b[e]),a.editNameSelectAll?this._inputSelect(f):this._inputFocus(f),f.bind("blur",function(b){c._editNodeBlur||c._cancelCurEditNode(a)}).bind("keydown",function(b){"13"==b.keyCode?(c._editNodeBlur=!0,c._cancelCurEditNode(a)):"27"==b.keyCode&&c._cancelCurEditNode(a,null,!0)}).bind("click",function(a){return!1}).bind("dblclick",function(a){return!1}),this._$(b,_final.id.A,a).addClass(_final.node.CURSELECTED_EDIT),d.curEditInput=f,d.noSelection=!1,d.curEditNode=b},_destroy:function(a){a&&(this._initCache(a),this._initRoot(a),this._unbindTree(a),this._unbindEvent(a),this.element.empty(),delete settings[a.treeId])},_expandCollapseNode:function(a,b,c,d,e){var f=this,g=this._getRoot(a),h=a.keyChildren;if(!b)return void f._apply(e,[]);if(g.expandTriggerFlag){var i=e;e=function(){i&&i(),b.open?f.element.trigger(_final.event.EXPAND,[a.treeId,b]):f.element.trigger(_final.event.COLLAPSE,[a.treeId,b])},g.expandTriggerFlag=!1}if(!b.open&&b.isParent&&(!this._$(b,_final.id.UL,a).get(0)||b[h]&&b[h].length>0&&!this._$(b[h][0],a).get(0))&&(this._appendParentULDom(a,b),this._createNodeCallback(a)),b.open==c)return void this._apply(e,[]);var j=this._$(b,_final.id.UL,a),k=this._$(b,_final.id.SWITCH,a),l=this._$(b,_final.id.ICON,a);b.isParent?(b.open=!b.open,b.iconOpen&&b.iconClose&&l.attr("style",this._makeNodeIcoStyle(a,b)),b.open?(this._replaceSwitchClass(b,k,_final.arrow.DOWN),this._replaceIcoClass(b,l,_final.folder.OPEN),0==d||""==a.expandSpeed?(j.show(),this._apply(e,[])):b[h]&&b[h].length>0?j.slideDown(a.expandSpeed,e):(j.show(),this._apply(e,[]))):(this._replaceSwitchClass(b,k,_final.arrow.RIGHT),this._replaceIcoClass(b,l,_final.folder.CLOSE),0!=d&&""!=a.expandSpeed&&b[h]&&b[h].length>0?j.slideUp(a.expandSpeed,e):(j.hide(),this._apply(e,[])))):this._apply(e,[])},_expandCollapseParentNode:function(a,b,c,d,e){if(b){if(!b.parentTId)return void this._expandCollapseNode(a,b,c,d,e);this._expandCollapseNode(a,b,c,d),b.parentTId&&this._expandCollapseParentNode(a,b.getParentNode(),c,d,e)}},_expandCollapseSonNode:function(a,b,c,d,e){var f=this._getRoot(a),g=a.keyChildren,h=b?b[g]:f[g],i=b?!1:d,j=this._getRoot(a).expandTriggerFlag;if(this._getRoot(a).expandTriggerFlag=!1,h)for(var k=0,l=h.length;l>k;k++)h[k]&&this._expandCollapseSonNode(a,h[k],c,i);this._getRoot(a).expandTriggerFlag=j,this._expandCollapseNode(a,b,c,d,e)},_makeDOMNodeIcon:function(a,b,c){var d=this._getNodeName(b,c),e=b.nameIsHTML?d:d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");b.formatter&&(e=this._apply(b.formatter,[b,c,e,b],b.formatter)),a.push("<span id='",c.tId,_final.id.ICON,"' title='' treeNode",_final.id.ICON," class='",this._makeNodeIcoClass(b,c),"' style='",this._makeNodeIcoStyle(b,c),"'></span><span id='",c.tId,_final.id.SPAN,"' class='coral-tree-node-name'>",e,"</span>")},_makeDOMNodeLine:function(a,b,c){a.push("<span id='",c.tId,_final.id.SWITCH,"' title='' class='",this._makeNodeLineClass(b,c),"' treeNode",_final.id.SWITCH,"></span>")},_makeDOMNodeMainAfter:function(a,b,c){a.push("</li>")},_makeDOMNodeMainBefore:function(a,b,c){a.push("<li ",c.hidden?"style='display:none;' ":"","id='",c.tId,"' class='",_final.className.LEVEL,c.level,"' tabindex='0' hidefocus='true' treenode>")},_makeDOMNodeNameAfter:function(a,b,c){a.push("</a>")},_makeDOMNodeNameBefore:function(a,b,c){var d=this._getNodeTitle(b,c),e=this._makeNodeUrl(b,c),f=this._makeNodeFontCss(b,c),g=[];for(var h in f)g.push(h,":",f[h],";");a.push("<a id='",c.tId,_final.id.A,"' class='",_final.className.LEVEL,c.level,c.nodeDisabled===!0?" coral-state-disabled":"","' treeNode",_final.id.A,' onclick="',c.click||"",'" ',1==c.nodeDisabled?"title='"+b.disabledMessage+"'":"",null!=e&&e.length>0?"href='"+e+"'":""," target='",this._makeNodeTarget(c),"' style='",g.join(""),"'"),this._apply(1==c.nodeDisabled||b.showTitle,[b.treeId,c,b],b.showTitle)&&d&&a.push("title='",d.replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"'"),a.push(">")},_addDiyDom:function(a,b,c){c.level>0&&a.push(this._getIndent(b,c))},_getIndent:function(a,b){var c=16;if(b.getParentNode()){var d="",e=["cui-icon"];return b.getParentNode().getNextNode()?(a.showLine?e.push(_final.line.LINE):e.push(_final.line.NOLINE),d="<span class='treeLine "+e.join("-")+"' style='width:"+c+"px;'></span>"):d="<span class='treeIndent' style='width:"+c+"px;'></span>",this._getIndent(a,b.getParentNode())+d}return""},_makeNodeFontCss:function(a,b){var c=this._apply(a.fontCss,[a.treeId,b,a],a.fontCss);return c&&"function"!=typeof c?c:{}},_makeNodeIcoClass:function(a,b){var c=b.isParent&&b.iconOpen&&b.iconClose?b.open?b.iconOpen:b.iconClose:b.icon,d=b.isParent?" coral-tree-icon-parent":" coral-tree-icon-leaf";if(c)return 1==a.iconUrl?_final.className.BUTTON:_final.className.BUTTON+" "+c;var e=["cui-icon"];return b.isAjaxing||(e[0]=(b.iconSkin?b.iconSkin+"-":"")+e[0],a.showIcon&&(b.isParent?e.push(b.open?_final.folder.OPEN:_final.folder.CLOSE):e.push(_final.folder.FILE))),_final.className.BUTTON+d+" "+e.join("-")},_makeNodeIcoStyle:function(a,b){var c=[];if(!b.isAjaxing){var d=b.isParent&&b.iconOpen&&b.iconClose?b.open?b.iconOpen:b.iconClose:b.icon;d&&(1==a.iconUrl?c.push("background:url(",d,") 0 0 no-repeat;"):this._makeNodeIcoClass(a,b)),0!=a.showIcon&&this._apply(a.showIcon,[a.treeId,b,a],!0)||c.push("width:0px;height:0px;display:none")}return c.join("")},_makeNodeLineClass:function(a,b){var c=[],d="cui-icon-";return 1==a.showLine?b.isParent?c.push(b.open?_final.arrow.DOWN:_final.arrow.RIGHT):b.isLastNode?(c.push(_final.line.BOTTOM),d="cui-icon-"):(c.push(_final.line.CENTER),d="cui-icon-"):b.isParent?c.push(b.open?_final.arrow.DOWN:_final.arrow.RIGHT):c.push(_final.folder.DOCU),this._makeNodeLineClassEx(b)+d+c.join("-")},_makeNodeLineClassEx:function(a){return _final.className.BUTTON+" "+_final.className.LEVEL+a.level+" "+_final.className.SWITCH+" "},_makeNodeTarget:function(a){return a.target||"_blank"},_makeNodeUrl1:function(a,b){var c=a.keyUrl;return b[c]?b[c]:null},_makeUlHtml:function(a,b,c,d){c.push("<ul id='",b.tId,_final.id.UL,"' class='",_final.className.LEVEL,b.level," ",this._makeUlLineClass(a,b),"' style='display:",b.open?"block":"none","'>"),c.push(d),c.push("</ul>")},_makeUlLineClass:function(a,b){return a.showLine&&!b.isLastNode?_final.line.LINE:""},_makeChkClass:function(a,b){var c,d=a.keyChecked,e=_final.checkbox,f=_final.radio,g="",h="";return a.chkStyle==f.STYLE?(g=b.check_Child_State<1?e.CHECKED:e.PARTIAL,c="cui-icon-"+a.chkStyle+"-"+(b[d]?e.CHECKED:e.UNCHECKED),c+=g==e.PARTIAL?e.PARTIAL:""):(g=b.halfCheck?e.PARTIAL:b[d]?2===b.check_Child_State||-1===b.check_Child_State?e.CHECKED:e.PARTIAL:b.check_Child_State<1?e.UNCHECKED:e.PARTIAL,c="cui-icon-"+a.chkStyle+"-"+(g==e.PARTIAL?(b[d]?e.CHECKED:e.UNCHECKED)+e.PARTIAL:g)),h=b.check_Focus&&b.chkDisabled!==!0?e.FOCUS:1==b.chkDisabled?e.DISABLED:e.DEFAULT,_final.className.BUTTON+" "+h+" "+c},_addLine:function(a,b,c){var d="undefined"==typeof c?1:0,e="",f=this._transformToArrayFormat(a,b);for(null!=c&&null!=b.level&&(e=("undefined"==typeof c?0:c)-("undefined"==typeof b.level?0:b.level)),d;d<f.length;d++)this._$(f[d],_final.id.A,a).find("span:lt("+(f[d].level+e)+")").remove(),this._$(f[d],_final.id.A,a).prepend(this._getIndent(a,f[d]))},_lineClass:function(a,b){var c=[];return c=a.isParent?a.open?_final.arrow.DOWN:_final.arrow.RIGHT:b?0==a.level&&a.isLastNode&&a.isFirstNode?_final.line.NOLINE:0==a.level&&a.isFirstNode&&!a.isLastNode?_final.line.ROOTS:a.isLastNode?_final.line.BOTTOM:_final.line.CENTER:_final.line.NOLINE},_moveNode:function(a,b,c,d,e,f){var g=this._getRoot(a),h=a.keyChildren;if(b!=c&&(!a.keepLeaf||!b||b.isParent||d!=_final.move.TYPE_INNER)){var i=c.parentTId?c.getParentNode():g,j=i.level;targetNodeIsRoot=null===b||b==g,targetNodeIsRoot&&null===b&&(b=g),targetNodeIsRoot&&(d=_final.move.TYPE_INNER);var k=b.parentTId?b.getParentNode():g;d!=_final.move.TYPE_PREV&&d!=_final.move.TYPE_NEXT&&(d=_final.move.TYPE_INNER),d==_final.move.TYPE_INNER&&(targetNodeIsRoot?c.parentTId=null:(b.isParent||(b.isParent=!0,b.open=!!b.open,this._setNodeLineIcos(a,b)),c.parentTId=b.tId));var l,m;if(targetNodeIsRoot)l=this.element,m=l;else{if(f||d!=_final.move.TYPE_INNER?f||this._expandCollapseNode(a,b.getParentNode(),!0,!1):this._expandCollapseNode(a,b,!0,!1),l=this._$(b,a),m=this._$(b,_final.id.UL,a),l.get(0)&&!m.get(0)){var n=[];this._makeUlHtml(a,b,n,""),l.append(n.join(""))}m=this._$(b,_final.id.UL,a)}var o=this._$(c,a);o.get(0)?l.get(0)||o.remove():o=this._appendNodes(a,c.level,[c],null,!1,!0).join(""),m.get(0)&&d==_final.move.TYPE_INNER?m.append(o):l.get(0)&&d==_final.move.TYPE_PREV?l.before(o):l.get(0)&&d==_final.move.TYPE_NEXT&&l.after(o);var p,q,r=[],s=-1,t=0,u=null,v=null,w=null,x=null,y=c.level;if(c.isFirstNode)s=0,i[h].length>1&&(u=i[h][1],u.isFirstNode=!0,w=u.level);else if(c.isLastNode)s=i[h].length-1,u=i[h][s-1],u.isLastNode=!0,w=u.level;else for(p=0,q=i[h].length;q>p;p++)if(i[h][p].tId==c.tId){s=p;break}if(s>=0&&i[h].splice(s,1),d!=_final.move.TYPE_INNER)for(p=0,q=k[h].length;q>p;p++)k[h][p].tId==b.tId&&(t=p);d==_final.move.TYPE_INNER?(b[h]||(b[h]=new Array),b[h].length>0&&(v=b[h][b[h].length-1],v.isLastNode=!1,x=v.level),b[h].splice(b[h].length,0,c),c.isLastNode=!0,c.isFirstNode=1==b[h].length):b.isFirstNode&&d==_final.move.TYPE_PREV?(k[h].splice(t,0,c),v=b,v.isFirstNode=!1,x=v.level,c.parentTId=b.parentTId,c.isFirstNode=!0,c.isLastNode=!1):b.isLastNode&&d==_final.move.TYPE_NEXT?(k[h].splice(t+1,0,c),v=b,v.isLastNode=!1,x=v.level,c.parentTId=b.parentTId,c.isFirstNode=!1,c.isLastNode=!0):(d==_final.move.TYPE_PREV?k[h].splice(t,0,c):k[h].splice(t+1,0,c),c.parentTId=b.parentTId,c.isFirstNode=!1,c.isLastNode=!1),this._fixPIdKeyValue(a,c),this._setSonNodeLevel(a,c.getParentNode(),c);var z=this._$(c,_final.id.SWITCH,a);if(this._setNodeLineIcos(a,c),this._repairNodeLevelClass(a,c,y),this._addLine(a,c,y),r=this._lineClass(c,a.showLine),this._replaceSwitchClass(c,z,r),!a.keepParent&&i[h].length<1){i.isParent=!1,i.open=!1;var A=this._$(i,_final.id.UL,a),B=this._$(i,_final.id.SWITCH,a),C=this._$(i,_final.id.ICON,a);r=this._lineClass(i,a.showLine),this._replaceSwitchClass(i,B,r),this._replaceIcoClass(i,C,_final.folder.FILE),A.css("display","none"),this._addLine(a,i,j)}else u&&(this._setNodeLineIcos(a,u),this._addLine(a,u,w));v&&(B=this._$(v,_final.id.SWITCH,a),this._setNodeLineIcos(a,v),this._addLine(a,v,x),r=this._lineClass(v,a.showLine),this._replaceSwitchClass(v,B,r)),a.check&&a.checkable&&this._repairChkClass&&(this._repairChkClass(a,i),this._repairParentChkClassWithSelf(a,i),i!=c.parent&&this._repairParentChkClassWithSelf(a,c)),f||this._expandCollapseParentNode(a,c.getParentNode(),!0,e)}},_removeChildNodes:function(a,b){if(b){var c=a.keyChildren,d=b[c];if(d){for(var e=0,f=d.length;f>e;e++)this._removeNodeCache(a,d[e]);if(this._removeSelectedNode(a),delete b[c],a.keepParent)this._$(b,_final.id.UL,a).empty();else{b.isParent=!1,b.open=!1;var g=this._$(b,_final.id.SWITCH,a),h=this._$(b,_final.id.ICON,a);this._replaceSwitchClass(b,g,_final.line.CENTER),this._replaceIcoClass(b,h,_final.line.CENTER),this._$(b,_final.id.UL,a).remove()}}}},_showNode:function(a,b,c){b.hidden=!1,this._initShowForExCheck(a,b),this._$(b,a).show(),"undefined"!=typeof c&&"undefined"!=typeof c.showParents&&c.showParents&&null!==b.getParentNode()&&this._showNode(a,b.getParentNode(),c)},_initShowForExCheck:function(a,b){if(!b.hidden&&a.checkable){if("undefined"!=typeof b._nocheck&&(b.nocheck=b._nocheck,delete b._nocheck),this._setChkClass){var c=this._$(b,_final.id.CHECK,a);this._setChkClass(a,c,b)}this._repairParentChkClassWithSelf&&this._repairParentChkClassWithSelf(a,b)}},_showNodes:function(a,b,c){if(b&&0!=b.length){var d,e,f={};for(d=0,e=b.length;e>d;d++){var g=b[d];if(!f[g.parentTId]){var h=g.getParentNode();f[g.parentTId]=null===h?this._getRoot(a):g.getParentNode()}this._showNode(a,g,c)}for(var i in f){var j=f[i][a.keyChildren];this._setFirstNodeForShow(a,j),this._setLastNodeForShow(a,j)}}},_setFirstNodeForShow:function(a,b){var c,d,e,f,g;for(d=0,e=b.length;e>d;d++){if(c=b[d],!f&&!c.hidden&&c.isFirstNode){f=c;break}if(f||c.hidden||c.isFirstNode){if(f&&c.isFirstNode){c.isFirstNode=!1,g=c,this._setNodeLineIcos(a,c);break}c=null}else c.isFirstNode=!0,f=c,this._setNodeLineIcos(a,c)}return{"new":f,old:g}},_setLastNodeForShow:function(a,b){var c,d,e,f;for(d=b.length-1;d>=0;d--){if(c=b[d],!e&&!c.hidden&&c.isLastNode){e=c;break}if(e||c.hidden||c.isLastNode){if(e&&c.isLastNode){c.isLastNode=!1,f=c,this._setNodeLineIcos(a,c);break}c=null}else c.isLastNode=!0,e=c,this._setNodeLineIcos(a,c)}return{"new":e,old:f}},_hideNode:function(a,b,c){b.hidden=!0,b.isFirstNode=!1,b.isLastNode=!1,this._initHideForExCheck(a,b),this._cancelPreSelectedNode(a,b),this._$(b,a).hide()},_initHideForExCheck:function(a,b){b.hidden&&a.checkable&&("undefined"==typeof b._nocheck&&(b._nocheck=!!b.nocheck,b.nocheck=!0),b.check_Child_State=-1,
this._repairParentChkClassWithSelf&&this._repairParentChkClassWithSelf(a,b))},_hideNodes:function(a,b,c){if(b&&0!=b.length){var d,e,f={};for(d=0,e=b.length;e>d;d++){var g=b[d];if((g.isFirstNode||g.isLastNode)&&!f[g.parentTId]){var h=g.getParentNode();f[g.parentTId]=null===h?this._getRoot(a):g.getParentNode()}this._hideNode(a,g,c)}for(var i in f){var j=f[i][a.keyChildren];this._setFirstNodeForHide(a,j),this._setLastNodeForHide(a,j)}}},_setFirstNodeForHide:function(a,b){var c,d,e;for(d=0,e=b.length;e>d&&(c=b[d],!c.isFirstNode);d++){if(!c.hidden&&!c.isFirstNode){c.isFirstNode=!0,this._setNodeLineIcos(a,c);break}c=null}return c},_setLastNodeForHide:function(a,b){var c,d;for(d=b.length-1;d>=0&&(c=b[d],!c.isLastNode);d--){if(!c.hidden&&!c.isLastNode){c.isLastNode=!0,this._setNodeLineIcos(a,c);break}c=null}return c},_setFirstNode:function(a,b){var c=a.keyChildren,d=b[c].length;d>0&&(b[c][0].isFirstNode=!0)},_setLastNode:function(a,b){var c=a.keyChildren,d=b[c].length;d>0&&(b[c][d-1].isLastNode=!0)},_removeNode2:function(a,b){var c=this._getRoot(a),d=[],e=a.keyChildren,f=(b.level,b.getPreNode(),b.getNextNode(),b.parentTId?b.getParentNode():c),g=f.level;if(b.isFirstNode=!1,b.isLastNode=!1,b.getPreNode=function(){return null},b.getNextNode=function(){return null},this._getNodeCache(a,b.tId)){this._$(b,a).remove(),this._removeNodeCache(a,b),this._removeSelectedNode(a,b);for(var h=0,i=f[e].length;i>h;h++)if(f[e][h].tId==b.tId){f[e].splice(h,1);break}this._setFirstNode(a,f),this._setLastNode(a,f);var j,k,l,m=f[e].length;if(a.keepParent||0!=m){if(a.showLine&&m>0){var n=f[e][m-1];if(j=this._$(n,_final.id.UL,a),k=this._$(n,_final.id.SWITCH,a),l=this._$(n,_final.id.ICON,a),f==c)if(1==f[e].length)this._replaceSwitchClass(n,k,_final.arrow.DOWN);else{var o=this._$(f[e][0],_final.id.SWITCH,a);this._replaceSwitchClass(f[e][0],o,f[e][0].isParent?1==f[e][0].open?_final.arrow.DOWN:_final.arrow.RIGHT:_final.line.ROOTS),n.isParent?this._replaceSwitchClass(n,k,1==b.open?_final.arrow.DOWN:_final.arrow.RIGHT):this._replaceSwitchClass(n,k,_final.line.BOTTOM)}else n.isParent?this._replaceSwitchClass(n,k,n.open?_final.arrow.DOWN:_final.arrow.RIGHT):this._replaceSwitchClass(n,k,_final.line.BOTTOM);this._addLine(a,f,g),j.removeClass(_final.line.LINE)}}else f.isParent=!1,f.open=!1,j=this._$(f,_final.id.UL,a),k=this._$(f,_final.id.SWITCH,a),l=this._$(f,_final.id.ICON,a),d=this._lineClass(f,a.showLine),this._replaceSwitchClass(f,k,d),this._replaceIcoClass(f,l,_final.folder.FILE),j.css("display","none")}},_replaceIcoClass:function(a,b,c){var d=a.isParent&&a.iconOpen&&a.iconClose?a.open?a.iconOpen:a.iconClose:a.icon;if(b&&!a.isAjaxing){var e=b.attr("class");if(void 0!=e){var f=e.split("-");switch(c){case _final.folder.OPEN:case _final.folder.CLOSE:case _final.folder.FILE:case _final.line.CENTER:case _final.line.BOTTOM:case _final.line.LINE:d?b.attr("class",f):(f[f.length-1]=c,b.attr("class",f.join("-")))}}}},_replaceSwitchClass:function(a,b,c){if(b){var d=b.attr("class");if(void 0!=d){var e=d.split("-");switch(c){case _final.arrow.DOWN:case _final.arrow.RIGHT:case _final.line.NOLINE:e[e.length-1]=c;break;case _final.folder.OPEN:case _final.folder.CLOSE:case _final.line.ROOTS:case _final.line.CENTER:case _final.line.BOTTOM:case _final.folder.DOCU:case _final.line.LINE:e[e.length-1]=c}b.attr("class",e.join("-")),c!==_final.folder.DOCU?b.removeAttr("disabled"):b.attr("disabled","disabled")}}},_repairAllChk:function(a,b){if(a.checkable&&a.chkStyle===_final.checkbox.STYLE)for(var c=a.keyChecked,d=a.keyChildren,e=this._getRoot(a),f=0,g=e[d].length;g>f;f++){var h=e[d][f];h.nocheck!==!0&&h.chkDisabled!==!0&&(h[c]=b),this._setSonNodeCheckBox(a,h,b)}},_repairChkClass:function(a,b){if(b&&(this._makeChkFlag(a,b),b.nocheck!==!0)){var c=this._$(b,_final.id.CHECK,a);this._setChkClass(a,c,b)}},_repairParentChkClass:function(a,b){if(b&&b.parentTId){var c=b.getParentNode();this._repairChkClass(a,c),this._repairParentChkClass(a,c)}},_repairParentChkClassWithSelf:function(a,b){if(b){var c=a.keyChildren;b[c]&&b[c].length>0?this._repairParentChkClass(a,b[c][0]):this._repairParentChkClass(a,b)}},_repairSonChkDisabled:function(a,b,c,d){if(b){var e=a.keyChildren;if(b.chkDisabled!=c&&(b.chkDisabled=c),this._repairChkClass(a,b),b[e]&&d)for(var f=0,g=b[e].length;g>f;f++){var h=b[e][f];this._repairSonChkDisabled(a,h,c,d)}}},_repairParentChkDisabled:function(a,b,c,d){b&&(b.chkDisabled!=c&&d&&(b.chkDisabled=c),this._repairChkClass(a,b),this._repairParentChkDisabled(a,b.getParentNode(),c,d))},_selectNode1:function(a,b,c){c||this._cancelPreSelectedNode(a),this._$(b,_final.id.A,a).addClass(_final.node.CURSELECTED),this._addSelectedNode(a,b)},_setNodeFontCss:function(a,b){var c=this._$(b,_final.id.A,a),d=this._makeNodeFontCss(a,b);d&&c.css(d)},_setNodeLineIcos:function(a,b){if(b){var c=this._$(b,_final.id.SWITCH,a),d=this._$(b,_final.id.UL,a),e=this._$(b,_final.id.ICON,a),f=this._makeUlLineClass(a,b);0==f.length?d.removeClass(_final.line.LINE):d.addClass(f),c.attr("class",this._makeNodeLineClass(a,b)),b.isParent?c.removeAttr("disabled"):c.attr("disabled","disabled"),e.removeAttr("style"),e.attr("style",this._makeNodeIcoStyle(a,b)),e.attr("class",this._makeNodeIcoClass(a,b))}},_setNodeName:function(a,b){var c=this._getNodeTitle(a,b),d=this._$(b,_final.id.SPAN,a);d.empty();var e="";if(e=a.formatter?this._apply(a.formatter,[a,b,a],a.formatter):this._getNodeName(a,b),a.nameIsHTML?d.html(e):d.text(e),this._apply(a.showTitle,[a.treeId,b,a],a.showTitle)){var f=this._$(b,_final.id.A,a);f.attr("title",c?c:"")}},_setNodeTarget:function(a,b){var c=this._$(b,_final.id.A,a);c.attr("target",this._makeNodeTarget(b))},_setNodeUrl:function(a,b){var c=this._$(b,_final.id.A,a),d=this._makeNodeUrl(a,b);null==d||0==d.length?c.removeAttr("href"):c.attr("href",d)},_switchNode:function(a,b){if(b.open||!this._canAsync(a,b))this._expandCollapseNode(a,b,!b.open);else if(a.asyncEnable){if(!this._asyncNode(a,b))return void this._expandCollapseNode(a,b,!b.open)}else b&&this._expandCollapseNode(a,b,!b.open)},_setChkClass:function(a,b,c){b&&(c.nocheck===!0?b.hide():b.show(),b.attr("class",this._makeChkClass(a,c)))},_setParentNodeCheckBox:function(a,b,c,d){var e=a.keyChildren,f=a.keyChecked,g=this._$(b,_final.id.CHECK,a);if(d||(d=b),this._makeChkFlag(a,b),b.nocheck!==!0&&b.chkDisabled!==!0&&(b[f]=c,this._setChkClass(a,g,b),a.autoCheckTrigger&&b!=d&&this.element.trigger(_final.event.CHECK,[null,a.treeId,b])),b.parentTId){var h=!0;if(!c)for(var i=b.getParentNode()[e],j=0,k=i.length;k>j;j++)if(i[j].nocheck!==!0&&i[j].chkDisabled!==!0&&i[j][f]||(i[j].nocheck===!0||i[j].chkDisabled===!0)&&i[j].check_Child_State>0){h=!1;break}h&&this._setParentNodeCheckBox(a,b.getParentNode(),c,d)}},_setSonNodeCheckBox:function(a,b,c,d){if(b){var e=a.keyChildren,f=a.keyChecked,g=this._$(b,_final.id.CHECK,a);d||(d=b);var h=!1;if(b[e])for(var i=0,j=b[e].length;j>i&&b.chkDisabled!==!0;i++){var k=b[e][i];this._setSonNodeCheckBox(a,k,c,d),k.chkDisabled===!0&&(h=!0)}b!=this._getRoot(a)&&b.chkDisabled!==!0&&(h&&b.nocheck!==!0&&this._makeChkFlag(a,b),b.nocheck!==!0&&b.chkDisabled!==!0?(b[f]=c,h||(b.check_Child_State=b[e]&&b[e].length>0?c?2:0:-1)):b.check_Child_State=-1,this._setChkClass(a,g,b),a.autoCheckTrigger&&b!=d&&b.nocheck!==!0&&b.chkDisabled!==!0&&this.element.trigger(_final.event.CHECK,[null,a.treeId,b]))}},_removeEditBtn:function(a,b){this._$(b,_final.id.EDIT,a).unbind().remove()},_removeRemoveBtn:function(a,b){this._$(b,_final.id.REMOVE,a).unbind().remove()},_removeTreeDom:function(a,b){b.isHover=!1,this._removeEditBtn(a,b),this._removeRemoveBtn(a,b),this._$(b,_final.id.A,a).removeClass(_final.node.CURHOVER),this._apply(a.removeHoverDom,[a.treeId,b,a])},_repairNodeLevelClass:function(a,b,c){if(c!==b.level){var d=this._$(b,a),e=this._$(b,_final.id.A,a),f=this._$(b,_final.id.UL,a),g=_final.className.LEVEL+c,h=_final.className.LEVEL+b.level;d.removeClass(g),d.addClass(h),e.removeClass(g),e.addClass(h),f.removeClass(g),f.addClass(h)}},_selectNodes:function(a,b){for(var c=0,d=b.length;d>c;c++)this._selectNode(a,b[c],c>0)},_createNodes:function(a,b,c,d){var e=this._createNodes1;e&&e.apply(this,arguments),c&&this._repairParentChkClassWithSelf&&this._repairParentChkClassWithSelf(a,d)},_removeNode1:function(a,b){var c=this._removeNode2,d=b.getParentNode();c&&c.apply(this,arguments),b&&d&&(this._repairChkClass(a,d),this._repairParentChkClass(a,d))},_appendNodes:function(a,b,c,d,e,f){var g=this._appendNodes1,h="";return g&&(h=g.apply(this,arguments)),d&&this._makeChkFlag(a,d),h},_cancelPreSelectedNode:function(a,b){_cancelPreSelectedNode=this._cancelPreSelectedNode1;for(var c=this._getRoot(a).curSelectedList,d=0,e=c.length;e>d&&(b&&b!==c[d]||(this._removeTreeDom(a,c[d]),!b));d++);_cancelPreSelectedNode&&_cancelPreSelectedNode.apply(this,arguments)},_makeNodeUrl:function(a,b){var c=this._makeNodeUrl1;return a.editable?null:c.apply(this,arguments)},_removeNode:function(a,b){var c=this._removeNode1,d=this._getRoot(a);d.curEditNode===b&&(d.curEditNode=null),c&&c.apply(this,arguments)},_selectNode:function(a,b,c){var d=this._selectNode1,e=this._getRoot(a);return this._isSelectedNode(a,b)&&e.curEditNode==b&&b.editNameFlag?!1:(d&&d.apply(this,arguments),this._addHoverDom(a,b),!0)},_uCanDo1:function(a,b){return!0},_uCanDo:function(a,b){var c=this._uCanDo1,d=this._getRoot(a);return b&&(this._eqs(b.type,"mouseover")||this._eqs(b.type,"mouseout")||this._eqs(b.type,"mousedown")||this._eqs(b.type,"mouseup"))?!0:(d.curEditNode&&(this._editNodeBlur=!1,d.curEditInput.focus()),!d.curEditNode&&(c?c.apply(this,arguments):!0))}});/*! cui 2016-11-08 */
$.component("coral.layout",{version:"4.1.4",options:{onCreate:null,fit:!1},layoutPanelDefault:{region:null,split:!1,showSplitIcon:!1,collapsedSize:30,minWidth:10,minHeight:10,maxWidth:1e4,maxHeight:1e4},resizing:!1,_resizeLayout:function(){function a(a){var b=a.panel("getOptions");return Math.min(Math.max(b.height,b.minHeight),b.maxHeight)}function b(a){var b=a.panel("getOptions");return Math.min(Math.max(b.width,b.minWidth),b.maxWidth)}function c(b,c){if(b.length&&e._isPanelVisible(b)){var d=b.panel("getOptions"),f=a(b),g="n"==c?"north":"south",h=i.find(">.coral-layout-panel-"+g).children(".ctrl-init-panel"),l=h.panel("getOptions");if(n.height-=f,"n"==c){var m=i.find(">.coral-layout-split-north");n.top+=f+j,!l.split&&d.border&&n.top--,m.css({top:f,left:0})}else{var o=i.find(">.coral-layout-split-south");o.css({top:i.height()-f-k,left:0})}b.panel("resize",{width:i.width(),height:f,left:0,top:"n"==c?0:i.height()-f}),!l.split&&d.border&&n.height++,d.border&&!$.support.boxSizing&&n.height-2}}function d(a,c){if(a.length&&e._isPanelVisible(a)){var d=a.panel("getOptions"),f="e"==c?"east":"west",g=i.find(">.coral-layout-panel-"+f).children(".ctrl-init-panel"),h=g.panel("getOptions"),j=b(a);if(a.panel("resize",{width:j,height:n.height,left:"e"==c?i.width()-j:0,top:n.top}),n.width-=j,"w"==c){var k=i.find(">.coral-layout-split-west");n.left+=j+l,k.css({height:n.height,top:n.top,left:j}),!h.split&&d.border&&n.left--}else{var o=i.find(">.coral-layout-split-east");o.css({height:n.height,top:n.top,left:i.width()-j-m})}!h.split&&d.border&&n.width++,$.support.boxSizing||n.width-2}}var e=this,f=this.element,g=e.options,h=e.panels,i=$(f);"body"==f[0].tagName.toLowerCase()?this._fit():g.fit?i.css(this._fit()):this._fit(!1);var j=i.find(">.coral-layout-split-north").height()||0,k=i.find(">.coral-layout-split-south").height()||0,l=i.find(">.coral-layout-split-west").width()||0,m=i.find(">.coral-layout-split-east").width()||0,n={top:0,left:0,width:i.width()-l-m,height:i.height()-k-j};c(this._isPanelVisible(h.expandNorth)?h.expandNorth:h.north,"n"),c(this._isPanelVisible(h.expandSouth)?h.expandSouth:h.south,"s"),d(this._isPanelVisible(h.expandEast)?h.expandEast:h.east,"e"),d(this._isPanelVisible(h.expandWest)?h.expandWest:h.west,"w"),h.center.panel("resize",n)},_splitLayout:function(a,b){var c=$(this.element).layout("panel",a);c.panel("options").split=b;var d="layout-split-"+a,e=c.panel("panel").removeClass(d);b&&e.addClass(d),e.resizable({disabled:!b}),this._resizeLayout()},_create:function(){function a(a){a.children("div").each(function(){var d=$.parser.parseOptions(this,[]);if("north,south,east,west,center".indexOf(d.region)>=0){b._addPanel(c,d,this);var e=a.layout("panel",d.region);e.panel("option").split&&b._addSplitIcon(c,d,this)}})}this.panels={center:$(),north:$(),south:$(),east:$(),west:$()};var b=this,c=this.element,d=$(c);d.addClass("coral-layout"),this.component().attr("component-id",this.options.id),a(d.children("form").length?d.children("form"):d),d.append('<div class="coral-layout-split-proxy-h"></div><div class="coral-layout-split-proxy-v"></div>'),this._resizeLayout(),this._initCollapse(),this._on({"click.splitIcon":function(a){var c=$(a.target).attr("data-dir");return b.panels[c].is(":visible")?this._collapse(c):this._expand(c),!1}})},_addSplitIcon:function(a,b,c){var d=$(a),e=b.region,f=d.layout("panel",e),g=$(c),h=$(c).parent(),i=(g.panel("component"),"coral-layout-split-"+e),j="<div id='layout-split-"+e+"Id' class='layout-split "+i+"'>",k={north:"up5",south:"down5",east:"right5",west:"left5"};if(k[e]){if(g.length||(h=d.find(">.coral-layout-panel-"+e)),f.panel("option").showSplitIcon){var l="splitIcon cui-icon-arrow-"+k[e],m="<div class='"+l+"' data-dir='"+e+"'></div>";j+=m+"</div>"}else j+="</div>";var n=$(j);h.after(n)}},_addPanel:function(a,b,c){var d=this;b.region=b.region||"center";var e=this.panels,f=$(a),g=b.region;if(!e[g].length){var h=$(c);h.length||(h=$("<div></div>").appendTo(f));var i={north:"up3",south:"down3",east:"right3",west:"left3"},j="cui-icon-arrow-"+i[g],k=["title","->"],i={north:"up3",south:"down3",east:"right3",west:"left3"},j="cui-icon-arrow-"+i[g];i[g]&&k.push({icons:j,label:g,text:!1,onClick:function(a){d._collapse(g)}});var l=$.extend({},this.layoutPanelDefault,{width:h.length?parseInt(h[0].style.width)||h.outerWidth():"auto",height:h.length?parseInt(h[0].style.height)||h.outerHeight():"auto",doSize:!1,componentCls:"coral-layout-panel coral-layout-panel-"+g,bodyCls:"coral-layout-body",toolbarOptions:{data:k},onOpen:function(){}},b);"center"===l.region&&(l.split=!1),h.panel(l),e[g]=h;var m=h.panel("component"),n={north:"s",south:"n",east:"w",west:"e"};h.panel("option").split&&m.resizable($.extend({handles:n[g]||"",disabled:!h.panel("option").split,start:function(b){if(d.resizing=!0,"north"==g||"south"==g)var c=$(">div.coral-layout-split-proxy-v",a);else var c=$(">div.coral-layout-split-proxy-h",a);var e={display:"block"};"north"==g?(e.top=parseInt(m.css("top"))+m.outerHeight()-c.height(),e.left=parseInt(m.css("left")),e.width=m.outerWidth(),e.height=c.height()):"south"==g?(e.top=parseInt(m.css("top")),e.left=parseInt(m.css("left")),e.width=m.outerWidth(),e.height=c.height()):"east"==g?(e.top=parseInt(m.css("top"))||0,e.left=parseInt(m.css("left"))||0,e.width=c.width(),e.height=m.outerHeight()):"west"==g&&(e.top=parseInt(m.css("top"))||0,e.left=m.outerWidth()-c.width(),e.width=c.width(),e.height=m.outerHeight()),c.css(e),$('<div class="coral-layout-mask"></div>').css({left:0,top:0,width:f.width(),height:f.height()}).appendTo(f)},resize:function(b){if("north"==g||"south"==g){var c=$(">div.coral-layout-split-proxy-v",a);c.css("top",b.pageY-$(a).offset().top-c.height()/2)}else{var c=$(">div.coral-layout-split-proxy-h",a);c.css("left",b.pageX-$(a).offset().left-c.width()/2)}return!1},helper:"coral-resizable-helper",stop:function(a,b){f.children("div.coral-layout-split-proxy-v,div.coral-layout-split-proxy-h").hide(),h.panel("resize",b.size),d._resizeLayout(),d.resizing=!1,f.find(">div.coral-layout-mask").remove()}},b))}},_remove:function(a){var b=this.panels,c=this.element,d=$(c).find(".coral-layout-split-"+a);d.find(".splitIcon");if(b[a].length){b[a].panel("destroy"),$(b[a]).remove(),b[a]=$();var e="expand"+a.substring(0,1).toUpperCase()+a.substring(1);b[e]&&(b[e].panel("destroy"),$(b[a]).remove(),b[e]=void 0),d.length&&($(d).remove(),d=$())}},_collapseSplitIcon:function(a,b){var c,d=this.element,e=this.panels[a],f=e.panel("getOptions"),g=(f.collapsedSize,$(d).find(".coral-layout-split-"+a)),h=g.find(".splitIcon");if("east"==a)c="cui-icon-arrow-left5",h.removeClass("cui-icon-arrow-right5").addClass(c),g.css({left:b.expandP.left-g.width()});else if("west"==a)c="cui-icon-arrow-right5",h.removeClass("cui-icon-arrow-left5").addClass(c),g.css({left:b.expandP.width});else if("north"==a)c="cui-icon-arrow-down5",h.removeClass("cui-icon-arrow-up5").addClass(c),g.css({top:b.expandP.height}),$(d).find(".coral-layout-split-west").css({top:b.expandP.height+g.height(),height:b.resizeC.height}),$(d).find(".coral-layout-split-east").css({top:b.expandP.height+g.height(),height:b.resizeC.height});else if("south"==a){c="cui-icon-arrow-up5",h.removeClass("cui-icon-arrow-down5").addClass(c);var i=b.expandP.top-g.height();g.css({top:i}),$(d).find(".coral-layout-split-west").css({height:b.resizeC.height}),$(d).find(".coral-layout-split-east").css({height:b.resizeC.height})}},_collapse:function(a,b){function c(b){var c="";"east"==b?c+="cui-icon-arrow-left3":"west"==b?c+="cui-icon-arrow-right3":"north"==b?c+="cui-icon-arrow-down3":"south"==b&&(c+="cui-icon-arrow-up3");var d=$("<div></div>").appendTo(f),g=["->","->",{icons:c,componentCls:"collapseIcon",label:a,text:!1,onClick:function(b){e._expand(a)}}];return"east"!=b&&"west"!=b||(g=[{icons:c,componentCls:"collapseIcon",label:a,text:!1,onClick:function(b){e._expand(a)}}]),d.panel($.extend({},e.layoutPanelDefault,{componentCls:"coral-layout-expand coral-layout-expand-"+b,title:"&nbsp;",showTitle:!1,closed:!0,minWidth:0,minHeight:0,doSize:!1,toolbarOptions:{isOverflow:!1,data:g}})),d.panel("component").hover(function(){$(this).addClass("coral-layout-expand-over")},function(){$(this).removeClass("coral-layout-expand-over")}),d}function d(){var b=$(f),c=g.center.panel("getOptions"),d=i.collapsedSize;if("east"==a){var h=c.width+i.width-d,j=0;return i.split||(j=1),{resizeC:{width:h},expand:{left:b.width()-i.width},expandP:{top:c.top,left:b.width()-d,width:d,height:c.height},collapse:{left:b.width(),top:c.top,height:c.height}}}if("west"==a){var h=c.width+i.width-d,k=b.find(">.coral-layout-split-west"),j=0;return i.split||(j=1),{resizeC:{width:h,left:d+k.width()-j},expand:{left:0},expandP:{left:0,top:c.top,width:d,height:c.height},collapse:{left:-i.width,top:c.top,height:c.height}}}if("north"==a){var l=c.height,m=b.find(">.coral-layout-split-north");return e._isPanelVisible(g.expandNorth)||(l+=i.height-d),g.east.add(g.west).add(g.expandEast).add(g.expandWest).panel("resize",{top:d+m.height(),height:l}),{resizeC:{top:d+m.height(),height:l},expand:{top:0},expandP:{top:0,left:0,width:b.width(),height:d},collapse:{top:-i.height,width:b.width()}}}if("south"==a){var l=c.height;return e._isPanelVisible(g.expandSouth)||(l+=i.height-d),g.east.add(g.west).add(g.expandEast).add(g.expandWest).panel("resize",{height:l}),{resizeC:{height:l},expand:{top:b.height()-i.height},expandP:{top:b.height()-d,left:0,width:b.width(),height:d},collapse:{top:b.height(),width:b.width()}}}}var e=this,f=this.element;void 0==b&&(b="normal");var g=this.panels,h=g[a],i=h.panel("getOptions");if(0!=i.beforeCollapse.call(h)){var j="expand"+a.substring(0,1).toUpperCase()+a.substring(1);g[j]||(g[j]=c(a),g[j].panel("component").bind("click",function(b){if($(b.target).closest(".collapseIcon").length)return!1;var c=d();return h.panel("expand",!1).panel("open").panel("resize",c.collapse),h.panel("component").animate(c.expand,function(){$(this).unbind(".layout").bind("mouseleave.layout",{region:a},function(a){1!=e.resizing&&e._collapse(a.data.region)})}),!1}));var k=d();this._isPanelVisible(g[j])||g.center.panel("resize",k.resizeC),h.panel("component").animate(k.collapse,b,function(){h.panel("collapse",!1).panel("close"),g[j].panel("open").panel("resize",k.expandP),$(this).unbind(".layout")}),this._collapseSplitIcon(a,k)}},_expandSplitIcon:function(a){var b,c=this.element,d=$(c).find(".coral-layout-split-"+a),e=d.find(".splitIcon");"east"==a?(b="cui-icon-arrow-right5",e.removeClass("cui-icon-arrow-left5").addClass(b)):"west"==a?(b="cui-icon-arrow-left5",e.removeClass("cui-icon-arrow-right5").addClass(b)):"north"==a?(b="cui-icon-arrow-up5",e.removeClass("cui-icon-arrow-down5").addClass(b)):"south"==a&&(b="cui-icon-arrow-down5",e.removeClass("cui-icon-arrow-up5").addClass(b))},_expand:function(a){function b(){var b=$(d),c=e.center.panel("getOptions");return"east"==a&&e.expandEast?{collapse:{left:b.width(),top:c.top,height:c.height},expand:{left:b.width()-e.east.panel("getOptions").width}}:"west"==a&&e.expandWest?{collapse:{left:-e.west.panel("getOptions").width,top:c.top,height:c.height},expand:{left:0}}:"north"==a&&e.expandNorth?{collapse:{top:-e.north.panel("getOptions").height,width:b.width()},expand:{top:0}}:"south"==a&&e.expandSouth?{collapse:{top:b.height(),width:b.width()},expand:{top:b.height()-e.south.panel("getOptions").height,height:e.south.panel("getOptions").height}}:void 0}var c=this,d=this.element,e=this.panels,f=e[a],g=f.panel("getOptions");if(0!=g.beforeExpand.call(f)){var h=b(),i="expand"+a.substring(0,1).toUpperCase()+a.substring(1);e[i]&&(e[i].panel("close"),f.panel("component").stop(!0,!0),f.panel("expand",!1).panel("open").panel("resize",h.collapse),f.panel("component").animate(h.expand,function(){c._resizeLayout()}),this._expandSplitIcon(a))}},_isPanelVisible:function(a){return a&&a.length?a.panel("component").is(":visible"):!1},_initCollapse:function(){var a=this.panels;a.east.length&&a.east.panel("getOptions").collapsed&&this._collapse("east",0),a.west.length&&a.west.panel("getOptions").collapsed&&this._collapse("west",0),a.north.length&&a.north.panel("getOptions").collapsed&&this._collapse("north",0),a.south.length&&a.south.panel("getOptions").collapsed&&this._collapse("south",0)},_fit:function(a){return $.coral.panel.fit(this.element,a)},_destroy:function(){this.element.children().remove(),this.element.detach()},refresh:function(){this._resizeLayout()},panel:function(a){return this.panels[a]},collapse:function(a){this._collapse(a)},expand:function(a){this._expand(a)},add:function(a){this._addPanel(this.element,a),this._addSplitIcon(this.element,a),this._resizeLayout(),this.panels[a.region].panel("getOptions").collapsed&&this._collapse(a.region,0)},remove:function(a){this._remove(a),this._resizeLayout()},split:function(a){this._splitLayout(a,!0)},unsplit:function(a){this._splitLayout(a,!1)},resize:function(a,b){var c=a,d=this.element;if(void 0!==b){var e=this.panels[b],f=e.panel("component").outerHeight(),g=e.panel("component").outerWidth();e.panel("resize",a);var h=e.panel("component").outerHeight(),i=e.panel("component").outerWidth();c.height=$(d).height()+h-f,c.width=$(d).width()+i-g}$(d).css(c),this._resizeLayout()}});/*! cui 2016-11-08 */
$.component("coral.basemenu",{castProperties:["data"],options:{responsive:!1,minmenu:!1,onLoad:null,singleOpen:!1,collapseButton:!1,collapseIcon:"cui-icon-arrow-left3",expandIcon:"cui-icon-arrow-right3",simpleDataIdKey:"id",firstIsactive:!1,isactiveField:"isactive",nameField:"name",simpleDataPIdKey:"pId",vertical:!1,autoDisplay:!0,popup:!1,trigger:null,my:"left top",at:"left bottom",simpleDataEnable:!1,of:null,triggerEvent:"click",data:null,onClick:null,onCreate:null,url:null,method:"post"},_create:function(){this.options.popup&&this._initPopup()},reload:function(a,b){var c=!1,d=[],e=this,f={};if(a||e.options.url?!a&&e.options.url&&(a=e.options.url):a=[],"string"!=typeof a?(f=a,f.data?d=f.data:f.url?(a=f.url,e.options.url=f.url,c=!0):f instanceof Array?d=a:f.url||f.data||e.options.url?f.url||f.data||!e.options.url||(a=e.options.url,c=!0):d=[]):(e.options.url=a,c=!0),c){var g="";$.ajax({type:this.options.method,url:e.options.url,async:!1,data:null,dataType:"json",success:function(a){var b="";b=e._generateHTML(b,a),b.length>7&&(b=b.substring(4),b=b.substring(0,b.length-5)),e.element.empty(),e.element.html(b),e._trigger($.isFunction(f.onLoad)?f.onLoad:"onLoad",null,[a])}})}else{var g="";g=e._generateHTML(g,d),g.length>7&&(g=g.substring(4),g=g.substring(0,g.length-5)),e.element.empty(),e.element.html(g),e._trigger($.isFunction(f.onLoad)?f.onLoad:"onLoad",null,[d])}e._render()},_generateULContent:function(){var a=this;if(0==this.element.children().length&&null!=this.options.data){var b="",c=this.options.data;b=this._generateHTML(b,c),b.length>7&&(b=b.substring(4),b=b.substring(0,b.length-5)),this.element.html(b)}else if(0==this.element.children().length&&null!=this.options.url){var b="";$.ajax({type:this.options.method,url:a.options.url,async:!1,data:null,dataType:"json",success:function(b){var c="";c=a._generateHTML(c,b),c.length>7&&(c=c.substring(4),c=c.substring(0,c.length-5)),a.element.html(c)},error:function(){}})}},_transformToSimpleData:function(a,b){if(!b)return[];var c,d,e=[],f=[],g=this.options.simpleDataIdKey,h=this.options.simpleDataPIdKey;for(c=0,d=b.length;d>c;c++)f[b[c][g]]=b[c];for(c=0,d=b.length;d>c;c++)f[b[c][h]]&&b[c][g]!=b[c][h]?(f[b[c][h]].items||(f[b[c][h]].items=[]),f[b[c][h]].items.push(b[c])):e.push(b[c]);return e},_transformToGeneralData:function(a,b){},_generateHTML:function(a,b){var c=[],d=this.options,e=d.simpleDataIdKey;c=this.options.simpleDataEnable?this._transformToSimpleData(d,b):b,b=c,a+="<ul>";for(var f=0;f<b.length;f++){a+="<li",""!=b[f][e]&&(a+=' data-id="'+b[f][e]+'" id="menubar-'+b[f][e]+'"'),b[f].path&&(a+=' data-path="'+b[f].path+'"'),a+=">",a+=this._generateANode(b[f]);var g=b[f].items;"undefined"!=typeof g&&g instanceof Array&&g.length>0&&(a=this._generateHTML(a,g)),a+="</li>"}return a+="</ul>"},_generateANode:function(a){var b="<a",c=(this.options.simpleDataIdKey,this.options.isactiveField),d=this.options.nameField;return""!=a.iconclass&&(b+=" data-icon='"+a.iconclass+"'"),""!=a[d]&&(b+=" data-name='"+a[d]+"'"),a.disabled&&(b+=" data-disabled='"+a.disabled+"'"),a.url&&(b+=" data-url='"+a.url+"'"),a.target&&(b+=" data-target='"+a.target+"'"),a[c]&&(b+=" data-isactive='"+a[c]+"'"),b+=">",""!=a[d]&&(b+=a[d]),b+="</a>"},_initPopup:function(){var a=this;this.options.trigger="string"==typeof this.options.trigger?$("#"+this.options.trigger):this.options.trigger,this.element.closest(".coral-menu").addClass("coral-menu-dynamic coral-shadow").appendTo(document.body),this.positionConfig={my:this.options.my,at:this.options.at,of:this.options.of?this.options.of:this.options.trigger},this.options.trigger.on(this.options.triggerEvent+".coral-menu",function(b){if(a.options.disabled!==!0){$(this);a.element.is(":visible")?a.hide():a.show(),b.preventDefault()}}),$(document.body).on("click.coral-menu",function(b){var c=a.element.closest(".coral-menu");if(!c.is(":hidden")){var d=$(b.target);if(!(d.is(a.options.trigger.get(0))||a.options.trigger.has(d).length>0)){var e=c.offset();(b.pageX<e.left||b.pageX>e.left+c.width()||b.pageY<e.top||b.pageY>e.top+c.height())&&a.hide(b)}}}),$(window).on("resize.coral-menu",function(){a.element.closest(".coral-menu").is(":visible")&&a.align()})},show:function(){this.align(),this.element.closest(".coral-menu").css("z-index",++$.coral.zindex).show()},hide:function(){this.element.closest(".coral-menu").fadeOut("fast")},align:function(){this.element.closest(".coral-menu").css({left:"",top:""}).position({my:this.options.my,at:this.options.at,of:this.options.of?this.options.of:this.options.trigger})},_apply:function(a,b,c){return"string"==typeof a?window[a].apply(b,[c]):$.isFunction(a)?a.apply(b,[c]):void 0},_setMenuItemLinkDisabled:function(a){a.data("disabled")===!0?a.toggleClass(this.componentFullName+"-disabled coral-state-disabled",!0).attr("aria-disabled",!0):a.toggleClass(this.componentFullName+"-disabled coral-state-disabled",!1).attr("aria-disabled",!1)},_setMenuItemIsOpen:function(a,b){var c=$(b).data("isopen"),d=this.options.singleOpen,e=this.element.find(".coral-menuitem-open").length;d&&e||!c||(a.addClass("coral-menuitem-open"),a.children("ul").css({display:"block"}))},setMenuItemIsactive:function(a){if("string"==typeof a)a=this.element.find("#menubar-"+a).children(),$(a).parents("li").addClass("coral-menuitem-active"),$(a).parent().parents("li").addClass("coral-menuitem-open "),$(a).parents("ul.coral-menu-child").css({display:"block"});else{var b=$(a).data("isactive");b&&($(a).parents("li").addClass("coral-menuitem-active"),$(a).parent().parents("li").addClass("coral-menuitem-open "),$(a).parents("ul.coral-menu-child").css({display:"block"}))}},_bindMenuItemClick:function(a){a.options.onClick;a.links.on("click",function(){if(a.options.disabled!==!0){var b={};null!=$(this).parent("li").attr("data-id")&&(b.id=$(this).parent("li").attr("data-id")),null!=$(this).attr("data-target")&&(b.target=$(this).attr("data-target")),null!=$(this).attr("data-name")&&(b.name=$(this).attr("data-name")),null!=$(this).attr("data-url")&&(b.url=$(this).attr("data-url")),$(this).find(":checkbox,:radio").length>0?(b.hasChk=!0,b.checked=$(this).find(":checkbox,:radio").prop("checked")):b.hasChk=!1;var c={target:a,currentTarget:a,preventDefault:$.noop};a._trigger("onClick",c,b)}})},setActiveMenu:function(a){var b=this;null!=a&&0!=a.length&&$.each(a,function(){var a=b.element.find("[data-name='"+this+"']");a.parent().addClass("coral-menuitem-current")})},setCurrenMenu:function(a){null!=a&&0!=a.length&&this.element.find(">li>a").each(function(){var b=$(this),c=b.attr("data-name");c===a&&(b.parent().addClass("coral-menuitem-current"),$(this).parent().siblings().removeClass("coral-menuitem-current"))})}}),$.component("coral.navigationmenu",$.coral.basemenu,{castProperties:["title"],options:{collapsible:!0,active:0,textAlign:"left",role:"navigationmenu",menus:"ul",title:null,icons:{activeHeader:"cui-icon-arrow-down",header:"cui-icon-arrow-right2"},header:"> li > :first-child,> :not(li):even"},_activate:function(a){var b=this._findActive(a)[0];b!==this.active[0]&&(b=b||this.active[0],this._eventHandler({target:b,currentTarget:b,preventDefault:$.noop}))},_findActive:function(a){return"number"==typeof a?this.headers.eq(a):$()},_setOption:function(a,b){return"active"===a?void this._activate(b):void this._super(a,b)},_create:function(){var a=this;this._generateULContent(),this._render(),this.links=this.element.find(".coral-menuitem-link:not(.coral-state-disabled)"),this._on({"mousedown .coral-navigationmenu-header":function(a){a.preventDefault()},"click .coral-menuitem-link":function(b){b.preventDefault();var c=$(b.target).closest(".coral-menuitem-link"),d=$(b.target).closest(".coral-menu-parent");if(d.not(".coral-state-disabled").length){d.siblings().find(">ul").attr("aria-expanded",!1).slideUp(),d.find(">.icon").removeClass(a.options.icons.activeHeader).addClass(a.options.icons.header),b.isPropagationStopped()||(this.mouseHandled=!0);var e=d.find(">ul");c.parent().hasClass("coral-menu-parent")?"true"==e.attr("aria-expanded")?e.attr("aria-expanded",!1).slideUp():(e.attr("aria-expanded",!0).slideDown(),d.find(">.icon").removeClass(a.options.icons.header).addClass(a.options.icons.activeHeader)):(this.oldActive=this.active||$(),this.active=c,this.oldActive.removeClass("coral-state-highlight"),ui={item:this.active,target:this.active.attr("href")},this.active.addClass("coral-state-highlight"),this._trigger("onSelect",b,ui))}},"mouseenter .coral-menuitem-link":function(a){a.preventDefault();var b=$(a.target).closest(".coral-menuitem-link"),c=$(a.target).closest(".coral-menu-parent");c.not(".coral-state-disabled").length&&(b.parent().hasClass("coral-menu-parent")||b.addClass("coral-state-hover"),this._updateTitle())},"mouseleave .coral-menuitem-link":function(a){a.preventDefault();var b=$(a.target).closest(".coral-menuitem-link"),c=$(a.target).closest(".coral-menu-parent");c.not(".coral-state-disabled").length&&(b.parent().hasClass("coral-menu-parent")||b.removeClass("coral-state-hover"))}}),this._super()},_updateTitle:function(){this.element.find("li>a").each(function(){var a=$(this),b=a.find(".coral-menuitem-text").text(),c=$("<span style = 'visibility: hidden'>"+b+"</span>").appendTo("body");a.width()<c.width()&&a.attr("title",b),c.remove()})},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("coral-navigationmenu-header coral-state-default")},_render:function(){var a=this;this.element.addClass("coral-helper-reset coral-navigationmenu coral-menu").attr("role","navigationmenu"),this.element.uniqueId(),this.options.id=this.element.attr("id"),this._processPanels(),submenus=this.element.find(this.options.menus),submenus.filter(":not(.coral-menu)").addClass("coral-menu-list coral-helper-reset").attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var a=$(this),b=a.parent();b.attr("aria-haspopup","true"),a.attr("aria-labelledby",b.attr("id"))}),menus=submenus.add(this.element),items=menus.find(this.options.items),items.not(".coral-menu-item").each(function(){var a=$(this);that._isDivider(a)&&a.addClass("coral-component-content coral-menu-divider")}),this.element.find("li").each(function(){var b=$(this),c=b.children("a"),d=(c.data("icon"),"undefined"==typeof b.parent().parent("li").attr("data-level")?0:parseInt(b.parent().parent("li").attr("data-level"))+1);if(c.addClass("coral-menuitem-link coral-state-default coral-corner-all"),c.contents().filter(function(a,b){return!b.tagName}).wrap("<span class='coral-menuitem-text'/>"),c.html('<div class="coral-navigationmenu-item-inner">'+c.html()+"</div>"),b.addClass("coral-menuitem coral-component coral-corner-all").attr("data-level",d).addClass("level"+d),b.children("ul").length>0){var e=b.children("ul");b.addClass("coral-menu-parent"),e.addClass("coral-menu-list coral-helper-reset"),c.prepend('<span class="coral-navigationmenu-item-arrow cui-icon-arrow-down3"></span>')}else"right"==a.options.textAlign;"right"==a.options.textAlign&&$("<span class='coral-empty' style='width:"+16*d+"px;height:16px;'></span>").prependTo(c.find(".coral-navigationmenu-item-inner"))});var b=".coral-navigationmenu li > a[data-target='"+this.options.active+"'], .coral-navigationmenu li > a[href='"+this.options.active+"']",c=$(b);c.parents("ul").show(),c.parent().hasClass("coral-menu-parent")||(c.addClass("coral-state-highlight"),this.oldActive=c,this.active=c)}}),$.component("coral.menu",{version:"4.0.2",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"coral-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",onBlur:null,onFocus:null,onSelect:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("coral-menu coral-component coral-component-content").toggleClass("coral-menu-icons",!!this.element.find(".coral-icon").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass("coral-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .coral-menu-item":function(a){a.preventDefault()},"click .coral-menu-item":function(a){var b=$(a.target);!this.mouseHandled&&b.not(".coral-state-disabled").length&&(this.select(a),a.isPropagationStopped()||(this.mouseHandled=!0),b.has(".coral-menu").length?this.expand(a):!this.element.is(":focus")&&$(this.document[0].activeElement).closest(".coral-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".coral-menu").length&&clearTimeout(this.timer)))},"mouseenter .coral-menu-item":function(a){if(!this.previousFilter){var b=$(a.currentTarget);b.siblings(".coral-state-active").removeClass("coral-state-active"),this.focus(a,b)}},mouseleave:"collapseAll","mouseleave .coral-menu":"collapseAll",focus:function(a,b){var c=this.active||this.element.find(this.options.items).eq(0);b||this.focus(a,c)},blur:function(a){this._delay(function(){$.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(a)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(a){this._closeOnDocumentClick(a)&&this.collapseAll(a),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".coral-menu").addBack().removeClass("coral-menu coral-component coral-component-content coral-menu-icons coral-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".coral-menu-item").removeClass("coral-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("coral-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var a=$(this);a.data("coral-menu-submenu-carat")&&a.remove()}),this.element.find(".coral-menu-divider").removeClass("coral-menu-divider coral-component-content")},_keydown:function(a){var b,c,d,e,f=!0;switch(a.keyCode){case $.coral.keyCode.PAGE_UP:this.previousPage(a);break;case $.coral.keyCode.PAGE_DOWN:this.nextPage(a);break;case $.coral.keyCode.HOME:this._move("first","first",a);break;case $.coral.keyCode.END:this._move("last","last",a);break;case $.coral.keyCode.UP:this.previous(a);break;case $.coral.keyCode.DOWN:this.next(a);break;case $.coral.keyCode.LEFT:this.collapse(a);break;case $.coral.keyCode.RIGHT:this.active&&!this.active.is(".coral-state-disabled")&&this.expand(a);break;case $.coral.keyCode.ENTER:case $.coral.keyCode.SPACE:this._activate(a);break;case $.coral.keyCode.ESCAPE:this.collapse(a);break;default:f=!1,c=this.previousFilter||"",d=String.fromCharCode(a.keyCode),e=!1,clearTimeout(this.filterTimer),d===c?e=!0:d=c+d,b=this._filterMenuItems(d),b=e&&-1!==b.index(this.active.next())?this.active.nextAll(".coral-menu-item"):b,b.length||(d=String.fromCharCode(a.keyCode),b=this._filterMenuItems(d)),b.length?(this.focus(a,b),this.previousFilter=d,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}f&&a.preventDefault()},_activate:function(a){this.active.is(".coral-state-disabled")||(this.active.is("[aria-haspopup='true']")?this.expand(a):this.select(a))},refresh:function(){var a,b,c=this,d=this.options.icons.submenu,e=this.element.find(this.options.menus);this.element.toggleClass("coral-menu-icons",!!this.element.find(".coral-icon").length),e.filter(":not(.coral-menu)").addClass("coral-menu coral-component coral-component-content coral-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var a=$(this),b=a.parent(),c=$("<span>").addClass("coral-menu-icon coral-icon "+d).data("coral-menu-submenu-carat",!0);b.attr("aria-haspopup","true").prepend(c),a.attr("aria-labelledby",b.attr("id"))}),a=e.add(this.element),b=a.find(this.options.items),b.not(".coral-menu-item").each(function(){var a=$(this);c._isDivider(a)&&a.addClass("coral-component-content coral-menu-divider")}),b.not(".coral-menu-item, .coral-menu-divider").addClass("coral-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),b.filter(".coral-state-disabled").attr("aria-disabled","true"),this.active&&!$.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(a,b){"icons"===a&&this.element.find(".coral-menu-icon").removeClass(this.options.icons.submenu).addClass(b.submenu),"disabled"===a&&this.element.toggleClass("coral-state-disabled",!!b).attr("aria-disabled",b),this._super(a,b)},focus:function(a,b){var c,d;this.blur(a,a&&"focus"===a.type),this._scrollIntoView(b),this.active=b.first(),d=this.active.addClass("coral-state-focus").removeClass("coral-state-active"),this.options.role&&this.element.attr("aria-activedescendant",d.attr("id")),this.active.parent().closest(".coral-menu-item").addClass("coral-state-active"),a&&"keydown"===a.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),c=b.children(".coral-menu"),c.length&&a&&/^mouse/.test(a.type)&&this._startOpening(c),this.activeMenu=b.parent(),this._trigger("onFocus",a,{item:b})},_scrollIntoView:function(a){var b,c,d,e,f,g;this._hasScroll()&&(b=parseFloat($.css(this.activeMenu[0],"borderTopWidth"))||0,c=parseFloat($.css(this.activeMenu[0],"paddingTop"))||0,d=a.offset().top-this.activeMenu.offset().top-b-c,e=this.activeMenu.scrollTop(),f=this.activeMenu.height(),g=a.outerHeight(),0>d?this.activeMenu.scrollTop(e+d):d+g>f&&this.activeMenu.scrollTop(e+d-f+g))},blur:function(a,b){b||clearTimeout(this.timer),this.active&&(this.active.removeClass("coral-state-focus"),this.active=null,this._trigger("onBlur",a,{item:this.active}))},_startOpening:function(a){clearTimeout(this.timer),"true"===a.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(a)},this.delay))},_open:function(a){var b=$.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".coral-menu").not(a.parents(".coral-menu")).hide().attr("aria-hidden","true"),a.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(b)},collapseAll:function(a,b){clearTimeout(this.timer),this.timer=this._delay(function(){var c=b?this.element:$(a&&a.target).closest(this.element.find(".coral-menu"));c.length||(c=this.element),this._close(c),this.blur(a),this.activeMenu=c},this.delay)},_close:function(a){a||(a=this.active?this.active.parent():this.element),a.find(".coral-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".coral-state-active").not(".coral-state-focus").removeClass("coral-state-active")},_closeOnDocumentClick:function(a){return!$(a.target).closest(".coral-menu").length},_isDivider:function(a){return!/[^\-\u2014\u2013\s]/.test(a.text())},collapse:function(a){var b=this.active&&this.active.parent().closest(".coral-menu-item",this.element);b&&b.length&&(this._close(),this.focus(a,b))},expand:function(a){var b=this.active&&this.active.children(".coral-menu ").find(this.options.items).first();b&&b.length&&(this._open(b.parent()),this._delay(function(){this.focus(a,b)}))},next:function(a){this._move("next","first",a)},previous:function(a){this._move("prev","last",a)},isFirstItem:function(){return this.active&&!this.active.prevAll(".coral-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".coral-menu-item").length},_move:function(a,b,c){var d;this.active&&(d="first"===a||"last"===a?this.active["first"===a?"prevAll":"nextAll"](".coral-menu-item").eq(-1):this.active[a+"All"](".coral-menu-item").eq(0)),d&&d.length&&this.active||(d=this.activeMenu.find(this.options.items)[b]()),this.focus(c,d)},nextPage:function(a){var b,c,d;return this.active?void(this.isLastItem()||(this._hasScroll()?(c=this.active.offset().top,d=this.element.height(),this.active.nextAll(".coral-menu-item").each(function(){return b=$(this),b.offset().top-c-d<0}),this.focus(a,b)):this.focus(a,this.activeMenu.find(this.options.items)[this.active?"last":"first"]()))):void this.next(a)},previousPage:function(a){var b,c,d;return this.active?void(this.isFirstItem()||(this._hasScroll()?(c=this.active.offset().top,d=this.element.height(),this.active.prevAll(".coral-menu-item").each(function(){return b=$(this),b.offset().top-c+d>0}),this.focus(a,b)):this.focus(a,this.activeMenu.find(this.options.items).first()))):void this.next(a)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(a){this.active=this.active||$(a.target).closest(".coral-menu-item");var b={item:this.active};this.active.has(".coral-menu").length||this.collapseAll(a,!0),this._trigger("onSelect",a,b)},_filterMenuItems:function(a){var b=a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),c=new RegExp("^"+b,"i");return this.activeMenu.find(this.options.items).filter(".coral-menu-item").filter(function(){return c.test($.trim($(this).text()))})}}),$.component("coral.breadcrumb",{_create:function(){this.element.wrap('<div class="coral-breadcrumb coral-module coral-component coral-component-header coral-helper-clearfix coral-corner-all" role="menu">'),this.element.children("li").each(function(a){var b=$(this);b.attr("role","menuitem");var c=b.children("a");c.addClass("coral-menuitem-link coral-corner-all").contents().wrap('<span class="coral-menuitem-text" />'),a>0?b.before('<li class="coral-breadcrumb-chevron menu-rightArrow cui-icon-arrowDown1"></li>'):c.addClass("coral-icon coral-icon-home")})}}),$.component("coral.tieredmenu",$.coral.basemenu,{options:{autoDisplay:!0},_create:function(){this._generateULContent(),this.element.wrap('<div class="coral-tieredmenu coral-menu coral-component coral-component-content coral-corner-all coral-helper-clearfix" />'),this._render(),this.links=this.element.find(".coral-menuitem-link"),this.lis=this.element.find(".coral-menuitem"),this.menuitems=this.element.children("li.coral-menuitem"),this._bindEvents(),this._super()},_render:function(){var a=this;this.element.addClass("coral-menu-list coral-helper-reset"),this.element.find("li").each(function(b){var c=$(this),d=c.children("a"),e=d.data("icon");a._setMenuItemLinkDisabled(d),a._setMenuItemIsOpen(c,d),a.setMenuItemIsactive(d),d.addClass("coral-menuitem-link coral-corner-all").contents().wrap('<span class="coral-menuitem-text" />'),e&&d.prepend('<span class="menu-icon '+e+'"></span>'),c.addClass("coral-menuitem coral-component coral-corner-all"),c.children("ul").length>0&&(c.addClass("coral-menu-parent"),c.children("ul").addClass("coral-component-content coral-menu-list coral-corner-all coral-helper-clearfix coral-menu-child coral-shadow"),d.prepend('<span class="menu-rightArrow cui-icon-arrowDown1"></span>'))})},_bindEvents:function(){this._bindItemEvents(),this._bindDocumentHandler()},_bindMenuItemClick:function(a,b){a._on({"click.coral-menuitem-link":function(c){var d=$(c.target).closest("a");if(a.options.disabled!==!0&&!d.hasClass("coral-state-disabled")&&("boolean"!=typeof b||b||!d.parent().parent().hasClass("ctrl-init"))){var e={},f=d.closest("li").hasClass("coral-menu-parent");null!=d.parent("li").attr("data-id")&&(e.id=d.parent("li").attr("data-id")),d.parent("li").attr("data-path")&&(e.path=d.parent("li").attr("data-path")),null!=d.attr("data-target")&&(e.target=d.attr("data-target")),null!=d.attr("data-name")&&(e.name=d.attr("data-name")),null!=d.attr("data-url")&&(e.url=d.attr("data-url")),d.find(":checkbox,:radio").length>0?(e.hasChk=!0,e.checked=d.find(":checkbox,:radio").prop("checked")):e.hasChk=!1;var g={target:c.target,currentTarget:a,preventDefault:$.noop};e.isParent=f,e.target=c.target,a._trigger("onClick",g,e)}}})},_bindItemEvents:function(){var a=this;this._on({"mouseenter.coral-menuitem-link":function(a){var b=a.target;if(!(this.options.vertical||$(window).width()<900||this.options.disabled===!0||$(b).hasClass("coral-state-disabled"))){var c=$(b),d=c.parent(),e=this.options.autoDisplay,f=d.siblings("li").children(".coral-state-hover");1===f.length&&this._deactivate(f),e||this.active?this._activate(d):this._highlight(d)}}}),this._on({"mouseleave.coral-menuitem":function(a){var b=$(a.target).closest("li");this.options.vertical||$(window).width()<900||this.options.disabled===!0||$(a.target).closest("a").hasClass("coral-state-disabled")||($(b).find("ul").hide(),$(b).children("a").removeClass("coral-state-hover"))},mouseleave:function(a){this.options.vertical||!this.options.autoDisplay||$(window).width()<900||(this.element.find("ul").hide(),this.element.find(".coral-state-hover").removeClass("coral-state-hover"))},"click.coral-menuitem":function(b){var c=$(b.target).closest("li");this.options.disabled===!0||$(c).find(">a").hasClass("coral-state-disabled")||(!this.options.vertical&&$(window).width()>900&&0==c.find("li").length&&(c.hasClass("coral-menuitem-active")||(a.element.find(".coral-menuitem-active").removeClass("coral-menuitem-active"),c.addClass("coral-menuitem-active"),c.parents("li").addClass("coral-menuitem-active"))),!this.options.vertical&&$(window).width()>900||(c.find("li").length?c.hasClass("coral-menuitem-open")?(c.children("ul").css({display:"none"}),c.removeClass("coral-menuitem-open")):(this.options.singleOpen&&(this.element.find(".coral-menu-child").css({display:"none"}),this.element.find(".coral-menuitem-open").removeClass("coral-menuitem-open"),c.parents(".coral-menu-child").css({display:"block"}),c.parents(".coral-menu-child").closest("li").addClass("coral-menuitem-open")),c.children("ul").css({display:"block"}),c.addClass("coral-menuitem-open")):c.hasClass("coral-menuitem-active")||(a.element.find(".coral-menuitem-active").removeClass("coral-menuitem-active"),c.addClass("coral-menuitem-active"),c.parents("li").addClass("coral-menuitem-active")),b.stopPropagation()))}}),this.options.autoDisplay===!1?(this.rootLinks=this.element.find("> .coral-menuitem > .coral-menuitem-link"),this.rootLinks.data("primecoral-tieredmenu-rootlink",this.options.id).find("*").data("primecoral-tieredmenu-rootlink",this.options.id),this._on(this.rootLinks,{click:function(b){var c=$(b.target).closest("a");if(a.options.disabled!==!0&&!c.hasClass("coral-state-disabled")){var d=c.parent(),e=d.children("ul.coral-menu-child");1===e.length&&(e.is(":visible")?(a.active=!1,a._deactivate(d)):(a.active=!0,a._highlight(d),a._showSubmenu(d,e)));var f={};null!=c.parent("li").attr("data-id")&&(f.id=c.parent("li").attr("data-id")),null!=c.attr("data-target")&&(f.target=c.attr("data-target")),null!=c.attr("data-name")&&(f.name=c.attr("data-name")),null!=c.attr("data-url")&&(f.url=c.attr("data-url")),c.find(":checkbox,:radio").length>0?(f.hasChk=!0,f.checked=c.find(":checkbox,:radio").prop("checked")):f.hasChk=!1;var g={target:a,currentTarget:a,preventDefault:$.noop};a._trigger("onClick",g,f),c.parent("li").hasClass("coral-menu-parent")||a.hide()}}}),this._bindMenuItemClick(a,!1)):this._bindMenuItemClick(a,!0),this._on(this.element.parent().find("ul.coral-menu-list"),{mouseleave:function(b){a.activeitem&&a._deactivate(a.activeitem),a.element.parent().hasClass("coral-menubar-horizontal")||b.stopPropagation()}})},add:function(a,b){if(("string"==typeof a||"number"==typeof a||null===a)&&"object"==typeof b){"string"==typeof a||null==a?this._addByParentId(a,b):"number"==typeof a&&this._addByIndex(a,b)}},_addByParentId:function(a,b){var c=this.element.find(".coral-menuitem").filter("[data-id$='"+a+"']");if(c.length||null===a)if(null===a){this.element.append(this._getAddHTML(b,!1));var d=this._renderAddHTML();this._bindAddItemEvents(d),this._bindLinkRootEvents($(d[0]))}else{this._hasChildren(c)?c.children("ul").append(this._getAddHTML(b,!1)):c.append(this._getAddHTML(b,!0));var e=this._renderAddHTML(c);this._bindAddItemEvents(e)}},_getAddHTML:function(a,b){var c="",d=this.options.simpleDataIdKey;a instanceof Array||(a=[a]),"boolean"==typeof b&&b&&(c+="<ul>");for(var e=0;e<a.length;e++){c+=""!=a[e][d]?'<li data-id="'+a[e][d]+'">':"<li>",c+=this._generateANode(a[e]);var f=a[e].items;f.length>0&&(c=this._generateHTML(c,f)),c+="</li>"}return"boolean"==typeof b&&b&&(c+="</ul>"),c},_renderAddHTML:function(a){var b=this,c=this.element.find("li").not(".coral-menuitem");return a&&!a.children("ul").hasClass("coral-menu-list")&&(a.addClass("coral-menu-parent"),a.children("ul").addClass("coral-component-content coral-menu-list coral-corner-all coral-helper-clearfix coral-menu-child coral-shadow"),a.children("a").prepend('<span class="menu-rightArrow cui-icon-arrowDown1"></span>')),c.each(function(){var a=$(this),c=a.children("a"),d=c.data("icon");b._setMenuItemLinkDisabled(c),c.addClass("coral-menuitem-link coral-corner-all").contents().wrap('<span class="coral-menuitem-text" />'),d&&c.prepend('<span class="menu-icon '+d+'"></span>'),a.addClass("coral-menuitem coral-component coral-corner-all"),a.children("ul").length>0&&(a.addClass("coral-menu-parent"),a.children("ul").addClass("coral-component-content coral-menu-list coral-corner-all coral-helper-clearfix coral-menu-child coral-shadow"),c.prepend('<span class="menu-rightArrow cui-icon-arrowDown1"></span>'))}),c.find(".coral-menuitem-link")},_bindLinkRootEvents:function(a){var b=this;a.data("primecoral-tieredmenu-rootlink",this.options.id).find("*").data("primecoral-tieredmenu-rootlink",this.options.id),this._on(a,{click:function(a){var c=$(a.target).closest("a");if(b.options.disabled!==!0&&!c.hasClass("coral-state-disabled")){var d=c.parent(),e=d.children("ul.coral-menu-child");1===e.length&&(e.is(":visible")?(b.active=!1,b._deactivate(d)):(b.active=!0,b._highlight(d),b._showSubmenu(d,e)))}}})},_bindAddItemEvents:function(a){var b=this;this._on(a,{click:function(a){var c={},d=$(a.target).closest("a");if(b.options.disabled!==!0&&!d.hasClass("coral-state-disabled")){null!=d.parent("li").attr("data-id")&&(c.id=d.parent("li").attr("data-id")),null!=d.attr("data-target")&&(c.target=d.attr("data-target")),null!=d.attr("data-name")&&(c.name=d.attr("data-name")),null!=d.attr("data-url")&&(c.url=d.attr("data-url")),d.find(":checkbox,:radio").length>0?(c.hasChk=!0,c.checked=d.find(":checkbox,:radio").prop("checked")):c.hasChk=!1;var e={target:b,currentTarget:b,preventDefault:$.noop};b._trigger("onClick",e,c),b.hide()}}}),a.on("mouseenter",function(){if(b.options.disabled!==!0&&!$(this).hasClass("coral-state-disabled")){var a=$(this),c=a.parent(),d=b.options.autoDisplay,e=c.siblings(".coral-menuitem-active");1===e.length&&b._deactivate(e),d||b.active?c.hasClass("coral-menuitem-active")?b._reactivate(c):b._activate(c):b._highlight(c)}}),a.parents("li").find("ul.coral-menu-list").on("mouseleave.coral-menu",function(a){b.activeitem&&b._deactivate(b.activeitem),a.stopPropagation()})},_hasChildren:function(a){return!!a.hasClass("coral-menu-parent")},_getLength:function(){return this.element.children("li").length},_addByIndex:function(a,b){var c=parseInt(a);if(!(0>c||c>this._getLength())){0==this._getLength()||c==this._getLength()?this.element.append(this._getAddHTML(b,!1)):this.element.children("li:eq("+c+")").before(this._getAddHTML(b,!1));var d=this._renderAddHTML();this._bindAddItemEvents(d),this._bindLinkRootEvents($(d[0]))}},remove:function(){var a=this.element.children("li");a.length&&a.remove()},removeItem:function(a){"string"==typeof a?this._removeById(a):this._removeByIndex(a)},_removeById:function(a){var b=this.element.find(".coral-menuitem").filter("[data-id$='"+a+"']");b.length&&(b.siblings("li").length?b.remove():b.parent("ul").remove())},_removeByIndex:function(a){var b=parseInt(a);if(!(0>b||b>this._getLength()-1)){var c=this.element.children("li.coral-menuitem:eq("+b+")");c.length&&c.remove()}},updateItem:function(a,b){"string"==typeof a?this._updateById(a,b):this._updateByIndex(a,b)},_updateById:function(a,b){var c=this.element.find(".coral-menuitem").filter("[data-id$='"+a+"']");c.length&&c.children(".coral-menuitem-link").children(".coral-menuitem-text").html(b)},_updateByIndex:function(a,b){var c=parseInt(a);if(!(0>c||c>this._getLength()-1)){var d=this.element.children("li.coral-menuitem:eq("+c+")");
d.length&&d.children(".coral-menuitem-link").children(".coral-menuitem-text").html(b)}},_bindDocumentHandler:function(){var a=this;$(document.body).on("click.coral-menu",function(b){var c=$(b.target);c.data("primecoral-tieredmenu-rootlink")!==a.options.id&&(a.active=!1,0!=c.closest("li").find("ul").length||a.element.parent().hasClass("coral-menubar-vertical")||a.element.find("li.coral-menuitem-active").each(function(){a._deactivate($(this),!0)}))})},enable:function(){var a=this.element.find(".coral-menuitem");a.length&&a.children(".coral-menuitem-link").toggleClass(this.componentFullName+"-disabled coral-state-disabled",!1).attr("aria-disabled",!1)},enableItem:function(a){"string"==typeof a?this._enableItemById(a):this._enableItemByIndex(a)},_enableItemById:function(a){var b=this.element.find(".coral-menuitem").filter("[data-id$='"+a+"']");b.length&&b.children(".coral-menuitem-link").toggleClass(this.componentFullName+"-disabled coral-state-disabled",!1).attr("aria-disabled",!1)},_enableItemByIndex:function(a){var b=parseInt(a);if(!(0>b||b>this._getLength()-1)){var c=this.element.children("li.coral-menuitem:eq("+b+")");c.length&&c.children(".coral-menuitem-link").toggleClass(this.componentFullName+"-disabled coral-state-disabled",!1).attr("aria-disabled",!1)}},disable:function(){var a=this.element.find(".coral-menuitem");a.length&&a.children(".coral-menuitem-link").toggleClass(this.componentFullName+"-disabled coral-state-disabled",!0).attr("aria-disabled",!0)},disableItem:function(a){return"string"==typeof a?this._disableItemById(a):this._disableItemByIndex(a)},_disableItemById:function(a){var b=this.element.find(".coral-menuitem").filter("[data-id$='"+a+"']");b.length&&b.children(".coral-menuitem-link").toggleClass(this.componentFullName+"-disabled coral-state-disabled",!0).attr("aria-disabled",!0)},_disableItemByIndex:function(a){var b=parseInt(a);if(!(0>b||b>this._getLength()-1)){var c=this.element.children("li.coral-menuitem:eq("+b+")");c.length&&c.children(".coral-menuitem-link").toggleClass(this.componentFullName+"-disabled coral-state-disabled",!0).attr("aria-disabled",!0)}},hideAll:function(){var a=this.element.children("li");a.length&&a.hide()},hideItem:function(a){var b=this;return"string"==typeof a?b._hideById(a):b._hideByIndex(a)},_hideById:function(a){var b=this.element.find(".coral-menuitem").filter("[data-id$='"+a+"']");b.length&&b.toggleClass("coral-tieredmenu-hidden",!0)},_hideByIndex:function(a){var b=parseInt(a);if(!(0>b||b>this._getLength()-1)){var c=this.element.children("li.coral-menuitem:eq("+b+")");c.length&&c.toggleClass("coral-tieredmenu-hidden",!0)}},showAll:function(){var a=this.element.children("li");a.length&&a.show()},showItem:function(a){var b=this;return"string"==typeof a?b._showById(a):b._showByIndex(a)},_showById:function(a){var b=this.element.find(".coral-menuitem").filter("[data-id$='"+a+"']");b.length&&b.toggleClass("coral-tieredmenu-hidden",!1)},_showByIndex:function(a){var b=parseInt(a);if(!(0>b||b>this._getLength()-1)){var c=this.element.children("li.coral-menuitem:eq("+b+")");c.length&&c.toggleClass("coral-tieredmenu-hidden",!1)}},_deactivate:function(a,b){this.activeitem=null,a.children("a.coral-menuitem-link").removeClass("coral-state-hover"),b?a.children("ul.coral-menu-child:visible").fadeOut("fast"):a.children("ul.coral-menu-child:visible").hide()},_activate:function(a){this._highlight(a);var b=a.children("ul.coral-menu-child");1===b.length&&this._showSubmenu(a,b)},_reactivate:function(a){this.activeitem=a;var b=a.children("ul.coral-menu-child"),c=b.children("li.coral-menuitem-active:first"),d=this;1===c.length&&d._deactivate(c)},_highlight:function(a){this.activeitem=a,a.children("a.coral-menuitem-link").addClass("coral-state-hover")},_showSubmenu:function(a,b){b.children("li:not(.coral-tieredmenu-hidden)").length&&this.options.disabled!==!0&&(b.css({left:a.outerWidth(),top:0,"z-index":++$.coral.zindex}),b.show())}}),$.component("coral.menubar",$.coral.tieredmenu,{options:{},component:function(){return this.element.parent()},_create:function(){this._super(),this.options.vertical?this.options.vertical&&this.element.parent().addClass("coral-menubar-vertical").removeClass("coral-tieredmenu"):this.element.parent().removeClass("coral-tieredmenu").addClass("coral-menubar").addClass("coral-menubar-horizontal"),this.element.find(">li>ul").addClass("coral-dropdown-menu"),this.options.responsive&&this.component().addClass("menu-responsive"),this.options.minmenu&&this.component().addClass("coral-menu-min"),this.options.collapseButton&&$("<div class='coral-menubar-toggle coral-menubar-collapse'><a href='javascript:void(0)' class='coral-menubar-collapseButton "+this.options.collapseIcon+"'></a></div>").insertAfter(this.element);var a=this;if(this.component().find(".coral-menubar-collapseButton").click(function(){$(this).hasClass(a.options.collapseIcon)?($(this).removeClass(a.options.collapseIcon).addClass(a.options.expandIcon),$(this).parents(".coral-menu").removeClass("coral-menu-min").addClass("coral-menu-min")):$(this).hasClass(a.options.expandIcon)&&($(this).removeClass(a.options.expandIcon).addClass(a.options.collapseIcon),$(this).parents(".coral-menu").removeClass("coral-menu-min"))}),this.options.firstIsactive){var b=this.element.find("li");b=b.filter(function(a){return!$(b[a]).hasClass("coral-menu-parent")});var c=$(b.get(0)).children("a");c.data("isactive",!0),this.setMenuItemIsactive(c)}if(this.options.openFirst){var b=this.element.find("li:first"),c=b.children("a");c.next("ul.coral-menu-child").css({display:"block"})}},_setOption:function(a,b){this._super(a,b),"minmenu"==a&&(b?this.component().removeClass("coral-menu-min").addClass("coral-menu-min"):b||this.component().removeClass("coral-menu-min"))},_showSubmenu:function(a,b){var c=$(window),d=null,e={"z-index":++$.coral.zindex};a.parent().hasClass("coral-menu-child")?(e.left=a.outerWidth(),e.top=0,d=a.offset().top-c.scrollTop()):(e.left=0,a.parent().parent().hasClass("coral-menu-min")?e.top=a.outerHeight()+37:e.top=a.outerHeight(),d=a.offset().top+e.top-c.scrollTop()),b.css("height","auto"),d+b.outerHeight()>c.height()&&(e.overflow="auto",e.height=c.height()-(d+20)),b.css(e).show()}}),$.component("coral.slidemenu",$.coral.basemenu,{_create:function(){this._generateULContent(),this._render(),this.rootList=this.element,this.content=this.element.parent(),this.wrapper=this.content.parent(),this.container=this.wrapper.parent(),this.submenus=this.container.find("ul.coral-menu-list"),this.links=this.element.find("a.coral-menuitem-link:not(.coral-state-disabled)"),this.backward=this.wrapper.children("div.coral-slidemenu-backward"),this.stack=[],this.jqWidth=this.container.width();this.element.hasClass("coral-menu-dynamic")||this._applyDimensions(),this._super(),this._bindEvents()},_render:function(){var a=this;this.element.addClass("coral-menu-list coral-helper-reset").wrap('<div class="coral-menu coral-slidemenu coral-component coral-component-content coral-corner-all coral-helper-clearfix"/>').wrap('<div class="coral-slidemenu-wrapper" />').after('<div class="coral-slidemenu-backward coral-component-header coral-corner-all coral-helper-clearfix">\n                    <span class="coral-icon coral-icon-triangle-1-w"></span>Back</div>').wrap('<div class="coral-slidemenu-content" />'),this.element.parent().uniqueId(),this.options.id=this.element.parent().attr("id"),this.element.find("li").each(function(){var b=$(this),c=b.children("a"),d=c.data("icon");a._setMenuItemLinkDisabled(c),c.addClass("coral-menuitem-link coral-corner-all").contents().wrap('<span class="coral-menuitem-text" />'),d&&c.prepend('<span class="menu-icon '+d+'"></span>'),b.addClass("coral-menuitem coral-component coral-corner-all"),b.children("ul").length>0&&(b.addClass("coral-menu-parent"),b.children("ul").addClass("coral-component-content coral-menu-list coral-corner-all coral-helper-clearfix coral-menu-child coral-shadow"),c.prepend('<span class="menu-rightArrow cui-icon-arrowDown1"></span>'))})},_bindEvents:function(){var a=this;this._bindMenuItemClick(a),this.links.on("mouseenter.coral-menu",function(){$(this).addClass("coral-state-hover")}).on("mouseleave.coral-menu",function(){$(this).removeClass("coral-state-hover")}).on("click.coral-menu",function(){var b=$(this),c=b.next();1==c.length&&a._forward(c)}),this.backward.on("click.coral-menu",function(){a._back()})},_forward:function(a){var b=this;this._push(a);var c=-1*(this._depth()*this.jqWidth);a.show().css({left:this.jqWidth}),this.rootList.animate({left:c},300,"easeInOutCirc",function(){b.backward.is(":hidden")&&b.backward.fadeIn("fast")})},_back:function(){var a=this,b=this._pop(),c=this._depth(),d=-1*(c*this.jqWidth);this.rootList.animate({left:d},300,"easeInOutCirc",function(){b.hide(),0===c&&a.backward.fadeOut("fast")})},_push:function(a){this.stack.push(a)},_pop:function(){return this.stack.pop()},_last:function(){return this.stack[this.stack.length-1]},_depth:function(){return this.stack.length},_applyDimensions:function(){this.submenus.width(this.container.width()),this.wrapper.height(this.rootList.outerHeight(!0)+this.backward.outerHeight(!0)),this.content.height(this.rootList.outerHeight(!0)),this.rendered=!0},show:function(){this.align(),this.container.css("z-index",++$.coral.zindex).show(),this.rendered||this._applyDimensions()}}),$.component("coral.contextmenu",$.coral.tieredmenu,{options:{autoDisplay:!0,target:null,event:"contextmenu"},_create:function(){this._super(),this.element.parent().removeClass("coral-tieredmenu").addClass("coral-contextmenu coral-menu-dynamic coral-shadow coral-contextmenu");var a=this;this.options.target="string"==typeof this.options.target?$("#"+this.options.target):this.options.target,this.options.target=this.options.target||$(document),this.element.parent().parent().is(document.body)||this.element.parent().appendTo("body"),this.options.target.on(this.options.event+".coral-contextmenu",function(b){a.show(b)})},_bindItemEvents:function(){this._super();var a=this;this.links.bind("click",function(){return $(this).parent().hasClass("coral-menu-parent")?!1:void a._hide()})},_bindDocumentHandler:function(){var a=this;$(document.body).bind("click.coral-contextmenu",function(b){a.element.parent().is(":hidden")||a._hide()})},show:function(a){if(this.options.disabled===!0)return a.preventDefault(),void a.stopPropagation();$(document.body).children(".coral-contextmenu:visible").hide();var b=$(window),c=a.pageX,d=a.pageY,e=this.element.parent().outerWidth(),f=this.element.parent().outerHeight();c+e>b.width()+b.scrollLeft()&&(c-=e),d+f>b.height()+b.scrollTop()&&(d-=f),this.options.beforeShow&&this.options.beforeShow.call(this),this.element.parent().css({left:c,top:d,"z-index":++$.coral.zindex}).show(),a.preventDefault(),a.stopPropagation()},_hide:function(){var a=this;this.element.parent().find("li.coral-menuitem-active").each(function(){a._deactivate($(this),!0)}),this.element.parent().fadeOut("fast")},isVisible:function(){return this.element.parent().is(":visible")},getTarget:function(){return this.jqTarget}}),$.component("coral.navigatemenubase",$.coral.basemenu,{options:{autoDisplay:!0},_create:function(){this._generateULContent(),this._render(),this.links=this.element.find(".coral-menuitem-link:not(.coral-state-disabled)"),this._bindEvents(),this._super()},_render:function(){var a=this;this.element.addClass("coral-menu-list coral-helper-reset").wrap('<div class="coral-tieredmenu coral-menu coral-component coral-component-content coral-corner-all coral-helper-clearfix" />'),this.element.parent().uniqueId(),this.options.id=this.element.parent().attr("id"),this.element.find("li").each(function(){var b=$(this),c=b.children("a"),d=c.data("icon");a._setMenuItemLinkDisabled(c),c.addClass("coral-menuitem-link coral-corner-all").contents().wrap('<span class="coral-menuitem-text" />'),d&&c.prepend('<span class="menu-icon '+d+'"></span>'),b.addClass("coral-menuitem coral-component coral-corner-all"),b.children("ul").length>0&&(b.addClass("coral-menu-parent"),b.css("position","static"),b.children("ul").css("width","100%"),b.find("ul li").css("width","auto"),b.find("ul li a").css("width","auto"),b.children("ul").addClass("coral-component-content coral-menu-list coral-corner-all coral-helper-clearfix coral-menu-child coral-shadow"),c.prepend('<span class="menu-rightArrow cui-icon-arrowDown1"></span>'))})},_bindEvents:function(){this._bindItemEvents(),this._bindDocumentHandler()},_bindItemEvents:function(){var a=this;this._bindMenuItemClick(a),this.links.on("mouseenter.coral-menu",function(){if(a.options.disabled!==!0){var b=$(this),c=b.parent(),d=a.options.autoDisplay,e=c.siblings(".coral-menuitem-active");1===e.length&&a._deactivate(e),d||a.active?c.hasClass("coral-menuitem-active")?a._reactivate(c):a._activate(c):a._highlight(c)}}),this.options.autoDisplay===!1&&(this.rootLinks=this.element.find("> .coral-menuitem > .coral-menuitem-link"),this.rootLinks.data("primecoral-tieredmenu-rootlink",this.options.id).find("*").data("primecoral-tieredmenu-rootlink",this.options.id),this.rootLinks.on("click.coral-menu",function(b){var c=$(this),d=c.parent(),e=d.children("ul.coral-menu-child");1===e.length&&(e.is(":visible")?(a.active=!1,a._deactivate(d)):(a.active=!0,a._highlight(d),a._showSubmenu(d,e)))})),this.element.parent().find("ul.coral-menu-list").on("mouseleave.coral-menu",function(b){a.activeitem,b.stopPropagation()})},_bindDocumentHandler:function(){var a=this;$(document.body).on("click.coral-menu ",function(b){var c=$(b.target);c.data("primecoral-tieredmenu-rootlink")!==a.options.id&&(c.is("[type='checkbox']")||(a.active=!1,a.element.find("li.coral-menuitem-active").each(function(){"false"===a.options.fixmenu&&a._deactivate($(this),!0)})))})},_deactivate:function(a,b){this.activeitem=null,a.children("a.coral-menuitem-link").removeClass("coral-state-hover"),a.removeClass("coral-menuitem-active"),b?a.children("ul.coral-menu-child:visible").fadeOut("fast"):a.children("ul.coral-menu-child:visible").hide()},_activate:function(a){this._highlight(a);var b=a.children("ul.coral-menu-child");1===b.length&&this._showSubmenu(a,b)},_reactivate:function(a){this.activeitem=a;var b=a.children("ul.coral-menu-child"),c=b.children("li.coral-menuitem-active:first"),d=this;1===c.length&&d._deactivate(c)},_highlight:function(a){this.activeitem=a,a.children("a.coral-menuitem-link").addClass("coral-state-hover"),a.addClass("coral-menuitem-active")},_showSubmenu:function(a,b){this.options.disabled!==!0&&(b.css({left:a.outerWidth(),top:0,"z-index":++$.coral.zindex}),b.show())}}),$.component("coral.navigatemenu",$.coral.navigatemenubase,{options:{autoDisplay:!0,checkable:null,fixmenu:null},_generateHTML:function(a,b){a+="<ul>";for(var c=0;c<b.length;c++){a+="<li>",a+=this._generateANode(b[c]);var d=b[c].name,e=b[c].items;e.length>0&&(a=this._generateLast(a,e,d)),a+="</li>"}return a+="</ul>"},_generateLast:function(a,b,c){a+="<ul>";for(var d=0;d<b.length;d++)a+="<li>",a+=this._generateChbNode(b[d],c),a+="</li>";return a+="</ul>"},_generateChbNode:function(a,b){var c="<a";""!=a.iconclass,""!=a.name&&(c+=" data-name='"+a.name+"'"),""!=a.disabled&&(c+=" data-disabled='"+a.disabled+"'"),""!=a.url&&(c+=" href='"+a.url+"'"),""!=a.target&&(c+=" target='"+a.target+"'"),c+=">";var d=a.checked===!0?"checked":"",e="true"==a.disabled?"disabled=true":"",f="<input type='radio' "+e+" name='"+b+"' "+d+" data-id='"+this.element[0].id+"_"+a.name+"'/>";return this.options.checkable===!0&&(f="<input type='checkbox' "+e+" "+d+" data-id='"+this.element[0].id+"_"+a.name+"'/>"),c+=f,""!=a.name&&(c+=a.name),c+="</a>"},_create:function(){if(this._super(),this.element.parent().removeClass("coral-tieredmenu").addClass("coral-navigatemenu"),"false"!==this.options.fixmenu){var a=$(this.links[0]).parent(":first").find("ul").outerHeight(),b=this.element.parent().outerHeight();this.element.parent().outerHeight(a+b-3)}"false"!==this.options.fixmenu&&(this._activate($(this.links[0]).parent()),$(this.links[0]).parent(":first").find("ul").css("height","auto"))},_showSubmenu:function(a,b){var c=$(window),d=null,e={"z-index":++$.coral.zindex};a.parent().hasClass("coral-menu-child")?(e.left=a.outerWidth(),e.top=0,d=a.offset().top-c.scrollTop()):(e.left=0,e.top=this.element.parent().outerHeight(),d=a.offset().top+e.top-c.scrollTop()),b.css("height","auto"),d+b.outerHeight()>c.height()&&(e.overflow="auto",e.height=c.height()-(d+20)),b.css(e).show()},check:function(a,b){$("[data-id='"+this.element[0].id+"_"+a+"']").prop("checked",b)}});/*! cui 2016-11-08 */
var swfobject=function(){function a(){if(!R){try{var a=K.getElementsByTagName("body")[0].appendChild(q("span"));a.parentNode.removeChild(a)}catch(b){return}R=!0;for(var c=N.length,d=0;c>d;d++)N[d]()}}function b(a){R?a():N[N.length]=a}function c(a){if(typeof J.addEventListener!=C)J.addEventListener("load",a,!1);else if(typeof K.addEventListener!=C)K.addEventListener("load",a,!1);else if(typeof J.attachEvent!=C)r(J,"onload",a);else if("function"==typeof J.onload){var b=J.onload;J.onload=function(){b(),a()}}else J.onload=a}function d(){M?e():f()}function e(){var a=K.getElementsByTagName("body")[0],b=q(D);b.setAttribute("type",G);var c=a.appendChild(b);if(c){var d=0;!function(){if(typeof c.GetVariable!=C){var e=c.GetVariable("$version");e&&(e=e.split(" ")[1].split(","),U.pv=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)])}else if(10>d)return d++,void setTimeout(arguments.callee,10);a.removeChild(b),c=null,f()}()}else f()}function f(){var a=O.length;if(a>0)for(var b=0;a>b;b++){var c=O[b].id,d=O[b].callbackFn,e={success:!1,id:c};if(U.pv[0]>0){var f=p(c);if(f)if(!s(O[b].swfVersion)||U.wk&&U.wk<312)if(O[b].expressInstall&&h()){var k={};k.data=O[b].expressInstall,k.width=f.getAttribute("width")||"0",k.height=f.getAttribute("height")||"0",f.getAttribute("class")&&(k.styleclass=f.getAttribute("class")),f.getAttribute("align")&&(k.align=f.getAttribute("align"));for(var l={},m=f.getElementsByTagName("param"),n=m.length,o=0;n>o;o++)"movie"!=m[o].getAttribute("name").toLowerCase()&&(l[m[o].getAttribute("name")]=m[o].getAttribute("value"));i(k,l,c,d)}else j(f),d&&d(e);else u(c,!0),d&&(e.success=!0,e.ref=g(c),d(e))}else if(u(c,!0),d){var q=g(c);q&&typeof q.SetVariable!=C&&(e.success=!0,e.ref=q),d(e)}}}function g(a){var b=null,c=p(a);if(c&&"OBJECT"==c.nodeName)if(typeof c.SetVariable!=C)b=c;else{var d=c.getElementsByTagName(D)[0];d&&(b=d)}return b}function h(){return!S&&s("6.0.65")&&(U.win||U.mac)&&!(U.wk&&U.wk<312)}function i(a,b,c,d){S=!0,y=d||null,z={success:!1,id:c};var e=p(c);if(e){"OBJECT"==e.nodeName?(w=k(e),x=null):(w=e,x=c),a.id=H,(typeof a.width==C||!/%$/.test(a.width)&&parseInt(a.width,10)<310)&&(a.width="310"),(typeof a.height==C||!/%$/.test(a.height)&&parseInt(a.height,10)<137)&&(a.height="137"),K.title=K.title.slice(0,47)+" - Flash Player Installation";var f=U.ie&&U.win?"ActiveX":"PlugIn",g="MMredirectURL="+J.location.toString().replace(/&/g,"%26")+"&MMplayerType="+f+"&MMdoctitle="+K.title;if(typeof b.flashvars!=C?b.flashvars+="&"+g:b.flashvars=g,U.ie&&U.win&&4!=e.readyState){var h=q("div");c+="SWFObjectNew",h.setAttribute("id",c),e.parentNode.insertBefore(h,e),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}l(a,b,c)}}function j(a){if(U.ie&&U.win&&4!=a.readyState){var b=q("div");a.parentNode.insertBefore(b,a),b.parentNode.replaceChild(k(a),b),a.style.display="none",function(){4==a.readyState?a.parentNode.removeChild(a):setTimeout(arguments.callee,10)}()}else a.parentNode.replaceChild(k(a),a)}function k(a){var b=q("div");if(U.win&&U.ie)b.innerHTML=a.innerHTML;else{var c=a.getElementsByTagName(D)[0];if(c){var d=c.childNodes;if(d)for(var e=d.length,f=0;e>f;f++)1==d[f].nodeType&&"PARAM"==d[f].nodeName||8==d[f].nodeType||b.appendChild(d[f].cloneNode(!0))}}return b}function l(a,b,c){var d,e=p(c);if(U.wk&&U.wk<312)return d;if(e)if(typeof a.id==C&&(a.id=c),U.ie&&U.win){var f="";for(var g in a)a[g]!=Object.prototype[g]&&("data"==g.toLowerCase()?b.movie=a[g]:"styleclass"==g.toLowerCase()?f+=' class="'+a[g]+'"':"classid"!=g.toLowerCase()&&(f+=" "+g+'="'+a[g]+'"'));var h="";for(var i in b)b[i]!=Object.prototype[i]&&(h+='<param name="'+i+'" value="'+b[i]+'" />');e.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+f+">"+h+"</object>",P[P.length]=a.id,d=p(a.id)}else{var j=q(D);j.setAttribute("type",G);for(var k in a)a[k]!=Object.prototype[k]&&("styleclass"==k.toLowerCase()?j.setAttribute("class",a[k]):"classid"!=k.toLowerCase()&&j.setAttribute(k,a[k]));for(var l in b)b[l]!=Object.prototype[l]&&"movie"!=l.toLowerCase()&&m(j,l,b[l]);e.parentNode.replaceChild(j,e),d=j}return d}function m(a,b,c){var d=q("param");d.setAttribute("name",b),d.setAttribute("value",c),a.appendChild(d)}function n(a){var b=p(a);b&&"OBJECT"==b.nodeName&&(U.ie&&U.win?(b.style.display="none",function(){4==b.readyState?o(a):setTimeout(arguments.callee,10)}()):b.parentNode.removeChild(b))}function o(a){var b=p(a);if(b){for(var c in b)"function"==typeof b[c]&&(b[c]=null);b.parentNode.removeChild(b)}}function p(a){var b=null;try{b=K.getElementById(a)}catch(c){}return b}function q(a){return K.createElement(a)}function r(a,b,c){a.attachEvent(b,c),Q[Q.length]=[a,b,c]}function s(a){var b=U.pv,c=a.split(".");return c[0]=parseInt(c[0],10),c[1]=parseInt(c[1],10)||0,c[2]=parseInt(c[2],10)||0,b[0]>c[0]||b[0]==c[0]&&b[1]>c[1]||b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]}function t(a,b,c,d){if(!U.ie||!U.mac){var e=K.getElementsByTagName("head")[0];if(e){var f=c&&"string"==typeof c?c:"screen";if(d&&(A=null,B=null),!A||B!=f){var g=q("style");g.setAttribute("type","text/css"),g.setAttribute("media",f),A=e.appendChild(g),U.ie&&U.win&&typeof K.styleSheets!=C&&K.styleSheets.length>0&&(A=K.styleSheets[K.styleSheets.length-1]),B=f}U.ie&&U.win?A&&typeof A.addRule==D&&A.addRule(a,b):A&&typeof K.createTextNode!=C&&A.appendChild(K.createTextNode(a+" {"+b+"}"))}}}function u(a,b){if(T){var c=b?"visible":"hidden";R&&p(a)?p(a).style.visibility=c:t("#"+a,"visibility:"+c)}}function v(a){var b=/[\\\"<>\.;]/,c=null!=b.exec(a);return c&&typeof encodeURIComponent!=C?encodeURIComponent(a):a}var w,x,y,z,A,B,C="undefined",D="object",E="Shockwave Flash",F="ShockwaveFlash.ShockwaveFlash",G="application/x-shockwave-flash",H="SWFObjectExprInst",I="onreadystatechange",J=window,K=document,L=navigator,M=!1,N=[d],O=[],P=[],Q=[],R=!1,S=!1,T=!0,U=function(){var a=typeof K.getElementById!=C&&typeof K.getElementsByTagName!=C&&typeof K.createElement!=C,b=L.userAgent.toLowerCase(),c=L.platform.toLowerCase(),d=c?/win/.test(c):/win/.test(b),e=c?/mac/.test(c):/mac/.test(b),f=/webkit/.test(b)?parseFloat(b.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,g=!1,h=[0,0,0],i=null;if(typeof L.plugins!=C&&typeof L.plugins[E]==D)i=L.plugins[E].description,!i||typeof L.mimeTypes!=C&&L.mimeTypes[G]&&!L.mimeTypes[G].enabledPlugin||(M=!0,g=!1,i=i.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),h[0]=parseInt(i.replace(/^(.*)\..*$/,"$1"),10),h[1]=parseInt(i.replace(/^.*\.(.*)\s.*$/,"$1"),10),h[2]=/[a-zA-Z]/.test(i)?parseInt(i.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof J.ActiveXObject!=C)try{var j=new ActiveXObject(F);j&&(i=j.GetVariable("$version"),i&&(g=!0,i=i.split(" ")[1].split(","),h=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)]))}catch(k){}return{w3:a,pv:h,wk:f,ie:g,win:d,mac:e}}();(function(){U.w3&&((typeof K.readyState!=C&&"complete"==K.readyState||typeof K.readyState==C&&(K.getElementsByTagName("body")[0]||K.body))&&a(),R||(typeof K.addEventListener!=C&&K.addEventListener("DOMContentLoaded",a,!1),U.ie&&U.win&&(K.attachEvent(I,function(){"complete"==K.readyState&&(K.detachEvent(I,arguments.callee),a())}),J==top&&!function(){if(!R){try{K.documentElement.doScroll("left")}catch(b){return void setTimeout(arguments.callee,0)}a()}}()),U.wk&&!function(){return R?void 0:/loaded|complete/.test(K.readyState)?void a():void setTimeout(arguments.callee,0)}(),c(a)))})(),function(){U.ie&&U.win&&window.attachEvent("onunload",function(){for(var a=Q.length,b=0;a>b;b++)Q[b][0].detachEvent(Q[b][1],Q[b][2]);for(var c=P.length,d=0;c>d;d++)n(P[d]);for(var e in U)U[e]=null;U=null;for(var f in swfobject)swfobject[f]=null;swfobject=null})}();return{registerObject:function(a,b,c,d){if(U.w3&&a&&b){var e={};e.id=a,e.swfVersion=b,e.expressInstall=c,e.callbackFn=d,O[O.length]=e,u(a,!1)}else d&&d({success:!1,id:a})},getObjectById:function(a){return U.w3?g(a):void 0},embedSWF:function(a,c,d,e,f,g,j,k,m,n){var o={success:!1,id:c};U.w3&&!(U.wk&&U.wk<312)&&a&&c&&d&&e&&f?(u(c,!1),b(function(){d+="",e+="";var b={};if(m&&typeof m===D)for(var p in m)b[p]=m[p];b.data=a,b.width=d,b.height=e;var q={};if(k&&typeof k===D)for(var r in k)q[r]=k[r];if(j&&typeof j===D)for(var t in j)typeof q.flashvars!=C?q.flashvars+="&"+t+"="+j[t]:q.flashvars=t+"="+j[t];if(s(f)){var v=l(b,q,c);b.id==c&&u(c,!0),o.success=!0,o.ref=v}else{if(g&&h())return b.data=g,void i(b,q,c,n);u(c,!0)}n&&n(o)})):n&&n(o)},switchOffAutoHideShow:function(){T=!1},ua:U,getFlashPlayerVersion:function(){return{major:U.pv[0],minor:U.pv[1],release:U.pv[2]}},hasFlashPlayerVersion:s,createSWF:function(a,b,c){return U.w3?l(a,b,c):void 0},showExpressInstall:function(a,b,c,d){U.w3&&h()&&i(a,b,c,d)},removeSWF:function(a){U.w3&&n(a)},createCSS:function(a,b,c,d){U.w3&&t(a,b,c,d)},addDomLoadEvent:b,addLoadEvent:c,getQueryParamValue:function(a){var b=K.location.search||K.location.hash;if(b){if(/\?/.test(b)&&(b=b.split("?")[1]),null==a)return v(b);for(var c=b.split("&"),d=0;d<c.length;d++)if(c[d].substring(0,c[d].indexOf("="))==a)return v(c[d].substring(c[d].indexOf("=")+1))}return""},expressInstallCallback:function(){if(S){var a=p(H);a&&w&&(a.parentNode.replaceChild(w,a),x&&(u(x,!0),U.ie&&U.win&&(w.style.display="block")),y&&y(z)),S=!1}}}}();/*! cui 2016-11-08 */
$.component("coral.swfuploader",{options:{swfUploadOptions:null,swf:"external/swfupload.swf",uploader:"swfupload.php",auto:!0,buttonClass:"",buttonCursor:"hand",buttonImage:null,buttonText:"SELECT FILES",checkExisting:!1,debug:!1,fileObjName:"Filedata",maxFileSize:0,fileTypeDesc:"All Files",fileTypeExts:"*.*",uploadTemplate:!1,method:"post",multiple:!0,formData:{},preventCaching:!0,uploadedFileList:[],separator:",",progressData:"speed",queueID:!1,queueSizeLimit:999,removeCompleted:!0,removeTimeout:3,requeueErrors:!1,successTimeout:30,uploadLimit:999,overrideEvents:[]},_create:function(){var a=this,b=this.element.clone(),c=this.options;this.options.id=this.element.attr("id");var d=$("<div />",{id:c.id+"_wrappper","class":"swfuploader",css:{height:c.height+"px",width:c.width+"px"}});this.element.append(d);var e={assume_success_timeout:c.successTimeout,button_placeholder_id:d[0].id,button_width:c.width,button_height:c.height,button_text:null,button_text_style:null,button_text_top_padding:0,button_text_left_padding:0,button_action:c.multiple?SWFUpload.BUTTON_ACTION.SELECT_FILES:SWFUpload.BUTTON_ACTION.SELECT_FILE,button_disabled:!1,button_cursor:"arrow"==c.buttonCursor?SWFUpload.CURSOR.ARROW:SWFUpload.CURSOR.HAND,button_window_mode:SWFUpload.WINDOW_MODE.TRANSPARENT,debug:c.debug,requeue_on_error:c.requeueErrors,file_post_name:c.fileObjName,file_size_limit:c.maxFileSize,file_types:c.fileTypeExts,file_types_description:c.fileTypeDesc,file_queue_limit:c.queueSizeLimit,file_upload_limit:c.uploadLimit,flash_url:c.swf,prevent_swf_caching:c.preventCaching,post_params:c.formData,upload_url:c.uploader,delete_url:c.deleteUrl,use_query_string:"get"==c.method,swfupload_loaded_handler:c.onSWFReady,file_dialog_complete_handler:this.onDialogClose,file_dialog_start_handler:this.onDialogOpen,file_queued_handler:function(b){a.onSelect.apply(a,[this,b])},file_queue_error_handler:function(b,c,d){a.onSelectError.apply(a,[this,b,c,d])},upload_complete_handler:function(b){a.onUploadComplete.apply(a,[this,b])},upload_error_handler:function(b,c,d){a.onUploadError.apply(a,[this,b,c,d])},upload_progress_handler:function(b,c,d){a.onUploadProgress.apply(a,[this,b,c,d])},upload_start_handler:function(b){a.onUploadStart.apply(a,[this,b])},upload_remove_handler:function(b){a.onRemove.apply(a,[this,b])},upload_success_handler:function(b,c,d){a.onUploadSuccess.apply(a,[this,b,c,d])}};c.swfUploadOptions&&(e=$.extend(e,c.swfUploadOptions)),e=$.extend(e,c);var f=swfobject.getFlashPlayerVersion(),g=f.major>=9;if(g){window["swfuploader_"+c.id]=new SWFUpload(e);var h=window["swfuploader_"+c.id];if(this.element.data("swfuploader",h),$("#"+h.movieName).wrap(d),d=$("#"+c.id),d.data("swfuploader",h),$("#"+h.movieName).css({position:"absolute","z-index":1}),!c.queueID){var i=$("<div />",{id:c.id+"-queue","class":"swfuploader-queue"});d.after(i),h.settings.queueID=c.id+"-queue",h.settings.defaultQueue=!0}h.queueData={files:{},filesSelected:0,filesQueued:0,filesReplaced:0,filesCancelled:0,filesErrored:0,uploadsSuccessful:0,uploadsErrored:0,averageSpeed:0,queueLength:0,queueSize:0,uploadSize:0,queueBytesUploaded:0,uploadQueue:[],errorMsg:"Some files were not added to the queue:"},h.original=b,h.wrapper=d,h.queue=i,c.onInit&&c.onInit.call(this.element,h)}else{var j=c.onNoflash.call(this.element),k=$("<div class='coral-uploader-button' style='height: 40px;'></div>").appendTo(j),l=$("<input type='button'/>").appendTo(k);l.button({id:c.id+"-button",label:c.buttonText,onClick:function(){alert("没有安装flash或flash版本过低")}})}},addUploadCount:function(){var a=this.element.data("swfuploader");a.addUploadCount()},reduece:function(a){var b=this.element.data("swfuploader"),c=b.settings;if($("#"+a).hasClass("template-download")){b.reduceUploadCount(),uploadList=c.uploadedFileList;var d=this.getValues();uploadList.splice($.inArray(a,d),1)}else if($("#"+a).hasClass("template-upload")){downList=c.unUploadedFileList;var d=this.getUnUploadValues();downList.splice($.inArray(a,d),1)}},setValues:function(a){var b=this.element.data("swfuploader"),c=b.settings;c.uploadedFileList=a},cancel:function(a,b){var c,d,e=arguments,f=this,g=this.element.data("swfuploader"),h=g.settings,i=-1;if(!h.disabled)if("array"==typeof a||"undefined"==typeof a)if("undefined"==typeof a){var j=g.queueData.queueLength;$("#"+h.queueID).children().each(function(){i++,e[1]===!0?g.cancelUpload(this.id,!1):g.cancelUpload(this.id),$(this).find(".data").removeClass("data");var a=f.getValues();if(-1!=$.inArray(this.id,a)){var b=$("#"+this.id),c=$(b);if(c.data().url&&"undefined"!=c.data().url){for(var d={},j=0;j<h.uploadedFileList.length;j++)this.id==h.uploadedFileList[j].fileId&&(d.data=h.uploadedFileList[j]);d.dataType=h.dataType||"json",d.url=h.uploadedFileList[0].fileUrl,$.ajax(d).done(function(){c.delay(1e3).fadeOut(500,function(){$(this).remove()})}),f._trigger("onRemove",null,{fileId:this.id})}else c.delay(1e3+100*i).fadeOut(500,function(){$(this).remove()}),f._trigger("onRemove",null,{fileId:this.id});delete g.queueData.files[this.id],f.reduece(this.id)}}),g.queueData.queueSize=0,g.queueData.queueLength=0,h.onClearQueue&&h.onClearQueue.call(this.element,j)}else for(var k=0;k<e.length;k++)g.cancelUpload(e[k]),$("#"+e[k]).find(".data").removeClass("data"),$("#"+e[k]).delay(1e3+100*k).fadeOut(500,function(){$(this).remove()}),this._trigger("onRemove",null),delete g.queueData.files[e[k]],f.reduece(e[k]);else{var l=$("#"+a);if($item=$(l),g.cancelUpload($item.attr("id")),$item.find(".data").removeClass("data"),$item.data().url&&"undefined"!=$item.data().url){for(var m={},n=0;n<h.uploadedFileList.length;n++)a==h.uploadedFileList[n].fileId&&(m.data=h.uploadedFileList[n]);m.dataType=h.dataType||"json",m.url=$item.data().url,$.ajax(m).done(function(){$item.delay(1e3).fadeOut(500,function(){$(this).remove()})})}else $item.delay(1e3).fadeOut(500,function(){$(this).remove()});if(this._trigger("onRemove",null),delete g.queueData.files[a],$("#"+a).hasClass("template-download")){g.reduceUploadCount(),c=h.uploadedFileList;var o=this.getValues();c.splice($.inArray(a,o),1)}else if($("#"+a).hasClass("template-upload")){d=h.unUploadedFileList;var o=this.getUnUploadValues();d.splice($.inArray(a,o),1)}}},_destroy:function(){var a=this.element.data("swfuploader"),b=a.settings;a.destroy(),this.element.find(".swfuploader").remove(),b.uploadedFileList&&$("#"+b.queueID).remove(),$("#"+b.id).replaceWith(this.element),b.onDestroy&&b.onDestroy.call(this),delete a},disable:function(a){var b=this.element.data("swfuploader"),c=b.settings;a?($("#"+this.options.queueID).addClass("coral-state-disabled"),c.disabled=!0,this._trigger("onDisable",null,[])):($("#"+this.options.queueID).removeClass("coral-state-disabled"),c.disabled=!1,this._trigger("onEnable",null,[])),b.setButtonDisabled(a)},getQueueData:function(){for(var a=[],b=[],c=this.element.data("swfuploader"),d=c.settings,e=0;e<d.uploadedFileList.length;e++)a.push(d.uploadedFileList[e].fileId);for(var e=0;e<d.unUploadedFileList.length;e++)b.push(d.unUploadedFileList[e].fileId);return $.merge(a,b)},getUnUploadValues:function(){for(var a=[],b=this.element.data("swfuploader"),c=b.settings,d=0;d<c.unUploadedFileList.length;d++)a.push(c.unUploadedFileList[d].fileId);return a},getValues:function(){for(var a=[],b=this.element.data("swfuploader"),c=b.settings,d=0;d<c.uploadedFileList.length;d++)a.push(c.uploadedFileList[d].fileId);return a},getValue:function(){var a=this.element.data("swfuploader"),b=a.settings;return this.getValues().join(b.separator)},getValidateValue:function(){return this.getValue()},_setOption:function(a,b,c){var d=this.element.data("swfuploader"),e=d.settings;switch(this._super(a,b),a){case"uploader":d.setUploadURL(b);break;case"formData":c||(b=$.extend(e.formData,b)),d.setPostParams(e.formData);break;case"method":"get"==b?d.setUseQueryString(!0):d.setUseQueryString(!1);break;case"fileObjName":d.setFilePostName(b);break;case"fileTypeExts":d.setFileTypes(b,e.fileTypeDesc);break;case"fileTypeDesc":d.setFileTypes(e.fileTypeExts,b);break;case"maxFileSize":d.setFileSizeLimit(b);break;case"uploadLimit":d.setFileUploadLimit(b);break;case"queueSizeLimit":d.setFileQueueLimit(b);break;case"buttonCursor":"arrow"==b?d.setButtonCursor(SWFUpload.CURSOR.ARROW):d.setButtonCursor(SWFUpload.CURSOR.HAND);break;case"buttonText":$("#"+this.options.id+"-button").find(".swfuploader-button-text").html(b);break;case"width":d.setButtonDimensions(b,e.height);break;case"height":d.setButtonDimensions(e.width,b);break;case"multiple":b?d.setButtonAction(SWFUpload.BUTTON_ACTION.SELECT_FILES):d.setButtonAction(SWFUpload.BUTTON_ACTION.SELECT_FILE)}},stop:function(){var a=this.element.data("swfuploader");a.queueData.averageSpeed=0,a.queueData.uploadSize=0,a.queueData.bytesUploaded=0,a.queueData.uploadQueue=[],a.stopUpload(),this._trigger("onStop",null,[])},upload:function(a){var b,c=arguments,d=this.element.data("swfuploader"),e=d.settings;if(d.queueData.averageSpeed=0,d.queueData.uploadSize=0,d.queueData.bytesUploaded=0,d.queueData.uploadQueue=[],!e.disabled)if(c[0]||"undefined"==typeof a)if("undefined"==typeof a){d.queueData.uploadSize=d.queueData.queueSize;e.unUploadedFileList;d.queueData.uploadQueue.push("*"),d.startUpload()}else{for(b=0;b<c.length;b++)d.queueData.uploadQueue.push(c[b]);d.startUpload(d.queueData.uploadQueue.shift())}else d.startUpload()},onDialogOpen:function(){var a=this.settings;this.queueData.errorMsg="Some files were not added to the queue:",this.queueData.filesReplaced=0,this.queueData.filesCancelled=0,a.onDialogOpen&&a.onDialogOpen.call(this)},onDialogClose:function(a,b,c){var d=this.settings;this.queueData.filesErrored=a-b,this.queueData.filesSelected=a,this.queueData.filesQueued=b-this.queueData.filesCancelled,this.queueData.queueLength=c,$.inArray("onDialogClose",d.overrideEvents)<0&&this.queueData.filesErrored>0,d.onDialogClose&&d.onDialogClose.call(this,this.queueData),d.auto&&$("#"+d.id).swfuploader("upload")},handerSWFEvent:function(){},validateFiles:function(a,b){var c=a.settings;return!c.acceptFileTypes||c.acceptFileTypes.test(b.type)||c.acceptFileTypes.test(b.name)?b.size>c.maxFileSize&&(b.error="The File is too large."):b.error="The file is not an accepted file type.",b.error},onSelect:function(a,b){var c,d=a.settings,e=Math.round(b.size/1024),f="KB";e>1e3&&(e=Math.round(e/1e3),f="MB");var g=e.toString().split(".");e=g[0],g.length>1&&(e+="."+g[1].substr(0,2)),e+=f;var h=b.name;if(h.length>25&&(h=h.substr(0,25)+"..."),itemData={fileID:b.id,instanceID:d.id,fileName:h,fileSize:e},$.inArray("onSelect",d.overrideEvents)<0){c=d.uploadTemplate({files:[b],options:d});for(var i in itemData)c=c.replace(new RegExp("\\$\\{"+i+"\\}","g"),itemData[i]);c=$(d.templatesContainer).html(c).children(),c.addClass("template-upload fade"),$("#"+d.queueID).append(c),this._trigger("onRenderUploadTmp",null,{item:c})}a.queueData.queueSize+=b.size,a.queueData.files[b.id]=b,this._trigger("onSelect",null,[{file:b}])},onSelectError:function(a,b,c,d){var e=a.settings;if($.inArray("onSelectError",e.overrideEvents)<0)switch(c){case SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:e.queueSizeLimit>d?alert("\nThe number of files selected exceeds the remaining upload limit"):$.messageQueue({message:e.messages.maxNumberOfFiles});break;case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:$.messageQueue({message:e.messages.maxFileSize});break;case SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:a.queueData.errorMsg='\nThe file "'+b.name+'" is empty.';break;case SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:$.messageQueue({message:e.messages.acceptFileTypes})}c!=SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED&&delete a.queueData.files[b.id],this._trigger("onSelectError",null,[{file:b,error:d}])},onQueueComplete:function(){this.settings.onQueueComplete&&this.settings.onQueueComplete.call(this,this.settings.queueData)},onUploadComplete:function(a,b){var c=a.settings,d=a,e=a.getStats();if(a.queueData.queueLength=e.files_queued,"*"==a.queueData.uploadQueue[0]?a.queueData.queueLength>0?a.startUpload():(a.queueData.uploadQueue=[],c.onQueueComplete&&c.onQueueComplete.call(a,a.queueData)):a.queueData.uploadQueue.length>0?a.startUpload(a.queueData.uploadQueue.shift()):(a.queueData.uploadQueue=[],c.onQueueComplete&&c.onQueueComplete.call(a,a.queueData)),$.inArray("onUploadComplete",c.overrideEvents)<0)if(c.removeCompleted)switch(b.filestatus){case SWFUpload.FILE_STATUS.COMPLETE:setTimeout(function(){$("#"+b.id)&&(d.queueData.queueSize-=b.size,d.queueData.queueLength-=1,delete d.queueData.files[b.id],$("#"+b.id).fadeOut(500,function(){$(this).remove()}))},1e3*c.removeTimeout);break;case SWFUpload.FILE_STATUS.ERROR:c.requeueErrors||setTimeout(function(){$("#"+b.id)&&(d.queueData.queueSize-=b.size,d.queueData.queueLength-=1,delete d.queueData.files[b.id],$("#"+b.id).fadeOut(500,function(){$(this).remove()}))},1e3*c.removeTimeout)}else b.uploaded=!0;var f=c.unUploadedFileList,g=this.getUnUploadValues();f.splice($.inArray(b[c.prmNames.fileId],g),1),this._trigger("onComplete",null,[{file:b}])},onUploadError:function(a,b,c,d){var e=a.settings,f="Error";switch(c){case SWFUpload.UPLOAD_ERROR.HTTP_ERROR:f="HTTP Error ("+d+")",this._trigger("onFail",null,[{file:b,error:d}]);break;case SWFUpload.UPLOAD_ERROR.MISSING_UPLOAD_URL:f="Missing Upload URL";break;case SWFUpload.UPLOAD_ERROR.IO_ERROR:f="IO Error",this._trigger("onFail",null,[{file:b,error:d}]);break;case SWFUpload.UPLOAD_ERROR.SECURITY_ERROR:f="Security Error",this._trigger("onFail",null,[{file:b,error:d}]);break;case SWFUpload.UPLOAD_ERROR.UPLOAD_LIMIT_EXCEEDED:alert("The upload limit has been reached ("+d+")."),f="Exceeds Upload Limit";break;case SWFUpload.UPLOAD_ERROR.UPLOAD_FAILED:f="Failed",this._trigger("onFail",null,[{file:b,error:d}]);break;case SWFUpload.UPLOAD_ERROR.SPECIFIED_FILE_ID_NOT_FOUND:break;case SWFUpload.UPLOAD_ERROR.FILE_VALIDATION_FAILED:f="Validation Error";break;case SWFUpload.UPLOAD_ERROR.FILE_CANCELLED:f="Cancelled",a.queueData.queueSize-=b.size,a.queueData.queueLength-=1,(b.status==SWFUpload.FILE_STATUS.IN_PROGRESS||$.inArray(b.id,a.queueData.uploadQueue)>=0)&&(a.queueData.uploadSize-=b.size),delete a.queueData.files[b.id];break;case SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED:f="Stopped",this._trigger("onFail",null,[{file:b,error:d}])}$.inArray("onUploadError",e.overrideEvents)<0;var g=a.getStats();a.queueData.uploadsErrored=g.upload_errors},onUploadProgress:function(a,b,c,d){var e=a.settings,f=new Date,g=f.getTime(),h=g-a.timer;h>500&&(a.timer=g);var i=c-a.bytesLoaded;a.bytesLoaded=c;var j=(a.queueData.queueBytesUploaded+c,Math.round(c/d*100)),k="KB/s",l=0,m=i/1024/(h/1e3);m=Math.floor(10*m)/10,a.queueData.averageSpeed>0?a.queueData.averageSpeed=Math.floor((a.queueData.averageSpeed+m)/2):a.queueData.averageSpeed=Math.floor(m),m>1e3&&(l=.001*m,a.queueData.averageSpeed=Math.floor(l),k="MB/s"),$.inArray("onUploadProgress",e.overrideEvents)<0&&($("#"+b.id).find(".progressbar-value").show().css("width",j+"%"),$("#"+b.id).find(".progressbar-text").text(j+"%")),this._trigger("onProgress",null,[{file:b}])},onUploadStart:function(a,b){var c=a.settings,d=new Date;a.timer=d.getTime(),a.bytesLoaded=0,0==a.queueData.uploadQueue.length&&(a.queueData.uploadSize=b.size),c.checkExisting&&$.ajax({type:"POST",async:!1,url:c.checkExisting,data:{filename:b.name},success:function(c){if(1==c){var d=confirm('A file with the name "'+b.name+'" already exists on the server.\nWould you like to replace the existing file?');d||(a.cancelUpload(b.id),$("#"+b.id).remove(),a.queueData.uploadQueue.length>0&&a.queueData.queueLength>0&&("*"==a.queueData.uploadQueue[0]?a.startUpload():a.startUpload(a.queueData.uploadQueue.shift())))}}}),this._trigger("onStart",null,[{file:b}]),this._trigger("onSend",null,[{file:b}])},onUploadSuccess:function(a,b,c,d){var e,f=a.settings,g=a.getStats(),h=JSON.parse(c).files;a.queueData.uploadsSuccessful=g.successful_uploads,a.queueData.queueBytesUploaded+=b.size,$.inArray("onUploadSuccess",f.overrideEvents)<0&&$("#"+b.id).find(".data").html(" - 上传完成");var i=Math.round(b.size/1024),j="KB";i>1e3&&(i=Math.round(i/1e3),j="MB");var k=i.toString().split(".");i=k[0],k.length>1&&(i+="."+k[1].substr(0,2)),i+=j;var l=b.name;if(l.length>25&&(l=l.substr(0,25)+"..."),$.inArray("onSelect",f.overrideEvents)<0){e=f.downloadTemplate({files:h,options:f});for(var m in itemData)e=e.replace(new RegExp("\\$\\{"+m+"\\}","g"),itemData[m]);f.uploadTemplate&&(e=$(f.templatesContainer).html(e).children(),e.addClass("template-download fade"),$("#"+b.id).replaceWith(e)),this._trigger("onRenderDownloadTmp",null,{item:e})}this._trigger("onSuccess",null,[{file:h[0]}])}});/*! cui 2016-11-08 */
!function(){"use strict";function a(a){var b="dragover"===a;return function(c){c.dataTransfer=c.originalEvent&&c.originalEvent.dataTransfer;var d=c.dataTransfer;d&&-1!==$.inArray("Files",d.types)&&this._trigger(a,$.Event(a,{delegatedEvent:c}))!==!1&&(c.preventDefault(),b&&(d.dropEffect="copy"))}}$.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||$('<input type="file">').prop("disabled")),$.support.xhrFileUpload=!(!window.ProgressEvent||!window.FileReader),$.support.xhrFormDataFileUpload=!!window.FormData,$.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),$.component("blueimp.fileupload",{options:{dropZone:$(document),pasteZone:void 0,fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,limitMultiFileUploadSize:void 0,limitMultiFileUploadSizeOverhead:512,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(a,b){return a=this.messages[a]||a.toString(),b&&$.each(b,function(b,c){a=a.replace("{"+b+"}",c)}),a},formData:function(a){return a.serializeArray()},add:function(a,b){return a.isDefaultPrevented()?!1:void((b.autoUpload||b.autoUpload!==!1&&$(this).fileupload("option","autoUpload"))&&b.process().done(function(){b.submit()}))},processData:!1,contentType:!1,cache:!1,timeout:0},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:$.support.blobSlice&&function(){var a=this.slice||this.webkitSlice||this.mozSlice;return a.apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime(),this.loaded=0,this.bitrate=0,this.getBitrate=function(a,b,c){var d=a-this.timestamp;return(!this.bitrate||!c||d>c)&&(this.bitrate=(b-this.loaded)*(1e3/d)*8,this.loaded=b,this.timestamp=a),this.bitrate}},_isXHRUpload:function(a){return!a.forceIframeTransport&&(!a.multipart&&$.support.xhrFileUpload||$.support.xhrFormDataFileUpload)},_getFormData:function(a){var b;return"function"===$.type(a.formData)?a.formData(a.form):$.isArray(a.formData)?a.formData:"object"===$.type(a.formData)?(b=[],$.each(a.formData,function(a,c){b.push({name:a,value:c})}),b):[]},_getTotal:function(a){var b=0;return $.each(a,function(a,c){b+=c.size||1}),b},_initProgressObject:function(a){var b={loaded:0,total:0,bitrate:0};a._progress?$.extend(a._progress,b):a._progress=b},_initResponseObject:function(a){var b;if(a._response)for(b in a._response)a._response.hasOwnProperty(b)&&delete a._response[b];else a._response={}},_onProgress:function(a,b){if(a.lengthComputable){var c,d=Date.now?Date.now():(new Date).getTime();if(b._time&&b.progressInterval&&d-b._time<b.progressInterval&&a.loaded!==a.total)return;b._time=d,c=Math.floor(a.loaded/a.total*(b.chunkSize||b._progress.total))+(b.uploadedBytes||0),this._progress.loaded+=c-b._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(d,this._progress.loaded,b.bitrateInterval),b._progress.loaded=b.loaded=c,b._progress.bitrate=b.bitrate=b._bitrateTimer.getBitrate(d,c,b.bitrateInterval),this._trigger("progress",$.Event("progress",{delegatedEvent:a}),b),this._trigger("progressall",$.Event("progressall",{delegatedEvent:a}),this._progress)}},_initProgressListener:function(a){var b=this,c=a.xhr?a.xhr():$.ajaxSettings.xhr();c.upload&&($(c.upload).bind("progress",function(c){var d=c.originalEvent;c.lengthComputable=d.lengthComputable,c.loaded=d.loaded,c.total=d.total,b._onProgress(c,a)}),a.xhr=function(){return c})},_isInstanceOf:function(a,b){return Object.prototype.toString.call(b)==="[object "+a+"]"},_initXHRData:function(a){var b,c=this,d=a.files[0],e=a.multipart||!$.support.xhrFileUpload,f="array"===$.type(a.paramName)?a.paramName[0]:a.paramName;a.headers=$.extend({},a.headers),a.contentRange&&(a.headers["Content-Range"]=a.contentRange),e&&!a.blob&&this._isInstanceOf("File",d)||(a.headers["Content-Disposition"]='attachment; filename="'+encodeURI(d.name)+'"'),e?$.support.xhrFormDataFileUpload&&(a.postMessage?(b=this._getFormData(a),a.blob?b.push({name:f,value:a.blob}):$.each(a.files,function(c,d){b.push({name:"array"===$.type(a.paramName)&&a.paramName[c]||f,value:d})})):(c._isInstanceOf("FormData",a.formData)?b=a.formData:(b=new FormData,$.each(this._getFormData(a),function(a,c){b.append(c.name,c.value)})),a.blob?b.append(f,a.blob,d.name):$.each(a.files,function(d,e){(c._isInstanceOf("File",e)||c._isInstanceOf("Blob",e))&&b.append("array"===$.type(a.paramName)&&a.paramName[d]||f,e,e.uploadName||e.name)})),a.data=b):(a.contentType=d.type||"application/octet-stream",a.data=a.blob||d),a.blob=null},_initIframeSettings:function(a){var b=$("<a></a>").prop("href",a.url).prop("host");a.dataType="iframe "+(a.dataType||""),a.formData=this._getFormData(a),a.redirect&&b&&b!==location.host&&a.formData.push({name:a.redirectParamName||"redirect",value:a.redirect})},_initDataSettings:function(a){this._isXHRUpload(a)?(this._chunkedUpload(a,!0)||(a.data||this._initXHRData(a),this._initProgressListener(a)),a.postMessage&&(a.dataType="postmessage "+(a.dataType||""))):this._initIframeSettings(a)},_getParamName:function(a){var b=$(a.fileInput),c=a.paramName;return c?$.isArray(c)||(c=[c]):(c=[],b.each(function(){for(var a=$(this),b=a.prop("name")||"files[]",d=(a.prop("files")||[1]).length;d;)c.push(b),d-=1}),c.length||(c=[b.prop("name")||"files[]"])),c},_initFormSettings:function(a){a.form&&a.form.length||(a.form=$(a.fileInput.prop("form")),a.form.length||(a.form=$(this.options.fileInput.prop("form")))),a.paramName=this._getParamName(a),a.url||(a.url=a.form.prop("action")||location.href),a.type=(a.type||"string"===$.type(a.form.prop("method"))&&a.form.prop("method")||"").toUpperCase(),"POST"!==a.type&&"PUT"!==a.type&&"PATCH"!==a.type&&(a.type="POST"),a.formAcceptCharset||(a.formAcceptCharset=a.form.attr("accept-charset"))},_getAJAXSettings:function(a){var b=$.extend({},this.options,a);return this._initFormSettings(b),this._initDataSettings(b),b},_getDeferredState:function(a){return a.state?a.state():a.isResolved()?"resolved":a.isRejected()?"rejected":"pending"},_enhancePromise:function(a){return a.success=a.done,a.error=a.fail,a.complete=a.always,a},_getXHRPromise:function(a,b,c){var d=$.Deferred(),e=d.promise();return b=b||this.options.context||e,a===!0?d.resolveWith(b,c):a===!1&&d.rejectWith(b,c),e.abort=d.promise,this._enhancePromise(e)},_addConvenienceMethods:function(a,b){var c=this,d=function(a){return $.Deferred().resolveWith(c,a).promise()};b.process=function(a,e){return(a||e)&&(b._processQueue=this._processQueue=(this._processQueue||d([this])).pipe(function(){return b.errorThrown?$.Deferred().rejectWith(c,[b]).promise():d(arguments)}).pipe(a,e)),this._processQueue||d([this])},b.submit=function(){return"pending"!==this.state()&&(b.jqXHR=this.jqXHR=c._trigger("submit",$.Event("submit",{delegatedEvent:a}),this)!==!1&&c._onSend(a,this)),this.jqXHR||c._getXHRPromise()},b.abort=function(){return this.jqXHR?this.jqXHR.abort():(this.errorThrown="abort",c._trigger("fail",null,this),c._getXHRPromise(!1))},b.state=function(){return this.jqXHR?c._getDeferredState(this.jqXHR):this._processQueue?c._getDeferredState(this._processQueue):void 0},b.processing=function(){return!this.jqXHR&&this._processQueue&&"pending"===c._getDeferredState(this._processQueue)},b.progress=function(){return this._progress},b.response=function(){return this._response}},_getUploadedBytes:function(a){var b=a.getResponseHeader("Range"),c=b&&b.split("-"),d=c&&c.length>1&&parseInt(c[1],10);return d&&d+1},_chunkedUpload:function(a,b){a.uploadedBytes=a.uploadedBytes||0;var c,d,e=this,f=a.files[0],g=f.size,h=a.uploadedBytes,i=a.maxChunkSize||g,j=this._blobSlice,k=$.Deferred(),l=k.promise();return this._isXHRUpload(a)&&j&&(h||g>i)&&!a.data?b?!0:h>=g?(f.error=a.i18n("uploadedBytes"),this._getXHRPromise(!1,a.context,[null,"error",f.error])):(d=function(){var b=$.extend({},a),l=b._progress.loaded;b.blob=j.call(f,h,h+i,f.type),b.chunkSize=b.blob.size,b.contentRange="bytes "+h+"-"+(h+b.chunkSize-1)+"/"+g,e._initXHRData(b),e._initProgressListener(b),c=(e._trigger("chunksend",null,b)!==!1&&$.ajax(b)||e._getXHRPromise(!1,b.context)).done(function(c,f,i){h=e._getUploadedBytes(i)||h+b.chunkSize,l+b.chunkSize-b._progress.loaded&&e._onProgress($.Event("progress",{lengthComputable:!0,loaded:h-b.uploadedBytes,total:h-b.uploadedBytes}),b),a.uploadedBytes=b.uploadedBytes=h,b.result=c,b.textStatus=f,b.jqXHR=i,e._trigger("chunkdone",null,b),e._trigger("chunkalways",null,b),g>h?d():k.resolveWith(b.context,[c,f,i])}).fail(function(a,c,d){b.jqXHR=a,b.textStatus=c,b.errorThrown=d,e._trigger("chunkfail",null,b),e._trigger("chunkalways",null,b),k.rejectWith(b.context,[a,c,d])})},this._enhancePromise(l),l.abort=function(){return c.abort()},d(),l):!1},_beforeSend:function(a,b){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0),this._initResponseObject(b),this._initProgressObject(b),b._progress.loaded=b.loaded=b.uploadedBytes||0,b._progress.total=b.total=this._getTotal(b.files)||1,b._progress.bitrate=b.bitrate=0,this._active+=1,this._progress.loaded+=b.loaded,this._progress.total+=b.total},_onDone:function(a,b,c,d){var e=d._progress.total,f=d._response;d._progress.loaded<e&&this._onProgress($.Event("progress",{lengthComputable:!0,loaded:e,total:e}),d),f.result=d.result=a,f.textStatus=d.textStatus=b,f.jqXHR=d.jqXHR=c,this._trigger("done",null,d)},_onFail:function(a,b,c,d){var e=d._response;d.recalculateProgress&&(this._progress.loaded-=d._progress.loaded,this._progress.total-=d._progress.total),e.jqXHR=d.jqXHR=a,e.textStatus=d.textStatus=b,e.errorThrown=d.errorThrown=c,this._trigger("fail",null,d)},_onAlways:function(a,b,c,d){this._trigger("always",null,d)},_onSend:function(a,b){b.submit||this._addConvenienceMethods(a,b);var c,d,e,f,g=this,h=g._getAJAXSettings(b),i=function(){return g._sending+=1,h._bitrateTimer=new g._BitrateTimer,c=c||((d||g._trigger("send",$.Event("send",{delegatedEvent:a}),h)===!1)&&g._getXHRPromise(!1,h.context,d)||g._chunkedUpload(h)||$.ajax(h)).done(function(a,b,c){g._onDone(a,b,c,h)}).fail(function(a,b,c){g._onFail(a,b,c,h)}).always(function(a,b,c){if(g._onAlways(a,b,c,h),g._sending-=1,g._active-=1,h.limitConcurrentUploads&&h.limitConcurrentUploads>g._sending)for(var d=g._slots.shift();d;){if("pending"===g._getDeferredState(d)){d.resolve();break}d=g._slots.shift()}0===g._active&&g._trigger("stop")})};return this._beforeSend(a,h),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(e=$.Deferred(),this._slots.push(e),f=e.pipe(i)):(this._sequence=this._sequence.pipe(i,i),f=this._sequence),f.abort=function(){return d=[void 0,"abort","abort"],c?c.abort():(e&&e.rejectWith(h.context,d),i())},this._enhancePromise(f)):i()},_onAdd:function(a,b){var c,d,e,f,g=this,h=!0,i=$.extend({},this.options,b),j=b.files,k=j.length,l=i.limitMultiFileUploads,m=i.limitMultiFileUploadSize,n=i.limitMultiFileUploadSizeOverhead,o=0,p=this._getParamName(i),q=0;if(!k)return!1;if(m&&void 0===j[0].size&&(m=void 0),(i.singleFileUploads||l||m)&&this._isXHRUpload(i))if(i.singleFileUploads||m||!l)if(!i.singleFileUploads&&m)for(e=[],c=[],f=0;k>f;f+=1)o+=j[f].size+n,(f+1===k||o+j[f+1].size+n>m||l&&f+1-q>=l)&&(e.push(j.slice(q,f+1)),d=p.slice(q,f+1),d.length||(d=p),c.push(d),q=f+1,o=0);else c=p;else for(e=[],c=[],f=0;k>f;f+=l)e.push(j.slice(f,f+l)),d=p.slice(f,f+l),d.length||(d=p),c.push(d);else e=[j],c=[p];return b.originalFiles=j,$.each(e||j,function(d,f){var i=$.extend({},b);return i.files=e?f:[f],i.paramName=c[d],g._initResponseObject(i),g._initProgressObject(i),g._addConvenienceMethods(a,i),h=g._trigger("add",$.Event("add",{delegatedEvent:a}),i)}),h},_replaceFileInput:function(a){var b=a.fileInput,c=b.clone(!0),d=b.is(document.activeElement);a.fileInputClone=c,$("<form></form>").append(c)[0].reset(),b.after(c).detach(),d&&c.focus(),$.cleanData(b.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(a,d){return d===b[0]?c[0]:d}),b[0]===this.element[0]&&(this.element=c)},_handleFileTreeEntry:function(a,b){var c,d=this,e=$.Deferred(),f=function(b){b&&!b.entry&&(b.entry=a),e.resolve([b])},g=function(c){d._handleFileTreeEntries(c,b+a.name+"/").done(function(a){e.resolve(a)}).fail(f)},h=function(){c.readEntries(function(a){a.length?(i=i.concat(a),h()):g(i)},f)},i=[];return b=b||"",a.isFile?a._file?(a._file.relativePath=b,e.resolve(a._file)):a.file(function(a){a.relativePath=b,e.resolve(a)},f):a.isDirectory?(c=a.createReader(),h()):e.resolve([]),e.promise()},_handleFileTreeEntries:function(a,b){var c=this;return $.when.apply($,$.map(a,function(a){return c._handleFileTreeEntry(a,b)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(a){a=a||{};var b=a.items;return b&&b.length&&(b[0].webkitGetAsEntry||b[0].getAsEntry)?this._handleFileTreeEntries($.map(b,function(a){var b;return a.webkitGetAsEntry?(b=a.webkitGetAsEntry(),b&&(b._file=a.getAsFile()),b):a.getAsEntry()})):$.Deferred().resolve($.makeArray(a.files)).promise()},_getSingleFileInputFiles:function(a){a=$(a);var b,c,d=a.prop("webkitEntries")||a.prop("entries");if(d&&d.length)return this._handleFileTreeEntries(d);if(b=$.makeArray(a.prop("files")),b.length)void 0===b[0].name&&b[0].fileName&&$.each(b,function(a,b){b.name=b.fileName,b.size=b.fileSize});else{if(c=a.prop("value"),!c)return $.Deferred().resolve([]).promise();b=[{name:c.replace(/^.*\\/,"")}]}return $.Deferred().resolve(b).promise()},_getFileInputFiles:function(a){return a instanceof $&&1!==a.length?$.when.apply($,$.map(a,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(a)},_onChange:function(a){var b=this,c={fileInput:$(a.target),form:$(a.target.form)};this._getFileInputFiles(c.fileInput).always(function(d){c.files=d,b.options.replaceFileInput&&b._replaceFileInput(c),b._trigger("change",$.Event("change",{delegatedEvent:a}),c)!==!1&&b._onAdd(a,c)})},_onPaste:function(a){var b=a.originalEvent&&a.originalEvent.clipboardData&&a.originalEvent.clipboardData.items,c={files:[]};b&&b.length&&($.each(b,function(a,b){var d=b.getAsFile&&b.getAsFile();d&&c.files.push(d)}),this._trigger("paste",$.Event("paste",{delegatedEvent:a}),c)!==!1&&this._onAdd(a,c))},_onDrop:function(a){a.dataTransfer=a.originalEvent&&a.originalEvent.dataTransfer;var b=this,c=a.dataTransfer,d={};c&&c.files&&c.files.length&&(a.preventDefault(),this._getDroppedFiles(c).always(function(c){d.files=c,b._trigger("drop",$.Event("drop",{delegatedEvent:a}),d)!==!1&&b._onAdd(a,d)}))},_onDragOver:a("dragover"),_onDragEnter:a("dragenter"),_onDragLeave:a("dragleave"),_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop,dragenter:this._onDragEnter,dragleave:this._onDragLeave}),this._on(this.options.pasteZone,{paste:this._onPaste})),$.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragenter dragleave dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_setOption:function(a,b){var c=-1!==$.inArray(a,this._specialOptions);c&&this._destroyEventHandlers(),this._super(a,b),c&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var a=this.options;void 0===a.fileInput?a.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):a.fileInput instanceof $||(a.fileInput=$(a.fileInput)),a.dropZone instanceof $||(a.dropZone=$(a.dropZone)),a.pasteZone instanceof $||(a.pasteZone=$(a.pasteZone))},_getRegExp:function(a){var b=a.split("/"),c=b.pop();return b.shift(),new RegExp(b.join("/"),c)},_isRegExpOption:function(a,b){return"url"!==a&&"string"===$.type(b)&&/^\/.*\/[igm]{0,3}$/.test(b)},_initDataAttributes:function(){var a=this,b=this.options,c=this.element.data();$.each(this.element[0].attributes,function(d,e){var f,g=e.name.toLowerCase();/^data-/.test(g)&&(g=g.slice(5).replace(/-[a-z]/g,function(a){return a.charAt(1).toUpperCase()}),f=c[g],a._isRegExpOption(g,f)&&(f=a._getRegExp(f)),b[g]=f)})},_create:function(){this._initDataAttributes(),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=0,this._initProgressObject(this),this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(a){var b=this;a&&!this.options.disabled&&(a.fileInput&&!a.files?this._getFileInputFiles(a.fileInput).always(function(c){a.files=c,b._onAdd(null,a)}):(a.files=$.makeArray(a.files),this._onAdd(null,a)))},send:function(a){if(a&&!this.options.disabled){if(a.fileInput&&!a.files){var b,c,d=this,e=$.Deferred(),f=e.promise();return f.abort=function(){return c=!0,b?b.abort():(e.reject(null,"abort","abort"),f)},this._getFileInputFiles(a.fileInput).always(function(f){if(!c){if(!f.length)return void e.reject();a.files=f,b=d._onSend(null,a),b.then(function(a,b,c){e.resolve(a,b,c)},function(a,b,c){e.reject(a,b,c)})}}),this._enhancePromise(f)}if(a.files=$.makeArray(a.files),a.files.length)return this._onSend(null,a)}return this._getXHRPromise(!1,a&&a.context)}})}();/*! cui 2016-11-08 */
!function(){"use strict";var a=$.blueimp.fileupload.prototype.options.add;$.component("blueimp.fileupload",$.blueimp.fileupload,{options:{processQueue:[],add:function(b,c){var d=$(this);c.process(function(){return d.fileupload("process",c)}),a.call(this,b,c)}},processActions:{},_processFile:function(a,b){var c=this,d=$.Deferred().resolveWith(c,[a]),e=d.promise();return this._trigger("process",null,a),$.each(a.processQueue,function(a,d){var f=function(a){return b.errorThrown?$.Deferred().rejectWith(c,[b]).promise():c.processActions[d.action].call(c,a,d)};e=e.pipe(f,d.always&&f)}),e.done(function(){c._trigger("onProcessDone",null,a),c._trigger("onProcessAlways",null,a)}).fail(function(){c._trigger("onProcessFail",null,a),c._trigger("onProcessAlways",null,a)}),e},_transformProcessQueue:function(a){var b=[];$.each(a.processQueue,function(){var c={},d=this.action,e=this.prefix===!0?d:this.prefix;$.each(this,function(b,d){"string"===$.type(d)&&"@"===d.charAt(0)?c[b]=a[d.slice(1)||(e?e+b.charAt(0).toUpperCase()+b.slice(1):b)]:c[b]=d}),b.push(c)}),a.processQueue=b},processing:function(){return this._processing},process:function(a){var b=this,c=$.extend({},this.options,a);return c.processQueue&&c.processQueue.length&&(this._transformProcessQueue(c),0===this._processing&&this._trigger("onProcessStart"),$.each(a.files,function(d){var e=d?$.extend({},c):c,f=function(){return a.errorThrown?$.Deferred().rejectWith(b,[a]).promise():b._processFile(e,a)};e.index=d,b._processing+=1,b._processingQueue=b._processingQueue.pipe(f,f).always(function(){b._processing-=1,0===b._processing&&b._trigger("onProcessStop")})})),this._processingQueue},_create:function(){this._super(),this._processing=0,this._processingQueue=$.Deferred().resolveWith(this).promise()}})}();/*! cui 2016-11-08 */
!function(){"use strict";$.blueimp.fileupload.prototype._specialOptions.push("filesContainer","uploadTemplateId","downloadTemplateId"),$.component("blueimp.fileupload",$.blueimp.fileupload,{getUnUploadValues:function(){for(var a=[],b=0;b<this.options.unUploadedFileList.length;b++)a.push(this.options.unUploadedFileList[b][this.options.prmNames.fileId]);return a},remove:function(a){function b(a){var b=$("#"+a).data("data");$("#"+a).hasClass("template-download")?c._trigger("remove",null,$.extend({context:$("#"+a),id:a,type:"DELETE"},$("#"+a).data())):$("#"+a).hasClass("template-upload")&&(b.abort?b.abort():(b.errorThrown="abort",c._trigger("fail",null,$.extend({context:$("#"+a),type:"DELETE"},b))))}var c=this;if(void 0===a)this.options.filesContainer.children().each(function(){b(this.id)});else if($.isArray(a))for(var d=0;d<a.length;d++)b(a[d]);else b(a);this._trigger("onDelete",null)},destroy:function(){this.element.find(".fileupload-buttonbar").find(".fileinput-button").each(function(){var a=$(this).find("input:file").detach();$(this).button("destroy").append(a)}),this.element.find(".ctrl-init-button").remove(),this.options.filesContainer.remove(),this._super()},upload:function(a){if($.isArray(a))for(var b=0;b<a.length;b++){var c=$("#"+a[b]).data("data");c&&c.submit&&c.submit()}else{var c=$("#"+a).data("data");c&&c.submit&&c.submit()}}}),$.component("coral.fileuploader",{castProperties:["triggers","uploadBtnOptions","formData"],checkIE:function(){for(var a=3,b=document.createElement("div"),c=b.getElementsByTagName("i");b.innerHTML="<!--[if gt IE "+ ++a+"]><i></i><![endif]-->",c[0];);return a>4?a:!1},options:{prmNames:{fileName:"name",fileSize:"size",fileURL:"url",fileError:"error",fileId:"id",filetype:"type",fileDate:"date",thumbnailUrl:"thumbnailUrl"},focus:null,clearError:null,triggers:null,postData:{},autoUpload:!1,removeCompleted:!1,maxFileSize:"5012kb",minFileSize:"0kb",separator:",",filesUrl:null,filesLimt:9999,multiple:"multiple",uploadBtnOptions:{icons:"",label:"+"}},_getConfig:function(){var a,b=this,c=this.checkIE(),d=this.options;d.queueID?(d.filesContainer=$("#"+d.queueID),d.filesContainer.addClass("files")):(d.queueID=this.element[0].id+"_queueID",d.filesContainer=$("<ul/>",{"class":"files",id:d.queueID}),this.element.before(d.filesContainer)),"list"==d.queueMode&&d.filesContainer.addClass("list-files"),"card"==d.queueMode&&d.filesContainer.addClass("card-files"),"card"!==d.queueMode&&"list"!==d.queueMode&&d.filesContainer.addClass(d.queueMode),d.templatesContainer=this.document[0].createElement(d.filesContainer.prop("nodeName"));var e={uploadTmp:function(a){var b,c;return b=a.fileError?'<div class="fileError"><span class="error"></span></div>':"",c='<li id="{{fileId}}" class="fileItem"><div class="fileContent"><span class="fileThumb">{{fileType}}</span><div class="progress"><div class="progressbar-value"></div></div><span class="fileName" title="{{fileName}}">{{fileName}}</span><span class="fileSize">({{fileSize}})k</span><span class="fileAction"><span class="progressbar-text"></span><span class="upload cui-icon-plus-circle2"></span><span class="remove cui-icon-minus-circle2"></span></span>'+b+"</div></li>"},uploadTemplate:function(a){var b="fileId_"+(new Date).getTime(),c=a.options.prmNames;a.options.unUploadedFileList=a.options.unUploadedFileList||[];var d,e,f=a.options.autoUpload,g={fileName:a.files[0][c.fileName],fileSize:a.files[0][c.fileSize],fileId:a.files[0][c.fileId]||b,fileError:a.files[0][c.fileError],fileType:a.files[0][c.filetype],fileDate:a.files[0][c.fileDate]};a.files[0].id=g.fileId,g.fileType=g.fileName.substring(g.fileName.lastIndexOf(".")+1),a.options.unUploadedFileList.push(g),f||(d="disabled"),e=a.options.uploadTmp(g);for(var h in g)e=e.replace(new RegExp("\\{\\{"+h+"\\}\\}","g"),g[h]);return e},downloadTmp:function(a){var b,c,d="";return b=a.fileError?'<div class="fileError"><span class="error"></span>{{fileError}}</div>':"",d=a.thumbnailUrl?'<span class="fileThumb"> <img src= "{{thumbnailUrl}}"></span>':'<span class="fileThumb">{{fileType}}</span>',c='<li id="{{fileId}}" data-url="{{fileUrl}}" class="fileItem"><div class="fileContent">'+d+'<div class="progress"><div class="progressbar-value"></div></div><span class="fileName"><a href="javascript:void(0)" title="{{fileName}}" download="{{fileName}}">{{fileName}}</a></span><span class="fileSize">({{fileSize}})k</span><span class="remove cui-icon-minus-circle2 fileAction"></span></span>'+b+"</div></li>"},downloadTemplate:function(a){var b=a.options.prmNames;a.options.uploadedFileList=a.options.uploadedFileList||[];var c,d="fileId_"+(new Date).getTime(),e=(a.options.autoUpload,{fileName:a.files[0][b.fileName],fileSize:a.files[0][b.fileSize],fileUrl:a.files[0][b.fileURL],fileError:a.files[0][b.fileError],fileId:a.files[0][b.fileId]||d,fileType:a.files[0][b.filetype],fileDate:a.files[0][b.fileDate],thumbnailUrl:a.files[0][b.thumbnailUrl]});a.options.uploadedFileList.push(e),c=a.options.downloadTmp(e);for(var f in e)c=c.replace(new RegExp("\\{\\{"+f+"\\}\\}","g"),e[f]);return c}};if(this.options=$.extend(!0,{},e,this.options),this.useFlash=c!==!1&&10>c,this.options.uploadBtn){var f="fileinput-button",g=$.coral.toFunction(this.options.uploadBtnOptions);g=g.cls?$.extend({},g,{cls:f+" "+g.cls}):$.extend({},g,{cls:f}),$(this.options.uploadBtn).button(g);var h={type:"file",name:"uploadFile"};this.options.multiple&&(h.multiple="multiple"),this.options.fileObjName&&(h.name=this.options.fileObjName),$("<input/>",h).appendTo($(this.options.uploadBtn)),this.uploadFile=$(this.options.uploadBtn).find("input[type=file]"),this.uploaderBtn=$(this.options.uploadBtn).uniqueId()}else this.uploadFile=this.element.find("input[type=file]"),this.uploaderBtn=this.element.find(".fileinput-button").uniqueId();this.useFlash?(this.uploadFile.hide(),a={swf:$.coral.scriptPath+"external/swfupload.swf",uploader:this.options.url,auto:this.options.autoUpload,messages:{uploadedBytes:"Uploaded bytes exceed file size",maxNumberOfFiles:"上传的文件数量超出限制",acceptFileTypes:"选择的文件类型不符合",maxFileSize:"上传文件的大小超出最大限制",minFileSize:"上传文件的大小低于最小限制"},separator:this.options.separator,checkExisting:!1,debug:this.options.debug,fileObjName:"uploadFile",height:130,uploadTemplate:this.options.uploadTemplate,downloadTemplate:this.options.downloadTemplate,method:"post",multi:this.options.multi,formData:this.options.formData,preventCaching:!0,progressData:"percentage",queueID:this.options.queueID,queueSizeLimit:999,removeCompleted:this.options.removeCompleted,removeTimeout:this.options.removeTimeout,requeueErrors:!1,successTimeout:30,uploadLimit:this.options.filesLimt,width:820,maxFileSize:this.options.maxFileSize,minFileSize:this.options.minFileSize,fileTypeExts:this.options.acceptFileTypes,onSWFReady:function(){b.options.filesUrl&&$.ajax({type:"POST",async:!1,datatype:"json",url:b.options.filesUrl,data:b.options.postData,success:function(a){for(var c=0;c<a.length;c++){var d=b._renderDownload([a[c]]).appendTo(b.options.filesContainer);b._transition(d),b.uploaderBtn.swfuploader("addUploadCount"),b.setValue(b.options.uploadedFileList)}},error:function(a){}})},overrideEvents:[]},$.extend(!0,a,this.options),this.uploaderBtn.swfuploader(a)):(a={disabled:!1,autoUpload:!1,url:this.options.url,maxFileSize:this.options.maxFileSize,minFileSize:this.options.minFileSize,maxNumberOfFiles:this.options.maxNumberOfFiles,acceptFileTypes:this.options.acceptFileTypes,uploadTemplate:this.options.uploadTemplate,downloadTemplate:this.options.downloadTemplate,templatesContainer:this.options.templatesContainer,filesContainer:this.options.filesContainer,prependFiles:!1,formData:this.options.formData,dataType:"json",separator:",",messages:{unknownError:"Unknown error",uploadedBytes:"Uploaded bytes exceed file size",maxNumberOfFiles:"上传的文件数量超出限制",acceptFileTypes:"选择的文件类型不符合",maxFileSize:"上传文件的大小超出最大限制",minFileSize:"上传文件的大小低于最小限制"},processdone:function(a,b){b.context.find(".upload").button("enable")},required:!0,getNumberOfFiles:function(){return this.filesContainer.children().not(".processing").length},getFilesFromResponse:function(a){return"string"==typeof a.result&&(a.result=$.parseJSON(a.result)),a.result&&$.isArray(a.result.files)?a.result.files:[]},add:function(a,c){if(a.isDefaultPrevented())return!1;var d=$(this),e=d.data("blueimp-fileupload"),f=e.options;b.validateFile(f,c)&&(d.fileupload("process",c),c.context=b._renderUpload(c.files).data("data",c).addClass("processing"),f.filesContainer[f.prependFiles?"prepend":"append"](c.context),b._forceReflow(c.context),b._transition(c.context),c.process(function(){return d.fileupload("process",c)}).always(function(){c.context.each(function(a){$(this).find(".size").text(b._formatFileSize(c.files[a].size))}).removeClass("processing")}).done(function(){c.context.find(".upload").prop("disabled",!1),b._trigger("onSelect",a,[{file:c.files[0]}])!==!1&&(f.autoUpload||c.autoUpload)&&c.autoUpload!==!1&&c.submit()}).fail(function(){c.files.error&&c.context.each(function(a){var b=c.files[a].error;b&&$(this).find(".error").text(b)})}))},done:function(a,c){if(a.isDefaultPrevented())return!1;var d,e,f=$(this).data("blueimp-fileupload"),g=c.getFilesFromResponse||f.options.getFilesFromResponse,h=g(c);c.context?c.context.each(function(f){var g=h[f]||{error:"Empty file upload result"};e=b._addFinishedDeferreds(),b._transition($(this)).done(function(){var f=$(this);d=b._renderDownload([g]).data("data",c).replaceAll(f),b._forceReflow(d),b._transition(d).done(function(){c.context=$(this),b._trigger("onSuccess",a,[{file:g}]),b._trigger("onComplete",a,[{file:g}]),e.resolve()})})}):(d=b._renderDownload(h)[f.options.prependFiles?"prependTo":"appendTo"](f.options.filesContainer),b._forceReflow(d),e=b._addFinishedDeferreds(),b._transition(d).done(function(){c.context=$(this),b._trigger("onSuccess",a,[{file:file}]),b._trigger("onComplete",a,[{file:file}]),e.resolve()}));var i=b.options.unUploadedFileList;b.clearFileList(i,c)},stop:function(a){if(a.isDefaultPrevented())return!1;var c=($(this).data("blueimp-fileupload"),b._addFinishedDeferreds());$.when.apply($,b._getFinishedDeferreds()).done(function(){b._trigger("onStop",a)}),b._transition($(this).find(".fileupload-progress")).done(function(){$(this).find(".progress").attr("aria-valuenow","0").children().first().css("width","0%"),$(this).find(".progress-extended").html("&nbsp;"),c.resolve()})},processstart:function(a){return a.isDefaultPrevented()?!1:void $(this).addClass("fileupload-processing")},processstop:function(a){return a.isDefaultPrevented()?!1:void $(this).removeClass("fileupload-processing")},fail:function(a,c){if(a.isDefaultPrevented())return!1;var d,e,f=$(this).data("blueimp-fileupload");c.context?c.context.each(function(f){if("abort"!==c.errorThrown){var g=c.files[f];g.error=g.error||c.errorThrown||c.i18n("unknownError"),e=b._addFinishedDeferreds(),b._transition($(this)).done(function(){var f=$(this);d=b._renderDownload([g]).replaceAll(f),b._forceReflow(d),b._transition(d).done(function(){c.context=$(this),b._trigger("onFail",a,[{file:g,error:g.error}]),b._trigger("onComplete",a,[{file:g}]),e.resolve()})})}else e=b._addFinishedDeferreds(),b._transition($(this)).done(function(){$(this).remove(),b._trigger("onRemove",a),e.resolve()})}):"abort"!==c.errorThrown?(c.context=b._renderUpload(c.files)[f.options.prependFiles?"prependTo":"appendTo"](f.options.filesContainer).data("data",c),b._forceReflow(c.context),e=b._addFinishedDeferreds(),b._transition(c.context).done(function(){c.context=$(this),b._trigger("onFail",a,[{file:c.files[0],error:c.files[0].error}]),b._trigger("onComplete",a,[{file:c.files[0]}]),e.resolve()})):(b._trigger("onFail",a,[{file:c.files[0],error:c.files[0].error}]),b._trigger("onComplete",a,[{file:c.files[0]}]),b._addFinishedDeferreds().resolve());var g=b.options.uploadedFileList;b.clearFileList(g,c);var h=b.options.unUploadedFileList;b.clearFileList(h,c)},progress:function(a,c){if(a.isDefaultPrevented())return!1;var d=Math.floor(c.loaded/c.total*100);c.context&&c.context.each(function(){$(this).find(".progressbar-value").show().css("width",d+"%"),$(this).find(".progressbar-text").text(d+"%")}),b._trigger("onProgress",a,[{file:c.files[0]}])},progressall:function(a,c){if(a.isDefaultPrevented())return!1;var d=$(this),e=(Math.floor(c.loaded/c.total*100),d.find(".fileupload-progress")),f=e.find(".progress-extended");f.length&&f.html(b._renderExtendedProgress(c))},start:function(a){if(a.isDefaultPrevented())return!1;$(this).data("blueimp-fileupload");b._resetFinishedDeferreds(),b._transition($(this).find(".fileupload-progress")).done(function(){b._trigger("onStart",a)})},send:function(a,c){return a.isDefaultPrevented()?!1:(c.context&&c.dataType&&"iframe"===c.dataType.substr(0,6)&&c.context.find(".progress").addClass(!$.support.transition&&"progress-animated").attr("aria-valuenow",100).children().first().css("width","100%"),b._trigger("onSend",a,[{file:c.files[0]}]))},remove:function(a,c){if(a.isDefaultPrevented())return!1;var d,e=$(this).data("blueimp-fileupload"),f=function(){b._transition(c.context).done(function(){$(this).remove(),b._trigger("onRemove",a,{fileId:c.id})})};if(c.url&&"undefined"!=c.url){var g={};c.data=[];for(var h=0;h<b.options.uploadedFileList.length;h++)c.id==b.options.uploadedFileList[h].fileId&&(g.data=b.options.uploadedFileList[h]);g.dataType=c.dataType||e.options.dataType,g.url=c.url,$.ajax(g).done(f).fail(function(){b._trigger("onRemoveFailed",a)})}else f();var d=b.options.uploadedFileList;b.clearFileList(d,c)}},$.extend(!0,a,this.options),this.uploaderBtn.fileupload(a),this.options.filesUrl&&$.ajax({type:"POST",async:!1,datatype:"json",url:this.options.filesUrl,data:this.options.postData,success:function(a){for(var c=0;c<a.length;c++){var d=b._renderDownload([a[c]]).appendTo(b.options.filesContainer);b._transition(d)}},error:function(a){}}))},upload:function(a){this.checkIE();this.useFlash?this.uploaderBtn.swfuploader("upload",a):(void 0===a&&(a=this.getUnUploadValues()),this.uploaderBtn.fileupload("upload",a))},_destroy:function(){this.checkIE();this.useFlash?this.uploaderBtn.swfuploader("destroy"):this.uploaderBtn.fileupload("destroy")},remove:function(a){this.checkIE();this.useFlash?this.uploaderBtn.swfuploader("cancel",a):this.uploaderBtn.fileupload("remove",a)},_resetFinishedDeferreds:function(){this._finishedUploads=[]},_addFinishedDeferreds:function(a){return a||(a=$.Deferred()),this._finishedUploads.push(a),a},_getFinishedDeferreds:function(){return this._finishedUploads},_enableDragToDesktop:function(){var a=$(this),b=a.prop("href"),c=a.prop("download"),d="application/octet-stream";a.bind("dragstart",function(a){try{a.originalEvent.dataTransfer.setData("DownloadURL",[d,c,b].join(":"))}catch(e){}})},_formatFileSize:function(a){return"number"!=typeof a?"":a>=1e9?(a/1e9).toFixed(2)+" GB":a>=1e6?(a/1e6).toFixed(2)+" MB":(a/1e3).toFixed(2)+" KB"},_formatBitrate:function(a){return"number"!=typeof a?"":a>=1e9?(a/1e9).toFixed(2)+" Gbit/s":a>=1e6?(a/1e6).toFixed(2)+" Mbit/s":a>=1e3?(a/1e3).toFixed(2)+" kbit/s":a.toFixed(2)+" bit/s"},_formatTime:function(a){var b=new Date(1e3*a),c=Math.floor(a/86400);return c=c?c+"d ":"",c+("0"+b.getUTCHours()).slice(-2)+":"+("0"+b.getUTCMinutes()).slice(-2)+":"+("0"+b.getUTCSeconds()).slice(-2)},_formatPercentage:function(a){return(100*a).toFixed(2)+" %"},_renderExtendedProgress:function(a){return this._formatBitrate(a.bitrate)+" | "+this._formatTime(8*(a.total-a.loaded)/a.bitrate)+" | "+this._formatPercentage(a.loaded/a.total)+" | "+this._formatFileSize(a.loaded)+" / "+this._formatFileSize(a.total)},_renderTemplate:function(a,b){if(!a)return $();var c=a({files:b,formatFileSize:this._formatFileSize,options:this.options});return c instanceof $?c:$(this.options.templatesContainer).html(c).children()},_renderPreviews:function(a){a.context.find(".preview").each(function(b,c){$(c).append(a.files[b].preview)})},_renderUpload:function(a,b){var c=this._renderTemplate(this.options.uploadTemplate,a);return c.addClass("template-upload fade"),c.hasClass("fade")&&c.hide(),this._trigger("onRenderUploadTmp",null,{item:c}),c},_renderDownload:function(a){var b=this._renderTemplate(this.options.downloadTemplate,a).find("a[download]").each(this._enableDragToDesktop).end();return b.addClass("template-download fade"),b.hasClass("fade")&&b.hide(),this._trigger("onRenderDownloadTmp",null,{item:b}),b},_forceReflow:function(a){return $.support.transition&&a.length&&a[0].offsetWidth},_transition:function(a){var b=$.Deferred();return a.hasClass("fade")?a.fadeToggle(this.options.transitionDuration,this.options.transitionEasing,function(){b.resolveWith(a)}):b.resolveWith(a),b},_destroyButtonBarEventHandlers:function(){this._off(this.element.find(".fileupload-buttonbar").find(".upload, .remove"),"click"),this._off(this.element.find(".fileupload-buttonbar .toggle"),"change.")},_destroyEventHandlers:function(){this._destroyButtonBarEventHandlers(),this._off(this.options.filesContainer,"click"),this._super()},_enableFileInputButton:function(){this.element.find(".fileinput-button input").prop("disabled",!1).parent().removeClass("disabled")},_disableFileInputButton:function(){this.element.find(".fileinput-button input").prop("disabled",!0).parent().addClass("disabled")},_create:function(){var a=this.options;this.options.id=this.element.uniqueId().attr("id"),this._super(),this._resetFinishedDeferreds(),$.support.fileInput||this._disableFileInputButton(),this.element.find(".fileupload-buttonbar").find(".fileinput-button").each(function(){}),a.uploadedFileList=[],a.unUploadedFileList=[],this._getConfig(),a.beforeCreate?a.beforeCreate.apply(this):this.beforeCreate()},beforeCreate:function(){var a=this;this._on(this.options.filesContainer,{"click .upload":function(b){b.preventDefault();var c=$(b.currentTarget).closest(".template-upload");$("#"+a.element[0].id).fileuploader("upload",c[0].id)},"click .remove":function(b){b.preventDefault();var c=$(b.currentTarget).closest(".template-upload,.template-download");$("#"+a.element[0].id).fileuploader("remove",c[0].id)},"click .stop":function(b){b.preventDefault();var c=$(b.currentTarget).closest(".template-upload");$("#"+a.element[0].id).fileuploader("stop",c[0].id)}})},_setOption:function(a,b){this._super(a,b),"formData"===a&&(this.useFlash?this.uploaderBtn.swfuploader("option","formData",b):this.uploaderBtn.fileupload("option","formData",b))},clearFileList:function(a,b){var c,d;a===this.options.uploadedFileList?c=this.getValues():a===this.options.unUploadedFileList&&(c=this.getUnUploadValues()),d=$.inArray(b.context[0][this.options.prmNames.fileId],c),-1!==d?a.splice(d,1):a.splice(d,0)},validateFile:function(a,b){var c=b.files[0].name.substring(b.files[0].name.lastIndexOf(".")+1);c=$.trim(c);var d=$.trim(a.acceptFileTypes),e=this.getQueueData(),f=this.formatMaxSize(a.maxFileSize);return e.length>=a.filesLimt?($.messageQueue({message:a.messages.maxNumberOfFiles}),!1):b.files[0].size>=f?($.messageQueue({message:a.messages.maxFileSize}),!1):"*.*"==d?!0:-1==d.indexOf(c.toLowerCase())?($.messageQueue({message:a.messages.acceptFileTypes}),!1):!0},formatMinSize:function(a){var b,c,d=new RegExp("/^s*|s*$/"),e=1024;a=a.toLowerCase(),a=a.replace(d,"");var f=a.match(/^\d+/);return null!==f&&f.length>0&&(c=parseInt(f[0])),(isNaN(c)||0>c)&&(c=0),b=c*e},formatMaxSize:function(a){var b,c,d=new RegExp("/^s*|s*$/"),e=1024;a=a.toLowerCase(),a=a.replace(d,"");var f=a.match(/^\d+/);return null!==f&&f.length>0&&(c=parseInt(f[0])),(isNaN(c)||0>c)&&(c=0),b=c*e},getQueueData:function(){for(var a=[],b=[],c=0;c<this.options.uploadedFileList.length;c++)a.push(this.options.uploadedFileList[c].fileId);for(var c=0;c<this.options.unUploadedFileList.length;c++)b.push(this.options.unUploadedFileList[c].fileId);return $.merge(a,b)},getValues:function(){for(var a=[],b=0;b<this.options.uploadedFileList.length;b++)a.push(this.options.uploadedFileList[b].fileId);return a},getValidateValue:function(){this.checkIE();return this.useFlash?this.uploaderBtn.swfuploader("getValidateValue"):this.getValue()},setValue:function(a){this.checkIE();this.useFlash&&this.uploaderBtn.swfuploader("setValues",a)},getValue:function(){this.checkIE();return this.useFlash?this.uploaderBtn.swfuploader("getValue"):this.getValues().join(this.options.separator)},clearError:function(){},focus:function(){},getUnUploadValues:function(){for(var a=[],b=0;b<this.options.unUploadedFileList.length;b++)a.push(this.options.unUploadedFileList[b].fileId);return a},enable:function(){this.checkIE();if(this.useFlash)this.uploaderBtn.swfuploader("disable",!1);else{var a=!1;this.options.disabled&&(a=!0),this._super(),a&&(this.element.find("input, button").prop("disabled",!1),this._enableFileInputButton(),this.options.filesContainer.prop("disabled",!1).removeClass("coral-state-disabled")),this.options.disabled=!1,this._trigger("onEnable",null,[])}},disable:function(){this.checkIE();this.useFlash?this.uploaderBtn.swfuploader("disable",!0):(this.options.disabled||(this.element.find("input, button").prop("disabled",!0),this._disableFileInputButton(),this.options.filesContainer.prop("disabled",!0).addClass("coral-state-disabled")),this._super(),this.options.disabled=!0,this._trigger("onDisable",null,[]))}})}();/*! cui 2016-11-08 */
!function(){var a={init:function(a,c){return this.each(function(){var d=$(this),e=d.clone(),f=$.extend({id:d.attr("id"),swf:$.coral.scriptPath+"external/swfupload.swf",uploader:"swfupload.php",auto:!0,buttonClass:"",buttonCursor:"hand",buttonImage:null,buttonText:"SELECT FILES",checkExisting:!1,debug:!1,fileObjName:"Filedata",fileSizeLimit:0,fileTypeDesc:"All Files",fileTypeExts:"*.*",height:30,itemTemplate:!1,method:"post",multi:!0,formData:{},preventCaching:!0,progressData:"percentage",queueID:!1,queueSizeLimit:999,removeCompleted:!0,removeTimeout:3,requeueErrors:!1,successTimeout:30,uploadLimit:0,width:120,overrideEvents:[]},a),g={assume_success_timeout:f.successTimeout,button_placeholder_id:f.id,button_width:f.width,button_height:f.height,button_text:null,button_text_style:null,button_text_top_padding:0,button_text_left_padding:0,button_action:f.multi?SWFUpload.BUTTON_ACTION.SELECT_FILES:SWFUpload.BUTTON_ACTION.SELECT_FILE,button_disabled:!1,button_cursor:"arrow"==f.buttonCursor?SWFUpload.CURSOR.ARROW:SWFUpload.CURSOR.HAND,button_window_mode:SWFUpload.WINDOW_MODE.TRANSPARENT,debug:f.debug,requeue_on_error:f.requeueErrors,file_post_name:f.fileObjName,file_size_limit:f.fileSizeLimit,file_types:f.fileTypeExts,file_types_description:f.fileTypeDesc,file_queue_limit:f.queueSizeLimit,file_upload_limit:f.uploadLimit,flash_url:f.swf,prevent_swf_caching:f.preventCaching,post_params:f.formData,upload_url:f.uploader,use_query_string:"get"==f.method,file_dialog_complete_handler:b.onDialogClose,file_dialog_start_handler:b.onDialogOpen,file_queued_handler:b.onSelect,file_queue_error_handler:b.onSelectError,swfupload_loaded_handler:f.onSWFReady,upload_complete_handler:b.onUploadComplete,upload_error_handler:b.onUploadError,upload_progress_handler:b.onUploadProgress,upload_start_handler:b.onUploadStart,upload_success_handler:b.onUploadSuccess};c&&(g=$.extend(g,c)),g=$.extend(g,f);var h=swfobject.getFlashPlayerVersion(),i=h.major>=9;if(i){window["uploadify_"+f.id]=new SWFUpload(g);var j=window["uploadify_"+f.id];d.data("uploadify",j);var k=$("<div />",{id:f.id,"class":"uploadify",css:{height:f.height+"px",width:f.width+"px"}});$("#"+j.movieName).wrap(k),k=$("#"+f.id),k.data("uploadify",j);var l=$("<div />",{id:f.id+"-button","class":"uploadify-button "+f.buttonClass});if(f.buttonImage&&l.css({"background-image":"url('"+f.buttonImage+"')","text-indent":"-9999px"}),l.html('<span class="uploadify-button-text">'+f.buttonText+"</span>").css({height:f.height+"px","line-height":f.height+"px",width:f.width+"px"}),k.append(l),$("#"+j.movieName).css({position:"absolute","z-index":1}),!f.queueID){var m=$("<div />",{id:f.id+"-queue","class":"uploadify-queue"});k.after(m),j.settings.queueID=f.id+"-queue",j.settings.defaultQueue=!0}j.queueData={files:{},filesSelected:0,filesQueued:0,filesReplaced:0,filesCancelled:0,filesErrored:0,uploadsSuccessful:0,uploadsErrored:0,averageSpeed:0,queueLength:0,queueSize:0,uploadSize:0,queueBytesUploaded:0,uploadQueue:[],errorMsg:"Some files were not added to the queue:"},j.original=e,j.wrapper=k,j.button=l,j.queue=m,f.onInit&&f.onInit.call(d,j)}else{f.onFallback&&f.onFallback.call(d);var n=f.onNoflash.call(d),o=$("<div class='coral-uploader-button' style='height: 40px;'></div>").appendTo(n),p=$("<input type='button'/>").appendTo(o);p.button({id:f.id+"-button",label:f.buttonText,onClick:function(){alert("没有安装flash或flash版本过低")}})}})},cancel:function(a,b){var c=arguments;this.each(function(){var b=$(this),d=b.data("uploadify"),e=d.settings,f=-1;if(c[0])if("*"==c[0]){var g=d.queueData.queueLength;$("#"+e.queueID).find(".uploadify-queue-item").each(function(){f++,c[1]===!0?d.cancelUpload($(this).attr("id"),!1):d.cancelUpload($(this).attr("id")),$(this).find(".data").removeClass("data").html(" - Cancelled"),$(this).find(".uploadify-progress-bar").remove(),$(this).delay(1e3+100*f).fadeOut(500,function(){$(this).remove()}),delete d.queueData.files[a]}),d.queueData.queueSize=0,d.queueData.queueLength=0,e.onClearQueue&&e.onClearQueue.call(b,g)}else for(var h=0;h<c.length;h++)d.cancelUpload(c[h]),$("#"+c[h]).find(".data").removeClass("data").html(" - Cancelled"),$("#"+c[h]).find(".uploadify-progress-bar").remove(),$("#"+c[h]).delay(1e3+100*h).fadeOut(500,function(){$(this).remove()}),delete d.queueData.files[a];else{var i=$("#"+e.queueID).find(".uploadify-queue-item").get(0);$item=$(i),d.cancelUpload($item.attr("id")),$item.find(".data").removeClass("data").html(" - Cancelled"),$item.find(".uploadify-progress-bar").remove(),$item.delay(1e3).fadeOut(500,function(){$(this).remove()}),delete d.queueData.files[a]}})},destroy:function(){this.each(function(){var a=$(this),b=a.data("uploadify"),c=b.settings;b.destroy(),c.defaultQueue&&$("#"+c.queueID).remove(),$("#"+c.id).replaceWith(b.original),c.onDestroy&&c.onDestroy.call(this),delete b})},disable:function(a){this.each(function(){var b=$(this),c=b.data("uploadify"),d=c.settings;a?(c.button.addClass("disabled"),d.onDisable&&d.onDisable.call(this)):(c.button.removeClass("disabled"),d.onEnable&&d.onEnable.call(this)),c.setButtonDisabled(a)})},settings:function(a,b,c){var d=arguments,e=b;return this.each(function(){var f=$(this),g=f.data("uploadify"),h=g.settings;if("object"==typeof d[0])for(var i in b)setData(i,b[i]);if(1===d.length)e=h[a];else{switch(a){case"uploader":g.setUploadURL(b);break;case"formData":c||(b=$.extend(h.formData,b)),g.setPostParams(h.formData);break;case"method":"get"==b?g.setUseQueryString(!0):g.setUseQueryString(!1);break;case"fileObjName":g.setFilePostName(b);break;case"fileTypeExts":g.setFileTypes(b,h.fileTypeDesc);break;case"fileTypeDesc":g.setFileTypes(h.fileTypeExts,b);break;case"fileSizeLimit":g.setFileSizeLimit(b);break;case"uploadLimit":g.setFileUploadLimit(b);break;case"queueSizeLimit":g.setFileQueueLimit(b);break;case"buttonImage":g.button.css("background-image",settingValue);break;case"buttonCursor":"arrow"==b?g.setButtonCursor(SWFUpload.CURSOR.ARROW):g.setButtonCursor(SWFUpload.CURSOR.HAND);break;case"buttonText":$("#"+h.id+"-button").find(".uploadify-button-text").html(b);break;case"width":g.setButtonDimensions(b,h.height);break;case"height":g.setButtonDimensions(h.width,b);break;case"multi":b?g.setButtonAction(SWFUpload.BUTTON_ACTION.SELECT_FILES):g.setButtonAction(SWFUpload.BUTTON_ACTION.SELECT_FILE)}h[a]=b}}),1===d.length?e:void 0},stop:function(){this.each(function(){var a=$(this),b=a.data("uploadify");b.queueData.averageSpeed=0,b.queueData.uploadSize=0,b.queueData.bytesUploaded=0,b.queueData.uploadQueue=[],b.stopUpload()})},upload:function(){var a=arguments;this.each(function(){var b=$(this),c=b.data("uploadify");if(c.queueData.averageSpeed=0,c.queueData.uploadSize=0,c.queueData.bytesUploaded=0,c.queueData.uploadQueue=[],a[0])if("*"==a[0])c.queueData.uploadSize=c.queueData.queueSize,c.queueData.uploadQueue.push("*"),c.startUpload();else{for(var d=0;d<a.length;d++)c.queueData.uploadSize+=c.queueData.files[a[d]].size,c.queueData.uploadQueue.push(a[d]);c.startUpload(c.queueData.uploadQueue.shift())}else c.startUpload()})}},b={onDialogOpen:function(){var a=this.settings;this.queueData.errorMsg="Some files were not added to the queue:",this.queueData.filesReplaced=0,this.queueData.filesCancelled=0,a.onDialogOpen&&a.onDialogOpen.call(this)},onDialogClose:function(a,b,c){var d=this.settings;this.queueData.filesErrored=a-b,this.queueData.filesSelected=a,this.queueData.filesQueued=b-this.queueData.filesCancelled,this.queueData.queueLength=c,$.inArray("onDialogClose",d.overrideEvents)<0&&this.queueData.filesErrored>0&&alert(this.queueData.errorMsg),d.onDialogClose&&d.onDialogClose.call(this,this.queueData),d.auto&&$("#"+d.id).uploadify("upload","*")},onSelect:function(a){var b=this.settings,c={};for(var d in this.queueData.files)if(c=this.queueData.files[d],1!=c.uploaded&&c.name==a.name){var e=confirm('The file named "'+a.name+'" is already in the queue.\nDo you want to replace the existing item in the queue?');if(!e)return this.cancelUpload(a.id),this.queueData.filesCancelled++,!1;$("#"+c.id).remove(),delete this.queueData.files[d],this.cancelUpload(c.id),this.queueData.filesReplaced++}var f=Math.round(a.size/1024),g="KB";f>1e3&&(f=Math.round(f/1e3),g="MB");var h=f.toString().split(".");f=h[0],h.length>1&&(f+="."+h[1].substr(0,2)),f+=g;var i=a.name;if(i.length>25&&(i=i.substr(0,25)+"..."),itemData={fileID:a.id,instanceID:b.id,fileName:i,fileSize:f},0==b.itemTemplate&&(b.itemTemplate='<div id="${fileID}" class="uploadify-queue-item">					<div class="cancel">						<a href="javascript:$(\'#${instanceID}\').uploadify(\'cancel\', \'${fileID}\')">X</a>					</div>					<span class="fileName">${fileName} (${fileSize})</span><span class="data"></span>					<div class="uploadify-progress">						<div class="uploadify-progress-bar"><!--Progress Bar--></div>					</div>				</div>'),$.inArray("onSelect",b.overrideEvents)<0){itemHTML=b.itemTemplate;for(var j in itemData)itemHTML=itemHTML.replace(new RegExp("\\$\\{"+j+"\\}","g"),itemData[j]);$("#"+b.queueID).append(itemHTML)}this.queueData.queueSize+=a.size,this.queueData.files[a.id]=a,b.onSelect&&b.onSelect.apply(this,arguments)},onSelectError:function(a,b,c){var d=this.settings;if($.inArray("onSelectError",d.overrideEvents)<0)switch(b){case SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:d.queueSizeLimit>c?this.queueData.errorMsg+="\nThe number of files selected exceeds the remaining upload limit ("+c+").":this.queueData.errorMsg+="\nThe number of files selected exceeds the queue size limit ("+d.queueSizeLimit+").";break;case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:this.queueData.errorMsg+='\nThe file "'+a.name+'" exceeds the size limit ('+d.fileSizeLimit+").";break;case SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:this.queueData.errorMsg+='\nThe file "'+a.name+'" is empty.';break;case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:this.queueData.errorMsg+='\nThe file "'+a.name+'" is not an accepted file type ('+d.fileTypeDesc+")."}b!=SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED&&delete this.queueData.files[a.id],d.onSelectError&&d.onSelectError.apply(this,arguments)},onQueueComplete:function(){this.settings.onQueueComplete&&this.settings.onQueueComplete.call(this,this.settings.queueData)},onUploadComplete:function(a){var b=this.settings,c=this,d=this.getStats();if(this.queueData.queueLength=d.files_queued,"*"==this.queueData.uploadQueue[0]?this.queueData.queueLength>0?this.startUpload():(this.queueData.uploadQueue=[],b.onQueueComplete&&b.onQueueComplete.call(this,this.queueData)):this.queueData.uploadQueue.length>0?this.startUpload(this.queueData.uploadQueue.shift()):(this.queueData.uploadQueue=[],b.onQueueComplete&&b.onQueueComplete.call(this,this.queueData)),$.inArray("onUploadComplete",b.overrideEvents)<0)if(b.removeCompleted)switch(a.filestatus){case SWFUpload.FILE_STATUS.COMPLETE:setTimeout(function(){$("#"+a.id)&&(c.queueData.queueSize-=a.size,c.queueData.queueLength-=1,delete c.queueData.files[a.id],$("#"+a.id).fadeOut(500,function(){$(this).remove()}))},1e3*b.removeTimeout);break;case SWFUpload.FILE_STATUS.ERROR:b.requeueErrors||setTimeout(function(){$("#"+a.id)&&(c.queueData.queueSize-=a.size,c.queueData.queueLength-=1,delete c.queueData.files[a.id],$("#"+a.id).fadeOut(500,function(){$(this).remove()}))},1e3*b.removeTimeout)}else a.uploaded=!0;b.onUploadComplete&&b.onUploadComplete.call(this,a)},onUploadError:function(a,b,c){var d=this.settings,e="Error";switch(b){case SWFUpload.UPLOAD_ERROR.HTTP_ERROR:e="HTTP Error ("+c+")";break;case SWFUpload.UPLOAD_ERROR.MISSING_UPLOAD_URL:e="Missing Upload URL";break;case SWFUpload.UPLOAD_ERROR.IO_ERROR:e="IO Error";break;case SWFUpload.UPLOAD_ERROR.SECURITY_ERROR:e="Security Error";break;case SWFUpload.UPLOAD_ERROR.UPLOAD_LIMIT_EXCEEDED:alert("The upload limit has been reached ("+c+")."),e="Exceeds Upload Limit";break;case SWFUpload.UPLOAD_ERROR.UPLOAD_FAILED:e="Failed";break;case SWFUpload.UPLOAD_ERROR.SPECIFIED_FILE_ID_NOT_FOUND:break;case SWFUpload.UPLOAD_ERROR.FILE_VALIDATION_FAILED:e="Validation Error";break;case SWFUpload.UPLOAD_ERROR.FILE_CANCELLED:e="Cancelled",this.queueData.queueSize-=a.size,this.queueData.queueLength-=1,(a.status==SWFUpload.FILE_STATUS.IN_PROGRESS||$.inArray(a.id,this.queueData.uploadQueue)>=0)&&(this.queueData.uploadSize-=a.size),d.onCancel&&d.onCancel.call(this,a),delete this.queueData.files[a.id];break;case SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED:e="Stopped"}$.inArray("onUploadError",d.overrideEvents)<0&&(b!=SWFUpload.UPLOAD_ERROR.FILE_CANCELLED&&b!=SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED&&$("#"+a.id).addClass("uploadify-error"),$("#"+a.id).find(".uploadify-progress-bar").css("width","1px"),b!=SWFUpload.UPLOAD_ERROR.SPECIFIED_FILE_ID_NOT_FOUND&&a.status!=SWFUpload.FILE_STATUS.COMPLETE&&$("#"+a.id).find(".data").html(" - "+e));var f=this.getStats();this.queueData.uploadsErrored=f.upload_errors,d.onUploadError&&d.onUploadError.call(this,a,b,c,e)},onUploadProgress:function(a,b,c){var d=this.settings,e=new Date,f=e.getTime(),g=f-this.timer;g>500&&(this.timer=f);var h=b-this.bytesLoaded;this.bytesLoaded=b;var i=this.queueData.queueBytesUploaded+b,j=Math.round(b/c*100),k="KB/s",l=0,m=h/1024/(g/1e3);m=Math.floor(10*m)/10,this.queueData.averageSpeed>0?this.queueData.averageSpeed=Math.floor((this.queueData.averageSpeed+m)/2):this.queueData.averageSpeed=Math.floor(m),m>1e3&&(l=.001*m,this.queueData.averageSpeed=Math.floor(l),k="MB/s"),$.inArray("onUploadProgress",d.overrideEvents)<0&&("percentage"==d.progressData?$("#"+a.id).find(".data").html(" - "+j+"%"):"speed"==d.progressData&&g>500&&$("#"+a.id).find(".data").html(" - "+this.queueData.averageSpeed+k),$("#"+a.id).find(".uploadify-progress-bar").css("width",j+"%")),d.onUploadProgress&&d.onUploadProgress.call(this,a,b,c,i,this.queueData.uploadSize)},onUploadStart:function(a){var b=this.settings,c=new Date;this.timer=c.getTime(),this.bytesLoaded=0,0==this.queueData.uploadQueue.length&&(this.queueData.uploadSize=a.size),b.checkExisting&&$.ajax({type:"POST",async:!1,url:b.checkExisting,data:{filename:a.name},success:function(b){if(1==b){var c=confirm('A file with the name "'+a.name+'" already exists on the server.\nWould you like to replace the existing file?');c||(this.cancelUpload(a.id),$("#"+a.id).remove(),this.queueData.uploadQueue.length>0&&this.queueData.queueLength>0&&("*"==this.queueData.uploadQueue[0]?this.startUpload():this.startUpload(this.queueData.uploadQueue.shift())))}}}),b.onUploadStart&&b.onUploadStart.call(this,a)},onUploadSuccess:function(a,b,c){var d=this.settings,e=this.getStats();this.queueData.uploadsSuccessful=e.successful_uploads,this.queueData.queueBytesUploaded+=a.size,$.inArray("onUploadSuccess",d.overrideEvents)<0&&$("#"+a.id).find(".data").html(" - 上传完成"),d.onUploadSuccess&&d.onUploadSuccess.call(this,a,b,c)}};$.fn.uploadify=function(b){return a[b]?a[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void $.error("The method "+b+" does not exist in $.uploadify"):a.init.apply(this,arguments)}}();/*! cui 2016-11-08 */
$.component("coral.uploader",{version:$.coral.version,castProperties:["dataCustom","formData","overrideEvents","buttons","itemTemplate"],options:{id:"",swf:$.coral.scriptPath+"external/swfupload.swf",uploader:"",auto:!0,buttonClass:"",buttonCursor:"hand",buttonImage:null,buttonText:"SELECT FILES",checkExisting:!1,debug:!1,fileObjName:"Filedata",fileSizeLimit:0,fileTypeDesc:"All Files",fileTypeExts:"*.*",heigh:30,itemTemplate:!1,method:"post",multi:!0,formData:{},preventCaching:!0,progressData:"percentage",queueID:!1,queueSizeLimit:999,removeCompleted:!0,removeTimeout:3,requeueError:!1,successTimeout:30,uploadLimit:0,width:120,cls:"",displayStyle:"original",emptyText:"请选择...",delay:1e3,buttons:null,overrideEvents:[],onCancel:null,onClearQueue:null,onDestroy:null,onDialogClose:null,onDialogOpen:null,onDisable:null,onEnable:null,onFallback:null,onNoflash:null,onInit:null,onQueueComplete:null,onSelectError:null,onSelect:null,onNoFlash:null,onSWFReady:null,onUploadComplete:null,onUploadError:null,onUploadSuccess:null,onUploadProgress:null,onUploadStart:null},_create:function(){var a=this;a._initElement();var b=a._flashCheck();0==b&&a._trigger("onNoFlash",null,[])},_initElement:function(){var a=this,b=a.options,c={};"undefined"!=typeof a.element.attr("id")?b.id=a.element.attr("id"):b.id&&a.element.attr("id",b.id),"undefined"!=typeof a.element.attr("name")?b.name=a.element.attr("name"):b.name&&a.element.attr("name",b.name),delete b.id,c=a.getEventsObj(),b=$.extend({},b,c),this._initUploder(b),b.id=a.element.attr("id")},_flashCheck:function(){var a=!-[1],b=!0;if(a)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash");b=!0}catch(c){b=!1}else try{if(navigator.plugins&&navigator.plugins.length>0){var d=navigator.plugins["Shockwave Flash"];void 0==d&&(b=!1)}else b=!0}catch(c){b=!1}return b},component:function(){return this.uiUploader},destroy:function(){this.uploader.uploadify("destroy")},disable:function(a){this.uploader.uploadify("disable",a)},settings:function(a,b,c){this.uploader.uploadify("settings",a,b,c)},stop:function(){this.uploader.uploadify("stop")},upload:function(a){if("original"==this.options.displayStyle||!this._isQueueDialog())return void this.uploader.uploadify("upload",a);if(0!=this.select.length){var b=this.element.attr("id");$("#"+b+"_queue").dialog("open")}},getvalue:function(){return 0==this.select.length&&alert("none file"),this.select.join(",")},cancel:function(){this.uploader.uploadify("cancel")},clear:function(a){"custom"==this.options.displayStyle&&(this.select=[],this.uiUploader.find(".coral-file").html("请选择..."),this.uiUploader.find("object").attr("title","请选择...")),this.uploader.uploadify("cancel"),this.clearQueue()},clearQueue:function(){this.uploader.clearQueue()},uploadify:function(){return this.uploader},queueData:function(){return this.uploader.data("uploadify").queueData},_getButtons:function(){if("object"==typeof this.options.buttons)return this.options.buttons;if("string"!=typeof this.options.buttons)return[];var a=(this.options,this.options.buttons),b=[],c=$.trim(a).split(",");for(var d in c){var e={},f=c[d].split(" ");e.label=f[0],e.click=f[1],b.push(e)}return b},_triggerClick:function(a,b,c){var d=this,e=$.coral.toFunction(a);return b=$.Event(b),e.apply(d.element[0],[b].concat(c))},_createButtons:function(){var a=this,b=(this.options,this._getButtons()),c=$('<span class="coral-uploader-btn-icons coral-corner-right"></span>');a.uiBorder.append(c),$.each(b,function(b,d){var e=d.label,f=d.id,g=d.click,h={},i=$('<span class="coral-uploader-btn-ico icon coral-uploader-btn-textico"></span>');e&&(i.html(e),h.label=e),f&&(i.attr("data-id",f),h.id=f),i.bind("click"+a.eventNamespace,function(b){a.options.disabled||a._triggerClick(g,b,h)}),c.append(i)})},_initUploder:function(a){var b=this,c=b.element.attr("id");if(b.uiUploader=$('<span class="coral-uploader"></span>'),b.uiBorder=$('<span class="coral-uploader-border coral-corner-all"></span>'),b.uploader=$('<div id="'+c+'_uploader"></div>'),b.element.after(b.uiUploader),b.uiUploader.append(b.uiBorder),b.uiBorder.append(b.element),b.element.hide(),"original"==a.displayStyle)return b.element.before(b.uploader),void this.uploader.uploadify(a);this.uiUploader.addClass("coral-uploader-custom coral-textbox"),this.uiBorder.addClass("coral-textbox-border"),a.buttons&&this._createButtons(),b.select=[],$(this.element).wrap('<span class="coral-file-default"></span>').before("<span class='coral-file'>"+a.emptyText+"</span>").before(b.uploader);var d=$.extend(a,{height:28,width:800});d.queueID||($(this.element).before("<div id='"+c+"_queue'></div>"),$("#"+c+"_queue").dialog({autoOpen:!1,title:"上传",modal:!1,resizable:!1,onOpen:function(){b.uploader.uploadify("upload","*")}}),a.queueID=c+"_queue",this.hasDialog=!0),b.uploader.uploadify(d)},_isQueueDialog:function(){return this.hasDialog},_reloadUploader:function(){var a=this,b=this.options;delete b.id,a.uploader.uploadify(b),b.id=a.element.attr("id")},getEventsObj:function(){var a=this,b=this.options,c=this.element.attr("id");return{onCancel:function(b){a._trigger("onCancel",null,[{file:b}])},onClearQueue:function(b){a._trigger("onClearQueue",null,[{queueItemCount:b}])},onDestroy:function(){a._trigger("onDestroy",null,[])},onDialogClose:function(d){"custom"==b.displayStyle&&b.auto&&a._isQueueDialog()&&$("#"+c+"_queue").dialog("open"),a._trigger("onDialogClose",null,[{queueData:d}])},onDialogOpen:function(){"custom"==b.displayStyle,a._trigger("onDialogOpen",null,[])},onDisable:function(){a._trigger("onDisable",null,[])},onEnable:function(){a._trigger("onEnable",null,[])},onFallback:function(){a._trigger("onFallback ",null,[])},onNoflash:function(){return a.uiBorder},onInit:function(b){a._trigger("onInit",null,[{swfuploadify:b}])},onQueueComplete:function(c){var d=a.element.attr("id");"custom"==b.displayStyle&&a._isQueueDialog()&&setTimeout(function(){$("#"+d+"_queue").dialog("close"),a.select=[]},b.delay),a._trigger("onQueueComplete",null,[{queueData:c}])},onSelectError:function(b,c,d){a._trigger("onSelectError",null,[{arguments:arguments}])},onSelect:function(c){"custom"==b.displayStyle&&(a.select.push(c.name),a.uiUploader.find(".coral-file").html(a.select.join(",")),a.uiUploader.find("object").attr("title",a.select.join(","))),a._trigger("onSelect",null,[{file:c}])},onSWFReady:function(){a._trigger("onSWFReady",null,[])},onUploadComplete:function(b){a._trigger("onUploadComplete",null,[{file:b}])},onUploadError:function(b,c,d,e){a._trigger("onUploadError",null,[{file:b,errorCode:c,errorMsg:d,errorString:e}])},onUploadSuccess:function(b,c,d){a._trigger("onUploadSuccess",null,[{file:b,data:c,response:d}])},onUploadProgress:function(b,c,d,e,f){a._trigger("onUploadProgress",null,[{file:b,fileBytesLoaded:c,fileTotalBytes:d,queueBytesLoaded:e,uploadSize:f}])},onUploadStart:function(b){a._trigger("onUploadStart",null,[{file:b}])}}},_setOption:function(a,b){var c=this;if("id"!==a&&"name"!==a)return this._super(a,b),"emptyText"===a?void this.uiUploader.find(".coral-file").html(b):void c.settings(a,b)},_destroy:function(){var a=this;a.uiUploader.replaceWith(a.element)}});/*! cui 2016-11-08 */
var tooltip=$.component("coral.tooltip",{version:"4.0.1",options:{content:function(){var a=$(this).attr("title")||"";return $("<a>").text(a).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,onClose:null,onOpen:null},_addDescribedBy:function(a,b){var c=(a.attr("aria-describedby")||"").split(/\s+/);c.push(b),a.data("coral-tooltip-id",b).attr("aria-describedby",$.trim(c.join(" ")))},_removeDescribedBy:function(a){var b=a.data("coral-tooltip-id"),c=(a.attr("aria-describedby")||"").split(/\s+/),d=$.inArray(b,c);-1!==d&&c.splice(d,1),a.removeData("coral-tooltip-id"),c=$.trim(c.join(" ")),c?a.attr("aria-describedby",c):a.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable(),this.liveRegion=$("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).addClass("coral-helper-hidden-accessible").appendTo(this.document[0].body)},_setOption:function(a,b){var c=this;return"disabled"===a?(this[b?"_disable":"_enable"](),void(this.options[a]=b)):(this._super(a,b),void("content"===a&&$.each(this.tooltips,function(a,b){c._updateContent(b)})))},_disable:function(){var a=this;$.each(this.tooltips,function(b,c){var d=$.Event("blur");d.target=d.currentTarget=c[0],a.close(d,!0)}),this.element.find(this.options.items).addBack().each(function(){var a=$(this);a.is("[title]")&&a.data("coral-tooltip-title",a.attr("title")).removeAttr("title")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var a=$(this);a.data("coral-tooltip-title")&&a.attr("title",a.data("coral-tooltip-title"))})},open:function(a){var b=this,c=$(a?a.target:this.element).closest(this.options.items);c.length&&!c.data("coral-tooltip-id")&&(c.attr("title")&&c.data("coral-tooltip-title",c.attr("title")),c.data("coral-tooltip-open",!0),a&&"mouseover"===a.type&&c.parents().each(function(){var a,c=$(this);c.data("coral-tooltip-open")&&(a=$.Event("blur"),a.target=a.currentTarget=this,b.close(a,!0)),c.attr("title")&&(c.uniqueId(),b.parents[this.id]={element:this,title:c.attr("title")},c.attr("title",""))}),this._updateContent(c,a))},_updateContent:function(a,b){var c,d=this.options.content,e=this,f=b?b.type:null;return"string"==typeof d?this._open(b,a,d):(c=d.call(a[0],function(c){a.data("coral-tooltip-open")&&e._delay(function(){b&&(b.type=f),this._open(b,a,c)})}),void(c&&this._open(b,a,c)))},_open:function(a,b,c){function d(a){i.of=a,e.is(":hidden")||e.position(i)}var e,f,g,h,i=$.extend({},this.options.position);if(c){if(e=this._find(b),e.length)return void e.find(".coral-tooltip-content").html(c);b.is("[title]")&&(a&&"mouseover"===a.type?b.attr("title",""):b.removeAttr("title")),e=this._tooltip(b),this._addDescribedBy(b,e.attr("id")),e.find(".coral-tooltip-content").html(c),this.liveRegion.children().hide(),c.clone?(h=c.clone(),h.removeAttr("id").find("[id]").removeAttr("id")):h=c,$("<div>").html(h).appendTo(this.liveRegion),this.options.track&&a&&/^mouse/.test(a.type)?(this._on(this.document,{mousemove:d}),d(a)):e.position($.extend({of:b},this.options.position)),this.hiding=!1,this.closing=!1,e.hide(),this._show(e,this.options.show),this.options.show&&this.options.show.delay&&(g=this.delayedShow=setInterval(function(){e.is(":visible")&&(d(i.of),clearInterval(g))},$.fx.interval)),this._trigger("onOpen",a,{tooltip:e}),f={keyup:function(a){if(a.keyCode===$.coral.keyCode.ESCAPE){var c=$.Event(a);c.currentTarget=b[0],this.close(c,!0)}}},b[0]!==this.element[0]&&(f.remove=function(){this._removeTooltip(e)}),a&&"mouseover"!==a.type||(f.mouseleave="close"),a&&"focusin"!==a.type||(f.focusout="close"),this._on(!0,b,f)}},close:function(a){var b=this,c=$(a?a.currentTarget:this.element),d=this._find(c);this.closing||(clearInterval(this.delayedShow),c.data("coral-tooltip-title")&&!c.attr("title")&&c.attr("title",c.data("coral-tooltip-title")),this._removeDescribedBy(c),this.hiding=!0,d.stop(!0),this._hide(d,this.options.hide,function(){b._removeTooltip($(this)),this.hiding=!1,this.closing=!1}),c.removeData("coral-tooltip-open"),this._off(c,"mouseleave focusout keyup"),c[0]!==this.element[0]&&this._off(c,"remove"),this._off(this.document,"mousemove"),a&&"mouseleave"===a.type&&$.each(this.parents,function(a,c){$(c.element).attr("title",c.title),delete b.parents[a]}),this.closing=!0,this._trigger("onClose",a,{tooltip:d}),this.hiding||(this.closing=!1))},_tooltip:function(a){var b=$("<div>").attr("role","tooltip").addClass("coral-tooltip coral-component coral-corner-all coral-component-content "+(this.options.tooltipClass||"")),c=b.uniqueId().attr("id");return $("<div>").addClass("coral-tooltip-content").appendTo(b),b.appendTo(this.document[0].body),this.tooltips[c]=a,b},_find:function(a){var b=a.data("coral-tooltip-id");return b?$("#"+b):$()},_removeTooltip:function(a){a.remove(),delete this.tooltips[a.attr("id")]},_destroy:function(){var a=this;$.each(this.tooltips,function(b,c){var d=$.Event("blur");d.target=d.currentTarget=c[0],a.close(d,!0),$("#"+b).remove(),c.data("coral-tooltip-title")&&(c.attr("title")||c.attr("title",c.data("coral-tooltip-title")),c.removeData("coral-tooltip-title"))}),this.liveRegion.remove()}});/*! cui 2016-11-08 */
function spinner_modifier(a){return function(){var b=this.element.val();a.apply(this,arguments),this._refresh(),b!==this.element.val()&&this._trigger("onChange")}}var spinner=$.component("coral.spinner",$.coral.formelement,{version:"4.0.3",castProperties:["triggers"],defaultElement:"<input>",componentEventPrefix:"spin",options:{culture:null,icons:{down:"cui-icon-arrow-down3",up:"cui-icon-arrow-up3"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,onChange:null,onSpin:null,onStart:null,onStop:null,triggers:null,excluded:!1},_create:function(){"undefined"!=typeof this.element.attr("id")?this.options.id=this.element.attr("id"):this.options.id&&this.element.attr("id",this.options.id),"undefined"!=typeof this.element.attr("name")?this.options.name=this.element.attr("name"):this.options.name&&this.element.attr("name",this.options.name),"undefined"!=typeof this.element.attr("value")&&(this.options.value=this.element.attr("value")),this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),""!==$.trim(this.element.val())?this.options.value=this.element.text():this.options.value&&this.element.val(this.options.value),this.originalValue=this.getValue(),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var a={},b=this.element;return $.each(["min","max","step"],function(c,d){var e=b.attr(d);void 0!==e&&e.length&&(a[d]=e)}),a},_events:{"mouseenter.coral-textbox-border":function(a){"boolean"==typeof this.options.isLabel&&this.options.isLabel||"boolean"==typeof this.options.readonly&&this.options.readonly||(this.component().addClass("coral-textbox-hover"),this._trigger("onMouseEnter",a,[]))},"mouseleave.coral-textbox-border":function(a){"boolean"==typeof this.options.isLabel&&this.options.isLabel||"boolean"==typeof this.options.readonly&&this.options.readonly||(this.component().removeClass("coral-textbox-hover"),this._trigger("onMouseLeave",a,[]))},keydown:function(a){this._start(a)&&this._keydown(a)&&a.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(a){var b,c;return this.cancelBlur?void delete this.cancelBlur:(this._stop(),this._refresh(),b=this._parse(this.element.val()),isNaN(b)&&(b=0),c=this._restrictMinMax(b),this.setValue(c),void(this.previous!==this.element.val()&&this._trigger("onChange",a)))},mousewheel:function(a,b){if(b){if(!this.spinning&&!this._start(a))return!1;this._spin((b>0?1:-1)*this.options.step,a),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(a)},100),a.preventDefault()}},"mousedown .coral-spinner-button":function(a){function b(){var a=this.element[0]===this.document[0].activeElement;a||(this.element.focus(),this.previous=c,this._delay(function(){this.previous=c}))}var c;c=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),a.preventDefault(),b.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,b.call(this)}),this._start(a)!==!1&&this._repeat(null,$(a.currentTarget).hasClass("coral-spinner-up")?1:-1,a)},"mouseup .coral-spinner-button":"_stop","mouseenter .coral-spinner-button":function(a){return $(a.currentTarget).hasClass("coral-state-active")?this._start(a)===!1?!1:void this._repeat(null,$(a.currentTarget).hasClass("coral-spinner-up")?1:-1,a):void 0},"mouseleave .coral-spinner-button":"_stop"},_draw:function(){var a=this.uiSpinner=this.element.addClass("coral-spinner-input coral-textbox-default").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.options.vertical&&this.component().addClass("spinner-vertical"),this.buttons=a.find(".coral-spinner-button").attr("tabIndex",-1).button().removeClass("coral-corner-all"),this.options.vertical||this.buttons.height()>Math.ceil(.5*a.height())&&a.height()>0&&a.height(a.height()),this.options.disabled&&this.disable()},_keydown:function(a){var b=this.options,c=$.coral.keyCode;switch(a.keyCode){case c.UP:return this._repeat(null,1,a),!0;case c.DOWN:return this._repeat(null,-1,a),!0;case c.PAGE_UP:return this._repeat(null,b.page,a),!0;case c.PAGE_DOWN:return this._repeat(null,-b.page,a),!0}return!1},_uiSpinnerHtml:function(){return"<span class='coral-spinner coral-textbox coral-component'><span class='coral-textbox-border coral-corner-all'></span></span>"},_buttonHtml:function(){return"<a class='coral-spinner-button coral-spinner-up coral-corner-tr'><span class='icon "+this.options.icons.up+"'></span></a><a class='coral-spinner-button coral-spinner-down coral-corner-br'><span class='icon "+this.options.icons.down+"'></span></a>"},_start:function(a){return this.spinning||this._trigger("onStart",a)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(a,b,c){a=a||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,b,c)},a),this._spin(b*this.options.step,c)},_spin:function(a,b){var c=this.value()||0;this.counter||(this.counter=1),c=this._adjustValue(c+a*this._increment(this.counter)),this.spinning&&this._trigger("onSpin",b,{value:c})===!1||(this._value(c),this.counter++)},_increment:function(a){var b=this.options.incremental;return b?$.isFunction(b)?b(a):Math.floor(a*a*a/5e4-a*a/500+17*a/200+1):1},_precision:function(){var a=this._precisionOf(this.options.step);return null!==this.options.min&&(a=Math.max(a,this._precisionOf(this.options.min))),a},_precisionOf:function(a){var b=a.toString(),c=b.indexOf(".");return-1===c?0:b.length-c-1},_adjustValue:function(a){var b,c,d=this.options;return b=null!==d.min?d.min:0,c=a-b,c=Math.round(c/d.step)*d.step,a=b+c,a=parseFloat(a.toFixed(this._precision())),null!==d.max&&a>d.max?d.max:null!==d.min&&a<d.min?d.min:a},_stop:function(a){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("onStop",a))},_restrictMinMax:function(a){var b=this.options.min,c=this.options.max,d=b&&b>a?b:a;return c&&d>c?c:d},_setOption:function(a,b){if("value"===a&&("undefined"!=typeof b?this.value(b):this.value()),"culture"===a||"numberFormat"===a){var c=this._parse(this.element.val());return this.options[a]=b,void this.element.val(this._format(c))}"max"!==a&&"min"!==a&&"step"!==a||"string"==typeof b&&(b=this._parse(b)),"icons"===a&&(this.buttons.first().find(".coral-icon").removeClass(this.options.icons.up).addClass(b.up),this.buttons.last().find(".coral-icon").removeClass(this.options.icons.down).addClass(b.down)),this._super(a,b),"disabled"===a&&(this.component().toggleClass("coral-state-disabled",!!b),this.element.prop("disabled",!!b),this.buttons.button(b?"disable":"enable"))},_setOptions:spinner_modifier(function(a){this._super(a)}),_parse:function(a){return"string"==typeof a&&""!==a&&(a=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(a,10,this.options.culture):+a),a},_format:function(a){return""===a?"":window.Globalize&&this.options.numberFormat?Globalize.format(a,this.options.numberFormat,this.options.culture):a},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var a=this.value();return null===a?!1:a===this._adjustValue(a)},_value:function(a,b){var c;""!==a&&(c=this._parse(a),null!==c&&(b||(c=this._adjustValue(c)),a=this._format(c))),this.element.val(a),this._refresh()},_destroy:function(){this.element.removeClass("coral-spinner-input").removeClass("coral-textbox-default").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.component().replaceWith(this.element)},reset:function(){this.setValue(this.originalValue)},stepUp:spinner_modifier(function(a){this._stepUp(a)}),_stepUp:function(a){this._start()&&(this._spin((a||1)*this.options.step),this._stop())},stepDown:spinner_modifier(function(a){this._stepDown(a)}),_stepDown:function(a){this._start()&&(this._spin((a||1)*-this.options.step),this._stop())},pageUp:spinner_modifier(function(a){this._stepUp((a||1)*this.options.page)}),pageDown:spinner_modifier(function(a){this._stepDown((a||1)*this.options.page)}),setValue:function(a){a=0==a?0:a||"",this.value(a)},getValue:function(a){return this.value()+""},value:function(a){return arguments.length?void spinner_modifier(this._value).call(this,a):this._parse(this.element.val())},component:function(){return this.uiSpinner.parent()}});/*! cui 2016-11-08 */
var slider=$.component("coral.slider",$.coral.mouse,{version:"4.0.3",componentEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this.element.addClass("coral-slider coral-slider-"+this.orientation+" coral-component coral-component-content coral-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var a,b,c=this.options,d=this.element.find(".coral-slider-handle").addClass("coral-state-default coral-corner-all"),e="<span class='coral-slider-handle coral-state-default coral-corner-all' tabindex='0'></span>",f=[];for(b=c.values&&c.values.length||1,d.length>b&&(d.slice(b).remove(),d=d.slice(0,b)),a=d.length;b>a;a++)f.push(e);this.handles=d.add($(f.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(a){$(this).data("coral-slider-handle-index",a)})},_createRange:function(){var a=this.options,b="";a.range?(a.range===!0&&(a.values?a.values.length&&2!==a.values.length?a.values=[a.values[0],a.values[0]]:$.isArray(a.values)&&(a.values=a.values.slice(0)):a.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("coral-slider-range-min coral-slider-range-max").css({left:"",bottom:""}):(this.range=$("<div></div>").appendTo(this.element),b="coral-slider-range coral-component-header coral-corner-all"),this.range.addClass(b+("min"===a.range||"max"===a.range?" coral-slider-range-"+a.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("coral-slider coral-slider-horizontal coral-slider-vertical coral-component coral-component-content coral-corner-all"),this._mouseDestroy()},_mouseCapture:function(a){var b,c,d,e,f,g,h,i,j=this,k=this.options;return k.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),b={x:a.pageX,y:a.pageY},c=this._normValueFromMouse(b),d=this._valueMax()-this._valueMin()+1,this.handles.each(function(a){var b=Math.abs(c-j.values(a));(d>b||d===b&&(a===j._lastChangedValue||j.values(a)===k.min))&&(d=b,e=$(this),f=a)}),g=this._start(a,f),g===!1?!1:(this._mouseSliding=!0,this._handleIndex=f,e.addClass("coral-state-active").focus(),h=e.offset(),i=!$(a.target).parents().addBack().is(".coral-slider-handle"),this._clickOffset=i?{left:0,top:0}:{left:a.pageX-h.left-e.width()/2,top:a.pageY-h.top-e.height()/2-(parseInt(e.css("borderTopWidth"),10)||0)-(parseInt(e.css("borderBottomWidth"),10)||0)+(parseInt(e.css("marginTop"),10)||0)},this.handles.hasClass("coral-state-hover")||this._slide(a,f,c),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(a){var b={x:a.pageX,y:a.pageY},c=this._normValueFromMouse(b);return this._slide(a,this._handleIndex,c),!1},_mouseStop:function(a){return this.handles.removeClass("coral-state-active"),this._mouseSliding=!1,this._stop(a,this._handleIndex),this._change(a,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(a){var b,c,d,e,f;return"horizontal"===this.orientation?(b=this.elementSize.width,c=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(b=this.elementSize.height,c=a.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),d=c/b,d>1&&(d=1),0>d&&(d=0),"vertical"===this.orientation&&(d=1-d),e=this._valueMax()-this._valueMin(),f=this._valueMin()+d*e,this._trimAlignValue(f)},_start:function(a,b){var c={handle:this.handles[b],value:this.value()};return this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("start",a,c)},_slide:function(a,b,c){var d,e,f;this.options.values&&this.options.values.length?(d=this.values(b?0:1),2===this.options.values.length&&this.options.range===!0&&(0===b&&c>d||1===b&&d>c)&&(c=d),c!==this.values(b)&&(e=this.values(),e[b]=c,f=this._trigger("slide",a,{handle:this.handles[b],value:c,values:e}),d=this.values(b?0:1),f!==!1&&this.values(b,c))):c!==this.value()&&(f=this._trigger("slide",a,{handle:this.handles[b],value:c}),f!==!1&&this.value(c))},_stop:function(a,b){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("stop",a,c)},_change:function(a,b){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._lastChangedValue=b,this._trigger("change",a,c)}},value:function(a){return arguments.length?(this.options.value=this._trimAlignValue(a),this._refreshValue(),void this._change(null,0)):this._value()},values:function(a,b){var c,d,e;if(arguments.length>1)return this.options.values[a]=this._trimAlignValue(b),this._refreshValue(),void this._change(null,a);if(!arguments.length)return this._values();if(!$.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(a):this.value();for(c=this.options.values,d=arguments[0],e=0;e<c.length;e+=1)c[e]=this._trimAlignValue(d[e]),this._change(null,e);this._refreshValue()},_setOption:function(a,b){var c,d=0;switch("range"===a&&this.options.range===!0&&("min"===b?(this.options.value=this._values(0),this.options.values=null):"max"===b&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),$.isArray(this.options.values)&&(d=this.options.values.length),"disabled"===a&&this.element.toggleClass("coral-state-disabled",!!b),this._super(a,b),a){case"orientation":this._detectOrientation(),this.element.removeClass("coral-slider-horizontal coral-slider-vertical").addClass("coral-slider-"+this.orientation),this._refreshValue(),this.handles.css("horizontal"===b?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),c=0;d>c;c+=1)this._change(null,c);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var a=this.options.value;return a=this._trimAlignValue(a)},_values:function(a){var b,c,d;if(arguments.length)return b=this.options.values[a],b=this._trimAlignValue(b);if(this.options.values&&this.options.values.length){for(c=this.options.values.slice(),d=0;d<c.length;d+=1)c[d]=this._trimAlignValue(c[d]);return c}return[]},_trimAlignValue:function(a){if(a<=this._valueMin())return this._valueMin();if(a>=this._valueMax())return this._valueMax();var b=this.options.step>0?this.options.step:1,c=(a-this._valueMin())%b,d=a-c;return 2*Math.abs(c)>=b&&(d+=c>0?b:-b),parseFloat(d.toFixed(5))},_calculateNewMax:function(){var a=(this.options.max-this._valueMin())%this.options.step;this.max=this.options.max-a},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshValue:function(){var a,b,c,d,e,f=this.options.range,g=this.options,h=this,i=this._animateOff?!1:g.animate,j={};this.options.values&&this.options.values.length?this.handles.each(function(c){b=(h.values(c)-h._valueMin())/(h._valueMax()-h._valueMin())*100,j["horizontal"===h.orientation?"left":"bottom"]=b+"%",$(this).stop(1,1)[i?"animate":"css"](j,g.animate),h.options.range===!0&&("horizontal"===h.orientation?(0===c&&h.range.stop(1,1)[i?"animate":"css"]({left:b+"%"},g.animate),1===c&&h.range[i?"animate":"css"]({width:b-a+"%"},{queue:!1,duration:g.animate})):(0===c&&h.range.stop(1,1)[i?"animate":"css"]({bottom:b+"%"},g.animate),1===c&&h.range[i?"animate":"css"]({height:b-a+"%"},{queue:!1,duration:g.animate}))),a=b}):(c=this.value(),d=this._valueMin(),e=this._valueMax(),b=e!==d?(c-d)/(e-d)*100:0,j["horizontal"===this.orientation?"left":"bottom"]=b+"%",this.handle.stop(1,1)[i?"animate":"css"](j,g.animate),"min"===f&&"horizontal"===this.orientation&&this.range.stop(1,1)[i?"animate":"css"]({width:b+"%"},g.animate),"max"===f&&"horizontal"===this.orientation&&this.range[i?"animate":"css"]({width:100-b+"%"},{queue:!1,duration:g.animate}),"min"===f&&"vertical"===this.orientation&&this.range.stop(1,1)[i?"animate":"css"]({height:b+"%"},g.animate),"max"===f&&"vertical"===this.orientation&&this.range[i?"animate":"css"]({height:100-b+"%"},{queue:!1,duration:g.animate}))},_handleEvents:{keydown:function(a){var b,c,d,e,f=$(a.target).data("coral-slider-handle-index");switch(a.keyCode){case $.coral.keyCode.HOME:case $.coral.keyCode.END:case $.coral.keyCode.PAGE_UP:case $.coral.keyCode.PAGE_DOWN:case $.coral.keyCode.UP:case $.coral.keyCode.RIGHT:case $.coral.keyCode.DOWN:case $.coral.keyCode.LEFT:if(a.preventDefault(),!this._keySliding&&(this._keySliding=!0,$(a.target).addClass("coral-state-active"),b=this._start(a,f),b===!1))return}switch(e=this.options.step,c=d=this.options.values&&this.options.values.length?this.values(f):this.value(),a.keyCode){case $.coral.keyCode.HOME:d=this._valueMin();break;case $.coral.keyCode.END:d=this._valueMax();break;case $.coral.keyCode.PAGE_UP:d=this._trimAlignValue(c+(this._valueMax()-this._valueMin())/this.numPages);break;case $.coral.keyCode.PAGE_DOWN:d=this._trimAlignValue(c-(this._valueMax()-this._valueMin())/this.numPages);break;case $.coral.keyCode.UP:case $.coral.keyCode.RIGHT:if(c===this._valueMax())return;d=this._trimAlignValue(c+e);break;case $.coral.keyCode.DOWN:case $.coral.keyCode.LEFT:if(c===this._valueMin())return;d=this._trimAlignValue(c-e)}this._slide(a,f,d)},keyup:function(a){var b=$(a.target).data("coral-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(a,b),this._change(a,b),$(a.target).removeClass("coral-state-active"))}}});/*! cui 2016-11-08 */
!function(){"use strict";var a="easyinput",b="easytext",c=a+b.charAt(0).toUpperCase()+b.slice(1);$.component(a+"."+b,{options:{currentValue:"",values:[],maxWidth:200,minWidth:80,maxChars:200,storage:"array",ajaxConfig:{url:"/",id:"",UPDATETemplate:"",UPDATEData:{},GETCallback:null}},_name:b,_input:null,_id:null,_valuesIndex:null,_classUnChanged:null,_classEmpty:null,_classOnEdit:null,_classChanged:null,_classEasyText:b.toLowerCase(),_setListeners:function(){this._input.bind({focus:this._focusBehaviour,input:this._autoGrownBehaviour,blur:this._blurBehaviour,storageChange:this._storageChange})},_getClassName:function(a){return this._name.toLowerCase()+"-"+a},_setClassNames:function(){this._classOnHover=this._getClassName("onHover"),this._classUnChanged=this._getClassName("unChanged"),this._classOnEdit=this._getClassName("onEdit"),this._classChanged=this._getClassName("changed"),this._classEmpty=this._getClassName("empty")},_setVars:function(){var a=this.element;this._input=a,a.uniqueId(),this._valuesIndex=0,this._id=this._name+"-"+a.attr("id"),a.attr("maxLength",this.options.maxChars)},_setRuler:function(){var a="#"+this._name+"-ruler",b=$(a),c=this._input;b.length||(String.prototype.visualLength=function(){var b=$(a);return b.html(this.replace(/&/g,"&amp;").replace(/\s/g,"&nbsp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),b.width()},b=$('<span id="'+a.substr(1)+'"></span>'),b.css({fontSize:c.css("fontSize"),fontFamily:c.css("font-family"),fontWeight:c.css("fontWeight"),position:"absolute",visibility:"hidden",whiteSpace:"nowrap"}),$("body").after(b))},_initializeAjax:function(){var a=this.options.ajaxConfig;$.isFunction(a.GETCallback)&&("/"!==a.url.charAt(a.url.length-1)&&(a.url+="/"),a.id||(a.id=this._id),$.ajax({url:a.url+a.id,succes:a.GETCallback}))},_setState:function(){var a,b=this._input,c=b.val(),d=c.visualLength(),e=this.options.minWidth,f=this.options.maxWidth;a=e>d?e:d>f?f:d,b.width(a),0===b.val().length?(b.removeClass(this._classChanged),b.addClass(this._classEmpty)):b.addClass(this._classChanged)},_focusBehaviour:function(){var a=$(this).data(c),b=a._input;b.removeClass(a._classChanged+" "+a._classUnChanged+" "+a._classEmpty).addClass(a._classOnEdit)},_autoGrownBehaviour:function(){var a=$(this).data(c),b=a._input,d=b.val(),e=a.options.minWidth,f=a.options.maxWidth,g=d.visualLength();e>g?g=e:g>f&&(g=f),b.width(g)},_blurBehaviour:function(){var a=$(this).data(c),b=a._input,d=b.val(),e=a.options.ajaxConfig;b.removeClass(a._classOnEdit),0===d.length?b.addClass(a._classEmpty):(b.addClass(a._classChanged),a.option("values",d),a._valuesIndex=a.option("values").length-1,"ajax"===a.options.storage&&(e.UPDATEData.value=b.val(),$.ajax({url:e.url+e.id,data:a._tmpl(e.UPDATETemplate,e.UPDATEData),type:"UPDATE"}))),a._setState()},_tmpl:function(a,b){var c="string"!=typeof a?function(){throw{name:"Invalid Parameter",message:"You must insert a string into the function"}}():new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+a.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return b?c(b):c},_setOption:function(a,b){var c=this.options;switch(a){case"values":return c.values.push(b),void("localStorage"===c.storage&&localStorage.setItem(this._id,JSON.stringify(c.values)));case"currentValue":this.option("values",b),this._input.val(b)}this._super("_setOption",a,b)},_create:function(){var a,b,c=this.options.storage;this._setClassNames(),this._setVars(),this._setListeners(),b=this._input,b.addClass(this._classEasyText),"localStorage"===c?localStorage[this._id]&&(a=JSON.parse(localStorage[this._id]),this.options.values=a,b.val(a[a.length-1]),this._valuesIndex=a.length-1):"ajax"===c&&this._initializeAjax(),this._setRuler(),this._setState()},_destroy:function(){this._input.attr("class","")},deleteStorage:function(){var a=this.options.ajaxConfig,b=this.options.storage;"localStorage"===b?localStorage.removeItem(this._id):"ajax"===b&&$.ajax({url:a.url+a.id,type:"DELETE"}),this.options.values=[],this._input.val(""),this._setState()},getNextBackValue:function(a){var b=this.option("values"),c=this._valuesIndex;if(void 0===a&&(a=!0),"boolean"!=typeof a)throw new Error("Invalid parameter");return c+=a?1:-1,void 0===b[c]?-1:(this._valuesIndex=c,this._input.val(b[c]),this._setState(),b[c])}})}();/*! cui 2016-11-08 */
$.component("coral.autocomplete",$.coral.inputbase,{version:"4.0.2",defaultElement:"<input>",castProperties:["source","pageData","buttons","title","rootNode","triggers","showRequiredMark","shortCut","hideRequiredMark","itemattr","onValidSuccess","onValidError"],options:{appendTo:"body",autoFocus:!1,allowRepeat:!1,asyncType:"post",delay:300,scrollTimeOut:100,maxLabelWidth:"auto",pageData:[],multiLineLabel:!1,minLength:0,minHeight:1,panelComponentCls:null,panelWidth:null,height:"auto",multiple:!1,position:{my:"left top",at:"left bottom",collision:"none"},value:"",text:"",forceSelection:!1,defaultValue:"",postMode:"value",required:!1,showStar:!0,separator:",",labelCls:"",buttons:[],rowNum:100,title:null,errMsg:null,errMsgPosition:"leftBottom",panelHeight:"auto",placeholder:"",maxPanelHeight:200,iframePanel:!1,isLabel:!1,source:null,valueField:"value",textField:"label",searchField:"valueField",onValidSuccess:null,onValidError:null,onChange:null,onBlur:null,onClose:null,onFocus:null,onOpen:null,oncancel:null,onResponse:null,onSearch:null,onSelect:null,triggers:null,excluded:!1},requestIndex:0,pending:0,_create:function(){this._prepareInit(),this._initAutocomplete(),this._initState(),this._initSource(),this._initData(),this._bindEvent(),this._setDefaultValue(),this._setDefaultText(),this.liveRegion=$("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("coral-helper-hidden-accessible").appendTo(this.document[0].body),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}}),this.options.multiLineLabel&&($(this.element).easytext({minWidth:10,maxWidth:200,maxChars:60}),this._on(this.document,{click:function(a){this.options.readonly||this.options.isLabel||this._moveInput("last",a)}}))},_prepareInit:function(){this.lastSelectedItem={},this.selectedItems=[],this.isNewMenu=!0},_initAutocomplete:function(){var a="tree"==this.options.render?"coral-autocompletetree":"coral-autocomplete";if(this.className="coral-autocomplete-text coral-combo-default coral-textbox-default tabbable "+this.element[0].className,this.classBorder="",this.hiddenClass="",this.options.iframePanel&&(this.iframePanel=$("<iframe class='coral-autocomplete-iframePanel' style='position:absolute;display:none;'></iframe>").appendTo("body")),this.options.multiLineLabel){var b=this.element[0].nodeName.toLowerCase(),c="textarea"===b,d="input"===b;this.ismultiLineLabel=c?!0:d?!1:this.element.prop("isContentEditable"),this.compClass=a+" coral-textboxlist coral-textbox",this.createInput(),this.valuebox=$(this.textboxWrapper.lastChild),this.textboxWrapper=$(this.textboxWrapper),this.elementBorder=$(this.elementBorder),this.element=$(this.textboxInput),this.elementBorder.css({minHeight:this.options.minHeight+"px",height:this.options.height,overflow:"auto"}),this.valueMethod=this.valuebox[c||d?"val":"text"],this.textMethod=this.element[c||d?"val":"text"],this.textboxlistUl=$("<ul class='coral-textboxlist-ul'><li class='coral-textboxlist-inputLi'></li></ul>"),this.textboxlistUl.appendTo(this.elementBorder),this.element.appendTo(this.textboxlistUl.find(".coral-textboxlist-inputLi")),this.options.buttons.length>0&&this._createButtonPanel(),"undefined"!=typeof this.element.attr("id")?this.options.id=this.element.attr("id"):this.options.id&&this.element.attr("id",this.options.id),"undefined"!=typeof this.element.attr("name")?(this.options.name=this.element.attr("name"),this.valuebox.attr("name",this.options.name),this.element.removeAttr("name")):this.options.name&&this.valuebox.attr("name",this.options.name),this.options.text&&this.setText(this.options.text),""!=$.trim(this.valuebox.val())&&(this.options.value=this.valuebox.val()),this.options.showPopup}else{var b=this.element[0].nodeName.toLowerCase(),c="textarea"===b,d="input"===b;this.ismultiLineLabel=c?!0:d?!1:this.element.prop("isContentEditable"),this.compClass=a+" coral-textbox",this.createInput(),this.valuebox=$(this.textboxWrapper.lastChild),this.elementBorder=$(this.elementBorder),this.textboxWrapper=$(this.textboxWrapper),this.element=$(this.textboxInput),this.textboxWrapper.css({"border-width":"0"}),this.elementBorder.css({minHeight:this.options.minHeight+"px"}),this.valueMethod=this.valuebox[c||d?"val":"text"],this.textMethod=this.element[c||d?"val":"text"],this.options.buttons.length>0&&this._createButtonPanel(),"undefined"!=typeof this.element.attr("id")?this.options.id=this.element.attr("id"):this.options.id&&this.element.attr("id",this.options.id),"undefined"!=typeof this.element.attr("name")?(this.options.name=this.element.attr("name"),this.valuebox.attr("name",this.options.name),this.element.removeAttr("name")):this.options.name&&this.valuebox.attr("name",this.options.name),this.element.attr("placeholder",this.options.placeholder),this.options.placeholder&&""===this.element.val()&&this._showPlaceholder(),this.options.text&&this.setText(this.options.text),""!=$.trim(this.valuebox.val())&&(this.options.value=this.valuebox.val())}this.options.showClose&&this.clearIcon.css("right",this.rightPos?this.rightPos:0)},_initState:function(){(this.element.prop("readonly")||this.options.readonly)&&(this.options.readonly=!0,this.valuebox.prop("readonly",!0),this.element.prop("readonly",!0),this.element.removeClass("tabbable"),this.component().addClass("coral-readonly")),this.options.isLabel&&(this.element.prop("readonly",!0),this.valuebox.prop("readonly",!0),this.element.removeClass("tabbable"),this.component().addClass("coral-isLabel"))},reset:function(){this.setValue(this.originalValue)},_showPlaceholder:function(){if(!$.support.placeholder||this.options.multiLineLabel){var a=this,b=$("<span class='coral-textbox-placeholder-label'>"+a.options.placeholder+"</span>");$(a.element).after(b)}},_hidePlaceholder:function(){if(!$.support.placeholder||this.options.multiLineLabel){var a=this;a.textboxWrapper.find(".coral-textbox-placeholder-label").remove()}},_bindEvent:function(){var a,b,c,d=this;this._on({"mouseenter.coral-textbox-border":function(a){d.options.disabled||d.options.isLabel||d.options.readonly||d.textboxWrapper.addClass("coral-textbox-hover")},"mouseleave.coral-textbox-border":function(a){d.options.disabled||d.options.isLabel||d.options.readonly||d.textboxWrapper.removeClass("coral-textbox-hover")},"click.coral-input-clearIcon":function(a){this.setValue("",!0),this.options.placeholder&&this._showPlaceholder()},keyup:function(a){this.options.readonly||this.options.isLabel||this._trigger("onKeyUp",a,{})},keydown:function(e){if(!(d.options.disabled||d.options.isLabel||d.options.readonly)){if(this.element.prop("readOnly"))return a=!0,c=!0,void(b=!0);a=!1,c=!1,b=!1;var f=$.coral.keyCode;switch(e.keyCode){case f.PAGE_UP:if("tree"==this.options.render)break;a=!0,this._move("previousPage",e);break;case f.PAGE_DOWN:if("tree"==this.options.render)break;a=!0,this._move("nextPage",e);break;case f.LEFT:a=!0,this._moveItem("left",e);break;case f.RIGHT:a=!0,this._moveItem("right",e);break;case f.UP:if("tree"==this.options.render)break;a=!0,this._keyEvent("previous",e);break;case f.DOWN:if("tree"==this.options.render)break;a=!0,this._keyEvent("next",e);break;case f.ENTER:this.menu.active&&(a=!0,e.preventDefault(),this.menu.select(e));break;case f.TAB:this.menu.active&&this.menu.select(e);break;case f.ESCAPE:this.menu.element.is(":visible")&&(this.ismultiLineLabel||this.setValue(this.term,!0),this.close(e),e.preventDefault());break;default:b=!0,this._searchTimeout(e)}var g=this.options;g.shortCut&&$.coral.callFunction(g.shortCut,e,this),this._trigger("onKeyDown",e,{})}},keypress:function(c){if(!(d.options.disabled||d.options.isLabel||d.options.readonly)){if(a)return a=!1,void(this.ismultiLineLabel&&!this.menu.element.is(":visible")||c.preventDefault());if(!b&&"tree"!=this.options.render){var e=$.coral.keyCode;switch(c.keyCode){case e.PAGE_UP:this._move("previousPage",c);break;case e.PAGE_DOWN:this._move("nextPage",c);break;case e.UP:this._keyEvent("previous",c);break;case e.DOWN:this._keyEvent("next",c)}}}},input:function(a){return d.options.disabled||d.options.isLabel||d.options.readonly?void 0:c?(c=!1,void a.preventDefault()):void this._searchTimeout(a)},focus:function(){d.options.disabled||d.options.isLabel||d.options.readonly||(this.selectedItem=null,this.previous=this.getValue(),this.component().addClass("coral-state-focus"),this._hidePlaceholder())},blur:function(a){if(this.component().removeClass("coral-state-focus"),!(d.options.disabled||d.options.isLabel||d.options.readonly)){if(this.cancelBlur)return void delete this.cancelBlur;if(clearTimeout(this.searching),this.close(a),!this.options.multiLineLabel)if(this.options.multiple);else if(this.options.forceSelection)if("tree"==this.options.render);else{var b=$.grep(this.responseItems,function(a){return a[d.options.textField]==d.element.val()});b.length?this.setValue(b[0][d.options.valueField],!0):this.setValue("",!0)}else this.lastSelectedItem[this.options.textField]!=this.element.val()&&this.setValue(this.element.val(),!0);""===this.getValue()&&this._showPlaceholder(),this._trigger("onBlur",a,{item:this.selectedItem})}}}),this._on(this.menu.element,{scroll:function(a){var b=this;viewH=this.menu.element.height(),contentH=this.menu.element[0].scrollHeight,scrollTop=this.menu.element.scrollTop(),contentH-viewH-scrollTop<=15&&this.renderNumber<this.options.pageData.length&&(b.scrollTimer&&clearTimeout(b.scrollTimer),b.scrollTimer=setTimeout(function(){b._renderMenu(b.menu.element,b.options.pageData[b.renderNumber]),b.menu.refresh(),b.renderNumber++},b.options.scrollTimeout))},mousedown:function(a){if(!this.options.readonly&&!this.options.isLabel){a.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var b=this.menu.element[0];$(a.target).closest(".coral-menu-item").length||this._delay(function(){var a=this;this.document.one("mousedown",function(c){c.target===a.element[0]||c.target===b||$.contains(b,c.target)||a.close()})})}},menuonfocus:function(a,b){if(!this.options.readonly&&!this.options.isLabel){var c,d;if(this.isNewMenu&&(this.isNewMenu=!1,a.originalEvent&&/^mouse/.test(a.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",function(){$(a.target).trigger(a.originalEvent)});d=this.options.tempData[b.item.data("key")],!1!==this._trigger("onFocus",a,{item:d})&&a.originalEvent&&/^key/.test(a.originalEvent.type),c=b.item.attr("aria-label")||d[this.options.valueField],c&&$.trim(c).length&&(this.liveRegion.children().hide(),$("<div>").text(c).appendTo(this.liveRegion))}},menuonselect:function(a,b){if(!this.options.readonly&&!this.options.isLabel){var c=this.options.tempData[b.item.data("key")],e=this.previous;if(this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=e,this._delay(function(){this.previous=e,this.selectedItem=c,d.lastSelectedItem=c})),d.lastSelectedItem=c,this.selectedItem=c,!1!==this._trigger("onSelect",a,{item:c})){var c=this.options.tempData[b.item.data("key")];valueField=c[this.options.valueField],textField=c[this.options.textField];var f=d.getValue(),g=d.getText(),h=""==f?[]:f.split(this.options.separator),i=""==g?[]:g.split(this.options.separator);if(d.options.multiple){if("value"==this.options.postMode){if(!this.options.allowRepeat&&$.inArray(valueField,h)>-1)return;h.push(valueField),i.push(textField),this.setText(i.join(this.options.separator)),this.setValue(h.join(this.options.separator),!0)}if("text"==this.options.postMode){if(!this.options.allowRepeat&&$.inArray(textField,i)>-1)return;i.push(textField),d.setValue(i.join(this.options.separator),!0)}if("value-text"==this.options.postMode){if(!this.options.allowRepeat&&$.inArray(valueField+"-"+textField,h+"-"+i)>-1)return;h.push(valueField),i.push(textField),this.setValue(h.join(this.options.separator)+"-"+i.join(this.options.separator),!0)}}else"value"==this.options.postMode&&(this.setText(c[this.options.textField],!0),this.setValue(c[this.options.valueField],!0)),"text"==this.options.postMode&&this.setValue(c[this.options.textField],!0),"value-text"==this.options.postMode&&this.setValue(c[this.options.valueField]+"-"+c[this.options.textField],!0)}this.term=this.getText(),this.close(a)}}}),this.options.multiLineLabel&&this._on({"click .coral-label-close":function(a){this.options.readonly||this.options.isLabel||(this._removeLabel(a),a.stopPropagation(),this._trigger("onLabelClose",a,[]))},"click .coral-textboxlist-item":function(a){a.stopPropagation(),this._trigger("onLabelClick",a,[])},"click .coral-textbox-border":function(a){this.options.readonly||this.options.isLabel||this.element.focus()},"mouseenter .coral-label-close":function(a){$(a.target).addClass("coral-label-close-hover")},"mouseleave .coral-label-close":function(a){$(a.target).removeClass("coral-label-close-hover")},"focus .coral-textboxlist-item":function(a){this.options.readonly||this.options.isLabel||$(a.target).addClass("coral-state-active")},"blur .coral-textboxlist-item":function(a){$(a.target).removeClass("coral-state-active")},"keydown .coral-state-active":function(a){if(!this.options.readonly&&!this.options.isLabel){var b=$.coral.keyCode;switch(a.keyCode){case b.LEFT:this._moveInput("left",a);break;case b.RIGHT:this._moveInput("right",a);break;case b.BACKSPACE:this._removeLabel(a);break;case b.DELETE:this._removeLabel(a)}}}})},_initData:function(){var a=this.options;this.menu=$("<ul>").addClass("coral-autocomplete-panel coral-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),isNaN(a.panelHeight)&&($(".coral-autocomplete-panel").css({"max-height":a.maxPanelHeight+"px"}),$(".coral-autocomplete-iframePanel").css({"max-height":a.maxPanelHeight+"px"}))},_setDefaultValue:function(){return this.options.value?(this.setValue(this.options.value),void(this.originalValue=this.getValue())):void(this.originalValue="")},_setDefaultText:function(){this.options.text&&this.setText(this.options.text)},getLastSelectedItem:function(){return this.lastSelectedItem},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("coral-autocomplete-input").removeAttr("autocomplete").removeAttr("title"),this.menu.element.remove(),this.options.iframePanel&&this.iframePanel.remove(),this.liveRegion.remove()},_setOption:function(a,b){var c=this.options.maxLabelWidth;"auto"!=c&&(c+="px"),this._super(a,b),"isLabel"===a&&"boolean"==typeof b&&(this.element.prop("readonly",b),this.valuebox.prop("readonly",b),this.component().removeClass("coral-readonly"),this.component().toggleClass("coral-isLabel",b),this.element.toggleClass("tabbable",!b),this.textboxlistUl&&(b?this.textboxlistUl.find(".coral-textboxlist-item").css("max-width",""):this.textboxlistUl.find(".coral-textboxlist-item").css("max-width",c))),"readonly"===a&&"boolean"==typeof b&&(this.element.prop("readonly",b),this.valuebox.prop("readonly",b),this.component().removeClass("coral-isLabel"),this.component().toggleClass("coral-readonly",b),this.element.toggleClass("tabbable",!b),this.textboxlistUl&&(b?this.textboxlistUl.find(".coral-textboxlist-item").css("max-width",""):this.textboxlistUl.find(".coral-textboxlist-item").css("max-width",c))),"source"===a&&this._initSource(),"appendTo"===a&&this.menu.element.appendTo(this._appendTo()),"disabled"===a&&b&&this.xhr&&this.xhr.abort(),"value"===a&&this.setValue(b),"placeholder"===a&&(this.element.attr("placeholder",this.options.placeholder),""===this.getValue()&&this._showPlaceholder()),"panelComponentCls"===a&&this.menu.element.addClass(this.options.panelComponentCls)},_appendTo:function(){var a=this.options.appendTo;return a&&(a=a.jquery||a.nodeType?$(a):this.document.find(a).eq(0)),a&&a[0]||(a=this.element.closest(".coral-front")),a.length||(a=this.document[0].body),a},_filter:function(a,b,c){c($.coral.autocomplete.filter(a,b.term,this.options.valueField,this.options.textField,this.options.searchField))},transTempData:function(a){function b(a,c){for(var d=0;d<a.length;d++)a[d].children&&b(a[d].children,c),c.tempData[a[d].id]=a[d]}if(a&&"tree"===this.options.render&&(this.options.tempData={},this.options.textField=this.options.textField||"name",this.options.valueField=this.options.valueField||"id",b(a,this.options)),a&&"tree"!==this.options.render){this.options.tempData={},this.options.textField=this.options.textField||"text",this.options.valueField=this.options.valueField||"value";for(var c=0;c<a.length;c++)this.options.tempData[a[c][this.options.valueField]]=a[c]}},_initSource:function(){var a,b,c=this;$.isArray(this.options.source)?(a=this.options.source,this.transTempData(a),this.source=function(b,d){c._filter(a,b,d)}):"string"==typeof this.options.source?(b=this.options.source,this.source=function(a,d){c.xhr&&c.xhr.abort(),this.element.attr("name")&&(a[this.element.attr("name")]=a.term),c.xhr=$.ajax({url:b,data:a,type:c.options.asyncType,dataType:"json",success:function(a){"tree"!=c.options.render?d(a):($(c.menu.element).tree("reload",a),d(a)),c.transTempData(a)},error:function(){d([])}})}):this.source=this.options.source},_searchTimeout:function(a){clearTimeout(this.searching),this.searching=this._delay(function(){var b=this.term===this._term(),c=this.menu.element.is(":visible"),d=a.altKey||a.ctrlKey||a.metaKey||a.shiftKey;b&&(!b||c||d)||(this.selectedItem=null,this.search(null,a))},this.options.delay)},_term:function(){return this.options.multiLineLabel?this.element.val():this.getText()},_updateTitle:function(a){var b,c=this,d=this.options;b=d.multiLineLabel?c.element.closest("ul"):c.element,1==d.title?b.attr("title",a):0==d.title?b.attr("title",""):b.attr("title",d.title)},search:function(a,b){return a=null!=a?a:this._term(),this.term=this._term(),a.length<this.options.minLength||this.options.minLength>0&&""==$.trim(a)?this.close(b):this._trigger("onSearch",b)!==!1?this._search(a):void 0},_search:function(a){this.pending++,this.element.addClass("coral-autocomplete-loading"),this.cancelSearch=!1,this.source({term:a},this._response())},_response:function(){var a=++this.requestIndex;return $.proxy(function(b){a===this.requestIndex&&this.__response(b),this.pending--,this.pending||this.element.removeClass("coral-autocomplete-loading")},this)},__response:function(a){var b=this;if(this.renderNumber=1,this.options.pageData=[],a&&(a=this._normalize(a)),this._trigger("onResponse",null,{content:a}),!this.options.disabled&&a&&a.length&&!this.cancelSearch){var c=a.length,d=b.options.rowNum,e=Math.ceil(c/d);if(e>1){for(var f=0;e>f;f++)b.options.pageData[f]=a.slice(f*d,(f+1)*d-1);a=b.options.pageData[0]}this._suggest(a),this._trigger("onOpen")}else this._close()},close:function(a){this.cancelSearch=!0,this._close(a)},_close:function(a){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.options.iframePanel&&this.iframePanel.hide(),"tree"!=this.options.render&&this.menu.blur(),this.isNewMenu=!0,this._trigger("onClose",a))},_change:function(a){this.previous!==this.getValue()&&this._trigger("onChange",a,{item:this.selectedItem,oldValue:this.previous,value:this.getValue(),text:this.getText(),lastSelectedItem:this.lastSelectedItem})},_normalize:function(a){return a.length&&a[0][this.options.textField]&&a[0][this.options.valueField]?a:$.map(a,function(a){return"string"==typeof a?{label:a,value:a}:$.extend({},a,{label:a.label||a.value,value:a.value||a.label})})},_suggest:function(a){var b=this.menu.element,c=this.iframePanel||$();"tree"==this.options.render||(this.menu.element.empty(),this._renderMenu(b,a),this.isNewMenu=!0,this.menu.refresh()),this.responseItems=a;var d=b.height();c.css("height",d),b.show(),b.scrollTop(0),c.show();var e=b.siblings(".coral-front:visible").map(function(){return+$(this).css("z-index")}).get(),f=Math.max.apply(null,e);f>=+b.css("z-index")&&(b.css("z-index",f+1),c.css("z-index",f)),this._resizeMenu(),b.position($.extend({of:this.elementBorder},this.options.position)),c.position($.extend({of:this.elementBorder},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var a=this.menu.element,b=this.iframePanel||$();a.outerWidth(Math.max(this.options.panelWidth?this.options.panelWidth:a.width("").outerWidth()+1,this.elementBorder.outerWidth())),b.outerWidth(a.outerWidth())},_renderMenu:function(a,b){var c=this,d=[];$.each(b,function(b,e){d.push(c._renderItemData(a,e))}),a.append(d.join(""))},_renderItemData:function(a,b){return this._renderItem(a,b)},_renderItem:function(a,b){var c,d=b[this.options.textField],e="",f="",g=1==!!b.hidden?"hidden":"",h=$.coral.toFunction(this.options.formatter);$.isFunction(h)&&(d=h.apply(this.element[0],[{item:b}]));var i=$.coral.toFunction(this.options.itemattr);if(e+=' data-key="'+b[this.options.valueField]+'"',$.isFunction(i)){var j=i.apply(this.element[0],[{item:b}]);if(!$.isEmptyObject(j)){j.hasOwnProperty("style")&&(f+=j.style,delete j.style),j.hasOwnProperty("class")&&(g+=" "+j["class"],delete j["class"]);try{delete j.role}catch(k){}for(c in j)j.hasOwnProperty(c)&&(e+=" "+c+"="+j[c])}return"<li class='"+g+"' "+e+" style='"+f+"'>"+d+"</li>"}return"<li class='"+g+"' "+e+">"+d+"</li>"},_move:function(a,b){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(a)||this.menu.isLastItem()&&/^next/.test(a)?(this.options.multiLineLabel||(this.setValue("",!0),this.setText(this.term)),void this.menu.blur()):void this.menu[a](b):void this.search(null,b)},component:function(){return this.textboxWrapper},_setLastSelectedItem:function(){var a=this.options,b=this.getValue(),c=this.getText();this.lastSelectedItem={},this.lastSelectedItem[a.valueField]=b,this.lastSelectedItem[a.textField]=c},_text:function(a){var b=this.options.maxLabelWidth,c=this.options.readonly,d=this.options.isLabel,e=this.options.labelCls;if(!this.options.multiLineLabel)return this.textMethod.apply(this.element,arguments);if(""!=a&&!a){var f=[];return $.each(this.textboxlistUl.find(".coral-textboxlist-item"),function(){f.push($(this).text())}),f.join(",")}var g="";""==a||a instanceof Array||(a=a.split(this.options.separator)),a instanceof Array?("auto"==b||d||c?$.each(a,function(b){a.splice(b,1,"<li tabindex='-1' class='coral-textboxlist-item "+e+"'  title='"+this+"'>"+this+"<span class='coral-label-close cui-icon-cross2'></span></li>")}):$.each(a,function(c){a.splice(c,1,"<li tabindex='-1' class='coral-textboxlist-item "+e+"'  style='  max-width:"+b+"px;' title='"+this+"'>"+this+"<span class='coral-label-close cui-icon-cross2'></span></li>")}),g=a.join("")):g="auto"==b||d||c?"<li tabindex='-1' class='coral-textboxlist-item "+e+"'   title='"+this+"' >"+a+"<span class='coral-label-close  cui-icon-cross2'></span></li>":"<li tabindex='-1' class='coral-textboxlist-item "+e+"'  style='  max-width:"+b+"px;' title='"+this+"' >"+a+"<span class='coral-label-close cui-icon-cross2'></span></li>",""!=a?this.options.multiple?(this.textboxlistUl.find(".coral-textboxlist-item").remove(".coral-textboxlist-item"),this.textboxlistUl.find(".coral-textboxlist-inputLi").before(g)):(this.textboxlistUl.find(".coral-textboxlist-item").remove(".coral-textboxlist-item"),this.textboxlistUl.find(".coral-textboxlist-inputLi").before(g)):this.textboxlistUl.find(".coral-textboxlist-item").remove(".coral-textboxlist-item")},getOldValue:function(){var a=(this.options,[]),b=[],c=0;if(!this.currentValues)return a;for(var b=this.currentValues.split(",");c<b.length;c++){var d=b[c];a.push(d)}return a},setValue:function(a,b){a=a||"";var c,b,d;if("string"!=typeof a?(c=a.value,b=a.changed,d=a.removed):c=a,this.options.multiLineLabel&&(this.element.val(""),this.element.css({width:"10px"})),this.previous=this.getValue(),this.options.multiLineLabel){var e=this.element.closest("li.coral-textboxlist-inputLi"),f=(e.index(),""==this.valuebox.val(c)?[]:this.valuebox.val(c));if(""==$.trim(c))this.setText(c);else if("text"===this.options.postMode)this.setText(c);else if(""!==$.trim(c)&&$.isArray(this.options.source)){for(var g=[],h=this.options.textField,i=c.split(","),j=0;j<i.length;j++){var k=this.options.tempData[i[j]];k?g.push(this.options.tempData[i[j]][h]):g.push(i[j])}g.length&&this.setText(g)}""==c&&(f=[]),this.valuebox.val(c),this.currentValues=c}else{if(""==$.trim(c))this.setText(c);else if("text"===this.options.postMode)this.setText(c);else if(""!==$.trim(c)&&$.isArray(this.options.source)){for(var g=[],h=this.options.textField,i=c.split(","),j=0;j<i.length;j++){var k=this.options.tempData[i[j]];k?g.push(this.options.tempData[i[j]][h]):g.push(i[j])}g.length&&this.setText(g)}this.valuebox.val(c)}""!==c&&this._hidePlaceholder(),b&&this._change(null)},setText:function(a){this._updateTitle(a),this._text(a),this._setLastSelectedItem()},getValue:function(){return this.options.multiLineLabel?this.valuebox.val():this.valueMethod.apply(this.valuebox)},getText:function(){return this._text()},focus:function(){return this.options.disabled||this.options.readonly||this.options.isLabel?!1:void this.element.focus()},_keyEvent:function(a,b){this.ismultiLineLabel&&!this.menu.element.is(":visible")||(this._move(a,b),b.preventDefault())},_removeLabel:function(a){var b=this.element.closest("li.coral-textboxlist-inputLi"),c=$(a.target).closest("li.coral-textboxlist-item"),d=$(a.target).closest("li.coral-textboxlist-item:last");b.insertAfter(d);var e=b.index(),f=c.index(),g=f;f>e&&(g=f-1);var h=this.getText().split(",");h.splice(g,1),c.remove();var i=this.getValue().split(",");i.splice(g,1),this.selectedItems.splice(g,1),this.selectedItem=null,this.setValue(i.join(","),!0),"string"==typeof this.options.source&&this.setText(h.join(",")),this._moveInput("last",a),this.element.val(""),this.element.focus()},_moveInput:function(a,b){var c=this.element.closest("li.coral-textboxlist-inputLi"),d=$(b.target).closest("li.coral-textboxlist-item"),e=$(c).closest("li.coral-textboxlist-inputLi").nextAll("li.coral-textboxlist-item").last();switch(a){case"left":c.insertBefore(d),this.element.val(""),this.element.focus();break;case"right":c.insertAfter(d),this.element.val(""),this.element.focus();break;case"last":c.insertAfter(e),this.element.val("")}},_moveItem:function(a,b){var c=this.element.closest("li.coral-textboxlist-inputLi");"left"==a&&c.prev().length&&0==$(c.find("input")).caret()&&(this.element.val(""),c.prev().focus()),"right"==a&&c.next().length&&$(c.find("input")).caret()==c.find("input").val().length&&(this.element.val(""),c.next().focus())}}),$.extend($.coral.autocomplete,{escapeRegex:function(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(a,b,c,d,e){var f=new RegExp($.coral.autocomplete.escapeRegex(b),"i");return e?$.grep(a,function(a){for(var b=f.test(a[d]||a[c]||a),g=e.split(","),h=0;h<g.length&&(b||!a[g[h]]||!(b=f.test(a[g[h]])));h++);return b}):$.grep(a,function(a){return f.test(a[d]||a[c]||a[e]||a)})}}),$.component("coral.autocomplete",$.coral.autocomplete,{options:{messages:{noResults:"No search results.",results:function(a){return a+(a>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(a){var b;this._superApply(arguments),this.options.disabled||this.cancelSearch||(b=a&&a.length?this.options.messages.results(a.length):this.options.messages.noResults,this.liveRegion.children().hide(),$("<div>").text(b).appendTo(this.liveRegion))}});/*! cui 2016-11-08 */
$.component("coral.autocompletetree",$.coral.autocomplete,{requestIndex:0,pending:0,options:{allowPushParent:!1,rootNode:!1,multiLineLabel:!1,radioType:"level",showRootNode:!0,showClose:!1,cascadeCheck:!1,multiple:!1,triggers:null,excluded:!1},_create:function(){this.options.render="tree",this._super()},_filter:function(a,b,c){$(this.menu.element).tree("reload",a),$(this.menu.element).tree("filterNodesByParam",{name:b.term}),c(a)},_initData:function(){var a=this;this.menu={};var b=$("<ul>")[0];$(b).uniqueId().addClass("coral-autocomplete-panel coral-front").appendTo(this._appendTo()).tree({showLine:!1,showIcon:!0,radioType:this.options.radioType,checkable:null!=this.options.chkStyle,chkStyle:this.options.chkStyle,showRootNode:this.options.showRootNode,rootNode:this.options.rootNode,componentCls:"coral-autocomplete-tree",beforeClick:function(b,c){if(!a.options.allowPushParent&&c.isParent)return!1;var d=$.coral.toFunction(a.options.beforeClick);return a.options.checkable?!1:$.isFunction(d)?d(b,c):!0},onClick:function(b,c,d){var e=d,f=a.previous;if(a.element[0]!==a.document[0].activeElement&&(a.element.focus(),a.previous=f,a._delay(function(){a.previous=f,a.selectedItem=e})),!1!==a._trigger("beforeNodeClick",b,{item:e,value:a.getValue()})){a.selectedItem=e,a.selectedItems.push(e);var g=a.getValue(),h=a.getText(),i=""==g?[]:g.split(a.options.separator),j=""==h?[]:h.split(a.options.separator);if(a.options.multiple){if(!a.options.allowRepeat&&$.inArray(d.id,i)>-1)return;i.push(d.id),j.push(d.name)}else i=[d.id],j=[d.name];a.setText(j.join(a.options.separator)),a.setValue(i.join(a.options.separator),!0)}a._trigger("onNodeClick",b,{item:e,value:a.getValue()}),a.term=a._text(),a.close(b)},onCheck:function(b,c,d){for(var e=[],f=[],g=$("#"+c).tree("getCheckedNodes",!0),h=a.getValue(),i=a.getText(),f=""==h?[]:h.split(a.options.separator),e=""==i?[]:i.split(a.options.separator),j=0,k=g.length;k>j;j++)if(a.options.cascadeCheck||!g[j].getCheckStatus().half){if(!a.options.allowPushParent&&g[j].isParent)continue;(a.options.allowRepeat||-1==$.inArray(g[j].id,f))&&(e.push(g[j].name),f.push(g[j].id))}a.setValue(f.join(a.options.separator),!0),a._trigger("onNodeCheck",b,{treeId:c,node:d})}}).hide(),this.menu.element=$(b),isNaN(this.options.panelHeight)&&$(".coral-autocomplete-panel").css({"max-height":this.options.maxPanelHeight+"px"})}});/*! cui 2016-11-08 */
window.PINYIN_DATA={a:"啊阿吖嗄腌锕",ai:"爱埃挨哎唉哀皑癌蔼矮艾碍隘捱嗳嗌嫒瑷暧砹锿霭",an:"安案按鞍氨俺暗岸胺谙埯揞犴庵桉铵鹌黯",ang:"肮昂盎",ao:"凹敖熬翱袄傲奥懊澳坳拗嗷岙廒遨媪骜獒聱螯鏊鳌鏖",ba:"芭捌扒叭吧笆八疤巴拔跋靶把耙坝霸罢爸茇菝岜灞钯粑鲅魃",bai:"白柏百摆佰败拜稗捭掰",ban:"版般办斑班搬扳颁板扮拌伴瓣半绊阪坂钣瘢癍舨",bang:"帮邦梆榜膀绑棒磅蚌镑傍谤蒡浜",bao:"保报包苞胞褒剥薄雹堡饱宝抱暴豹鲍爆炮曝瀑勹葆孢煲鸨褓趵龅",bei:"北备杯碑悲卑辈背贝钡倍狈惫焙被孛陂邶蓓呗悖碚鹎褙鐾鞴",ben:"本奔苯笨夯畚坌锛",beng:"蚌崩绷甭泵蹦迸嘣甏",bi:"比必币毕逼鼻鄙笔彼碧蓖蔽毙毖庇痹闭敝弊辟壁臂避陛匕俾芘荜荸萆薜吡哔狴庳愎滗濞弼妣婢嬖璧贲睥畀铋秕裨筚箅篦舭襞跸髀",bian:"变编边便鞭贬扁卞辨辩辫遍匾弁苄忭汴缏煸砭碥窆褊蝙笾鳊",biao:"表标彪膘婊骠飑飙飚镖镳瘭裱鳔",bie:"别鳖憋瘪蹩",bin:"彬斌濒滨宾摈傧豳缤玢槟殡膑镔髌鬓",bing:"并兵冰柄丙秉饼炳病屏禀邴摒槟",bo:"播博柏剥薄玻菠拨钵波勃搏铂箔伯帛舶脖膊渤泊驳卜亳啵饽檗擘礴钹鹁簸跛踣",bu:"不布部步捕卜哺补埠簿怖埔卟逋瓿晡钚钸醭",ca:"擦嚓礤",cai:"才采材彩猜裁财睬踩菜蔡",can:"参餐蚕残惭惨灿孱骖璨粲黪",cang:"藏苍舱仓沧伧",cao:"操糙槽曹草嘈漕螬艚",ce:"册策测厕侧恻",ceng:"曾层蹭噌",cha:"查插叉茬茶碴搽察岔差诧刹喳嚓猹馇汊姹杈楂槎檫锸镲衩",chai:"差拆柴豺侪钗瘥虿",chan:"产搀掺蝉馋谗缠铲阐颤冁谄蒇廛忏潺澶孱羼婵骣觇禅蟾躔",chang:"场常长昌猖尝偿肠厂敞畅唱倡裳伥鬯苌菖徜怅惝阊娼嫦昶氅鲳",chao:"超抄钞朝嘲潮巢吵炒绰剿怊晁焯耖",che:"车扯撤掣彻澈坼砗",chen:"称郴臣辰尘晨忱沉陈趁衬沈谌谶抻嗔宸琛榇碜龀",cheng:"成程称城撑橙呈乘惩澄诚承逞骋秤丞埕枨柽塍瞠铖铛裎蛏酲",chi:"持吃痴匙池迟弛驰耻齿侈尺赤翅斥炽傺墀茌叱哧啻嗤彳饬媸敕眵鸱瘛褫蚩螭笞篪豉踟魑",chong:"重充冲虫崇宠茺忡憧铳舂艟",chou:"抽酬畴踌稠愁筹仇绸瞅丑臭俦帱惆瘳雠",chu:"出除处础初橱厨躇锄雏滁楚储矗搐触畜亍刍怵憷绌杵楮樗褚蜍蹰黜",chuai:"揣搋啜嘬膪踹",chuan:"传川穿椽船喘串舛遄氚钏舡",chuang:"创疮窗幢床闯怆",chui:"吹炊捶锤垂椎陲棰槌",chun:"春椿醇唇淳纯蠢莼鹑蝽",chuo:"戳绰啜辍踔龊",ci:"次此词差疵茨磁雌辞慈瓷刺赐茈祠鹚糍",cong:"从聪葱囱匆丛苁淙骢琮璁枞",cou:"凑楱辏腠",cu:"促粗醋簇卒蔟徂猝殂酢蹙蹴",cuan:"蹿篡窜攒汆撺爨镩",cui:"摧崔催脆瘁粹淬翠衰萃啐悴璀榱毳",cun:"存村寸忖皴",cuo:"错措磋撮搓挫厝嵯脞锉矬痤瘥鹾蹉",da:"大达打答搭瘩耷哒嗒囗怛妲沓褡笪靼鞑",dai:"代带呆歹傣戴殆贷袋待逮怠埭甙呔岱迨绐玳黛",dan:"单但耽担丹郸掸胆旦氮惮淡诞弹蛋石儋凼萏菪啖澹宕殚赕眈疸瘅聃箪",dang:"当挡党荡档谠砀铛裆",dao:"到道导刀捣蹈倒岛祷稻悼盗叨氘焘纛",de:"的地得德锝",deng:"等登蹬灯瞪凳邓噔嶝戥磴镫簦",di:"的地第底弟堤低滴迪敌笛狄涤翟嫡抵蒂帝递缔氐籴诋谛邸坻荻嘀娣柢棣觌祗砥碲睇镝羝骶",dian:"电点典店颠掂滇碘靛垫佃甸惦奠淀殿丶阽坫巅玷钿癜癫簟踮",diao:"调碉叼雕凋刁掉吊钓铞貂鲷",die:"跌爹碟蝶迭谍叠垤堞揲喋牒瓞耋鲽",ding:"定丁盯叮钉顶鼎锭订仃啶玎腚碇町疔耵酊",diu:"丢铥",dong:"动东冬董懂栋侗恫冻洞垌咚岽峒氡胨胴硐鸫",dou:"都兜抖斗陡豆逗痘蔸钭窦蚪篼",du:"都度读督毒犊独堵睹赌杜镀肚渡妒芏嘟渎椟牍蠹笃髑黩",duan:"断段短端锻缎椴煅簖",dui:"对堆兑队敦怼憝碓镦",dun:"墩吨蹲敦顿囤钝盾遁沌炖砘礅盹趸",duo:"多度掇哆夺垛躲朵跺舵剁惰堕咄哚沲缍铎裰踱",e:"阿蛾峨鹅俄额讹娥恶厄扼遏鄂饿哦噩谔垩苊莪萼呃愕屙婀轭腭锇锷鹗颚鳄",en:"恩蒽摁嗯",er:"而二儿耳尔饵洱贰迩珥铒鸸鲕",fa:"发法罚筏伐乏阀珐垡砝",fan:"范藩帆番翻樊矾钒繁凡烦反返贩犯饭泛蕃蘩幡夂梵攵燔畈蹯",fang:"方放访房坊芳肪防妨仿纺邡枋钫舫鲂",fei:"费非菲啡飞肥匪诽吠肺废沸芾狒悱淝妃绯榧腓斐扉砩镄痱蜚篚翡霏鲱",fen:"分份芬酚吩氛纷坟焚汾粉奋忿愤粪偾瀵棼鲼鼢",feng:"风丰封枫蜂峰锋疯烽逢冯缝讽奉凤俸酆葑唪沣砜",fo:"佛",fou:"否缶",fu:"服复府父负福富夫敷肤孵扶拂辐幅氟符伏俘浮涪袱弗甫抚辅俯釜斧脯腑腐赴副覆赋傅付阜腹讣附妇缚咐莆匐凫郛芙芾苻茯莩菔拊呋呒幞怫滏艴孚驸绂绋桴赙祓黻黼罘稃馥蚨蜉蝠蝮麸趺跗鲋鳆",ga:"噶嘎夹轧垓尬尕尜旮钆",gai:"改该概钙盖溉芥丐陔戤赅",gan:"感敢干甘杆柑竿肝赶秆赣坩苷尴擀泔淦澉绀橄旰矸疳酐",gang:"港冈刚钢缸肛纲岗杠戆罡筻",gao:"告高篙皋膏羔糕搞镐稿睾诰郜藁缟槔槁杲锆",ge:"个格合歌各革哥搁戈鸽胳疙割葛蛤阁隔铬咯鬲仡哿圪塥嗝纥搿膈硌镉袼颌虼舸骼",gei:"给",gen:"根跟亘茛哏艮",geng:"更耕庚羹埂耿梗哽赓绠鲠",gong:"公工供功共贡攻恭龚躬宫弓巩汞拱珙肱蚣觥",gou:"构够购钩勾沟苟狗垢佝诟岣遘媾缑枸觏彀笱篝鞲",gu:"告故辜菇咕箍估沽孤姑鼓古蛊骨谷股顾固雇贾嘏诂菰崮汩梏轱牯牿臌毂瞽罟钴锢鸪鹄痼蛄酤觚鲴鹘",gua:"刮瓜剐寡挂褂卦诖呱栝胍鸹",guai:"乖拐怪掴",guan:"关管观棺官冠馆罐惯灌贯纶倌莞掼涫盥鹳矜鳏",guang:"广光逛咣犷桄胱",gui:"规瑰圭硅归龟闺轨鬼诡癸桂柜跪贵刽匦刿庋宄妫桧炅晷皈簋鲑鳜",gun:"辊滚棍衮绲磙鲧",guo:"国过果锅郭裹馘埚掴呙帼崞猓椁虢聒蜾蝈",ha:"哈蛤铪",hai:"还海孩骸氦亥害骇嗨胲醢",han:"韩酣憨邯含涵寒函喊罕翰撼捍旱憾悍焊汗汉邗菡撖犴阚瀚晗焓顸颔蚶鼾",hang:"行杭夯航吭沆绗颃",hao:"好号壕嚎豪毫郝耗浩貉蒿薅嗥嚆濠灏昊皓颢蚝",he:"何合呵喝荷菏核禾和盒貉阂河涸赫褐鹤贺诃劾壑嗬阖曷盍颌蚵翮",hei:"嘿黑",hen:"很痕狠恨",heng:"哼亨横衡恒蘅珩桁",hong:"轰哄烘虹鸿洪宏弘红黉訇讧荭蕻薨闳泓",hou:"后候喉侯猴吼厚堠後逅瘊篌糇鲎骺",hu:"户护乎互和呼忽瑚壶葫胡蝴狐糊湖弧虎唬沪冱唿囫岵猢怙惚浒滹琥槲轷觳烀煳戽扈祜瓠鹄鹕鹱笏醐斛鹘",hua:"话华化划花哗猾滑画骅桦砉铧",huai:"槐徊怀淮坏踝",huan:"还欢环桓缓换患唤痪豢焕涣宦幻郇奂萑擐圜獾洹浣漶寰逭缳锾鲩鬟",huang:"荒慌黄磺蝗簧皇凰惶煌晃幌恍谎隍徨湟潢遑璜肓癀蟥篁鳇",hui:"会回恢挥灰辉徽蛔毁悔慧卉惠晦贿秽烩汇讳诲绘诙茴荟蕙咴喙隳洄彗缋珲桧晖恚虺蟪麾",hun:"荤昏婚魂浑混诨馄阍溷珲",huo:"活或获和豁伙火惑霍货祸劐藿攉嚯夥钬锪镬耠蠖",ji:"系己机技计级积际及基击记济辑即几继集极给绩激圾畸稽箕肌饥迹讥鸡姬缉吉棘籍急疾汲嫉挤脊蓟冀季伎祭剂悸寄寂既忌妓纪藉骑亟乩剞佶偈墼芨芰荠蒺蕺掎叽咭哜唧岌嵴洎屐骥畿玑楫殛戟戢赍觊犄齑矶羁嵇稷瘠虮笈笄暨跻跽霁鲚鲫髻麂",jia:"家加价佳嘉枷夹荚颊贾甲钾假稼架驾嫁茄伽郏葭岬浃迦珈戛胛恝铗镓痂瘕蛱笳袈跏",jian:"间件建简荐见健检坚监减键歼尖笺煎兼肩艰奸缄茧柬碱硷拣捡俭剪槛鉴践贱箭舰剑饯渐溅涧僭谏谫菅蒹搛囝湔蹇謇缣枧楗戋戬牮犍毽腱睑锏鹣裥笕翦踺鲣鞯",jiang:"江强僵姜将浆疆蒋桨奖讲匠酱降茳洚绛缰犟礓耩糨豇靓",jiao:"教交校较蕉椒礁焦胶郊浇骄娇嚼搅铰矫侥脚狡角饺缴绞剿酵轿叫窖佼僬艽茭挢噍峤徼湫姣敫皎鹪蛟醮跤鲛",jie:"接结解介界阶姐揭皆秸街截劫节桔杰捷睫竭洁戒藉芥借疥诫届讦诘拮喈嗟婕孑桀碣疖颉蚧羯鲒骱",jin:"进今金近仅津尽巾筋斤襟紧锦谨靳晋禁烬浸劲卺荩堇噤馑廑妗缙瑾槿赆觐衿矜",jing:"经京精境睛竞竟荆兢茎晶鲸惊粳井警景颈静敬镜径痉靖净刭儆阱菁獍憬泾迳弪婧肼胫腈旌箐",jiong:"炯窘迥扃",jiu:"就究酒揪纠玖韭久灸九厩救旧臼舅咎疚僦啾阄柩桕鸠鹫赳鬏",ju:"具且据车举巨鞠拘狙疽居驹菊局咀矩沮聚拒距踞锯俱句惧炬剧倨讵苣苴莒掬遽屦琚枸椐榘榉橘犋飓钜锔窭裾趄醵踽龃雎鞫",juan:"捐鹃娟倦眷卷绢鄄狷涓桊蠲锩镌隽",jue:"觉决绝嚼撅攫抉掘倔爵诀厥劂谲矍蕨噘噱崛獗孓珏桷橛爝镢蹶觖",jun:"均菌钧军君峻俊竣浚郡骏捃皲筠麇",ka:"喀咖卡咯佧咔胩",kai:"开揩楷凯慨剀垲蒈忾恺铠锎锴",kan:"看槛刊堪勘坎砍侃莰阚戡龛瞰",kang:"康慷糠扛抗亢炕伉闶钪",kao:"考拷烤靠尻栲犒铐",ke:"可科客课坷苛柯棵磕颗壳咳渴克刻嗑岢恪溘骒缂珂轲氪瞌钶锞稞疴窠颏蝌髁",ken:"肯啃垦恳裉龈",keng:"坑吭铿",kong:"控空恐孔倥崆箜",kou:"口抠扣寇芤蔻叩囗眍筘",ku:"枯哭窟苦酷库裤刳堀喾绔骷",kua:"夸垮挎跨胯侉",kuai:"会快块筷侩蒯郐哙狯浍脍",kuan:"款宽髋",kuang:"况匡筐狂框矿眶旷诓诳邝圹夼哐纩贶",kui:"亏盔岿窥葵奎魁傀馈愧溃馗匮夔隗蒉揆喹喟悝愦逵暌睽聩蝰篑跬",kun:"坤昆捆困悃阃琨锟醌鲲髡",kuo:"括扩廓阔蛞",la:"垃拉喇蜡腊辣啦落剌邋旯砬瘌",lai:"来莱赖崃徕涞濑赉睐铼癞籁",lan:"览蓝婪栏拦篮阑兰澜谰揽懒缆烂滥岚漤榄斓罱镧褴",lang:"琅榔狼廊郎朗浪蒗啷阆稂螂",lao:"老捞劳牢佬姥酪烙涝潦唠崂忉栳铑铹痨耢醪",le:"了乐勒仂叻泐鳓",lei:"类雷镭蕾磊累儡垒擂肋泪羸诔嘞嫘缧檑耒酹",leng:"棱楞冷塄愣",li:"理里力立历离利丽厘梨犁黎篱狸漓李鲤礼莉荔吏栗厉励砾傈例俐痢粒沥隶璃哩俪俚郦坜苈莅蓠藜呖唳喱猁溧澧逦娌嫠骊缡枥栎轹膦戾砺詈罹锂鹂疠疬蛎蜊蠡笠篥粝醴跞雳鲡鳢黧",lia:"俩",lian:"联链连练脸莲镰廉怜涟帘敛恋炼蔹奁潋濂琏楝殓臁裢裣蠊鲢",liang:"量两良亮俩粮凉梁粱辆晾谅墚莨椋锒踉靓魉",liao:"了料疗撩聊僚燎寥辽潦撂镣廖蓼尥嘹獠寮缭钌鹩",lie:"列裂烈劣猎冽埒捩咧洌趔躐鬣",lin:"琳林磷霖临邻鳞淋凛赁吝拎蔺啉嶙廪懔遴檩辚瞵粼躏麟",ling:"领另铃令玲菱零龄伶羚凌灵陵岭酃苓呤囹泠绫柃棂瓴聆蛉翎鲮",liu:"留浏流溜琉榴硫馏刘瘤柳六遛骝绺旒熘锍镏鹨鎏","long":"龙聋咙笼窿隆垄拢陇垅茏泷珑栊胧砻癃",lou:"楼娄搂篓漏陋露偻蒌喽嵝镂瘘耧蝼髅",lu:"录陆芦卢颅庐炉掳卤虏鲁麓碌露路赂鹿潞禄戮垆撸噜泸渌漉逯璐栌橹轳辂辘氇胪镥鸬鹭簏舻鲈",lv:"律旅虑驴吕铝侣履屡缕氯率滤绿偻捋闾榈膂稆褛",luan:"峦挛孪滦卵乱脔娈栾鸾銮",lue:"略掠锊",lun:"论抡轮伦仑沦纶囵",luo:"络咯烙萝螺罗逻锣箩骡裸落洛骆倮蠃荦摞猡泺漯珞椤脶镙瘰跞雒",ma:"码妈马麻玛蚂骂嘛吗抹唛犸杩蟆麽",mai:"买埋麦卖迈脉劢荬霾",man:"满瞒馒蛮蔓曼慢漫谩墁幔缦熳镘颟螨鳗鞔",mang:"芒茫盲氓忙莽邙漭硭蟒",mao:"贸猫茅锚毛矛铆卯茂冒帽貌袤茆峁泖瑁昴牦耄旄懋瞀蝥蟊髦",me:"么麽",mei:"没美每媒魅玫枚梅酶霉煤眉镁昧寐妹媚糜莓嵋猸浼湄楣镅鹛袂",men:"们门闷扪焖懑钔",meng:"盟萌蒙檬锰猛梦孟勐甍瞢懵朦礞虻蜢蠓艋艨",mi:"密眯醚靡糜迷谜弥米秘觅泌蜜幂芈谧咪嘧猕汨宓弭脒祢敉縻麋",mian:"面免棉眠绵冕勉娩缅沔渑湎腼眄",miao:"描苗瞄藐秒渺庙妙喵邈缈缪杪淼眇鹋",mie:"蔑灭乜咩蠛篾",min:"民抿皿敏悯闽苠岷闵泯缗玟珉愍黾鳘",ming:"明名命螟鸣铭冥茗溟暝瞑酩",miu:"谬缪",mo:"没模脉摸摹蘑膜磨摩魔抹末莫墨默沫漠寞陌谟茉蓦馍嫫嬷殁镆秣瘼耱貊貘麽",mou:"谋牟某侔哞缪眸蛑鍪",mu:"目母牟拇牡亩姆墓暮幕募慕木睦牧穆仫坶苜沐毪钼",na:"那拿哪呐钠娜纳讷捺肭镎衲",nai:"氖乃奶耐奈鼐佴艿萘柰",nan:"男南难喃囝囡楠腩蝻赧",nang:"囊攮囔馕曩",nao:"脑挠恼闹淖孬垴呶猱瑙硇铙蛲",ne:"呢讷",nei:"内馁",nen:"嫩恁",neng:"能",ni:"你妮霓倪泥尼拟匿腻逆溺伲坭蘼猊怩昵旎睨铌鲵",nian:"年蔫拈碾撵捻念粘廿埝辇黏鲇鲶",niang:"娘酿",niao:"鸟尿茑嬲脲袅",nie:"捏聂孽啮镊镍涅乜陧蘖嗫颞臬蹑",nin:"您",ning:"柠狞凝宁拧泞佞咛甯聍",niu:"牛扭钮纽拗狃忸妞",nong:"农脓浓弄侬哝",nu:"努奴怒弩胬孥驽",nv:"女恧钕衄",nuan:"暖",nue:"虐疟挪",nuo:"娜懦糯诺傩搦喏锘",o:"哦噢",ou:"欧鸥殴藕呕偶沤讴怄瓯耦",pa:"扒耙啪趴爬帕怕琶葩杷筢",pai:"牌派排拍徘湃俳蒎哌",pan:"攀潘盘磐盼畔判叛胖拚爿泮袢襻蟠蹒",pang:"磅乓庞旁耪胖彷夂滂逄攵螃",pao:"抛咆刨炮袍跑泡匏狍庖脬疱",pei:"培配呸胚裴赔陪佩沛辔帔旆锫醅霈",pen:"喷盆湓",peng:"朋砰抨烹澎彭蓬棚硼篷膨鹏捧碰堋嘭怦蟛",pi:"否被辟坯砒霹批披劈琵毗啤脾疲皮匹痞僻屁譬丕仳陴邳郫圮埤鼙芘擗噼庀淠媲纰枇甓罴铍癖疋蚍蜱貔",pian:"片便篇偏骗谝骈犏胼翩蹁",piao:"漂飘瓢票剽莩嘌嫖缥殍瞟螵",pie:"撇瞥丿苤彡氕",pin:"品频聘拼贫姘嫔榀牝颦",ping:"评平冯乒坪苹萍凭瓶屏俜娉枰鲆",po:"坡泼颇婆破魄迫粕叵鄱珀钋钷皤笸",pu:"普暴扑铺仆莆葡菩蒲埔朴圃浦谱曝瀑匍噗溥濮璞氆镤镨蹼",qi:"其企起期汽器启气奇缉欺栖戚妻七凄漆柒沏棋歧畦崎脐齐旗祈祁骑岂乞契砌迄弃泣讫亓俟圻芑芪萁萋葺蕲嘁屺岐汔淇骐绮琪琦杞桤槭耆祺憩碛颀蛴蜞綦鳍麒",qia:"夹掐恰洽葜袷髂",qian:"前钱牵扦钎铅千迁签仟谦乾黔钳潜遣浅谴堑嵌欠歉纤倩佥阡芊芡茜荨掮岍悭慊骞搴褰缱椠肷愆钤虔箝",qiang:"强将枪呛腔羌墙蔷抢戕嫱樯戗炝锖锵镪襁蜣羟跄",qiao:"壳橇锹敲悄桥瞧乔侨巧鞘撬翘峭俏窍削劁诮谯荞峤愀憔缲樵硗跷鞒",qie:"且切茄怯窃郄惬慊妾挈锲箧趄",qin:"亲钦侵秦琴勤芹擒禽寝沁芩揿吣嗪噙溱檎锓矜覃螓衾",qing:"情请庆轻青氢倾卿清擎晴氰顷苘圊檠磬蜻罄綮謦鲭黥",qiong:"琼穷邛茕穹蛩筇跫銎",qiu:"求球秋丘邱囚酋泅俅巯犰湫逑遒楸赇虬蚯蝤裘糗鳅鼽",qu:"区去取曲趋蛆躯屈驱渠娶龋趣诎劬苣蕖蘧岖衢阒璩觑氍朐祛磲鸲癯蛐蠼麴瞿黢",quan:"全权圈颧醛泉痊拳犬券劝诠荃犭悛绻辁畎铨蜷筌鬈",que:"确缺炔瘸却鹊榷雀阕阙悫",qun:"裙群逡麇",ran:"然燃冉染苒蚺髯",rang:"让瓤壤攘嚷禳穰",rao:"饶扰绕荛娆桡",re:"惹热喏",ren:"人任认壬仁忍韧刃妊纫仞荏饪轫稔衽",reng:"扔仍",ri:"日",rong:"容戎茸蓉荣融熔溶绒冗嵘狨榕肜蝾",rou:"揉柔肉糅蹂鞣",ru:"如入茹蠕儒孺辱乳汝褥蓐薷嚅洳溽濡缛铷襦颥",ruan:"软阮朊",rui:"蕊瑞锐芮蕤枘睿蚋",run:"闰润",ruo:"若弱偌箬",sa:"撒洒萨卅挲脎飒",sai:"赛腮鳃塞噻",san:"三叁伞散仨彡馓毵糁",sang:"桑嗓丧搡磉颡",sao:"搔骚扫嫂埽缫臊瘙鳋",se:"色塞瑟涩啬铯穑",sen:"森",seng:"僧",sha:"莎砂杀刹沙纱傻啥煞厦唼挲歃铩痧裟霎鲨",shai:"筛晒酾",shan:"删山珊苫杉煽衫闪陕擅赡膳善汕扇缮栅剡讪鄯埏芟潸姗嬗骟膻钐疝蟮舢跚鳝",shang:"上商尚赏墒伤晌裳垧泷绱殇熵觞",shao:"少绍鞘梢捎稍烧芍勺韶哨邵劭苕潲杓蛸筲艄",she:"设社奢赊蛇舌舍赦摄射慑涉厍佘揲猞滠歙畲麝",shen:"什身参深神甚申砷呻伸娠绅沈审婶肾慎渗诜谂莘葚哂渖椹胂矧蜃糁",sheng:"生声乘甥牲升绳省盛剩胜圣嵊渑晟眚笙",shi:"是时式什市实使事示始世施识视试师史十食势释失室匙狮湿诗尸虱石拾蚀矢屎驶士柿拭誓逝嗜噬适仕侍饰氏恃嘘谥埘莳蓍弑轼贳炻礻铈螫舐筮豕鲥鲺",shou:"手首受授收售守寿瘦兽狩绶艏",shu:"数术束输属殊述蔬枢梳抒叔舒淑疏书赎孰熟薯暑曙署蜀黍鼠树戍竖墅庶漱恕俞丨倏塾菽摅沭澍姝纾毹腧殳秫",shua:"刷耍唰",shuai:"率摔衰甩帅蟀",shuan:"栓拴闩涮",shuang:"霜双爽孀",shui:"说水谁睡税",shun:"吮瞬顺舜",shuo:"数说硕朔烁蒴搠妁槊铄",si:"司思似食四斯撕嘶私丝死肆寺嗣伺饲巳厮俟兕厶咝汜泗澌姒驷缌祀锶鸶耜蛳笥",song:"松送耸怂颂宋讼诵凇菘崧嵩忪悚淞竦",sou:"搜艘擞嗽叟薮嗖嗾馊溲飕瞍锼螋",su:"速诉苏素酥俗粟僳塑溯宿肃缩夙谡蔌嗉愫涑簌觫稣",suan:"算酸蒜狻",sui:"虽随隋绥髓碎岁穗遂隧祟谇荽濉邃燧眭睢",sun:"孙损笋荪狲飧榫隼",suo:"所索莎蓑梭唆缩琐锁唢嗦嗍娑桫挲睃羧",ta:"他它她塌塔獭挞蹋踏嗒闼溻漯遢榻沓铊趿鳎",tai:"大态台胎苔抬泰酞太汰邰薹骀肽炱钛跆鲐",tan:"坛弹坍摊贪瘫滩檀痰潭谭谈坦毯袒碳探叹炭郯澹昙忐钽锬覃",tang:"汤塘搪堂棠膛唐糖倘躺淌趟烫傥帑惝溏瑭樘铴镗耥螗螳羰醣",tao:"讨掏涛滔绦萄桃逃淘陶套鼗叨啕洮韬饕",te:"特忒忑慝铽",teng:"藤腾疼誊滕",ti:"题提体梯剔踢锑蹄啼替嚏惕涕剃屉倜荑悌逖绨缇鹈裼醍",tian:"天添填田甜恬舔腆掭忝阗殄畋",tiao:"调条挑迢眺跳佻苕祧窕蜩笤粜龆鲦髫",tie:"帖贴铁萜餮",ting:"庭听厅烃汀廷停亭挺艇莛葶婷梃铤蜓霆",tong:"同统通桐酮瞳铜彤童桶捅筒痛佟仝茼嗵恸潼砼",tou:"投头偷透骰",tu:"图突凸秃徒途涂屠土吐兔堍荼菟钍酴",tuan:"团湍抟彖疃",tui:"推颓腿蜕褪退忒煺",tun:"囤褪吞屯臀氽饨暾豚",tuo:"拖托脱鸵陀驮驼椭妥拓唾乇佗坨庹沱柝��橐砣箨酡跎鼍",wa:"挖哇蛙洼娃瓦袜佤娲腽",wai:"外歪崴",wan:"完湾万晚玩蔓豌弯顽丸烷碗挽皖惋宛婉腕剜芄莞菀纨绾琬脘畹蜿",wang:"网望汪王亡枉往旺忘妄罔惘辋魍",wei:"为位威未围维委巍微危韦违桅唯惟潍苇萎伟伪尾纬蔚味畏胃喂魏渭谓尉慰卫偎诿隈隗圩葳薇帏帷崴嵬猥猬闱沩洧涠逶娓玮韪軎炜煨痿艉鲔",wen:"文问闻稳瘟温蚊纹吻紊刎夂阌汶璺攵雯",weng:"嗡翁瓮蓊蕹",wo:"我挝蜗涡窝斡卧握沃倭莴喔幄渥肟硪龌",wu:"务无误物午恶巫呜钨乌污诬屋芜梧吾吴毋武五捂舞伍侮坞戊雾晤勿悟兀仵阢邬圬芴唔庑怃忤寤迕妩婺骛杌牾焐鹉鹜痦蜈鋈鼯",xi:"系息戏习希细西喜析栖昔熙硒矽晰嘻吸锡牺稀悉膝夕惜熄烯溪汐犀檄袭席媳铣洗隙僖兮隰郗茜菥葸蓰奚唏徙饩阋浠淅屣嬉玺樨曦觋欷歙熹禊禧皙穸裼蜥螅蟋舄舾羲粞翕醯蹊鼷",xia:"下瞎虾匣霞辖暇峡侠狭厦夏吓呷狎遐瑕柙硖罅黠",xian:"现限线显先见献衔险铣掀锨仙鲜纤咸贤舷闲涎弦嫌县腺馅羡宪陷冼苋莶藓岘猃暹娴氙燹祆鹇痫蚬筅籼酰跣跹霰",xiang:"相想项享详象响香像向降厢镶箱襄湘乡翔祥巷橡芗葙饷庠骧缃蟓鲞飨",xiao:"小销消效校萧硝霄削哮嚣宵淆晓孝肖啸笑哓崤潇逍骁绡枭枵蛸筱箫魈",xie:"些谢械楔歇蝎鞋协挟携邪斜胁谐写卸蟹懈泄泻屑偕亵勰燮薤撷獬廨渫瀣邂绁缬榭榍颉蹀躞",xin:"信新心欣薪芯锌辛忻衅囟馨莘昕歆镡鑫",xing:"行形型性幸姓省星腥猩惺兴刑邢醒杏陉荇荥擤饧悻硎",xiong:"兄凶胸匈汹雄熊芎",xiu:"修秀臭休羞朽嗅锈袖绣咻岫馐庥溴鸺貅髹",xu:"需许须序续墟戌虚嘘徐蓄酗叙旭畜恤絮婿绪吁诩勖圩蓿洫溆顼栩肷煦盱胥糈醑",xuan:"选宣轩喧悬旋玄癣眩绚儇谖萱揎泫渲漩璇楦暄炫煊碹铉镟痃",xue:"学削靴薛穴雪血谑噱泶踅鳕",xun:"询训讯迅寻浚勋熏循旬驯巡殉汛逊巽郇埙荀荨蕈薰峋徇獯恂洵浔曛窨醺鲟",ya:"压押鸦鸭呀丫芽牙蚜崖衙涯雅哑亚讶轧伢垭揠岈迓娅琊桠氩砑睚痖",yan:"言研验眼严颜焉咽阉烟淹盐蜒岩延阎炎沿奄掩衍演艳堰燕厌砚雁唁彦焰宴谚殷厣赝剡俨偃兖谳郾鄢埏芫菸崦恹闫阏湮滟妍嫣琰檐晏胭腌焱罨筵酽趼魇餍鼹",yang:"样央阳养殃鸯秧杨扬佯疡羊洋氧仰痒漾徉怏泱炀烊恙蛘鞅",yao:"要邀腰妖瑶摇尧遥窑谣姚咬舀药耀钥夭爻吆崾徭幺珧杳轺曜肴铫鹞窈繇鳐麽",ye:"业也页椰噎耶爷野冶掖叶曳腋夜液拽靥谒邺揶揲晔烨铘",yi:"一以已意易议医移艺益义艾蛇壹揖铱依伊衣颐夷遗仪胰疑沂宜姨彝椅蚁倚乙矣抑邑屹亿役臆逸肄疫亦裔毅忆溢诣谊译异翼翌绎刈劓佚佾诒圯埸懿苡荑薏弈奕挹弋呓咦咿嗌噫峄嶷猗饴怿怡悒漪迤驿缢殪轶贻欹旖熠眙钇镒镱痍瘗癔翊蜴舣羿翳酏黟",yin:"因音引银茵荫殷阴姻吟淫寅饮尹隐印胤鄞垠堙茚吲喑狺夤洇氤铟瘾窨蚓霪龈",ying:"影应营英迎樱婴鹰缨莹萤荧蝇赢盈颖硬映嬴郢茔荥莺萦蓥撄嘤膺滢潆瀛瑛璎楹媵鹦瘿颍罂",yo:"哟唷",yong:"用拥永佣臃痈庸雍踊蛹咏泳涌恿勇俑壅墉喁慵邕镛甬鳙饔",you:"有游由友优右邮幽悠忧尤铀犹油酉佑釉诱又幼卣攸侑莠莜莸尢呦囿宥柚猷牖铕疣蚰蚴蝣蝤繇鱿黝鼬",yu:"于育语域娱与遇尉迂淤盂榆虞愚舆余俞逾鱼愉渝渔隅予雨屿禹宇羽玉芋郁吁喻峪御愈欲狱誉浴寓裕预豫驭粥禺毓伛俣谀谕萸蓣揄圄圉嵛狳饫馀庾阈鬻妪妤纡瑜昱觎腴欤於煜熨燠聿畲钰鹆鹬瘐瘀窬窳蜮蝓竽臾舁雩龉",yuan:"员原源元院远鸳渊冤垣袁援辕园圆猿缘苑愿怨垸塬芫掾圜沅媛瑗橼爰眢鸢螈箢鼋",yue:"说乐阅越曰约跃钥岳粤月悦龠哕瀹栎樾刖钺",yun:"运耘云郧匀陨允蕴酝晕韵孕郓芸狁恽愠纭韫殒昀氲熨筠",za:"匝砸杂咋拶咂",zai:"在载子再栽哉灾宰崽甾",zan:"暂咱攒赞瓒昝簪糌趱錾",zang:"赃脏葬奘驵臧",zao:"造遭糟凿藻枣早澡蚤躁噪皂灶燥唣",ze:"责择则泽咋仄赜啧帻迮昃笮箦舴",zei:"贼",zen:"怎谮",zeng:"增综曾憎赠缯甑罾锃",zha:"扎喳渣札轧铡闸眨栅榨咋乍炸诈柞揸吒咤哳楂砟痄蚱齄",zhai:"翟摘斋宅窄债寨砦瘵",zhan:"站展战瞻毡詹粘沾盏斩辗崭蘸栈占湛绽谵搌旃",zhang:"章长张樟彰漳掌涨杖丈帐账仗胀瘴障仉鄣幛嶂獐嫜璋蟑",zhao:"着照找招朝昭沼赵罩兆肇召爪诏棹钊笊",zhe:"这者着浙遮折哲蛰辙锗蔗乇谪摺柘辄磔鹧褶蜇螫赭",zhen:"真圳珍斟甄砧臻贞针侦枕疹诊震振镇阵帧蓁浈缜桢椹榛轸赈胗朕祯畛稹鸩箴",zheng:"正政整证争蒸挣睁征狰怔拯症郑诤峥徵钲铮筝",zhi:"只之知制置址支直至织治质执职值致指志芝枝吱蜘肢脂汁植殖侄止趾旨纸挚掷帜峙智秩稚炙痔滞窒卮陟郅埴芷摭帙忮彘咫骘栉枳栀桎轵轾贽胝膣祉黹雉鸷痣蛭絷酯跖踬踯豸觯",zhong:"中种重终盅忠钟衷肿仲众冢忪锺螽舯踵",zhou:"州舟周洲诌粥轴肘帚咒皱宙昼骤荮啁妯纣绉胄碡籀繇酎",zhu:"注主助筑属珠株蛛朱猪诸诛逐竹烛煮拄瞩嘱著柱蛀贮铸住祝驻伫侏邾苎茱洙渚潴杼槠橥炷铢疰瘃竺箸舳翥躅麈",zhua:"挝抓爪",zhuai:"拽",zhuan:"专传转砖撰赚篆啭馔颛",zhuang:"状装幢桩庄妆撞壮僮",zhui:"椎锥追赘坠缀萑惴骓缒隹",zhun:"准屯谆肫窀",zhuo:"着捉拙卓桌琢茁酌啄灼浊倬诼擢浞涿濯禚斫镯",zi:"自资子字咨兹姿滋淄孜紫仔籽滓渍谘茈呲嵫姊孳缁梓辎赀恣眦锱秭耔笫粢趑觜訾龇鲻髭",zong:"综总鬃棕踪宗纵偬腙粽",zou:"邹走奏揍诹陬鄹驺鲰",zu:"组足租卒族祖诅阻俎菹镞",zuan:"钻纂攥缵躜",zui:"最嘴醉罪蕞觜",zun:"尊遵撙樽鳟",zuo:"作左昨佐柞做坐座阼唑嘬怍胙祚笮酢"};/*! cui 2016-11-08 */
var pinyinEngine=function(){return this instanceof pinyinEngine?this.resetCache():new pinyinEngine};window.pinyinEngine=pinyinEngine,pinyinEngine.prototype={search:function(a,b){var c=this._cache,d=this._history,e=[],f=0;a=a.toLowerCase(),b=b||function(){},d.length&&1===a.indexOf(d.keyword)&&(c=d.content);for(var g=0,h=c.length;h>g;g++)-1!==c[g].tags.indexOf(a)&&(f++,e.push(c[g]),b(c[g].content));return this._history={keyword:a,value:e,length:f},e},setCache:function(a,b){var c,d="";c=a;for(var e=0,f=a.length;f>e;e++)c.push(pinyinEngine.toPinyin(a[e],!1,d));c=c.join(d);var g={tags:c,content:b};this._cache.push(g)},resetCache:function(){this._cache=[],this._history={}}},pinyinEngine.toPinyin=function(){function a(a,b,c){for(var d,e=[],f=[],g=0,h=a.length;h>g;g++)for(var i=0,j=b.length;j>i;i++)d=e[e.length]=a[g]instanceof Array?a[g].concat(b[i]):[].concat(a[g],b[i]),f.push(d.join(""));return{array:e,string:f.join(c||"")}}var b,c,d,e,f=window.PINYIN_DATA,g={};for(var c in f)for(b=f[c],d=0,e=b.length;e>d;d++){var h=b.charAt(d);g[h]||(g[h]=[]),g[h].push(c)}return f=null,function(b,c,d){var e,f,h,i,j,k;if(null==b||0==b.length?e=0:("number"==typeof b&&"13"==b.toString().length&&(b=$.coral.longToStringDate(b)),e=b.length),0===e)return c?"":[];if(1===e)return k=g[b],c?k&&k[0]?k[0]:b:k||[b];var h=[];for(j=0;e>j;j++)k=g[b.charAt(j)],k?h[h.length]=c?k[0]:k:h[h.length]=c?b.charAt(j):[b.charAt(j)];if(c)return null==d?h:h.join(d||"");f=h[0],i=h.length;var l;for(j=1;i>j;j++)l=a(f,h[j],d),f=l.array;return null==d?f:l.string}}();/*! cui 2016-11-08 */
!function(){function a(a,b){this.element=a,this.options=$.extend({},d,b),this._defaults=d,this._name=c,this._loader=null,this.init()}function b(){$[c]||($.loading=function(a){$("body").loading(a)})}var c="loading",d={position:"overlay",text:"",loadingIcon:"coral-icon-loading",tpl:'<span class="loading-wrapper {wrapper}">{text}<span class="{loadingIcon}"></span></span>',disableSource:!1,disableOthers:[]};a.prototype={init:function(){$(this.element).is("body")&&(this.options.position="overlay"),this.show()},show:function(){var a=this,b=a.options.tpl.replace("{wrapper}"," loading-show ");switch(b=b.replace("{loadingIcon}",a.options.loadingIcon),b=b.replace("{text}",""!==a.options.text?a.options.text+" ":""),a._loader=$(b),$(a.element).is("input, textarea")&&!0===a.options.disableSource?$(a.element).attr("disabled","disabled"):!0===a.options.disableSource&&$(a.element).addClass("disabled"),a.options.position){case"inside":$(a.element).append(a._loader);break;case"overlay":var c=null;if($(a.element).is("body"))c=$('<div class="coral-loading" style="position:fixed; left:0; top:0; z-index: 10001; width: 100%; height: '+$(window).height()+'px;" />'),c.prepend("<div class ='coral-component-overlay'/>"),$("body").prepend(c);else{var d=$(a.element).css("position"),e={},f=$(a.element).outerHeight()+"px",g="100%";e="relative"===d||"absolute"===d?{top:0,left:0}:$(a.element).position(),c=$('<div class="coral-loading" style="position:absolute; top: '+e.top+"px; left: "+e.left+"px; z-index: 10000; width: "+g+"; height: "+f+';" />'),c.prepend("<div style='position:absolute;width:100%;height:100%;'><div class ='coral-component-overlay'style='position:relative;'></div></div>"),$(a.element).prepend(c)}c.append(a._loader),a._loader.css({top:c.outerHeight()/2-a._loader.outerHeight()/2+"px"});break;default:$(a.element).after(a._loader)}a.disableOthers()},refresh:function(){var a=null,b=this,c=$(b.element).css("position"),d={},e=$(b.element).outerHeight()+"px",f="100%";d="relative"===c||"absolute"===c?{top:0,left:0}:$(b.element).position(),a=$(b.element).find(".coral-loading"),a.css({top:d.top,left:d.left,width:f,height:e}),b._loader.css({top:a.outerHeight()/2-b._loader.outerHeight()/2+"px"})},hide:function(){"overlay"===this.options.position?$(this.element).find(".coral-loading").first().remove():($(this._loader).remove(),$(this.element).text($(this.element).attr("data-loading-label"))),$(this.element).removeAttr("disabled").removeClass("disabled"),this.enableOthers()},disableOthers:function(){$.each(this.options.disableOthers,function(a,b){var c=$(b);c.is("button, input, textarea")?c.attr("disabled","disabled"):c.addClass("disabled")})},enableOthers:function(){$.each(this.options.disableOthers,function(a,b){var c=$(b);c.is("button, input, textarea")?c.removeAttr("disabled"):c.removeClass("disabled")})}};var e=Array.prototype.slice;$.fn[c]=function(b){var d=this,f=e.call(arguments,1),g="string"==typeof b;return this.each(function(){if(g){if($.data(this,"plugin_"+c)){var e,h=$.data(this,"plugin_"+c);if(!$.isFunction(h[b])||"_"===b.charAt(0))return $.error("no such method '"+b+"' for "+name+" component instance");if(e=h[b].apply(h,f),e!==h&&void 0!==e)return d=e&&e.jquery?d.pushStack(e.get()):e,!1}}else $.data(this,"plugin_"+c,new a(this,b))})},b()}();/*! cui 2016-11-08 */
$(function(){$(document).tooltip({items:"[data-errors]",content:function(){var a=$(this);return a.is("[data-errors]")?a.attr("data-errors"):void 0},show:{effect:"fadeIn",delay:300},tooltipClass:"coral-state-error",hide:{effect:"fadeOut",delay:0},position:{my:"left top",at:"left bottom+5"}})});/*! cui 2016-11-08 */
$.component("coral.subfield",{version:"4.0.1",options:{title:"",lineCls:null,textCls:null,onClick:null},_create:function(){this.element.jquery||(this.element=$(this.element)),this.element.addClass("coral-subfield"),this.fieldset=$('<fieldset class="coral-subfield-fieldset"></fieldset>').appendTo(this.element),this.options.lineCls&&this.fieldset.addClass(this.options.lineCls),this.legend=$('<legend class="coral-subfield-legend">'+this.options.title+"</legend>").appendTo(this.fieldset),this.options.textCls&&this.legend.addClass(this.options.textCls),this._bindEvent()},_bindEvent:function(){var a=this;this.legend.bind("click"+this.eventNamespace,function(b){a.options.disabled?(b.preventDefault(),b.stopImmediatePropagation()):a._trigger("onClick")})},_setOption:function(a,b){"title"===a&&this.setTitle(b)},_destroy:function(){this.uiTitle.remove()},component:function(){return this.element},show:function(){this.component().show()},hide:function(){this.component().hide()},setTitle:function(a){$("legend",this.fieldset).html(a),this.options.title=a},getTitle:function(){return this.options.title}});/*! cui 2016-11-08 */
!function(){function a(a){var f=a||window.event,g=h.call(arguments,1),i=0,k=0,l=0,m=0,n=0,o=0;if(a=$.event.fix(f),a.type="mousewheel","detail"in f&&(l=-1*f.detail),"wheelDelta"in f&&(l=f.wheelDelta),"wheelDeltaY"in f&&(l=f.wheelDeltaY),"wheelDeltaX"in f&&(k=-1*f.wheelDeltaX),"axis"in f&&f.axis===f.HORIZONTAL_AXIS&&(k=-1*l,l=0),i=0===l?k:l,"deltaY"in f&&(l=-1*f.deltaY,i=l),"deltaX"in f&&(k=f.deltaX,0===l&&(i=-1*k)),0!==l||0!==k){if(1===f.deltaMode){var p=$.data(this,"mousewheel-line-height");i*=p,l*=p,k*=p}else if(2===f.deltaMode){var q=$.data(this,"mousewheel-page-height");i*=q,l*=q,k*=q}if(m=Math.max(Math.abs(l),Math.abs(k)),(!e||e>m)&&(e=m,c(f,m)&&(e/=40)),c(f,m)&&(i/=40,k/=40,l/=40),i=Math[i>=1?"floor":"ceil"](i/e),k=Math[k>=1?"floor":"ceil"](k/e),l=Math[l>=1?"floor":"ceil"](l/e),j.settings.normalizeOffset&&this.getBoundingClientRect){var r=this.getBoundingClientRect();n=a.clientX-r.left,o=a.clientY-r.top}return a.deltaX=k,a.deltaY=l,a.deltaFactor=e,a.offsetX=n,a.offsetY=o,a.deltaMode=0,g.unshift(a,i,k,l),d&&clearTimeout(d),d=setTimeout(b,200),($.event.dispatch||$.event.handle).apply(this,g)}}function b(){e=null}function c(a,b){return j.settings.adjustOldDeltas&&"mousewheel"===a.type&&b%120===0}var d,e,f=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],g="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],h=Array.prototype.slice;if($.event.fixHooks)for(var i=f.length;i;)$.event.fixHooks[f[--i]]=$.event.mouseHooks;var j=$.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var b=g.length;b;)this.addEventListener(g[--b],a,!1);else this.onmousewheel=a;$.data(this,"mousewheel-line-height",j.getLineHeight(this)),$.data(this,"mousewheel-page-height",j.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var b=g.length;b;)this.removeEventListener(g[--b],a,!1);else this.onmousewheel=null;$.removeData(this,"mousewheel-line-height"),$.removeData(this,"mousewheel-page-height")},getLineHeight:function(a){var b=$(a),c=b["offsetParent"in $.fn?"offsetParent":"parent"]();return c.length||(c=$("body")),parseInt(c.css("fontSize"),10)||parseInt(b.css("fontSize"),10)||16},getPageHeight:function(a){return $(a).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};$.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})}();/*! cui 2016-11-08 */
$.component("coral.splitcontainer",{version:"4.1.4",options:{minWidth:"600"},_create:function(){var a,b=this,c=this.options,d=(this.element,$(this.element)),e=$(this.element).attr("id");d.addClass("coral-splitcontainer coral-splitcontainer-showhide");var f=$('<ul id="'+e+"_tree\" style='display:none'></ul>").appendTo("body");f.tree({},[{id:"appRoot",name:"appRoot",children:[{id:"appMaster",name:"appMaster",children:[]},{id:"appDetails",name:"appDetails",children:[]}]}]),this.curDetailNode,this.pageIdArray=[],this.historyIdArray=[],this.arr=[];var g=$("#"+e).children("div")[0],h=$("#"+e).children("div")[1];""==g.id&&(g.id="splitContainer-Master"),""==h.id&&(h.id="splitContainer-Detail"),$("#"+g.id).addClass("coral-nav coral-splitcontainer-master coral-splitcontainer-mastervisible"),$("#"+h.id).addClass("coral-nav coral-splitcontainer-detail");var i=b.getTree().tree("getNodeByParam","id","appMaster"),j=b.getTree().tree("getNodeByParam","id","appDetails");this.curDetailNode=j,$("#"+g.id).children("div").each(function(a){c=$.parser.parseOptions(this,[]);var d=b._createView(this.id,c,$("#"+g.id),i);b.getTree().tree("addNodes",i,d),b.options.initialMaster||0!=a||(b.options.initialMaster=this.id),b.initialMaster=$("#"+b.options.initialMaster)}),$("#"+h.id).children("div").each(function(a){c=$.parser.parseOptions(this,[]);var d=b._createView(this.id,c,$("#"+h.id),j);b.getTree().tree("addNodes",j,d),b.options.initialDetail||0!=a||(b.options.initialDetail=this.id),c.title,b.initialDetail=$("#"+b.options.initialDetail)}),a=j.children[0].id,j.viewId="view_"+a,this.addView(a,$("#"+a)),this.toDetail(a),this.pageIdArray.push(a),this.historyIdArray.push(a),this._bindEvent()},addView:function(a,b){var c=$(this.element).attr("id"),d=$("#"+c).children("div")[1],e=this.getTree().tree("getNodeByParam","id",a);if(e){if(b&&"object"==typeof b)if(b.url)$("#"+e.id).panel("reload",b.url);else if(b.content){$("#"+e.id).panel("setContent",b.content);var f=this.initToolbar(b);$("#"+e.id).prev().find(".ctrl-init-toolbar").toolbar("reload",f)}}else{var g=this._createView(a,b,$("#"+d.id),this.curDetailNode);this.getTree().tree("addNodes",this.curDetailNode,g),e=this.getTree().tree("getNodeByParam","id",a)}return this.curDetailNode=e,this.pageIdArray.push(e.id),this.historyIdArray.push(e.id),e.level-2===this.arr.length&&this.arr.push(e),$("#"+e.id)},getCurrentView:function(a){return $("#"+this.curDetailNode.id)},toDetail:function(a,b){var c=(this.options,$(this.element).attr("id")),d=($("#"+c).children("div")[1],this.getTree().tree("getNodeByParam","id",a));d&&($("#"+d.viewId).siblings().hide(),$("#"+d.viewId).show()),d.data=b,$.coral.refreshAllComponent($("#"+a).parent()),this._trigger("onDetailNavigate",null,[{from:this.curDetailNode,fromId:this.curDetailNode.id,to:d,toId:a,direction:"to"}])},NodeRadio:function(a,b,c,d,e,f){var g={};return g.id=a,g.pId=b,g.name=a,g.isParent=c,g.open=d,g.icon=e,g.nocheck=f,g},_createView:function(a,b,c,d){var e,f,g,h=$("#"+a),i=$.inArray(a,this.pageIdArray);0==h.length&&(h=$("<div id='"+a+"'></div>")),i>-1?(g=this.getTree().tree("getNodeByParam","id",this.pageIdArray[i-1]),f=g.viewId,e=$("#"+f)):(f="view_"+a,e=$("<div id='"+f+"' class='coral-nav-item' style='width:100%'></div>").appendTo(c)),h.appendTo(e),this.initToolbar(b);var j=$.extend({},{fit:!0,componentCls:"coral-page",collapsible:!1},b);h.panel(j);var k=this.NodeRadio(a,d.id,!1,!0,null,!1);return k.viewId=f,k},initToolbar:function(a){var b=this,c={type:"button",icons:"cui-icon-arrow-left3",label:"back",text:!1,onClick:function(){b.backDetail()}},d={type:"html",content:a.title};return a.toolbarOptions=a.toolbarOptions||{},a.toolbarOptions.data=a.toolbarOptions.data||[],a.title&&(a.toolbarOptions.data.unshift("->"),a.toolbarOptions.data.unshift(d)),a.showNavButton&&(a.toolbarOptions.data.unshift("->"),a.toolbarOptions.data.unshift(c)),$.each(a.toolbarOptions.data,function(b,d){"navBtn"===this&&(a.toolbarOptions.data[b]=c)}),a.toolbarOptions.data},_bindEvent:function(){var a=this,b=$(this.element).attr("id");$("#"+b).children("div")[0];this._on(this.document,{click:function(b){var c=$(b.target),d=$(a.element).attr("id"),e=$("#"+d).children("div")[0],f=a.element.find(".coral-splitcontainer-master"),g=f.offset();(b.pageX<g.left||b.pageX>g.left+f.width()||b.pageY<g.top||b.pageY>g.top+f.height())&&!c.parent().is("button")&&$("#"+e.id).hasClass("showMaster")&&a.hideMaster()}})},showMaster:function(){var a=$(this.element).attr("id"),b=$("#"+a).children("div")[0];$("#"+a).children("div")[1];$("#"+b.id).addClass("showMaster")},hideMaster:function(){var a=$(this.element).attr("id"),b=$("#"+a).children("div")[0];$("#"+a).children("div")[1];$("#"+b.id).removeClass("showMaster")},maxDetail:function(a){var b=$(this.element).attr("id"),c=$("#"+b).children("div")[0],d=$("#"+b).children("div")[1];"max"==a?$("#"+b).removeClass("coral-splitcontainer-showhide").addClass("coral-splitcontainer-hidemode"):$("#"+b).removeClass("coral-splitcontainer-hidemode").addClass("coral-splitcontainer-showhide"),$("#"+c.id).removeClass("coral-splitcontainer-mastervisible showMaster").addClass("coral-splitcontainer-masterhidden"),$.coral.refreshAllComponent($("#"+d.id).parent())},refresh:function(){var a,b,c,d=this,e=$(this.element).attr("id"),f=$("#"+e).children("div")[0],g=$("#"+e).children("div")[1];this.initialDetail&&(b=$("#"+this.options.initialDetail).panel("option","title"),b&&(a=$("#"+this.options.initialDetail).panel("toolbar"))),$(window).width()<this.options.minWidth?($("#"+e).addClass("coral-splitcontainer-portrait"),a&&(c=a.toolbar("isExist",this.options.id+"_detailMenu"),c||a.toolbar("add",0,{id:this.options.id+"_detailMenu",type:"button",onClick:function(){d.showMaster()},icons:"cui-icon-menu7",text:!1,label:"菜单"})),$("#"+f.id).removeClass("coral-splitcontainer-mastervisible showMaster").addClass("coral-splitcontainer-masterhidden")):($("#"+e).removeClass("coral-splitcontainer-portrait"),$("#"+f.id).removeClass("coral-splitcontainer-masterhidden showMaster").addClass("coral-splitcontainer-mastervisible"),a&&(c=a.toolbar("isExist",this.options.id+"_detailMenu"),c&&a.toolbar("remove",0))),$.coral.refreshAllComponent($("#"+f.id)),$.coral.refreshAllComponent($("#"+g.id))},backDetail:function(a){var b=$.inArray(this.curDetailNode.id,this.historyIdArray);if(!(0>=b)){var c=this.getTree().tree("getNodeByParam","id",this.historyIdArray[b-1]);if($("#"+c.viewId).siblings().hide(),$("#"+c.viewId).show(),c.backData=a,b>-1){var d=this.historyIdArray.length,e=d-b;this.historyIdArray.splice(b,e)}$.coral.refreshAllComponent($("#"+c.id).parent()),this._trigger("onDetailNavigate",null,[{from:this.curDetailNode,fromId:this.curDetailNode.id,to:c,toId:c.id,direction:"back"}]),this.curDetailNode=c}},backToView:function(a,b){var c=$.inArray(a,this.historyIdArray);if(!(0>c)){var d=this.getTree().tree("getNodeByParam","id",a);$("#"+d.viewId).siblings().hide(),$("#"+d.viewId).show(),d.backData=b,$.coral.refreshAllComponent($("#"+a).parent()),this._trigger("onDetailNavigate",null,[{from:this.curDetailNode,fromId:this.curDetailNode.id,to:d,toId:d.id,direction:"backToView"}])}},backToTopDetail:function(a){var b=this.getTree().tree("getNodeByParam","id","appDetails");$("#"+b.viewId).siblings().hide(),$("#"+b.viewId).show(),b.backData=a,$.coral.refreshAllComponent($("#"+b.id).parent()),this._trigger("onDetailNavigate",null,[{from:this.curDetailNode,fromId:this.curDetailNode.id,to:b,toId:b.id,direction:"backToTop"}])},reload:function(a,b){var c;b||(this.curDetailNode=c=this.getTree().tree("getNodeByParam","id","appDetails")),this.toDetail(a)},getTree:function(){return $("#"+$(this.element).attr("id")+"_tree")}});/*! cui 2016-11-08 */
$.component("coral.view",{version:"@version",options:{controllerName:null,heightStyle:"auto"},_create:function(a,b){var c=this;this.options;this.element.addClass("coral-view coral-helper-reset"),$.controller(this.options.controllerName,{view:this.element,controllerName:this.options.controllerName});var d=$.controller(c.options.controllerName);$.parseDone({fun:d.onInit,context:d,args:[a,b]}),this._refresh()},_destroy:function(){},_setOption:function(a,b){this._super(a,b)},refresh:function(){this._refresh()},_refresh:function(){$.coral.refreshChild(this.element)}});/*! cui 2016-11-08 */
$.component("coral.adjusted",{_create:function(){this.element.addClass("ctrl-fit-element coral-scroll").removeClass("coral-adjusted"),this.element.hasClass("fill")&&this.element.removeClass("fill").addClass("coral-fill")},refresh:function(){var a,b=this.element,c=b.parent();a=c.height(),b.siblings(":visible").each(function(){var b=$(this),c=b.css("position");"absolute"!==c&&"fixed"!==c&&(a-=b.outerHeight(!0))}),b.height(Math.max(0,a-b.innerHeight()+b.height())).addClass("coral-scroll"),$.coral.refreshChild(this.element),$.coral.fitParent(c,!0)}});/*! cui 2016-11-08 */
$.grid=$.grid||{},$.extend($.grid,{defaults:{recordtext:"{0} - {1}　共 {2} 条",pagetext:"共 {0} 页",emptyrecords:"无数据显示",loadtext:"数据加载中...",pgtext:" {0} 共 {1} 页"},search:{caption:"搜索...",Find:"查找",Reset:"重置",odata:[{oper:"eq",text:"等于"},{oper:"ne",text:"不等"},{oper:"lt",text:"小于"},{oper:"le",text:"小于等于"},{oper:"gt",text:"大于"},{oper:"ge",text:"大于等于"},{oper:"bw",text:"开始于"},{oper:"bn",text:"不开始于"},{oper:"in",text:"包含"},{oper:"ni",text:"不包含"},{oper:"ew",text:"结束于"},{oper:"en",text:"不结束于"},{oper:"cn",text:"包含"},{oper:"nc",text:"不包含"},{oper:"nu",text:"空值"},{oper:"nn",text:"非空值"}],groupOps:[{op:"AND",text:"所有"},{op:"OR",text:"任一"}],matchText:" 匹配",rulesText:" 规则"},edit:{bUpdate:"更新",addCaption:"添加记录",editCaption:"编辑记录",bSubmit:"提交",bCancel:"取消",bClose:"关闭",saveData:"数据已改变，是否保存？",bYes:"是",bNo:"否",bExit:"取消",msg:{required:"此字段必需",number:"请输入有效数字",minValue:"输值必须大于等于 ",maxValue:"输值必须小于等于 ",email:"这不是有效的e-mail地址",integer:"请输入有效整数",date:"请输入有效时间",url:"无效网址。前缀必须为 ('http://' 或 'https://')",nodefined:" 未定义！",novalue:" 需要返回值！",customarray:"自定义函数需要返回数组！",customfcheck:"Custom function should be present in case of custom checking!"}},view:{caption:"查看记录",bClose:"关闭"},del:{caption:"删除",msg:"删除所选记录？",bSubmit:"删除",bCancel:"取消"},nav:{edittext:"",edittitle:"编辑所选记录",addtext:"",addtitle:"添加新记录",deltext:"",deltitle:"删除所选记录",searchtext:"",searchtitle:"查找",refreshtext:"",refreshtitle:"刷新表格",alertcap:"注意",alerttext:"请选择记录",viewtext:"",viewtitle:"查看所选记录"},col:{caption:"选择列",bSubmit:"确定",bCancel:"取消"},errors:{errcap:"错误",nourl:"没有设置url",norecords:"没有要处理的记录",model:"colNames 和 colModel 长度不等！"},formatter:{integer:{thousandsSeparator:",",defaultValue:"0"},number:{decimalSeparator:".",thousandsSeparator:" ",decimalPlaces:2,defaultValue:"0.00"},currency:{decimalSeparator:".",thousandsSeparator:" ",decimalPlaces:2,prefix:"",suffix:"",defaultValue:"0.00"},date:{dayNames:["Sun","Mon","Tue","Wed","Thr","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],AmPm:["am","pm","AM","PM"],S:function(a){return 11>a||a>13?["st","nd","rd","th"][Math.min((a-1)%10,3)]:"th"},srcformat:"Y-m-d",newformat:"m-d-Y",masks:{ISO8601Long:"Y-m-d H:i:s",ISO8601Short:"Y-m-d",ShortDate:"Y/j/n",LongDate:"l, F d, Y",FullDateTime:"l, F d, Y g:i:s A",MonthDay:"F d",ShortTime:"g:i A",LongTime:"g:i:s A",SortableDateTime:"Y-m-d\\TH:i:s",UniversalSortableDateTime:"Y-m-d H:i:sO",YearMonth:"F, Y"},reformatAfterEdit:!1},baseLinkUrl:"",showAction:"",target:"",checkbox:{},idName:"id"}});}));/*! cui 2016-11-08 */
var SWFUpload;void 0==SWFUpload&&(SWFUpload=function(a){this.initSWFUpload(a)}),SWFUpload.prototype.initSWFUpload=function(a){try{this.customSettings={},this.settings=a,this.eventQueue=[],this.movieName="SWFUpload_"+SWFUpload.movieCount++,this.movieElement=null,SWFUpload.instances[this.movieName]=this,this.initSettings(),this.loadFlash(),this.displayDebugInfo()}catch(b){throw delete SWFUpload.instances[this.movieName],b}},SWFUpload.instances={},SWFUpload.movieCount=0,SWFUpload.version="2.2.0 2009-03-25",SWFUpload.QUEUE_ERROR={QUEUE_LIMIT_EXCEEDED:-100,FILE_EXCEEDS_SIZE_LIMIT:-110,ZERO_BYTE_FILE:-120,INVALID_FILETYPE:-130},SWFUpload.UPLOAD_ERROR={HTTP_ERROR:-200,MISSING_UPLOAD_URL:-210,IO_ERROR:-220,SECURITY_ERROR:-230,UPLOAD_LIMIT_EXCEEDED:-240,UPLOAD_FAILED:-250,SPECIFIED_FILE_ID_NOT_FOUND:-260,FILE_VALIDATION_FAILED:-270,FILE_CANCELLED:-280,UPLOAD_STOPPED:-290},SWFUpload.FILE_STATUS={QUEUED:-1,IN_PROGRESS:-2,ERROR:-3,COMPLETE:-4,CANCELLED:-5},SWFUpload.BUTTON_ACTION={SELECT_FILE:-100,SELECT_FILES:-110,START_UPLOAD:-120},SWFUpload.CURSOR={ARROW:-1,HAND:-2},SWFUpload.WINDOW_MODE={WINDOW:"window",TRANSPARENT:"transparent",OPAQUE:"opaque"},SWFUpload.completeURL=function(a){if("string"!=typeof a||a.match(/^https?:\/\//i)||a.match(/^\//))return a;var b=(window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""),window.location.pathname.lastIndexOf("/"));return 0>=b?path="/":path=window.location.pathname.substr(0,b)+"/",path+a},SWFUpload.prototype.initSettings=function(){this.ensureDefault=function(a,b){this.settings[a]=void 0==this.settings[a]?b:this.settings[a]},this.ensureDefault("upload_url",""),this.ensureDefault("preserve_relative_urls",!1),this.ensureDefault("file_post_name","Filedata"),this.ensureDefault("post_params",{}),this.ensureDefault("use_query_string",!1),this.ensureDefault("requeue_on_error",!1),this.ensureDefault("http_success",[]),this.ensureDefault("assume_success_timeout",0),this.ensureDefault("file_types","*.*"),this.ensureDefault("file_types_description","All Files"),this.ensureDefault("file_size_limit",0),this.ensureDefault("file_upload_limit",0),this.ensureDefault("file_queue_limit",0),this.ensureDefault("flash_url","swfupload.swf"),this.ensureDefault("prevent_swf_caching",!0),this.ensureDefault("button_image_url",""),this.ensureDefault("button_width",1),this.ensureDefault("button_height",1),this.ensureDefault("button_text",""),this.ensureDefault("button_text_style","color: #000000; font-size: 16pt;"),this.ensureDefault("button_text_top_padding",0),this.ensureDefault("button_text_left_padding",0),this.ensureDefault("button_action",SWFUpload.BUTTON_ACTION.SELECT_FILES),this.ensureDefault("button_disabled",!1),this.ensureDefault("button_placeholder_id",""),this.ensureDefault("button_placeholder",null),this.ensureDefault("button_cursor",SWFUpload.CURSOR.ARROW),this.ensureDefault("button_window_mode",SWFUpload.WINDOW_MODE.WINDOW),this.ensureDefault("debug",!1),this.settings.debug_enabled=this.settings.debug,this.settings.return_upload_start_handler=this.returnUploadStart,this.ensureDefault("swfupload_loaded_handler",null),this.ensureDefault("file_dialog_start_handler",null),this.ensureDefault("file_queued_handler",null),this.ensureDefault("file_queue_error_handler",null),this.ensureDefault("file_dialog_complete_handler",null),this.ensureDefault("upload_start_handler",null),this.ensureDefault("upload_progress_handler",null),this.ensureDefault("upload_error_handler",null),this.ensureDefault("upload_success_handler",null),this.ensureDefault("upload_complete_handler",null),this.ensureDefault("debug_handler",this.debugMessage),this.ensureDefault("custom_settings",{}),this.customSettings=this.settings.custom_settings,this.settings.prevent_swf_caching&&(this.settings.flash_url=this.settings.flash_url+(this.settings.flash_url.indexOf("?")<0?"?":"&")+"preventswfcaching="+(new Date).getTime()),this.settings.preserve_relative_urls||(this.settings.upload_url=SWFUpload.completeURL(this.settings.upload_url),this.settings.button_image_url=this.settings.button_image_url?SWFUpload.completeURL(this.settings.button_image_url):this.settings.button_image_url),delete this.ensureDefault},SWFUpload.prototype.loadFlash=function(){var a,b;if(null!==document.getElementById(this.movieName))throw"ID "+this.movieName+" is already in use. The Flash Object could not be added";if(a=document.getElementById(this.settings.button_placeholder_id)||this.settings.button_placeholder,void 0==a)throw"Could not find the placeholder element: "+this.settings.button_placeholder_id;b=document.createElement("div"),b.innerHTML=this.getFlashHTML(),a.parentNode.replaceChild(b.firstChild,a),void 0==window[this.movieName]&&(window[this.movieName]=this.getMovieElement())},SWFUpload.prototype.getFlashHTML=function(){return['<object id="',this.movieName,'" type="application/x-shockwave-flash" data="',this.settings.flash_url,'" width="',this.settings.button_width,'" height="',this.settings.button_height,'" class="swfupload">','<param name="wmode" value="',this.settings.button_window_mode,'" />','<param name="movie" value="',this.settings.flash_url,'" />','<param name="quality" value="high" />','<param name="menu" value="false" />','<param name="allowScriptAccess" value="sameDomain"/>','<param name="flashvars" value="'+this.getFlashVars()+'" />',"</object>"].join("")},SWFUpload.prototype.getFlashVars=function(){var a=this.buildParamString(),b=this.settings.http_success.join(",");return["movieName=",encodeURIComponent(this.movieName),"&amp;uploadURL=",encodeURIComponent(this.settings.upload_url),"&amp;useQueryString=",encodeURIComponent(this.settings.use_query_string),"&amp;requeueOnError=",encodeURIComponent(this.settings.requeue_on_error),"&amp;httpSuccess=",encodeURIComponent(b),"&amp;assumeSuccessTimeout=",encodeURIComponent(this.settings.assume_success_timeout),"&amp;params=",encodeURIComponent(a),"&amp;filePostName=",encodeURIComponent(this.settings.file_post_name),"&amp;fileTypes=",encodeURIComponent(this.settings.file_types),"&amp;fileTypesDescription=",encodeURIComponent(this.settings.file_types_description),"&amp;fileSizeLimit=",encodeURIComponent(this.settings.file_size_limit),"&amp;fileUploadLimit=",encodeURIComponent(this.settings.file_upload_limit),"&amp;fileQueueLimit=",encodeURIComponent(this.settings.file_queue_limit),"&amp;debugEnabled=",encodeURIComponent(this.settings.debug_enabled),"&amp;buttonImageURL=",encodeURIComponent(this.settings.button_image_url),"&amp;buttonWidth=",encodeURIComponent(this.settings.button_width),"&amp;buttonHeight=",encodeURIComponent(this.settings.button_height),"&amp;buttonText=",encodeURIComponent(this.settings.button_text),"&amp;buttonTextTopPadding=",encodeURIComponent(this.settings.button_text_top_padding),"&amp;buttonTextLeftPadding=",encodeURIComponent(this.settings.button_text_left_padding),"&amp;buttonTextStyle=",encodeURIComponent(this.settings.button_text_style),"&amp;buttonAction=",encodeURIComponent(this.settings.button_action),"&amp;buttonDisabled=",encodeURIComponent(this.settings.button_disabled),"&amp;buttonCursor=",encodeURIComponent(this.settings.button_cursor)].join("")},SWFUpload.prototype.getMovieElement=function(){if(void 0==this.movieElement&&(this.movieElement=document.getElementById(this.movieName)),null===this.movieElement)throw"Could not find Flash element";return this.movieElement},SWFUpload.prototype.buildParamString=function(){var a=this.settings.post_params,b=[];if("object"==typeof a)for(var c in a)a.hasOwnProperty(c)&&b.push(encodeURIComponent(c.toString())+"="+encodeURIComponent(a[c].toString()));return b.join("&amp;")},SWFUpload.prototype.reduceUploadCount=function(){this.callFlash("reduceUploadCount")},SWFUpload.prototype.addUploadCount=function(){this.callFlash("addUploadCount")},SWFUpload.prototype.destroy=function(){try{this.cancelUpload(null,!1),this.callFlash("Destroy");var a=null;if(a=this.getMovieElement(),a&&"unknown"==typeof a.CallFunction){for(var b in a)try{"function"==typeof a[b]&&(a[b]=null)}catch(c){}try{a.parentNode.removeChild(a)}catch(d){}}return window[this.movieName]=null,SWFUpload.instances[this.movieName]=null,delete SWFUpload.instances[this.movieName],this.movieElement=null,this.settings=null,this.customSettings=null,this.eventQueue=null,this.movieName=null,!0}catch(e){return!1}},SWFUpload.prototype.displayDebugInfo=function(){this.debug(["---SWFUpload Instance Info---\n","Version: ",SWFUpload.version,"\n","Movie Name: ",this.movieName,"\n","Settings:\n","	","upload_url:               ",this.settings.upload_url,"\n","	","flash_url:                ",this.settings.flash_url,"\n","	","use_query_string:         ",this.settings.use_query_string.toString(),"\n","	","requeue_on_error:         ",this.settings.requeue_on_error.toString(),"\n","	","http_success:             ",this.settings.http_success.join(", "),"\n","	","assume_success_timeout:   ",this.settings.assume_success_timeout,"\n","	","file_post_name:           ",this.settings.file_post_name,"\n","	","post_params:              ",this.settings.post_params.toString(),"\n","	","file_types:               ",this.settings.file_types,"\n","	","file_types_description:   ",this.settings.file_types_description,"\n","	","file_size_limit:          ",this.settings.file_size_limit,"\n","	","file_upload_limit:        ",this.settings.file_upload_limit,"\n","	","file_queue_limit:         ",this.settings.file_queue_limit,"\n","	","debug:                    ",this.settings.debug.toString(),"\n","	","prevent_swf_caching:      ",this.settings.prevent_swf_caching.toString(),"\n","	","button_placeholder_id:    ",this.settings.button_placeholder_id.toString(),"\n","	","button_placeholder:       ",this.settings.button_placeholder?"Set":"Not Set","\n","	","button_image_url:         ",this.settings.button_image_url.toString(),"\n","	","button_width:             ",this.settings.button_width.toString(),"\n","	","button_height:            ",this.settings.button_height.toString(),"\n","	","button_text:              ",this.settings.button_text.toString(),"\n","	","button_text_style:        ",this.settings.button_text_style.toString(),"\n","	","button_text_top_padding:  ",this.settings.button_text_top_padding.toString(),"\n","	","button_text_left_padding: ",this.settings.button_text_left_padding.toString(),"\n","	","button_action:            ",this.settings.button_action.toString(),"\n","	","button_disabled:          ",this.settings.button_disabled.toString(),"\n","	","custom_settings:          ",this.settings.custom_settings.toString(),"\n","Event Handlers:\n","	","swfupload_loaded_handler assigned:  ",("function"==typeof this.settings.swfupload_loaded_handler).toString(),"\n","	","file_dialog_start_handler assigned: ",("function"==typeof this.settings.file_dialog_start_handler).toString(),"\n","	","file_queued_handler assigned:       ",("function"==typeof this.settings.file_queued_handler).toString(),"\n","	","file_queue_error_handler assigned:  ",("function"==typeof this.settings.file_queue_error_handler).toString(),"\n","	","upload_start_handler assigned:      ",("function"==typeof this.settings.upload_start_handler).toString(),"\n","	","upload_progress_handler assigned:   ",("function"==typeof this.settings.upload_progress_handler).toString(),"\n","	","upload_error_handler assigned:      ",("function"==typeof this.settings.upload_error_handler).toString(),"\n","	","upload_success_handler assigned:    ",("function"==typeof this.settings.upload_success_handler).toString(),"\n","	","upload_complete_handler assigned:   ",("function"==typeof this.settings.upload_complete_handler).toString(),"\n","	","debug_handler assigned:             ",("function"==typeof this.settings.debug_handler).toString(),"\n"].join(""))},SWFUpload.prototype.addSetting=function(a,b,c){return void 0==b?this.settings[a]=c:this.settings[a]=b},SWFUpload.prototype.getSetting=function(a){return void 0!=this.settings[a]?this.settings[a]:""},SWFUpload.prototype.callFlash=function(functionName,argumentArray){argumentArray=argumentArray||[];var movieElement=this.getMovieElement(),returnValue,returnString;try{returnString=movieElement.CallFunction('<invoke name="'+functionName+'" returntype="javascript">'+__flash__argumentsToXML(argumentArray,0)+"</invoke>"),returnValue=eval(returnString)}catch(ex){throw"Call to "+functionName+" failed"}return void 0!=returnValue&&"object"==typeof returnValue.post&&(returnValue=this.unescapeFilePostParams(returnValue)),returnValue},SWFUpload.prototype.selectFile=function(){this.callFlash("SelectFile")},SWFUpload.prototype.selectFiles=function(){this.callFlash("SelectFiles")},SWFUpload.prototype.startUpload=function(a){this.callFlash("StartUpload",[a])},SWFUpload.prototype.cancelUpload=function(a,b){b!==!1&&(b=!0),this.callFlash("CancelUpload",[a,b])},SWFUpload.prototype.stopUpload=function(){this.callFlash("StopUpload")},SWFUpload.prototype.getStats=function(){return this.callFlash("GetStats")},SWFUpload.prototype.setStats=function(a){this.callFlash("SetStats",[a])},SWFUpload.prototype.getFile=function(a){return"number"==typeof a?this.callFlash("GetFileByIndex",[a]):this.callFlash("GetFile",[a])},SWFUpload.prototype.addFileParam=function(a,b,c){return this.callFlash("AddFileParam",[a,b,c])},SWFUpload.prototype.removeFileParam=function(a,b){this.callFlash("RemoveFileParam",[a,b])},SWFUpload.prototype.setUploadURL=function(a){this.settings.upload_url=a.toString(),this.callFlash("SetUploadURL",[a])},SWFUpload.prototype.setPostParams=function(a){this.settings.post_params=a,this.callFlash("SetPostParams",[a])},SWFUpload.prototype.addPostParam=function(a,b){this.settings.post_params[a]=b,this.callFlash("SetPostParams",[this.settings.post_params])},SWFUpload.prototype.removePostParam=function(a){delete this.settings.post_params[a],this.callFlash("SetPostParams",[this.settings.post_params])},SWFUpload.prototype.setFileTypes=function(a,b){this.settings.file_types=a,this.settings.file_types_description=b,this.callFlash("SetFileTypes",[a,b])},SWFUpload.prototype.setFileSizeLimit=function(a){this.settings.file_size_limit=a,this.callFlash("SetFileSizeLimit",[a])},SWFUpload.prototype.setFileUploadLimit=function(a){this.settings.file_upload_limit=a,this.callFlash("SetFileUploadLimit",[a])},SWFUpload.prototype.setFileQueueLimit=function(a){this.settings.file_queue_limit=a,this.callFlash("SetFileQueueLimit",[a])},SWFUpload.prototype.setFilePostName=function(a){this.settings.file_post_name=a,this.callFlash("SetFilePostName",[a])},SWFUpload.prototype.setUseQueryString=function(a){this.settings.use_query_string=a,this.callFlash("SetUseQueryString",[a])},SWFUpload.prototype.setRequeueOnError=function(a){this.settings.requeue_on_error=a,this.callFlash("SetRequeueOnError",[a])},SWFUpload.prototype.setHTTPSuccess=function(a){"string"==typeof a&&(a=a.replace(" ","").split(",")),this.settings.http_success=a,this.callFlash("SetHTTPSuccess",[a])},SWFUpload.prototype.setAssumeSuccessTimeout=function(a){this.settings.assume_success_timeout=a,this.callFlash("SetAssumeSuccessTimeout",[a])},SWFUpload.prototype.setDebugEnabled=function(a){this.settings.debug_enabled=a,this.callFlash("SetDebugEnabled",[a])},SWFUpload.prototype.setButtonImageURL=function(a){void 0==a&&(a=""),this.settings.button_image_url=a,this.callFlash("SetButtonImageURL",[a])},SWFUpload.prototype.setButtonDimensions=function(a,b){this.settings.button_width=a,this.settings.button_height=b;var c=this.getMovieElement();void 0!=c&&(c.style.width=a+"px",c.style.height=b+"px"),this.callFlash("SetButtonDimensions",[a,b])},SWFUpload.prototype.setButtonText=function(a){this.settings.button_text=a,this.callFlash("SetButtonText",[a])},SWFUpload.prototype.setButtonTextPadding=function(a,b){this.settings.button_text_top_padding=b,this.settings.button_text_left_padding=a,this.callFlash("SetButtonTextPadding",[a,b])},SWFUpload.prototype.setButtonTextStyle=function(a){this.settings.button_text_style=a,this.callFlash("SetButtonTextStyle",[a])},SWFUpload.prototype.setButtonDisabled=function(a){this.settings.button_disabled=a,this.callFlash("SetButtonDisabled",[a])},SWFUpload.prototype.setButtonAction=function(a){this.settings.button_action=a,this.callFlash("SetButtonAction",[a])},SWFUpload.prototype.setButtonCursor=function(a){this.settings.button_cursor=a,this.callFlash("SetButtonCursor",[a])},SWFUpload.prototype.queueEvent=function(a,b){void 0==b?b=[]:b instanceof Array||(b=[b]);var c=this;if("function"==typeof this.settings[a])this.eventQueue.push(function(){this.settings[a].apply(this,b)}),setTimeout(function(){c.executeNextEvent()},0);else if(null!==this.settings[a])throw"Event handler "+a+" is unknown or is not a function"},SWFUpload.prototype.executeNextEvent=function(){var a=this.eventQueue?this.eventQueue.shift():null;"function"==typeof a&&a.apply(this)},SWFUpload.prototype.unescapeFilePostParams=function(a){var b,c=/[$]([0-9a-f]{4})/i,d={};if(void 0!=a){for(var e in a.post)if(a.post.hasOwnProperty(e)){b=e;for(var f;null!==(f=c.exec(b));)b=b.replace(f[0],String.fromCharCode(parseInt("0x"+f[1],16)));d[b]=a.post[e]}a.post=d}return a},SWFUpload.prototype.testExternalInterface=function(){try{return this.callFlash("TestExternalInterface")}catch(a){return!1}},SWFUpload.prototype.flashReady=function(){var a=this.getMovieElement();return a?(this.cleanUp(a),void this.queueEvent("swfupload_loaded_handler")):void this.debug("Flash called back ready but the flash movie can't be found.")},SWFUpload.prototype.cleanUp=function(a){try{if(this.movieElement&&"unknown"==typeof a.CallFunction){this.debug("Removing Flash functions hooks (this should only run in IE and should prevent memory leaks)");for(var b in a)try{"function"==typeof a[b]&&b[0]>="A"&&b[0]<="Z"&&(a[b]=null)}catch(c){}}}catch(d){}window.__flash__removeCallback=function(a,b){try{a&&(a[b]=null)}catch(c){}}},SWFUpload.prototype.fileDialogStart=function(){this.queueEvent("file_dialog_start_handler")},SWFUpload.prototype.fileQueued=function(a){a=this.unescapeFilePostParams(a),this.queueEvent("file_queued_handler",a)},SWFUpload.prototype.fileQueueError=function(a,b,c){a=this.unescapeFilePostParams(a),this.queueEvent("file_queue_error_handler",[a,b,c])},SWFUpload.prototype.fileDialogComplete=function(a,b,c){this.queueEvent("file_dialog_complete_handler",[a,b,c])},SWFUpload.prototype.uploadStart=function(a){a=this.unescapeFilePostParams(a),this.queueEvent("return_upload_start_handler",a)},SWFUpload.prototype.returnUploadStart=function(a){var b;if("function"==typeof this.settings.upload_start_handler)a=this.unescapeFilePostParams(a),b=this.settings.upload_start_handler.call(this,a);else if(void 0!=this.settings.upload_start_handler)throw"upload_start_handler must be a function";void 0===b&&(b=!0),b=!!b,this.callFlash("ReturnUploadStart",[b])},SWFUpload.prototype.uploadProgress=function(a,b,c){a=this.unescapeFilePostParams(a),this.queueEvent("upload_progress_handler",[a,b,c])},SWFUpload.prototype.uploadError=function(a,b,c){a=this.unescapeFilePostParams(a),this.queueEvent("upload_error_handler",[a,b,c])},SWFUpload.prototype.uploadSuccess=function(a,b,c){a=this.unescapeFilePostParams(a),this.queueEvent("upload_success_handler",[a,b,c])},SWFUpload.prototype.uploadComplete=function(a){a=this.unescapeFilePostParams(a),this.queueEvent("upload_complete_handler",a)},SWFUpload.prototype.debug=function(a){this.queueEvent("debug_handler",a)},SWFUpload.prototype.debugMessage=function(a){if(this.settings.debug){var b,c=[];if("object"==typeof a&&"string"==typeof a.name&&"string"==typeof a.message){for(var d in a)a.hasOwnProperty(d)&&c.push(d+": "+a[d]);b=c.join("\n")||"",c=b.split("\n"),b="EXCEPTION: "+c.join("\nEXCEPTION: "),SWFUpload.Console.writeLine(b)}else SWFUpload.Console.writeLine(a)}},SWFUpload.Console={},SWFUpload.Console.writeLine=function(a){var b,c;try{b=document.getElementById("SWFUpload_Console"),b||(c=document.createElement("form"),document.getElementsByTagName("body")[0].appendChild(c),b=document.createElement("textarea"),b.id="SWFUpload_Console",b.style.fontFamily="monospace",b.setAttribute("wrap","off"),b.wrap="off",b.style.overflow="auto",b.style.width="700px",b.style.height="350px",b.style.margin="5px",c.appendChild(b)),b.value+=a+"\n",b.scrollTop=b.scrollHeight-b.clientHeight}catch(d){alert("Exception: "+d.name+" Message: "+d.message)}};